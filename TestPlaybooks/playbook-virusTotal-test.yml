id: virusTotal-test-playbook
version: -1
name: virusTotal-test-playbook
description: |
  Test playbook for vt.

  vt has a quota of requests per minute that we exceed in the test playbook.

  Sleep for 60 seconds.

  https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c65b8bce-0597-4f9b-8bab-cb3367156da6
    type: start
    task:
      id: c65b8bce-0597-4f9b-8bab-cb3367156da6
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: c15ba1ed-3cd0-45d7-8a37-5082bbc11fb2
    type: regular
    task:
      id: c15ba1ed-3cd0-45d7-8a37-5082bbc11fb2
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 78dfffa6-8d71-47e3-864a-ab1553e059b8
    type: regular
    task:
      id: 78dfffa6-8d71-47e3-864a-ab1553e059b8
      version: -1
      name: ip
      description: Check IP Reputation
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: f7c1d374-e4f1-45a0-828d-545756b47823
    type: condition
    task:
      id: f7c1d374-e4f1-45a0-828d-545756b47823
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: 8.8.8.8
      - - operator: isEqualString
          left:
            value:
              simple: IP.Geo.Country
            iscontext: true
          right:
            value:
              simple: US
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: cd39c68d-4fb6-4ee2-8342-4618c46b1fbd
    type: regular
    task:
      id: cd39c68d-4fb6-4ee2-8342-4618c46b1fbd
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: fe05a415-83b7-4597-8dc0-ff1ded48a927
    type: regular
    task:
      id: fe05a415-83b7-4597-8dc0-ff1ded48a927
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      expectedValue:
        simple: demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 748a5900-b6d0-4654-8486-ee4327271065
    type: regular
    task:
      id: 748a5900-b6d0-4654-8486-ee4327271065
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 8c41e884-a585-4c82-8481-6f7c3453eadc
    type: regular
    task:
      id: 8c41e884-a585-4c82-8481-6f7c3453eadc
      version: -1
      name: domain
      description: Check domain reputation
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      domain:
        simple: demisto.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: de3b28ab-2c77-432e-8276-6dd0ba2383b2
    type: regular
    task:
      id: de3b28ab-2c77-432e-8276-6dd0ba2383b2
      version: -1
      name: file
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 8e55aa8a-4f6f-4d8d-8ab4-e2b2ce474c59
    type: condition
    task:
      id: 8e55aa8a-4f6f-4d8d-8ab4-e2b2ce474c59
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: File.MD5
            iscontext: true
          right:
            value:
              simple: 7657fcb7d772448a6d8504e4b20168b8
      - - operator: isEqualNumber
          left:
            value:
              simple: File.DetectionEngines
            iscontext: true
          right:
            value:
              simple: "71"
      - - operator: isEqualString
          left:
            value:
              simple: File.PositiveDetections
            iscontext: true
          right:
            value:
              simple: "67"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: eea9f04b-4255-42a2-8b0e-a4c3379a1f5a
    type: regular
    task:
      id: eea9f04b-4255-42a2-8b0e-a4c3379a1f5a
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 75d2d479-119b-4974-8070-3388c6684333
    type: regular
    task:
      id: 75d2d479-119b-4974-8070-3388c6684333
      version: -1
      name: url long demisto.com
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      long:
        simple: "true"
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 67ff006f-81ad-4073-8a37-21d36cf387e5
    type: regular
    task:
      id: 67ff006f-81ad-4073-8a37-21d36cf387e5
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 3d239612-5f7c-4e4a-8a3e-b6357717af93
    type: regular
    task:
      id: 3d239612-5f7c-4e4a-8a3e-b6357717af93
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 38e8f811-d513-4812-8d3a-f8ea99896328
    type: regular
    task:
      id: 38e8f811-d513-4812-8d3a-f8ea99896328
      version: -1
      name: file (second hash)
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: ff78458f-12e1-4a7d-87a2-888d36d8be89
    type: condition
    task:
      id: ff78458f-12e1-4a7d-87a2-888d36d8be89
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value:
              simple: d41d8cd98f00b204e9800998ecf8427e
      - - operator: isExists
          left:
            value:
              simple: File.VirusTotal.vtLink
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: 1db8cd78-dd97-40b3-892f-7c0f31d7b424
    type: regular
    task:
      id: 1db8cd78-dd97-40b3-892f-7c0f31d7b424
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: d8a3074b-3f05-404a-8775-f7027da00a0d
    type: regular
    task:
      id: d8a3074b-3f05-404a-8775-f7027da00a0d
      version: -1
      name: file long (second hash)
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long:
        simple: "true"
      retries: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: f7fc0d4b-49bf-4ad6-8bb6-570954bf663e
    type: regular
    task:
      id: f7fc0d4b-49bf-4ad6-8bb6-570954bf663e
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: 79e674f0-3d43-4503-8ab1-f8c4f6b519a2
    type: condition
    task:
      id: 79e674f0-3d43-4503-8ab1-f8c4f6b519a2
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value:
              simple: d41d8cd98f00b204e9800998ecf8427e
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: 8b8eb0d1-056f-464f-82ac-e09873de8fa2
    type: regular
    task:
      id: 8b8eb0d1-056f-464f-82ac-e09873de8fa2
      version: -1
      name: file long
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long:
        simple: "true"
      retries: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: e797ad80-312d-4958-8d8b-aa173e052b83
    type: condition
    task:
      id: e797ad80-312d-4958-8d8b-aa173e052b83
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: MD5
            iscontext: true
          right:
            value:
              simple: 7657fcb7d772448a6d8504e4b20168b8
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "29":
    id: "29"
    taskid: bcd02737-4298-4cab-8066-f0279cfffa26
    type: regular
    task:
      id: bcd02737-4298-4cab-8066-f0279cfffa26
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "30":
    id: "30"
    taskid: ddb52a6f-02f2-4090-8751-f6bc6449d719
    type: regular
    task:
      id: ddb52a6f-02f2-4090-8751-f6bc6449d719
      version: -1
      name: url coffedoesgood.com
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold:
        simple: "0"
      url:
        simple: http://coffeedoesgood.com
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "31":
    id: "31"
    taskid: b5bb25a5-2b77-40e2-8082-05073c800560
    type: regular
    task:
      id: b5bb25a5-2b77-40e2-8082-05073c800560
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      expectedValue:
        simple: http://coffeedoesgood.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "32":
    id: "32"
    taskid: 394c1ff4-5388-409f-8ef3-eb48da432a34
    type: regular
    task:
      id: 394c1ff4-5388-409f-8ef3-eb48da432a34
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "33":
    id: "33"
    taskid: 1618944a-fceb-4691-894b-5048efb48b81
    type: regular
    task:
      id: 1618944a-fceb-4691-894b-5048efb48b81
      version: -1
      name: url long coffedoesgood.com
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "75"
    scriptarguments:
      long:
        simple: "true"
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold:
        simple: "0"
      url:
        simple: http://coffeedoesgood.com
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "34":
    id: "34"
    taskid: 26526cc2-4fcc-461b-80ef-e8f3186df20d
    type: condition
    task:
      id: 26526cc2-4fcc-461b-80ef-e8f3186df20d
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Indicator
            iscontext: true
          right:
            value:
              simple: http://coffeedoesgood.com
      - - operator: isEqualNumber
          left:
            value:
              simple: URL.DetectionEngines
            iscontext: true
          right:
            value:
              simple: "70"
      - - operator: isEqualNumber
          left:
            value:
              simple: URL.PositiveDetections
            iscontext: true
          right:
            value:
              simple: "4"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "35":
    id: "35"
    taskid: 7bb2c14b-cbcf-4ed2-8523-f45e19d3e19f
    type: regular
    task:
      id: 7bb2c14b-cbcf-4ed2-8523-f45e19d3e19f
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "36":
    id: "36"
    taskid: b25514eb-0b56-4843-858a-0cff62435969
    type: regular
    task:
      id: b25514eb-0b56-4843-858a-0cff62435969
      version: -1
      name: url demisto.com
      description: Check URL Reputation
      script: VirusTotal|||url
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "37":
    id: "37"
    taskid: 3796047d-386c-4c87-819b-e3408286a3d1
    type: regular
    task:
      id: 3796047d-386c-4c87-819b-e3408286a3d1
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "38":
    id: "38"
    taskid: 6cdbe3d8-af35-4e34-81f1-7a4b814bc7eb
    type: regular
    task:
      id: 6cdbe3d8-af35-4e34-81f1-7a4b814bc7eb
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "42":
    id: "42"
    taskid: 7945ca3e-59a0-4504-8457-dbc44971eea5
    type: regular
    task:
      id: 7945ca3e-59a0-4504-8457-dbc44971eea5
      version: -1
      name: domain
      description: Check domain reputation
      script: VirusTotal|||domain
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      domain:
        simple: demisto.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold:
        simple: "0"
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "43":
    id: "43"
    taskid: 8b3af19f-e27c-4387-8109-557ec6e0ad90
    type: regular
    task:
      id: 8b3af19f-e27c-4387-8109-557ec6e0ad90
      version: -1
      name: VerifyContext
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      expectedValue:
        simple: demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "44":
    id: "44"
    taskid: c70f8bee-0464-4e77-8d77-50b83f3ec91b
    type: regular
    task:
      id: c70f8bee-0464-4e77-8d77-50b83f3ec91b
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      all:
        simple: "yes"
      key: {}
      keysToKeep: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "51":
    id: "51"
    taskid: 0f89c642-e886-44d2-8d67-77ca1d9bc3fe
    type: regular
    task:
      id: 0f89c642-e886-44d2-8d67-77ca1d9bc3fe
      version: -1
      name: Set
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      append: {}
      key:
        simple: File.SHA1
      value:
        simple: 3395856ce81f2b7382dee72602f798b642f14140
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "52":
    id: "52"
    taskid: c7f88219-8a1e-48b2-827d-6175cec07b8f
    type: regular
    task:
      id: c7f88219-8a1e-48b2-827d-6175cec07b8f
      version: -1
      name: Set2
      description: Sets a value into the context with the given context key
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: File.SHA1
      value:
        simple: cf8bd9dfddff007f75adf4c2be48005cea317c62
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "53":
    id: "53"
    taskid: 47e7445e-dc48-4220-86e8-3a8e3428fb64
    type: regular
    task:
      id: 47e7445e-dc48-4220-86e8-3a8e3428fb64
      version: -1
      name: File (1 call)
      description: Check file reputation of the given hash
      script: VirusTotal|||file
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      file:
        complex:
          root: File
          accessor: SHA1
      long: {}
      retries: {}
      threshold:
        simple: "1"
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "54":
    id: "54"
    taskid: 7076a609-e91b-4426-874b-b8fc3d5a93fb
    type: regular
    task:
      id: 7076a609-e91b-4426-874b-b8fc3d5a93fb
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "56":
    id: "56"
    taskid: 8fdce6cc-2882-42e7-8f0e-6c88bf9842d5
    type: condition
    task:
      id: 8fdce6cc-2882-42e7-8f0e-6c88bf9842d5
      version: -1
      name: Exists
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    scriptarguments:
      value:
        complex:
          root: File
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: File.MD5
                iscontext: true
              right:
                value:
                  simple: 44d88612fea8a8f36de82e1278abb02f
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "57":
    id: "57"
    taskid: 2df15cc2-8f7f-4719-8009-9241d729c819
    type: condition
    task:
      id: 2df15cc2-8f7f-4719-8009-9241d729c819
      version: -1
      name: Exists2
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      scriptName: Exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    scriptarguments:
      value:
        complex:
          root: File
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: File.MD5
                iscontext: true
              right:
                value:
                  simple: 69630e4574ec6798239b091cda43dca0
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "58":
    id: "58"
    taskid: f33c7c1d-3c40-4f1f-815a-4b848c6ea936
    type: condition
    task:
      id: f33c7c1d-3c40-4f1f-815a-4b848c6ea936
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "59":
    id: "59"
    taskid: 270f73cc-d543-470f-80bc-fed81e1c86ef
    type: condition
    task:
      id: 270f73cc-d543-470f-80bc-fed81e1c86ef
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "60":
    id: "60"
    taskid: 93a78e55-9534-40b9-816d-414ae671254d
    type: condition
    task:
      id: 93a78e55-9534-40b9-816d-414ae671254d
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "61"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "61":
    id: "61"
    taskid: 213dac33-edaf-47e3-8b14-446ac36f3877
    type: condition
    task:
      id: 213dac33-edaf-47e3-8b14-446ac36f3877
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "83"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "62":
    id: "62"
    taskid: 44d1e25a-0e25-4f5c-8945-5eb5898ba467
    type: condition
    task:
      id: 44d1e25a-0e25-4f5c-8945-5eb5898ba467
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "63":
    id: "63"
    taskid: 252522f3-0eea-471e-8c5e-e36c519d6aca
    type: condition
    task:
      id: 252522f3-0eea-471e-8c5e-e36c519d6aca
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "64":
    id: "64"
    taskid: 7bff4533-2f64-45db-8ac0-e273e79495d5
    type: condition
    task:
      id: 7bff4533-2f64-45db-8ac0-e273e79495d5
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "65":
    id: "65"
    taskid: e7607e0d-b909-40ec-84da-c5ddc104fc80
    type: condition
    task:
      id: e7607e0d-b909-40ec-84da-c5ddc104fc80
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "9"
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "66":
    id: "66"
    taskid: 673b52b6-75ab-4c14-8681-0925b6db3132
    type: condition
    task:
      id: 673b52b6-75ab-4c14-8681-0925b6db3132
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "67":
    id: "67"
    taskid: ad8dbe67-7bca-428b-8e87-0fbbeddd955f
    type: condition
    task:
      id: ad8dbe67-7bca-428b-8e87-0fbbeddd955f
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "29"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "68":
    id: "68"
    taskid: 0d65378c-266a-452c-84ee-cdcf2c3da66e
    type: condition
    task:
      id: 0d65378c-266a-452c-84ee-cdcf2c3da66e
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "69"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "69":
    id: "69"
    taskid: ca6f86de-0a4f-4bad-8081-453772290953
    type: condition
    task:
      id: ca6f86de-0a4f-4bad-8081-453772290953
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "71":
    id: "71"
    taskid: 1e53103d-f1cd-41ee-82c1-65a99e4968f8
    type: condition
    task:
      id: 1e53103d-f1cd-41ee-82c1-65a99e4968f8
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "72":
    id: "72"
    taskid: 8c0046cb-954a-43d7-85ec-bcc842bf07e5
    type: condition
    task:
      id: 8c0046cb-954a-43d7-85ec-bcc842bf07e5
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "71"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "73":
    id: "73"
    taskid: 464138ad-4d1a-4027-8739-0a9f1a6929a4
    type: condition
    task:
      id: 464138ad-4d1a-4027-8739-0a9f1a6929a4
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "31"
      "yes":
      - "74"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "74":
    id: "74"
    taskid: 98dfa0b9-3d0e-4f8f-8e20-6770dc0306e8
    type: condition
    task:
      id: 98dfa0b9-3d0e-4f8f-8e20-6770dc0306e8
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "75":
    id: "75"
    taskid: 4bf68b05-214e-4102-8c3f-d0358cfa61ac
    type: condition
    task:
      id: 4bf68b05-214e-4102-8c3f-d0358cfa61ac
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "76":
    id: "76"
    taskid: 2d53e2f6-228e-437d-8a19-48cc0f8922b4
    type: condition
    task:
      id: 2d53e2f6-228e-437d-8a19-48cc0f8922b4
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "77":
    id: "77"
    taskid: 8a1fd868-a9f9-4061-8111-1906be794693
    type: condition
    task:
      id: 8a1fd868-a9f9-4061-8111-1906be794693
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "78":
    id: "78"
    taskid: b2300cf7-6428-40ac-839b-a855609f2ce8
    type: condition
    task:
      id: b2300cf7-6428-40ac-839b-a855609f2ce8
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "79":
    id: "79"
    taskid: 328ae0db-cc33-40ae-8555-47282d9b782c
    type: condition
    task:
      id: 328ae0db-cc33-40ae-8555-47282d9b782c
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "80"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "80":
    id: "80"
    taskid: 1fb2e369-2bf5-4943-805e-3c1026a8b22c
    type: condition
    task:
      id: 1fb2e369-2bf5-4943-805e-3c1026a8b22c
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "81":
    id: "81"
    taskid: c6b211d6-aed7-4d84-8c33-45e47a2dfbba
    type: condition
    task:
      id: c6b211d6-aed7-4d84-8c33-45e47a2dfbba
      version: -1
      name: Check for error
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "82"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: ${Error}
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "82":
    id: "82"
    taskid: 4e7db897-573f-4beb-89e2-0d790ae23fcd
    type: condition
    task:
      id: 4e7db897-573f-4beb-89e2-0d790ae23fcd
      version: -1
      name: Check if error is API-RATE
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${Error}
            iscontext: true
          right:
            value:
              simple: No content received. Possible API rate limit reached.
    view: |-
      {
        "position": {
          "x": 480,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "83":
    id: "83"
    taskid: 0229d12e-1f4b-4822-8c0d-e07068727bea
    type: regular
    task:
      id: 0229d12e-1f4b-4822-8c0d-e07068727bea
      version: -1
      name: ip
      description: Check IP Reputation
      script: VirusTotal|||ip
      type: regular
      iscommand: true
      brand: VirusTotal
    nexttasks:
      '#none#':
      - "84"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "84":
    id: "84"
    taskid: 5cb8fd7c-ce9c-4268-8ee3-29bb8f9af216
    type: condition
    task:
      id: 5cb8fd7c-ce9c-4268-8ee3-29bb8f9af216
      version: -1
      name: Verify no duplicates
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: IP
                filters:
                - - operator: hasLength
                    left:
                      value:
                        simple: IP.Address
                      iscontext: true
                    right:
                      value:
                        simple: "1"
                accessor: Address
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "85":
    id: "85"
    taskid: f52aade2-9bd8-4fe2-8dbd-6dec9ab94837
    type: regular
    task:
      id: f52aade2-9bd8-4fe2-8dbd-6dec9ab94837
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      seconds:
        simple: "61"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 9690,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
