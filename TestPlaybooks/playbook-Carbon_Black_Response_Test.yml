id: CarbonBlackResponseTest
version: -1
name: Carbon Black Response Test
description: Tests carbon black enterprise response selected use cases and commands
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 6db30955-1640-4b01-8217-f72ca111cd89
    type: start
    task:
      id: 6db30955-1640-4b01-8217-f72ca111cd89
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: f2398fc7-b916-4c12-859e-d18d60407e32
    type: title
    task:
      id: f2398fc7-b916-4c12-859e-d18d60407e32
      version: -1
      name: Isolate Endpoint
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: da8f4faa-35d0-4088-8b92-e63553814899
    type: title
    task:
      id: da8f4faa-35d0-4088-8b92-e63553814899
      version: -1
      name: Search for a binary and fetch it
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 40687efe-502e-4fd9-8d91-5b7905d4d977
    type: title
    task:
      id: 40687efe-502e-4fd9-8d91-5b7905d4d977
      version: -1
      name: Add hash to blacklist
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: f1fc334e-8e2e-468c-829b-be57553ab200
    type: regular
    task:
      id: f1fc334e-8e2e-468c-829b-be57553ab200
      version: -1
      name: List available sensors
      script: carbonblack-v2|||cb-sensor-info
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      groupid: {}
      hostname:
        simple: WIN-SOSSKVTTQAB
      ip: {}
      sensor: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: c0465d88-1763-4d1f-8bac-acd07755721e
    type: regular
    task:
      id: c0465d88-1763-4d1f-8bac-acd07755721e
      version: -1
      name: Isolate (quarantine) sensor (endpoint)
      script: carbonblack-v2|||cb-quarantine-device
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      sensor:
        simple: ${CbResponse.FilteredSensors.[0].CbSensorID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: 1b2edf0a-a497-427d-83e5-889838e9ba80
    type: regular
    task:
      id: 1b2edf0a-a497-427d-83e5-889838e9ba80
      version: -1
      name: Check that sensor was blocked
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      expectedValue:
        simple: '["Blocked"]'
      fields: {}
      path:
        simple: Endpoint.LastAction
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: dea50d4a-a2bb-46ce-816c-1df1c7c42044
    type: regular
    task:
      id: dea50d4a-a2bb-46ce-816c-1df1c7c42044
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 83693315-95f7-4052-8629-ddd5ea92c8ad
    type: regular
    task:
      id: 83693315-95f7-4052-8629-ddd5ea92c8ad
      version: -1
      name: Get binaries by query
      script: carbonblack-v2|||cb-binary
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      facet: {}
      query: {}
      rows: {}
      sort: {}
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4450
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 42c4730c-74d9-4a42-8632-c6ac4d0819f8
    type: regular
    task:
      id: 42c4730c-74d9-4a42-8632-c6ac4d0819f8
      version: -1
      name: cb-block-hash
      script: carbonblack-v2|||cb-block-hash
      type: regular
      iscommand: true
      brand: carbonblack-v2
    scriptarguments:
      banCount: {}
      lastBanHost: {}
      lastBanTime: {}
      md5hash:
        simple: ${CbResponse.BlockedHashes.[0].MD5}
      text:
        simple: Reason for blocking hash
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: 6550edab-5ae1-49f5-8e26-122b246ccd13
    type: regular
    task:
      id: 6550edab-5ae1-49f5-8e26-122b246ccd13
      version: -1
      name: cb-unblock-hash
      script: carbonblack-v2|||cb-unblock-hash
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      md5hash:
        simple: ${CbResponse.BlockedHashes.[0].MD5}
      text:
        simple: Unblocked for testing
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: c2787c01-5afb-4f45-8f8a-61a0c028f878
    type: regular
    task:
      id: c2787c01-5afb-4f45-8f8a-61a0c028f878
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: 10793127-d960-4f11-85f8-f6f87fca815f
    type: regular
    task:
      id: 10793127-d960-4f11-85f8-f6f87fca815f
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: f6316f74-77e2-48c0-8f0a-9a602ab6d956
    type: regular
    task:
      id: f6316f74-77e2-48c0-8f0a-9a602ab6d956
      version: -1
      name: Get hash blacklist and choose an item to unblock and block
      script: carbonblack-v2|||cb-get-hash-blacklist
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      filter:
        simple: enabled == true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 5120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: 7e89e11c-31a5-4b14-8df5-5a0b4d2d0f74
    type: title
    task:
      id: 7e89e11c-31a5-4b14-8df5-5a0b4d2d0f74
      version: -1
      name: Update alert's status
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: 419968f1-0648-435d-83a4-cc7984c0df9f
    type: regular
    task:
      id: 419968f1-0648-435d-83a4-cc7984c0df9f
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "29":
    id: "29"
    taskid: b60b905d-9b88-406e-821c-5b7d8f0ddac2
    type: regular
    task:
      id: b60b905d-9b88-406e-821c-5b7d8f0ddac2
      version: -1
      name: List alerts
      script: carbonblack-v2|||cb-alert
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      facet: {}
      query: {}
      rows: {}
      sort: {}
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "30":
    id: "30"
    taskid: f18bcfa6-bc1e-4a4b-8baf-26b5e417982c
    type: regular
    task:
      id: f18bcfa6-bc1e-4a4b-8baf-26b5e417982c
      version: -1
      name: Update alert status to Unresolved
      script: carbonblack-v2|||cb-alert-update
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      setIgnored: {}
      status:
        simple: Unresolved
      uniqueId:
        simple: ${CbResponse.Alerts.[0].CbAlertID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "31":
    id: "31"
    taskid: 094627a1-a035-447e-8d28-fda1755edece
    type: regular
    task:
      id: 094627a1-a035-447e-8d28-fda1755edece
      version: -1
      name: Update alert status to False Positive
      script: carbonblack-v2|||cb-alert-update
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      setIgnored: {}
      status:
        simple: False Positive
      uniqueId:
        simple: ${CbResponse.Alerts.[0].CbAlertID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "32":
    id: "32"
    taskid: 74492384-1ff1-4323-8991-40f96cc83f33
    type: regular
    task:
      id: 74492384-1ff1-4323-8991-40f96cc83f33
      version: -1
      name: Fetch binary
      script: carbonblack-v2|||cb-binary-get
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      md5:
        simple: ${File.[0].MD5}
      summary:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 4625
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "33":
    id: "33"
    taskid: cf70861b-1855-4998-8bcd-b981148b1e2b
    type: regular
    task:
      id: cf70861b-1855-4998-8bcd-b981148b1e2b
      version: -1
      name: Unquarantine sensor (endpoint)
      script: carbonblack-v2|||cb-unquarantine-device
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      sensor:
        simple: ${CbResponse.FilteredSensors.[0].CbSensorID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "34":
    id: "34"
    taskid: 29780a39-9b9f-4d52-823f-920eeab6a359
    type: title
    task:
      id: 29780a39-9b9f-4d52-823f-920eeab6a359
      version: -1
      name: Get processes info
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "35":
    id: "35"
    taskid: 10b53555-1536-4e65-8740-b5b4dc8153e6
    type: regular
    task:
      id: 10b53555-1536-4e65-8740-b5b4dc8153e6
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
      - "45"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "36":
    id: "36"
    taskid: 99fe33b5-afac-44c2-8a6a-214a753c101d
    type: regular
    task:
      id: 99fe33b5-afac-44c2-8a6a-214a753c101d
      version: -1
      name: Fetch list of processes
      script: carbonblack-v2|||cb-get-processes
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      facet: {}
      query: {}
      rows: {}
      sort: {}
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "37":
    id: "37"
    taskid: 6bbd9f03-7468-4421-8153-08b8bd07ee86
    type: regular
    task:
      id: 6bbd9f03-7468-4421-8153-08b8bd07ee86
      version: -1
      name: Get event info on a process
      script: carbonblack-v2|||cb-process-events
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      pid:
        simple: ${Process.[0].CbID}
      segid:
        simple: ${Process.[0].CbSegmentID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "38":
    id: "38"
    taskid: f76a589b-f9aa-40bd-82d1-f1ee04c1163a
    type: regular
    task:
      id: f76a589b-f9aa-40bd-82d1-f1ee04c1163a
      version: -1
      name: Get process with relations by pid/segid
      script: carbonblack-v2|||cb-get-process
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      get_related:
        simple: "true"
      pid:
        simple: ${Process.[0].CbID}
      segid:
        simple: ${Process.[0].CbSegmentID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "39":
    id: "39"
    taskid: c05a8379-d6ba-4e14-8ad0-4768ac48624c
    type: regular
    task:
      id: c05a8379-d6ba-4e14-8ad0-4768ac48624c
      version: -1
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "40":
    id: "40"
    taskid: 6ade2e2c-c17f-45fe-89aa-cce96084a88a
    type: regular
    task:
      id: 6ade2e2c-c17f-45fe-89aa-cce96084a88a
      version: -1
      name: Create a new watchlist
      script: carbonblack-v2|||cb-watchlist-new
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      name:
        simple: TestWatchlist#123
      search-query:
        simple: bla-bla
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "41":
    id: "41"
    taskid: a838d522-e3e3-4709-886c-26a85498bb06
    type: regular
    task:
      id: a838d522-e3e3-4709-886c-26a85498bb06
      version: -1
      name: Set (update) watchlist name
      script: carbonblack-v2|||cb-watchlist-set
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      indexType: {}
      name:
        simple: TestWatchlist#123Changed
      search-query: {}
      watchlist-id:
        simple: ${CbResponse.Watchlists.CbWatchlistID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "42":
    id: "42"
    taskid: daa3a6e3-5e42-4102-8f7a-46ec0f4ad2e8
    type: regular
    task:
      id: daa3a6e3-5e42-4102-8f7a-46ec0f4ad2e8
      version: -1
      name: Delete the created watchlist
      script: carbonblack-v2|||cb-watchlist-del
      type: regular
      iscommand: true
      brand: carbonblack-v2
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      watchlist-id:
        simple: ${CbResponse.Watchlists.CbWatchlistID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "43":
    id: "43"
    taskid: 766ce0c3-aa54-44a8-831d-b4ebeeec0e5b
    type: regular
    task:
      id: 766ce0c3-aa54-44a8-831d-b4ebeeec0e5b
      version: -1
      name: Check that watchlist name was changed
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      expectedValue:
        simple: TestWatchlist#123Changed
      fields: {}
      path:
        simple: CbResponse.Watchlists.Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "44":
    id: "44"
    taskid: 2807aa29-a811-4368-8feb-0ffb891590fb
    type: regular
    task:
      id: 2807aa29-a811-4368-8feb-0ffb891590fb
      version: -1
      name: Get Online Sensors
      scriptName: CarbonBlackResponseFilterSensors
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      hostname: {}
      sensors:
        simple: ${CbResponse.Sensors}
      status: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "45":
    id: "45"
    taskid: 39130ac0-9cf0-49f7-8a02-7aabd1a9594b
    type: regular
    task:
      id: 39130ac0-9cf0-49f7-8a02-7aabd1a9594b
      version: -1
      name: Get md5 processes
      description: Query processes based on given parameters
      script: '|||cb-get-processes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      facet: {}
      group: {}
      hostname: {}
      md5:
        simple: d5669294f78a7d48c318ef22d5685ba7
      name: {}
      parent-process-name: {}
      process-path: {}
      query: {}
      rows: {}
      sort: {}
      start: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "48":
    id: "48"
    taskid: 5a8aebf9-d96a-4834-8392-cf1081383802
    type: condition
    task:
      id: 5a8aebf9-d96a-4834-8392-cf1081383802
      version: -1
      name: Check results
      description: Gets basic process information for segment (segment_id) of process
        (process_id)
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Process.MD5
            iscontext: true
          right:
            value:
              simple: d5669294f78a7d48c318ef22d5685ba7
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "49":
    id: "49"
    taskid: 030903e7-4247-4527-8287-7093de41570f
    type: title
    task:
      id: 030903e7-4247-4527-8287-7093de41570f
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1755
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "50":
    id: "50"
    taskid: 5ebe4ebb-fec7-4392-892e-5fc7811fedbf
    type: condition
    task:
      id: 5ebe4ebb-fec7-4392-892e-5fc7811fedbf
      version: -1
      name: Verify siblings were fetched
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Process
                accessor: Siblings.[0].PID
            iscontext: true
          right:
            value:
              simple: "340"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 5515,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
