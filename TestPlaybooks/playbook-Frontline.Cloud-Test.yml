id: 536b2926-9c55-4432-8ee4-87ee26039ea3
version: 24
name: Frontline.Cloud-Test
description: This is a test playbook for the Digital Defense Inc. FrontlineVM Integration
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e86e43e0-38fd-4b62-84c4-f9d4dd6e0d4c
    type: start
    task:
      id: e86e43e0-38fd-4b62-84c4-f9d4dd6e0d4c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: fe5cc8f6-95fd-4298-8032-a48d5d4f2a4f
    type: regular
    task:
      id: fe5cc8f6-95fd-4298-8032-a48d5d4f2a4f
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: d91374ad-a405-4375-89da-51f8fe06e14d
    type: regular
    task:
      id: d91374ad-a405-4375-89da-51f8fe06e14d
      version: -1
      name: frontline-get-assets (get asset that does not exists)
      description: Pull asset that does not exists within Frontline.Cloud
      script: '|||frontline-get-assets'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      hostname: {}
      ip_address:
        simple: 8.8.8.8
      label_name: {}
      max_days_since_scan: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 10cd7540-7b74-400c-8b00-54f34cd98499
    type: condition
    task:
      id: 10cd7540-7b74-400c-8b00-54f34cd98499
      version: -1
      name: Verify Command Results
      description: Verify command results from task 'frontline-get-assets (get asset
        that does not exits)'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEmpty
          left:
            value:
              simple: FrontlineVM.Hosts
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 5f7db6d0-385a-4a55-80eb-71e0f58b29a5
    type: regular
    task:
      id: 5f7db6d0-385a-4a55-80eb-71e0f58b29a5
      version: -1
      name: Close the Investigation
      description: Closing investigation.
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id:
        simple: ${incident.id}
      phishingsubtype: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: e54799b3-b1f9-4f13-8ef5-2705a8127c41
    type: regular
    task:
      id: e54799b3-b1f9-4f13-8ef5-2705a8127c41
      version: -1
      name: frontline-get-vulns
      description: Pull all vulnerability data from Frontline.Cloud
      script: '|||frontline-get-vulns'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      host_id: {}
      ip_address: {}
      max_days_since_created: {}
      min_days_since_created: {}
      min_severity: {}
      severity: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 57a0484c-830f-431f-8deb-5722865b31f4
    type: condition
    task:
      id: 57a0484c-830f-431f-8deb-5722865b31f4
      version: -1
      name: Verify Command Results
      description: Verify command results from task 'frontline-get-vulns'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FrontlineVM.Vulns
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: ba3a668c-d982-414f-865d-5d51469e196f
    type: regular
    task:
      id: ba3a668c-d982-414f-865d-5d51469e196f
      version: -1
      name: frontline-get-assets (get all assets)
      description: Pull all asset data from Frontline.Cloud
      script: '|||frontline-get-assets'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      hostname: {}
      ip_address: {}
      label_name: {}
      max_days_since_scan: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: bfce8f7a-eb07-4457-891e-57e299bf3526
    type: condition
    task:
      id: bfce8f7a-eb07-4457-891e-57e299bf3526
      version: -1
      name: Verify Command Results
      description: Verify command results from task 'frontline-get-assets (get all
        assets)'.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FrontlineVM.Hosts
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1575,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
