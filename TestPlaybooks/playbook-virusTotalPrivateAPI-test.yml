id: virusTotalPrivateAPI-test-playbook
version: -1
name: virusTotalPrivateAPI-test-playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c2fdb80f-d9ba-41d7-8fb8-15a770dabfe7
    type: start
    task:
      id: c2fdb80f-d9ba-41d7-8fb8-15a770dabfe7
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 50
        }
      }
    note: false
    timertriggers: []
  "1":
    id: "1"
    taskid: cb996a01-c0e3-447c-83d1-6328a0dcefbb
    type: regular
    task:
      id: cb996a01-c0e3-447c-83d1-6328a0dcefbb
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
  "12":
    id: "12"
    taskid: deae3ffc-3937-4a5e-83d0-96bb78723bf0
    type: title
    task:
      id: deae3ffc-3937-4a5e-83d0-96bb78723bf0
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2320
        }
      }
    note: false
    timertriggers: []
  "14":
    id: "14"
    taskid: 3a154399-9055-486c-8328-e52bd4f78894
    type: regular
    task:
      id: 3a154399-9055-486c-8328-e52bd4f78894
      version: -1
      name: vt-get-domain-report
      description: Retrieves a report on a given domain (including the information
        recorded by VirusTotal's passive DNS infrastructure).
      script: '|||vt-private-get-domain-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      domain:
        simple: google.com
      fullResponse: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
  "16":
    id: "16"
    taskid: 411efc82-26ce-48f6-819f-89e8aa236a49
    type: condition
    task:
      id: 411efc82-26ce-48f6-819f-89e8aa236a49
      version: -1
      name: Verify Domain Whois Contains
      description: "Checks whether substring is within string. Returns: \nyes - string
        contains substring. \nno - string does not contain substring. \nIf stringSeperator
        is provided, the substring will be split using the separator, and each item
        will be checked.\nIf one of the items will be found in the string, the srcipt
        will return yes.\n"
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              complex:
                root: Domain
                accessor: VirusTotal.Whois
            iscontext: true
          right:
            value:
              simple: GOOGLE
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
  "17":
    id: "17"
    taskid: 18f5ac65-12c7-4ec6-88bf-9b5431308e2b
    type: regular
    task:
      id: 18f5ac65-12c7-4ec6-88bf-9b5431308e2b
      version: -1
      name: vt-get-file-report
      description: Retrieves a concluded url scan report for a given url.
      script: '|||vt-private-get-file-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      allInfo: {}
      resource:
        simple: 65d7c8c92a2dce75ba037bb6f89258fdd5f786dfe36d0315fdb7e6f31ad78d36
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
  "18":
    id: "18"
    taskid: 54d72653-d27b-4549-8619-daabc2e14f1a
    type: condition
    task:
      id: 54d72653-d27b-4549-8619-daabc2e14f1a
      version: -1
      name: Verify File Malicious
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Malicious
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
  "19":
    id: "19"
    taskid: 99c0783e-3341-4ff2-893b-733447e200fe
    type: regular
    task:
      id: 99c0783e-3341-4ff2-893b-733447e200fe
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
  "20":
    id: "20"
    taskid: c0d85491-fc4a-4912-8a48-9611b94a80d6
    type: regular
    task:
      id: c0d85491-fc4a-4912-8a48-9611b94a80d6
      version: -1
      name: vt-private-get-url-report
      description: Retrieves a concluded url scan report for a given url.
      script: '|||vt-private-get-url-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      allInfo: {}
      fullResponse: {}
      resource:
        simple: http://En-us.secureconnection.moneytransaction.kb4.io
      retries: {}
      retry_time: {}
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
  "21":
    id: "21"
    taskid: 0e538c1a-778d-4a3c-8be0-e455d29d1649
    type: regular
    task:
      id: 0e538c1a-778d-4a3c-8be0-e455d29d1649
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
  "22":
    id: "22"
    taskid: 95324590-ddd8-40c5-83ef-f108df7255df
    type: regular
    task:
      id: 95324590-ddd8-40c5-83ef-f108df7255df
      version: -1
      name: vt-private-get-ip-report
      description: Retrieves a report on a given IP address (including the information
        recorded by VirusTotal's Passive DNS infrastructure).
      script: '|||vt-private-get-ip-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 139.130.4.5
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
  "23":
    id: "23"
    taskid: f4854eef-e673-4943-8b2e-5aa5d7f62e99
    type: condition
    task:
      id: f4854eef-e673-4943-8b2e-5aa5d7f62e99
      version: -1
      name: Verify DBot Score of ip
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: DBotScore
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
  "24":
    id: "24"
    taskid: 4dc0b7d1-7450-4308-8c50-35888456b6c5
    type: regular
    task:
      id: 4dc0b7d1-7450-4308-8c50-35888456b6c5
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
  "25":
    id: "25"
    taskid: 1193046c-e6e9-4190-8ca0-de86abea0703
    type: regular
    task:
      id: 1193046c-e6e9-4190-8ca0-de86abea0703
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2335,
        "width": 380,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []