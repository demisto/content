id: Carbon Black Enterprise Protection V2 Test
version: -1
name: Carbon Black Enterprise Protection V2 Test
fromversion: 4.1.0
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: aebf0561-8def-4acb-8bea-1b626dbb8835
    type: start
    task:
      id: aebf0561-8def-4acb-8bea-1b626dbb8835
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "7"
      - "12"
      - "15"
      - "18"
      - "21"
      - "28"
      - "31"
      - "34"
      - "37"
      - "42"
      - "46"
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 40
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 175c60f2-936f-4413-8124-7986963e4df7
    type: regular
    task:
      id: 175c60f2-936f-4413-8124-7986963e4df7
      version: -1
      name: Search connector
      description: Returns objects that match given criteria
      script: CarbonBlackProtectionV2|||cbp-connector-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      group: {}
      headers: {}
      limit: {}
      offset:
        simple: "2"
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 8cfc1e0c-d3a4-4553-84c2-d4d60dd7f821
    type: title
    task:
      id: 8cfc1e0c-d3a4-4553-84c2-d4d60dd7f821
      version: -1
      name: Connector
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 07aa5b01-bb6c-4377-833d-beed2c48a95d
    type: regular
    task:
      id: 07aa5b01-bb6c-4377-833d-beed2c48a95d
      version: -1
      name: Get 3rd connector
      description: Returns object instance of this class
      script: CarbonBlackProtectionV2|||cbp-connector-get
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      headers: {}
      id:
        simple: "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: ba2c19c9-8984-42ca-8dab-38a55ab32a64
    type: title
    task:
      id: ba2c19c9-8984-42ca-8dab-38a55ab32a64
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: de9ee75a-7736-42c7-8e8e-080f558b09fa
    type: title
    task:
      id: de9ee75a-7736-42c7-8e8e-080f558b09fa
      version: -1
      name: Computer
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 452543a3-7358-49f3-88bd-37050232b983
    type: regular
    task:
      id: 452543a3-7358-49f3-88bd-37050232b983
      version: -1
      name: Search computer
      description: 'Search for computers. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#computer'
      script: CarbonBlackProtectionV2|||cbp-computer-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      group: {}
      headers: {}
      limit: {}
      offset: {}
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: a3de11af-e964-412d-8bd1-5b4edda2f657
    type: condition
    task:
      id: a3de11af-e964-412d-8bd1-5b4edda2f657
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          right:
            value:
              simple: 34.247.165.10
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          right:
            value:
              simple: WORKGROUP\WIN-40PO3OKHP48
    view: |-
      {
        "position": {
          "x": 480,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 372024b8-b0f4-4594-8c78-bbd381da4afa
    type: regular
    task:
      id: 372024b8-b0f4-4594-8c78-bbd381da4afa
      version: -1
      name: Get computer
      description: 'Returns computer. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#computer'
      script: CarbonBlackProtectionV2|||cbp-computer-get
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      headers: {}
      id:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 34000cd0-6498-4d54-8d5f-d61116afc8fb
    type: condition
    task:
      id: 34000cd0-6498-4d54-8d5f-d61116afc8fb
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: IPAddress
            iscontext: true
          right:
            value:
              simple: 34.247.165.10
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Endpoint
                accessor: Hostname
            iscontext: true
          right:
            value:
              simple: WORKGROUP\WIN-40PO3OKHP48
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: 189a4791-7c3f-461b-8925-7ce9f6b7a8fd
    type: title
    task:
      id: 189a4791-7c3f-461b-8925-7ce9f6b7a8fd
      version: -1
      name: File Catalog
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: 6c6a23c8-a15d-49f2-8f3f-0c493ff20f90
    type: regular
    task:
      id: 6c6a23c8-a15d-49f2-8f3f-0c493ff20f90
      version: -1
      name: Search file catalog using query
      description: 'Search for file catalogs. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#filecatalog'
      script: CarbonBlackProtectionV2|||cbp-fileCatalog-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      group: {}
      headers: {}
      limit: {}
      offset: {}
      query:
        simple: MD5:bfcde7f24baa5f4e05b0525e5a4a79e4
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 22981eba-b95d-4296-8fd5-f45d08151937
    type: condition
    task:
      id: 22981eba-b95d-4296-8fd5-f45d08151937
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: File
                accessor: ID
            iscontext: true
          right:
            value:
              simple: "29"
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: File
                accessor: Size
            iscontext: true
          right:
            value:
              simple: "1084760"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              simple: crawler.exe
    view: |-
      {
        "position": {
          "x": 930,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 9086c2e4-746c-4557-8a31-fa33387268b3
    type: title
    task:
      id: 9086c2e4-746c-4557-8a31-fa33387268b3
      version: -1
      name: File Instance
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 47d31e10-754c-4906-8b08-ab472d2b99ea
    type: regular
    task:
      id: 47d31e10-754c-4906-8b08-ab472d2b99ea
      version: -1
      name: Search file instance
      description: 'Search for file instances. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#fileinstance'
      script: CarbonBlackProtectionV2|||cbp-fileInstance-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      group: {}
      headers: {}
      limit:
        simple: "2"
      offset:
        simple: "10"
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: 2de1a3e4-2b09-4120-8b08-27d1d3f97959
    type: condition
    task:
      id: 2de1a3e4-2b09-4120-8b08-27d1d3f97959
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: CBP
                accessor: FileInstance.ID
            iscontext: true
          right:
            value:
              simple: "12"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileInstance.ID
            iscontext: true
          right:
            value:
              simple: "11"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileInstance.Path
            iscontext: true
          right:
            value:
              simple: c:\program files (x86)\citrix\xentools
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileInstance.Name
            iscontext: true
          right:
            value:
              simple: msdtc.exe
    view: |-
      {
        "position": {
          "x": 1440,
          "y": 520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: c339666b-20db-47e1-8687-210cdd5060db
    type: title
    task:
      id: c339666b-20db-47e1-8687-210cdd5060db
      version: -1
      name: Event
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -370,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 6ae4621c-eee0-4372-8506-b5a2298d9367
    type: regular
    task:
      id: 6ae4621c-eee0-4372-8506-b5a2298d9367
      version: -1
      name: Search events using sort and limit
      description: 'Search for events. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#event'
      script: CarbonBlackProtectionV2|||cbp-event-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      group: {}
      headers: {}
      limit:
        simple: "1"
      offset: {}
      query: {}
      sort:
        simple: stringId
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -370,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 1c4ba059-4ed1-42a9-8a92-570929e682aa
    type: condition
    task:
      id: 1c4ba059-4ed1-42a9-8a92-570929e682aa
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: CBP
                accessor: Event.StringID
            iscontext: true
          right:
            value:
              simple: "247"
      - - operator: isSame
          left:
            value:
              complex:
                root: CBP
                accessor: Event.Timestamp
            iscontext: true
          right:
            value:
              simple: 2019-03-23T00:00:26.217Z
    view: |-
      {
        "position": {
          "x": -370,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: dfb3d26a-09fe-47e8-8d21-037eb2113105
    type: title
    task:
      id: dfb3d26a-09fe-47e8-8d21-037eb2113105
      version: -1
      name: File rule
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -810,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: 2ad61c55-ed5d-46db-8b4a-ff92b700afe2
    type: regular
    task:
      id: 2ad61c55-ed5d-46db-8b4a-ff92b700afe2
      version: -1
      name: Create file rule
      description: 'Creates or updates file rule. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#filerule'
      script: CarbonBlackProtectionV2|||cbp-fileRule-update
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      description:
        simple: Test file rule
      fileCatalogId:
        simple: "2"
      fileState:
        simple: "2"
      forceInstaller: {}
      forceNotInstaller: {}
      hash: {}
      headers: {}
      id: {}
      name: {}
      platformFlags: {}
      policyIds: {}
      reportOnly: {}
      'reputationApprovalsEnabled ': {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -810,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: d4adfff0-231c-432e-84ce-d969974c33c1
    type: regular
    task:
      id: d4adfff0-231c-432e-84ce-d969974c33c1
      version: -1
      name: Delete file rule
      description: 'Deletes the file rule. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#filerule'
      script: CarbonBlackProtectionV2|||cbp-fileRule-delete
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      headers: {}
      id:
        complex:
          root: CBP
          accessor: FileRule.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -810,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: 7189f251-61c4-4ae8-8a6f-162328e4c86a
    type: regular
    task:
      id: 7189f251-61c4-4ae8-8a6f-162328e4c86a
      version: -1
      name: Get deleted file rule
      description: 'Gets the file rule. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#filerule'
      script: CarbonBlackProtectionV2|||cbp-fileRule-get
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      headers: {}
      id:
        complex:
          root: CBP
          accessor: FileRule.ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -810,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: 01d5646b-419f-4964-878c-4c83e6c27d7c
    type: condition
    task:
      id: 01d5646b-419f-4964-878c-4c83e6c27d7c
      version: -1
      name: Verify file was deleted
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "26"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileRule.FileState
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": -810,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: 58f7d4a9-f457-44cf-892a-dd64f8a4951e
    type: regular
    task:
      id: 58f7d4a9-f457-44cf-892a-dd64f8a4951e
      version: -1
      name: Search file rule
      description: 'Search for file rules. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#filerule'
      script: CarbonBlackProtectionV2|||cbp-fileRule-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      group: {}
      headers: {}
      limit:
        simple: "1"
      offset:
        simple: "30"
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -810,
          "y": 1060
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: 87deac69-ce5f-4e7f-82d3-e1c5b3a8ea09
    type: condition
    task:
      id: 87deac69-ce5f-4e7f-82d3-e1c5b3a8ea09
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileRule.Hash
            iscontext: true
          right:
            value:
              simple: eab19a382c081ad2d37799ae842cd70631ea0daac8dd5092cb4de450dbd33880
    view: |-
      {
        "position": {
          "x": -810,
          "y": 1240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: 9a0bdb9e-710a-4019-89d3-d40f696ce68f
    type: title
    task:
      id: 9a0bdb9e-710a-4019-89d3-d40f696ce68f
      version: -1
      name: Policy
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "29":
    id: "29"
    taskid: 0ae8dda7-a58f-4aac-8899-30ffe65a899d
    type: regular
    task:
      id: 0ae8dda7-a58f-4aac-8899-30ffe65a899d
      version: -1
      name: Policy query
      description: 'Search for policies. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#policy'
      script: CarbonBlackProtectionV2|||cbp-policy-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      group: {}
      headers: {}
      limit: {}
      offset: {}
      query:
        simple: name:Local Approval Policy
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "30":
    id: "30"
    taskid: 679f9586-dbd6-4464-8367-1f2a62fcfbdb
    type: condition
    task:
      id: 679f9586-dbd6-4464-8367-1f2a62fcfbdb
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: CBP
                accessor: Policy.EnforcementLevel
            iscontext: true
          right:
            value:
              simple: "35"
      - - operator: isTrue
          left:
            value:
              complex:
                root: CBP
                accessor: Policy.ReadOnly
            iscontext: true
      - - operator: isTrue
          left:
            value:
              complex:
                root: CBP
                accessor: Policy.AutomaticApprovalsOnTransition
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1910,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "31":
    id: "31"
    taskid: 36fd9eab-8a90-4319-8d3a-69e4d79fef64
    type: title
    task:
      id: 36fd9eab-8a90-4319-8d3a-69e4d79fef64
      version: -1
      name: Server Config
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1280,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "32":
    id: "32"
    taskid: d365cc1b-b8ad-446d-8094-d459e4a3a7c8
    type: regular
    task:
      id: d365cc1b-b8ad-446d-8094-d459e4a3a7c8
      version: -1
      name: Search server config
      description: 'Search in server configurations. See more: https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#serverconfig'
      script: CarbonBlackProtectionV2|||cbp-serverConfig-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      group: {}
      headers: {}
      limit:
        simple: "3"
      offset: {}
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1280,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "33":
    id: "33"
    taskid: f592c64c-9566-4f49-89a9-4db68df45fa7
    type: condition
    task:
      id: f592c64c-9566-4f49-89a9-4db68df45fa7
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: ServerConfig.Name
            iscontext: true
          right:
            value:
              simple: PurgeEventThreshold
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: CBP
                accessor: ServerConfig.Value
            iscontext: true
          right:
            value:
              simple: "3700"
    view: |-
      {
        "position": {
          "x": -1280,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "34":
    id: "34"
    taskid: f052a92b-8521-43cc-8ab6-02dfd65a4961
    type: title
    task:
      id: f052a92b-8521-43cc-8ab6-02dfd65a4961
      version: -1
      name: Publisher
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "35":
    id: "35"
    taskid: 72f6c2bf-8662-4898-8a95-1519903a10b9
    type: regular
    task:
      id: 72f6c2bf-8662-4898-8a95-1519903a10b9
      version: -1
      name: Search publisher
      script: CarbonBlackProtectionV2|||cbp-publisher-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      group: {}
      limit:
        simple: "5"
      offset: {}
      query:
        simple: publisherReputation:0
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "36":
    id: "36"
    taskid: ab6161b4-0c59-40a2-89b9-b4c4d71dbddf
    type: condition
    task:
      id: ab6161b4-0c59-40a2-89b9-b4c4d71dbddf
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: Publisher.Name
            iscontext: true
          right:
            value:
              simple: Carbon Black, Inc.
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: CBP
                accessor: Publisher.SignedCertificatesCount
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: Publisher.SignedFilesCount
            iscontext: true
          right:
            value:
              simple: "12"
    view: |-
      {
        "position": {
          "x": -1760,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "37":
    id: "37"
    taskid: fa14ac58-1a08-42f7-87c4-41e0839a9348
    type: title
    task:
      id: fa14ac58-1a08-42f7-87c4-41e0839a9348
      version: -1
      name: File Analysis
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "38":
    id: "38"
    taskid: ac3403d2-75d9-476b-8c8f-7a72d05ea53e
    type: regular
    task:
      id: ac3403d2-75d9-476b-8c8f-7a72d05ea53e
      version: -1
      name: Create file analysis
      description: Creates or updates file analysis request
      script: CarbonBlackProtectionV2|||cbp-fileAnalysis-createOrUpdate
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      analysisStatus: {}
      analysisTarget: {}
      computerId: {}
      connectorId:
        simple: "2"
      fileCatalogId:
        simple: "2"
      id: {}
      priority: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "39":
    id: "39"
    taskid: 3d988d45-8542-4a7e-8ddc-58832fc08a8e
    type: condition
    task:
      id: 3d988d45-8542-4a7e-8ddc-58832fc08a8e
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: CBP
                accessor: FileAnalysis.Priority
            iscontext: true
          right:
            value:
              simple: "0"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileAnalysis.FileName
            iscontext: true
          right:
            value:
              simple: vcruntime140.dll
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileAnalysis.PathName
            iscontext: true
          right:
            value:
              simple: c:\program files (x86)\bit9\parity agent
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "40":
    id: "40"
    taskid: d5dab5b0-75b7-434b-89aa-e3b0142b7fff
    type: regular
    task:
      id: d5dab5b0-75b7-434b-89aa-e3b0142b7fff
      version: -1
      name: Get file analysis
      description: Returns object instance of this class
      script: CarbonBlackProtectionV2|||cbp-fileAnalysis-get
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      id:
        simple: "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "41":
    id: "41"
    taskid: ef5a6731-e614-4b9b-8ade-647d012d70aa
    type: condition
    task:
      id: ef5a6731-e614-4b9b-8ade-647d012d70aa
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: Name
            iscontext: true
          right:
            value:
              simple: vccorlib140.dll
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "42":
    id: "42"
    taskid: ab963289-2696-4e57-8658-aaf99af4d1c0
    type: title
    task:
      id: ab963289-2696-4e57-8658-aaf99af4d1c0
      version: -1
      name: File Upload
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2250,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "43":
    id: "43"
    taskid: 2d6bdf4f-11b0-4723-8b3a-d5db1d4b0879
    type: regular
    task:
      id: 2d6bdf4f-11b0-4723-8b3a-d5db1d4b0879
      version: -1
      name: Search file upload
      description: Returns objects that match given criteria
      script: CarbonBlackProtectionV2|||cbp-fileUpload-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      group: {}
      headers: {}
      limit:
        simple: "2"
      offset: {}
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2250,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "44":
    id: "44"
    taskid: 54cb1449-00b9-4e41-8887-d2e328c2289c
    type: regular
    task:
      id: 54cb1449-00b9-4e41-8887-d2e328c2289c
      version: -1
      name: Get file upload
      description: Returns object instance of this class
      script: CarbonBlackProtectionV2|||cbp-fileUpload-get
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      headers: {}
      id:
        simple: "66"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2250,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "45":
    id: "45"
    taskid: dbbd1f50-bba9-406c-886a-6584474b15d1
    type: condition
    task:
      id: dbbd1f50-bba9-406c-886a-6584474b15d1
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileUpload.UploadPath
            iscontext: true
          right:
            value:
              simple: C:\Program Files (x86)\Bit9\Parity Server\support\ServerInstall-2017522-194921.log
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: FileUpload.PathName
            iscontext: true
          right:
            value:
              simple: c:\program files (x86)\bit9\parity agent
    view: |-
      {
        "position": {
          "x": -2250,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "46":
    id: "46"
    taskid: dff2c063-d0a7-412d-85a0-144c100da135
    type: title
    task:
      id: dff2c063-d0a7-412d-85a0-144c100da135
      version: -1
      name: Connector
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2900,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "47":
    id: "47"
    taskid: f432dfba-be9e-44a6-8b93-cd443c5d193a
    type: regular
    task:
      id: f432dfba-be9e-44a6-8b93-cd443c5d193a
      version: -1
      name: Search connectors offset 1
      description: Returns objects that match given criteria
      script: CarbonBlackProtectionV2|||cbp-connector-search
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      group: {}
      headers: {}
      limit: {}
      offset:
        simple: "1"
      query: {}
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2900,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "48":
    id: "48"
    taskid: 56c9ca73-4b70-408d-8249-8cc78438ae5a
    type: regular
    task:
      id: 56c9ca73-4b70-408d-8249-8cc78438ae5a
      version: -1
      name: Get first connector
      description: Returns object instance of this class
      script: CarbonBlackProtectionV2|||cbp-connector-get
      type: regular
      iscommand: true
      brand: CarbonBlackProtectionV2
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      headers: {}
      id:
        simple: "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2900,
          "y": 515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "49":
    id: "49"
    taskid: 6a5ff8bf-4f30-4939-8c2e-c733a59fef2b
    type: condition
    task:
      id: 6a5ff8bf-4f30-4939-8c2e-c733a59fef2b
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: CBP
                accessor: Connector.AnalysisName
            iscontext: true
          right:
            value:
              simple: FireEye
      - - operator: isFalse
          left:
            value:
              complex:
                root: CBP
                accessor: Connector.Enabled
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: CBP.Connector.AnalysisTargets
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2900,
          "y": 680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "50":
    id: "50"
    taskid: 2deede46-f3af-4e76-85b3-9c8b72f48878
    type: regular
    task:
      id: 2deede46-f3af-4e76-85b3-9c8b72f48878
      version: -1
      name: Fetch Incidents
      description: Execute FetchIncident for a given instance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      add_to_context: {}
      brand_name:
        simple: CarbonBlackProtectionV2
      expect_data: {}
      instance_name: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1585,
        "width": 5530,
        "x": -2250,
        "y": 40
      }
    }
  }
inputs: []
outputs: []
