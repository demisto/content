description: Investigate a malware using one or more integrations
id: malware_investigation-_generic
inputs: []
name: Malware Investigation - Generic
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 6839ec7c-e614-4f3e-8eaf-17d155c840c2
      iscommand: false
      name: ""
      version: -1
    taskid: 6839ec7c-e614-4f3e-8eaf-17d155c840c2
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 2d951f6e-18e3-4618-8546-9bacc2ebac5e
      iscommand: false
      name: Setup
      type: title
      version: -1
    taskid: 2d951f6e-18e3-4618-8546-9bacc2ebac5e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    scriptarguments:
      assignBy:
        simple: random
      email: {}
      roles: {}
      username: {}
    separatecontext: false
    task:
      brand: ""
      id: c3be8540-6c7f-440a-84c0-474f62764780
      iscommand: false
      name: Choose analyst
      scriptName: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: c3be8540-6c7f-440a-84c0-474f62764780
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1010
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 27128b5c-e619-43d8-8913-baa519a3bd1a
      iscommand: false
      name: Handover to human analyst
      type: title
      version: -1
    taskid: 27128b5c-e619-43d8-8913-baa519a3bd1a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 690
        }
      }
  "31":
    id: "31"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 46f2f85d-5b7a-461c-84c8-926591fd866b
      iscommand: false
      name: Manually review the incident
      type: regular
      version: -1
    taskid: 46f2f85d-5b7a-461c-84c8-926591fd866b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1185
        }
      }
  "32":
    id: "32"
    ignoreworker: false
    note: false
    scriptarguments:
      notes: {}
      reason: {}
    separatecontext: false
    task:
      brand: ""
      id: 7bb473b8-90de-490e-8adb-e19dcb67794d
      iscommand: false
      name: Close Investigation
      scriptName: CloseInvestigation
      type: regular
      version: -1
    taskid: 7bb473b8-90de-490e-8adb-e19dcb67794d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1360
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "45"
      - "46"
    note: false
    separatecontext: true
    task:
      brand: ""
      id: 160ae532-83b9-4b75-83b4-074a4da7a886
      iscommand: false
      name: Malware Investigation - Generic - Setup
      playbookName: Malware Investigation - Generic - Setup
      type: playbook
      version: -1
    taskid: 160ae532-83b9-4b75-83b4-074a4da7a886
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 265,
          "y": 340
        }
      }
  "45":
    id: "45"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    separatecontext: true
    task:
      brand: ""
      id: 6dcf0e54-5c0c-4734-83a3-d15f83cb5360
      iscommand: false
      name: Entity Enrichment - Generic
      playbookName: Entity Enrichment - Generic
      type: playbook
      version: -1
    taskid: 6dcf0e54-5c0c-4734-83a3-d15f83cb5360
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
  "46":
    id: "46"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    separatecontext: true
    task:
      brand: ""
      id: 0f80017f-66cd-410d-87b0-04cc9e3fbb74
      iscommand: false
      name: Detonate File - Generic
      playbookName: Detonate File - Generic
      type: playbook
      version: -1
    taskid: 0f80017f-66cd-410d-87b0-04cc9e3fbb74
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": 515
        }
      }
  "47":
    id: "47"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "17"
    note: false
    scriptarguments:
      CriticalEndpoints: {}
      CriticalGroups: {}
      CriticalUsers: {}
    separatecontext: false
    task:
      brand: ""
      description: |-
        Calculate incident severity by indicators reputation and user/endpoint membership in critical groups.

        Note - current severity will be overwritten and new severity may be lower than the current one.

        Playbook inputs:
        * CriticalUsers - Comma separated array with usernames of critical users
        * CriticalEndpoints - Comma separated array with hostnames of critical endpoints
        * CriticalGroups - Comma separated array with DN of critical Active Directory groups
      id: 07dc310c-c368-4c96-878a-71a98af2c8f1
      iscommand: false
      name: Calculate Severity - Generic
      playbookName: Calculate Severity - Generic
      type: playbook
      version: -1
    taskid: 07dc310c-c368-4c96-878a-71a98af2c8f1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 265,
          "y": 835
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1405,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
