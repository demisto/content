commonfields:
  id: tenable.io
  version: -1
name: tenable.io
display: tenable.io
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,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
description: A comprehensive asset centric solution to accurately track resources
  while accommodating dynamic assets such as cloud, mobile devices, containers and
  web applications.
detaileddescription: A comprehensive asset centric solution to accurately track resources
  while accommodating dynamic assets such as cloud, mobile devices, containers and
  web applications.
configuration:
- display: Access Key
  name: access-key
  defaultvalue: ""
  type: 4
  required: true
- display: Secret Key
  name: secret-key
  defaultvalue: ""
  type: 4
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |-
    import sys, os, requests, traceback
    from time import sleep
    from requests.exceptions import HTTPError

    # Output headers / context keys
    FIELD_NAMES_MAP = {'ScanType': 'Type', 'ScanStart': 'StartTime', 'ScanEnd': 'EndTime', 'ScannerName': 'Scanner', 'SeenLast': 'LastSeen', 'SeenFirst': 'FirstSeen', 'PluginId': 'Id'}
    REMEDIATIONS_NAMES_MAP = {'Value': 'Id', 'Vulns': 'AssociatedVulnerabilities', 'Hosts': 'AffectedHosts', 'Remediation': 'Description'}
    GET_SCANS_HEADERS = ('Id', 'Uuid', 'Name', 'Type', 'Owner', 'Enabled', 'Status', 'UserPermissions', 'CreationDate', 'LastModificationDate', 'StartTime', 'EndTime', 'Scanner', 'Policy', 'Targets', 'FolderId')
    SCAN_REPORT_INFO_HEADERS = ('Id', 'Uuid', 'Name', 'Status', 'StartTime', 'EndTime', 'Scanner', 'Policy', 'Targets', 'FolderId')
    SCAN_REPORT_VULNERABILITIES_HEADERS = ('Id', 'Name', 'Description', 'FirstSeen', 'LastSeen', 'Solution', 'Synopsis', 'Count', 'Severity', 'RiskFactor')
    SCAN_REPORT_HOSTS_HEADERS = ('AssetId', 'Hostname', 'Score', 'Critical', 'High', 'Medium', 'Low')
    SCAN_REPORT_REMEDIATIONS_HEADERS = ('Id', 'Description', 'AffectedHosts', 'AssociatedVulnerabilities')


    BASE_URL = 'https://cloud.tenable.com/'
    ACCESS_KEY = demisto.params()['access-key']
    SECRET_KEY = demisto.params()['secret-key']
    AUTH_HEADERS = {'X-ApiKeys': 'accessKey={}; secretKey={}'.format(ACCESS_KEY, SECRET_KEY)}

    if not demisto.params()['proxy']:
        del os.environ['HTTP_PROXY']
        del os.environ['HTTPS_PROXY']
        del os.environ['http_proxy']
        del os.environ['https_proxy']


    # Utility methods
    def flatten(d):
        r = {}
        for k, v in d.iteritems():
            if isinstance(v, dict):
                r.update(flatten(v))
        d.update(r)
        return d

    def filter_dict_null(d):
        if isinstance(d, dict):
            return dict((k, v) for k, v in d.items() if v is not None)
        return d

    def get_entry_for_object(title, context_key, obj, headers=None):
        if len(obj) == 0:
            return "There is no output result"
        obj = filter_dict_null(obj)
        if isinstance(obj, list):
            obj = map(filter_dict_null, obj)
        if headers and isinstance(obj, dict):
            headers = list(set(headers).intersection(set(obj.keys())))

        return {
            'Type': entryTypes['note'],
            'Contents': obj,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, obj, headers),
            'EntryContext': {
                context_key: obj
            }
        }

    # change the keys of a dictionary according to a conversion map
    # trans_map - { 'OldKey': 'NewKey', ...}
    # camelize - change all keys from snake_case to CamelCase
    def replace_keys(src, trans_map=FIELD_NAMES_MAP, camelize=True):
        def snake_to_camel(snake_str):
            components = snake_str.split('_')
            return ''.join(map(lambda x: x.decode('utf-8').title(), components))

        def replace(key, trans_map):
            if key in trans_map:
                return trans_map[key]
            return key

        if isinstance(src, list):
            return map(lambda x: replace_keys(x, trans_map, camelize), src)
        if camelize:
            src = {snake_to_camel(k): v for k,v in src.iteritems()}
        if trans_map:
            src = {replace(k, trans_map): v for k,v in src.iteritems()}
        return src

    def date_range_to_param(date_range):
        params = {}
        if date_range:
            try:
                date_range = int(date_range)
                params['date_range'] = date_range
            except ValueError, e:
                raise e  # We want the stack trace to end here.
        return params

    def get_scan_error_message(response, scan_id):
        code = response.status_code
        message = "Error processing request"
        if scan_id:
            message += " for scan with id {}".format(scan_id)
        message += ". Got response status code: {}".format(code)
        if code == 401:
            message += " - Scan is disabled."
        elif code == 403:
            message += " - {}".format(response.json()['error'])
        elif code == 404:
            message += " - Scan does not exist."
        elif code == 409:
            message += " - Scan cannot be launched in its current status."
        return message

    def prep_create_scan_params(uuid, name, enabled, text_targets, start_time, timezone, scan_rule_frequency, scan_rule_time_interval, scan_rule_days_to_run, email_accounts, description, scanner_id):
        settings = {
            'name': name,
            'enabled': enabled,
            'text_targets': text_targets
        }
        if start_time:
            settings['starttime'] = start_time
        if timezone:
            settings['timezone'] = timezone,
        if email_accounts:
            settings['emails'] = email_accounts,
        if description:
            settings['description'] = description,
        if scanner_id:
            settings['scanner_id'] = scanner_id
        rrules = (scan_rule_frequency, scan_rule_time_interval, scan_rule_days_to_run)
        if any(rrules):
            if not all(rrules):
                raise ValueError("When giving a scan-rule argument, all scan-rule arguments must be given.")
            settings['rrules'] = "FREQ={};INTERVAL={};BYDAY={}".format(*rrules)

        return {
            'uuid': uuid,
            'settings': settings
        }

    # Request/Response methods
    # kwargs: request parameters
    def send_scan_request(scan_id="", endpoint="", method='GET', debug=False, **kwargs):
        if endpoint:
            endpoint = '/' + endpoint
        full_url = "{0}scans/{1!s}{2}".format(BASE_URL, scan_id, endpoint)
        try:
            res = requests.request(method, full_url, headers=AUTH_HEADERS, params=kwargs)
            res.raise_for_status()
        except HTTPError, e:
            if debug and res.status_code == 403:
                return
            err_msg = get_scan_error_message(res, scan_id)
            if demisto.command() != 'test-module':
                err_msg = {
                "Type": entryTypes["error"],
                "ContentsFormat": formats["text"],
                "Contents": err_msg
                }
            demisto.results(err_msg)
            demisto.error(traceback.format_exc())
            sys.exit(0)
        return res.json()

    def get_scan_info(scans_result_elem):
        response = send_scan_request(scans_result_elem['id'], debug=True) #TODO: handle 403
        if response:
            response['info'].update(scans_result_elem)
            return response['info']

    def send_vuln_details_request(plugin_id, date_range=None):
        full_url = "{}{}{}/{}".format(BASE_URL, "workbenches/vulnerabilities/", plugin_id, "info")
        res = requests.get(full_url, headers=AUTH_HEADERS, params=date_range_to_param(date_range))
        return res.json()

    def send_asset_vuln_request(asset_id, date_range):
        full_url = "{}workbenches/assets/{}/vulnerabilities/".format(BASE_URL, asset_id)
        res = requests.get(full_url, headers=AUTH_HEADERS, params=date_range_to_param(date_range))
        res.raise_for_status()
        return res.json()

    def send_templates_request():
        full_url = "{}editor/scan/templates".format(BASE_URL)
        res = requests.get(full_url, headers=AUTH_HEADERS)
        res.raise_for_status()
        return res.json()

    def send_create_scan_request(**kwargs):
        full_url = "{}scans".format(BASE_URL)
        params = prep_create_scan_params(**kwargs)
        res = requests.post(full_url, headers=AUTH_HEADERS, params=params)
        res.raise_for_status()
        return res.json()


    def get_vuln_info(vulns):
        vulns_info = {v['plugin_id']: v for v in vulns}
        errors = []
        for v in vulns:
            pid = v['plugin_id']
            vuln_details = send_vuln_details_request(v['plugin_id'])
            if u'error' in vuln_details:
                errors.append(pid)
            else:
                vulns_info[pid].update(flatten(vuln_details['info']))
        return list(vulns_info.itervalues()), errors

    # Command methods
    def test_module():
        send_scan_request()
        return 'ok'

    def get_scans(folder_id, last_modification_date):
        response = send_scan_request(folder_id=folder_id, last_modification_date=last_modification_date)
        res = map(get_scan_info, response['scans'])
        res = filter(lambda x: x is not None, res) # for 403 workaround
        res = replace_keys(res)
        return get_entry_for_object('Tenable.io - List of Scans', 'Tenable.Scan', res, GET_SCANS_HEADERS)

    def launch_scan(scan_id, targets):
        scan_info = send_scan_request(scan_id)['info']
        if not targets:
            targets = scan_info.get('targets', '')
        res = send_scan_request(scan_id, 'launch', 'POST', alt_targets=targets)
        res.update({
            'id': scan_id,
            'targets': targets
        })
        return get_entry_for_object('The requested scan was launched successfully', 'Tenable.Scan', res)

    def get_report(scan_id, info, detailed):
        results = []
        scan_details = send_scan_request(scan_id)

        if info == 'yes':
            scan_details['info']['id'] = scan_id
            scan_details['info'] = replace_keys(scan_details['info'])
            results.append(get_entry_for_object('Scan basic info', 'Tenable.Scan', scan_details['info'], SCAN_REPORT_INFO_HEADERS))

        vuln_info, vulns_not_found = get_vuln_info(scan_details['vulnerabilities'])
        vuln_info = replace_keys(vuln_info)
        results.append(get_entry_for_object('Vulnerabilities', 'Vulnerabilities', vuln_info, SCAN_REPORT_VULNERABILITIES_HEADERS))
        if len(vulns_not_found) > 0:
            results.append('The following vulnerability IDs were not found in the Tenable workbench:\n' + ', '.join(vulns_not_found))

        if detailed == 'yes':
            assets = replace_keys(scan_details['hosts'] + scan_details['comphosts'])
            results.append(get_entry_for_object('Assets', 'Assets', assets, SCAN_REPORT_HOSTS_HEADERS))
            remediations = scan_details['remediations']['remediations']
            if len(remediations) > 0:
                remediations = replace_keys(remediations, REMEDIATIONS_NAMES_MAP)
                results.append(get_entry_for_object('Remediations', 'Remediations', remediations, SCAN_REPORT_REMEDIATIONS_HEADERS))
        return results

    def get_vulnerability_details(plugin_id, date_range):
        info = send_vuln_details_request(plugin_id, date_range)
        return get_entry_for_object('Vulnerability details - {}'.format(plugin_id), 'Vulnerabilities', info['info'])

    def get_vulnerabilities_by_asset(asset_id, date_range):
        info = send_asset_vuln_request(asset_id, date_range)
        return get_entry_for_object('Vulnerabilities for asset {}'.format(asset_id), 'Vulnerabilities', info['vulnerabilities'])

    def get_scan_status(scan_id):
        scan_details = send_scan_request(scan_id)
        return get_entry_for_object('Scan status for {}'.format(scan_id), 'Tenable.Scan', scan_details['info']['status'])

    def get_templates():
        info = send_templates_request()
        return get_entry_for_object('Scan editor templates', 'Tenable.ScanEditorTemplates', info['templates'])

    def create_scan(**kwargs):
        info = send_create_scan_request(**kwargs)
        return get_entry_for_object('The requested scan was created successfully', 'Tenable.Scan', info[''])


    # Command selector
    if demisto.command() == 'test-module':
        demisto.results(test_module())
    elif demisto.command() == 'tenable-get-scans':
        demisto.results(get_scans(demisto.getArg('folder-id'), demisto.getArg('last-modification-date')))
    elif demisto.command() == 'tenable-launch-scan':
        demisto.results(launch_scan(demisto.getArg('scan-id'), demisto.getArg('scan-tartgets')))
    elif demisto.command() == 'tenable-get-scan-report':
        demisto.results(get_report(demisto.getArg('scan-id'), demisto.getArg('info'), demisto.getArg('detailed')))
    elif demisto.command() == 'tenable-get-vulnerability-details':
        demisto.results(get_vulnerability_details(demisto.getArg('vulnerability-id'), demisto.getArg('date-range')))
    elif demisto.command() == 'tenable-get-vulnerabilities-by-asset':
        demisto.results(get_vulnerabilities_by_asset(demisto.getArg('asset-id'), demisto.getArg('date-range')))
    elif demisto.command() == 'tenable-get-scan-status':
        demisto.results(get_scan_status(demisto.getArg('scan-id')))
    elif demisto.command() == 'tenable-get-scan-editor-templates':
        demisto.results(get_templates())
    elif demisto.command() == 'tenable-create-scan':
        demisto.results(create_scan(demisto.getArg('uuid'), demisto.getArg('name'), demisto.getArg('enabled'), demisto.getArg('text_targets'), demisto.getArg('start_time'), demisto.getArg('timezone'), demisto.getArg('scan_rule_frequency'), demisto.getArg('scan_rule_time_interval'), demisto.getArg('scan_rule_days_to_run'), demisto.getArg('email_accounts'), demisto.getArg('description'), demisto.getArg('scanner_id')
        ))
  type: python
  commands:
  - name: tenable-get-scans
    arguments:
    - name: folder-id
      description: 'The ID of the folder whose scans should be listed. Scans are stored
        in specific folders on Tenable. e.g : folderId = 8'
    - name: last-modified-date
      description: 'Limit the results to those that have only changed since this time.
        Time in the following format -  MM/DD/YYYY. e.g : lastModifiedDate = 08/12/2018'
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique id of the scan.
      type: number
    - contextPath: Tenable.Scan.Uuid
      description: The uuid for the scan.
      type: string
    - contextPath: Tenable.Scan.Name
      description: The name of the scan.
      type: string
    - contextPath: Tenable.Scan.Type
      description: The type of scan (local, remote, or agent).
      type: string
    - contextPath: Tenable.Scan.Owner
      description: The owner of the scan.
      type: string
    - contextPath: Tenable.Scan.Enabled
      description: If true, the schedule for the scan is enabled.
      type: boolean
    - contextPath: Tenable.Scan.Status
      description: The status of the scan (completed, aborted, imported, pending,
        running, resuming, canceling, cancelled, pausing, paused, stopping, stopped).
      type: string
    - contextPath: Tenable.Scan.UserPermissions
      description: The sharing permissions for the scan.
      type: number
    - contextPath: Tenable.Scan.CreationDate
      description: The creation date for the scan in Unix time.
      type: date
    - contextPath: Tenable.Scan.LastModificationDate
      description: The last modification date for the scan in Unix time.
      type: date
    - contextPath: Tenable.Scan.StartTime
      description: The scheduled start time for the scan.
      type: string
    - contextPath: Tenable.Scan.Scanner
      description: The scanner assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Policy
      description: The policy assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Target
      description: The targets to be scanned.
      type: string
    - contextPath: Tenable.Scan.FolderId
      description: The unique id of the folder where the scan has been stored.
      type: number
    description: Retrive scans from the Tenable platform.
  - name: tenable-launch-scan
    arguments:
    - name: scan-id
      required: true
      default: true
      description: The id of the scan to launch.
    - name: scan-targets
      description: If specified, these targets will be scanned instead of the default.
        Value can be an array where each index is a target, or an array with a single
        index of comma separated targets.
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique id of the scan.
      type: number
    - contextPath: Tenable.Scan.Targets
      description: The targets to be scanned.
      type: string
    description: Lauch a scan with existing or custom targets. (You can specify custom
      targets in the arguements of this command.)
  - name: tenable-get-scan-report
    arguments:
    - name: scan-id
      required: true
      default: true
      description: The uuid of the scan to retrieve. While scan uuid is preferred,
        scan id is supported.
    - name: detailed
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: If detailed is true, the report will contain remediations and hosts
        information as well for the given scan. Otherwise the report will only have
        vulnerabilities.
      defaultValue: "no"
    - name: info
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: Return the basic details of the given scan.
      defaultValue: "no"
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique id of the scan.
      type: number
    - contextPath: Tenable.Scan.Uuid
      description: The uuid for the scan.
      type: number
    - contextPath: Tenable.Scan.Name
      description: The name of the scan.
      type: string
    - contextPath: Tenable.Scan.Status
      description: The status of the scan (completed, aborted, imported, pending,
        running, resuming, canceling, cancelled, pausing, paused, stopping, stopped).
      type: string
    - contextPath: Tenable.Scan.StartTime
      description: The scheduled start time for the scan.
      type: string
    - contextPath: Tenable.Scan.EndTime
      description: The scan end time for the scan.
      type: string
    - contextPath: Tenable.Scan.Scanner
      description: The scanner assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Policy
      description: The policy assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Targets
      description: The targets to be scanned.
      type: string
    - contextPath: Tenable.Scan.FolderId
      description: The unique id of the folder where the scan has been stored.
      type: string
    - contextPath: Vulnerabilities.Id
      description: The unique ID of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Name
      description: The name of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Description
      description: The description of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.FirstSeen
      description: When the vulnerability was first seen.
      type: date
    - contextPath: Vulnerabilities.LastSeen
      description: When the vulnerability was last seen.
      type: date
    - contextPath: Vulnerabilities.Solution
      description: Information on how to fix the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Synopsis
      description: A brief summary of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Count
      description: A count of the vulnerability occurrences.
      type: number
    - contextPath: Vulnerabilities.Severity
      description: The severity level of the vulnerability.
      type: number
    - contextPath: Vulnerabilities.RiskFactor
      description: String containing risk factor information.
      type: string
    - contextPath: Assets.AssetId
      description: The unique id of the host.
      type: number
    - contextPath: Assets.Hostname
      description: The name of the host.
      type: string
    - contextPath: Assets.Score
      description: The overall score for the host.
      type: number
    - contextPath: Assets.Critical
      description: The percentage of critical findings on the host.
      type: number
    - contextPath: Assets.High
      description: Retrieving data. Wait a few seconds and try to cut or copy again.
      type: number
    - contextPath: Assets.Medium
      description: The percentage of medium findings on the host.
      type: number
    - contextPath: Assets.Low
      description: The percentage of low findings on the host.
      type: number
    - contextPath: Remediations.Id
      description: The unique id of the remediation.
      type: string
    - contextPath: Remediations.Description
      description: Specific information related to the vulnerability and steps to
        remedy.
      type: string
    - contextPath: Remediations.AffectedHosts
      description: The number of hosts affected.
      type: number
    - contextPath: Remediations.AssociatedVulnerabilities
      description: The number of vulnerabilities associated with the remedy.
      type: number
    description: Retrive scan-report for the given scan.
  - name: tenable-get-vulnerability-details
    arguments:
    - name: vulnerability-id
      required: true
      default: true
      description: The unique ID of the vulnerability.
    - name: date-range
      description: The number of days of data prior to and including today that should
        be returned.
    description: "Retrieve details for the given vulnerability."
    outputs:
    - contextPath: Vulnerabilities.Description
      description: The description of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.FirstSeen
      description: When the vulnerability was first seen.
      type: date
    - contextPath: Vulnerabilities.LastSeen
      description: When the vulnerability was last seen.
      type: date
    - contextPath: Vulnerabilities.Solution
      description: Information on how to fix the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Synopsis
      description: A brief summary of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Count
      description: A count of the vulnerability occurrences.
      type: number
    - contextPath: Vulnerabilities.Severity
      description: The severity level of the vulnerability.
      type: number
    - contextPath: Vulnerabilities.Family
      description: Object containing plugin information such as family, type, and publication and modification dates.
      type: string
    - contextPath: Vulnerabilities.ModificationDate
      description: The last modification date for the vulnerability in Unix time.
      type: date
    - contextPath: Vulnerabilities.Name
      description: The name of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Type
      description: The type of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Severity
      description: Integer [0-4] indicating how severe the vulnerability is, where
        0 is info only.
      type: string
    - contextPath: Vulnerabilities.PublicationDate
      description: The publication date of the vulnerability.
      type: date
    - contextPath: Vulnerabilities.RiskInfo.RiskFactor
      description: ""
      type: string
    - contextPath: Vulnerabilities.RiskInfo.CvssVector
      description: The Common Vulnerability Scoring System vector.
      type: string
    - contextPath: Vulnerabilities.RiskInfo.CvssBaseScore
      description: The Common Vulnerability Scoring System allotted base score.
      type: string
    - contextPath: Vulnerabilities.RiskInfo.Cvss3Vector
      description: The Common Vulnerability Scoring System version 3 vector.
      type: string
    - contextPath: Vulnerabilities.RiskInfo.Cvss3BaseScore
      description: The Common Vulnerability Scoring System version 3 allotted base
        score.
      type: string
  - name: tenable-get-vulnerabilities-by-asset
    arguments:
    - name: asset-id
      required: true
      default: true
      description: The unique ID of the Asset.
    - name: date-range
      description: The number of days of data prior to and including today that should
        be returned.
    outputs:
    - contextPath: Vulnerabilities.Count
      description: The number of times the vulnerability was found.
      type: number
    - contextPath: Vulnerabilities.Family
      description: The vulnerability's family.
      type: string
    - contextPath: Vulnerabilities.Id
      description: The unique vulnerability's ID.
      type: number
    - contextPath: Vulnerabilities.Name
      description: The name of the vulnerability's.
      type: string
    - contextPath: Vulnerabilities.VulnerabilityState
      description: The current state of the reported vulnerability (Active, Fixed,
        New, etc.)
      type: string
    - contextPath: Vulnerabilities.Severity
      description: Integer [0-4] indicating how severe the vulnerability is, where
        0 is info only.
      type: number
    description: Get a list of up to 5000 of the vulnerabilities recorded for a given
      asset. By default, this list is sorted by vulnerability count, descending.
  - name: tenable-get-scan-status
    arguments:
    - name: scan-id
      description: The unique ID of the Scan.
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique ID of the scan specified.
      type: string
    - contextPath: Tenable.Scan.Status
      description: The status of the scan specified.
      type: string
    description: 'Check the status of a specific scan using its ID. The status can
      hold following possible values : Running, Completed and Empty (Ready to run).'
  - name: tenable-get-scan-editor-templates
    arguments: []
    outputs:
    - contextPath: Tenable.ScanEditorTemplate.Unsupported
      description: If true, template is not supported.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.CloudOnly
      description: If true, template is only available on the cloud.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Description
      description: The description of the template.
      type: string
    - contextPath: Tenable.ScanEditorTemplate.SubscriptionOnly
      description: If true, the template is only available for subscribers.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.WebScanningBoolean
      description: If true, the template is for Web Application Scanning.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Title
      description: The long name of the template.
      type: string
    - contextPath: Tenable.ScanEditorTemplate.IsForAgents
      description: If true, the template is for agent scans.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Uuid
      description: The uuid for the template.
      type: string
    - contextPath: Tenable.ScanEditorTemplate.ManagerOnly
      description: If true, can only be used by manager.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Name
      description: The short name of the template.
      type: string
    description: Get the list of available scanning editor templates to create new
      scans.
  - name: tenable-create-scan
    arguments:
    - name: uuid
      required: true
      default: true
      description: The uuid for the editor template to use.
    - name: name
      required: true
      description: The name of the scan.
    - name: enabled
      required: true
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: If true, the schedule for the scan is enabled.
      defaultValue: "yes"
    - name: text-targets
      required: true
      description: The list of targets to scan.
    - name: start-time
      description: The starting time and date for the scan (i.e. YYYYMMDDTHHMMSS).
    - name: timezone
      description: The timezone for the scan schedule.
    - name: scan-rule-frequency
      auto: PREDEFINED
      predefined:
      - ONETIME
      - DAILY
      - WEEKLY
      - MONTHLY
      - YEARLY
      description: The frequency (scanRuleFrequency=onetime or daily or weekly or
        monthly or yearly) Expects a string comprised of three values. If you specify
        scanRuleFrequency you need to specify scanRuleTimeInterval and scanRuleDaysToRun
        as well. To create a scan that runs every three weeks on Monday Wednesday
        and Friday the string would be scanRuleFrequency=weekly;scanRuleTimeInterval=3;scanRuleDaysToRun=mo,we,fr
    - name: scan-rule-time-interval
      description: The time interval for which you want to run the scan (timeInterval=1
        or 2 or 3 ... x), Expects a string comprised of three values. If you specify
        timeInterval you need to specify scanFrequency and daysToRun as well. To create
        a scan that runs every three weeks on Monday Wednesday and Friday the string
        would be scanFrequency=weekly;timeInterval=3;daysToRun=mo,we,fr. 
    - name: scan-rule-days-to-run
      description: The days of the week on which you want to run the scan. (scanRuleDaysToRun=su,mo,tu,we,th,fr,sa)
        Please write down first two letter of the word. Expects a string comprised
        of three values. If you specify scanRuleDaysToRun you need to specify scanRuleFrequency
        and scanRuleTimeInterval as well. To create a scan that runs every three weeks
        on Monday Wednesday and Friday the string would be scanRuleFrequency=weekly;scanRuleTimeInterval=3;scanRuleDaysToRun=mo,we,fr. 
    - name: email-accounts
      description: A comma separated list of accounts who will recieve the email summary
        report.
    - name: description
      description: The description of the scan.
    - name: scanner-id
      description: The unique id of the scanner to use.
    outputs:
    - contextPath: Tenable.Scan.CreationDate
      description: The creation date of the scan.
      type: date
    - contextPath: Tenable.Scan.Targets
      description: The targets specified for the scan.
      type: string
    - contextPath: Tenable.Scan.DefaultPermissions
      description: The default permissions assigned to the scan.
      type: number
    - contextPath: Tenable.Scan.Id
      description: The unique ID of the scan.
      type: number
    - contextPath: Tenable.Scan.Name
      description: The name of the scan.
      type: string
    - contextPath: Tenable.Scan.Owner
      description: The owner of the scan.
      type: string
    description: Create a scan on the Tenable platform.
  runonce: false
releaseNotes: "-"
