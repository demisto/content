commonfields:
  id: Joe Security
  version: -1
name: Joe Security
display: Joe Security
category: Forensics & Malware Analysis
image: data:image/png;base64,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
description: Sandbox Cloud
configuration:
- display: API Key
  name: api_key
  defaultvalue: ""
  type: 0
  required: true
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |
    ''' IMPORTS '''
    import time
    import requests
    from distutils.util import strtobool
    # disable insecure warnings
    requests.packages.urllib3.disable_warnings()

    ''' GLOBAL VARS '''
    BASE_URL = 'https://jbxcloud.joesecurity.org/api/'
    USE_SSL = not demisto.params().get('insecure', False)

    ''' HELPER FUNCTIONS '''
    def dq(obj, path):
      '''
      return a value in an object path. in case of multiple objects in path, searches them all.
      @param obj - dictionary tree to search in
      @param path (list) - a path of the desired value in the object. for example: ['root', 'key', 'subkey']
      '''
      if len(path) == 0:
          return obj

      if isinstance(obj, dict):
          if path[0] in obj:
              return dq(obj[path[0]], path[1:])
      elif isinstance(obj, list):
          # in case current obj has multiple objects, search them all.
          l = [dq(o, path) for o in obj]
          return [k for k in l if k is not None]

      # in case of error in the path
      return None


    def mapSingleObj(obj, mapFields, filter_func=None):
      if filter_func is None:
          filter_func = lambda mf: True

      d = {}
      for f in mapFields:
          if filter_func(f):
              d[f['to']] = dq(obj, f['from'].split('.'))

      return d


    def mapObj(content, mapFields, filter_func=None):
      '''
      Converts object fields according to mapping dictionary
      @param content - original content to copy
      @param mapFields - an object assosiating source and destination object fields
      @filter_func - function to filter out fields
      @returns the mapped object
      '''
      if isinstance(content, (list, tuple)):
          return [mapSingleObj(item, mapFields, filter_func) for item in content]
      else:
          return mapSingleObj(content, mapFields, filter_func)


    def createEntry(result, translator, MDfilter=None):
      '''
      Creates war room entry
      @param {dict} result - the raw result to be parsed
      @param {dict} translator - maps raw data to war room output. Should be of the following format:
      {
        contextPath: <context-path>,
        title: <war-room-title>,
        innerPath: (optional) path to the root of all data in result dictionary.
        data: [
              {to: <dest-key>, from: <orig-key>, (optional) humanReadable: <true/false>},
              {to: <dest-key>, from: <orig-key>, (optional) humanReadable: <true/false>},
              ...
          ]
      }
      * dest-key/orig-key should be sparated with '.' (e.g. 'File.Malicious')
      * dest-key is also used for war room table headers
      * humanReadable states whether field should appear in war room table. Default is true.
      @param {function} MDfilter - (optional) filters out fields that shouldn't be displayed in warroom (returns true/false). Default uses humanReadable field.
      @returns {dict} - the war room entry
      '''
      # filters out all fields where humanReadable is false
      if MDfilter is None:
          MDfilter = lambda mf: mf.get('humanReadable', True)

      entry = {
          'Type': entryTypes['note'],
          'Contents': result,
          'ContentsFormat': formats['json'],
          'ReadableContentsFormat': formats['markdown'],
      }

      content = dq(result, translator['innerPath'].split('.')) if 'innerPath' in translator else result;
      translatedMD = mapObj(content, translator['data'], MDfilter)
      entry['HumanReadable'] = tableToMarkdown(translator['title'], translatedMD)

      translatedContext = mapObj(content, translator['data'])
      context = createContext(translatedContext)
      entry['EntryContext'] = {translator['contextPath'] : context}

      return entry


    def http_post(url_suffix, data=None, files=None):
        data = {} if data is None else data

        data.setdefault('apikey', demisto.params()['api_key'])
        LOG('running request with url=%s\tdata=%s\tfiles=%s' % (BASE_URL + url_suffix,
            data, files, ))
        try:
            res = requests.post(BASE_URL + url_suffix,
                verify=USE_SSL,
                data=data,
                files=files
            )

            if res.status_code != 200:
                raise Exception('Your request failed with the following error: ' + res.reason)

        except Exception, e:
            LOG(e)
            raise

        return res.json()


    def webid_to_entry(title, web_ids):
        return createEntry(web_ids, {
            'contextPath' : 'Joe.Analysis(val.WebID && val.WebID == obj.WebID)',
            'title' : title,
            'data' : [
                {'to' : 'WebID', 'from' : u'webid'},
            ],
        })


    def analysis_to_entry(title, info):
        return createEntry(info, {
            'contextPath' : 'Joe.Analysis(val.WebID && val.WebID == obj.WebID)',
            'title' : title,
            'data' : [
                {'to' : 'WebID', 'from' : u'webid'},
                {'to' : 'FileName', 'from' : u'filename'},
                {'to' : 'Status', 'from' : u'status'},
                {'to' : 'Comments', 'from' : u'comments'},
                {'to' : 'Time', 'from' : u'time'},
                {'to' : 'Runs', 'from' : u'runs', 'humanReadable' : False},
                {'to' : 'Result', 'from' : u'runs.detection'},
            ],
        })


    def poll_webid(web_id):
        result = {'data' : {'status' : 'pending'}}
        max_polls = 100;

        while (max_polls >=0) and result['data']['status'] != 'finished':
            if result['data']['status'] != 'pending':
                LOG('error while polling: result is %s' % (result, ))
            result = info_request(web_id)
            time.sleep(2);
            max_polls -= 1

        LOG('reached max_polls #%d' % (max_polls, ))
        if max_polls < 0:
            return analysis_to_entry('Polling timeout on Analysis #' + web_id, result['data'])
        else:
            return analysis_to_entry('Analysis #' + web_id, result['data'])


    ''' FUNCTIONS '''
    def is_online():
        cmd_url = 'v2/server/online'
        res = http_post(cmd_url)
        return res['data']['online']


    def list_analysis():
        cmd_url = 'v2/analysis/list'
        res = http_post(cmd_url)
        return webid_to_entry('Web IDs:', res['data'])


    def analysis_info():
        web_id = demisto.args().get('webid')
        LOG('info: web_id = %s' % (web_id, ))
        res = info_request(web_id)
        return analysis_to_entry('Analysis #' + web_id, res['data'])


    def info_request(web_id):
        cmd_url = 'v2/analysis/info'
        return http_post(cmd_url, data={'webid' : web_id})


    def analyse_url():
        args = demisto.args()
        url = args.get('url')
        should_wait = bool(strtobool(demisto.get(args, 'should_wait')))
        return analyse_url_request(url, should_wait)


    def analyse_url_request(url, should_wait):
        res = http_post('v2/analysis/submit',
            data={'accept-tac': 1, 'url' : url})

        if 'errors' in res:
            LOG('Error! in command analyse_url: url=%s' % (url, ))
            LOG('got the following errors:\n' + '\n'.join(e['message'] for e in res['errors']))
            raise Exception('command failed to run.')

        if should_wait:
            return poll_webid(res['data']['webids'][0])

        info = [{'webid' : i} for i in res['data']['webids']]
        return webid_to_entry('Web ID:', info)


    def analyse_sample():
        args = demisto.args()
        file_entry = args.get('sample')
        sample_url = args.get('sample_url')
        should_wait = bool(strtobool(demisto.get(args, 'should_wait')))

        if (file_entry is None and sample_url is None) or (None not in [file_entry, sample_url]):
            raise ValueError('You must specify one (and only one) of the following: sample_url, sample.')

        LOG('analysing sample')
        if file_entry is not None:
            return analyse_sample_file_request(file_entry, should_wait)
        else:
            return analyse_sample_url_request(sample_url, should_wait)


    def analyse_sample_file_request(file_entry, should_wait):
        with open(demisto.getFilePath(file_entry)['path'], 'rb') as f:
            res = http_post('v2/analysis/submit',
                data={'accept-tac': 1},
                files={'sample':f})

            if 'errors' in res:
                LOG('Error! in command sample file: file_entry=%s' % (file_entry, ))
                LOG('got the following errors:\n' + '\n'.join(e['message'] for e in res['errors']))
                raise Exception('command failed to run.')

        if should_wait:
            return poll_webid(res['data']['webids'][0])

        info = [{'webid' : i} for i in res['data']['webids']]
        return webid_to_entry('Web ID:', info)


    def analyse_sample_url_request(sample_url, should_wait):
        res = http_post('v2/analysis/submit',
                data={'accept-tac': 1, 'sample-url' : sample_url})

        if 'errors' in res:
            LOG('Error! in command sample file: file url=%s' % (sample_url, ))
            LOG('got the following errors:\n' + '\n'.join(e['message'] for e in res['errors']))
            raise Exception('command failed to run.')

        if should_wait:
            return poll_webid(res['data']['webids'][0])

        info = [{'webid' : i} for i in res['data']['webids']]
        return webid_to_entry('Web ID:', info)


    ''' EXECUTION CODE '''
    LOG('command is %s' % (demisto.command(), ))
    try:
        if demisto.command() in ['test-module', 'joe-is-online']:
            # This is the call made when pressing the integration test button.
            if is_online():
                demisto.results('ok')
            else:
                demisto.results('not online')
        elif demisto.command() == 'joe-list-analysis':
            demisto.results(list_analysis())
        elif demisto.command() == 'joe-analysis-info':
            demisto.results(analysis_info())
        elif demisto.command() == 'joe-analysis-submit-url':
            demisto.results(analyse_url())
        elif demisto.command() == 'joe-analysis-submit-sample':
            demisto.results(analyse_sample())

    except Exception, e:
        if demisto.params().get('verbose'):
            LOG(e.message)
            LOG.print_log()
        raise
  type: python
  commands:
  - name: joe-is-online
    arguments: []
    description: Check if Joe Sandbox is online or in maintenance mode.
  - name: joe-analysis-submit-url
    arguments:
    - name: url
      required: true
      default: true
      description: sample url
    - name: should_wait
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Should the command poll for the result of the analysis
      defaultValue: "False"
    outputs:
    - contextPath: Joe. Analysis.WebID
      description: Web ID
    - contextPath: Joe. Analysis.FileName
      description: Sample Data
    - contextPath: Joe. Analysis.Status
      description: Analysis Status
    - contextPath: Joe. Analysis.Comments
      description: Analysis Comments
    - contextPath: Joe. Analysis.Time
      description: Submitted Time
    - contextPath: Joe. Analysis.Runs
      description: Application used for analysis
    - contextPath: Joe. Analysis.Result
      description: Analysis Results
    description: Submit a url for analysis.
  - name: joe-analysis-info
    arguments:
    - name: webid
      required: true
      default: true
      description: Web ID
    outputs:
    - contextPath: Joe. Analysis.WebID
      description: Web ID
    - contextPath: Joe. Analysis.FileName
      description: Sample Data
    - contextPath: Joe. Analysis.Status
      description: Analysis Status
    - contextPath: Joe. Analysis.Comments
      description: Analysis Comments
    - contextPath: Joe. Analysis.Time
      description: Submitted Time
    - contextPath: Joe. Analysis.Runs
      description: Application used for analysis
    - contextPath: Joe. Analysis.Result
      description: Analysis Results
    description: Show information about an analysis.
  - name: joe-list-analysis
    arguments: []
    outputs:
    - contextPath: Joe. Analysis.WebID
      description: Web ID
    description: List all analyses.
  - name: joe-analysis-submit-sample
    arguments:
    - name: sample
      default: true
      description: Sample File
    - name: sample_url
      description: Url to a sample file
    - name: should_wait
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Should the command poll for the result of the analysis
      defaultValue: "False"
    outputs:
    - contextPath: Joe. Analysis.WebID
      description: Web ID
    - contextPath: Joe. Analysis.FileName
      description: Sample Data
    - contextPath: Joe. Analysis.Status
      description: Analysis Status
    - contextPath: Joe. Analysis.Comments
      description: Analysis Comments
    - contextPath: Joe. Analysis.Time
      description: Submitted Time
    - contextPath: Joe. Analysis.Runs
      description: Application used for analysis
    - contextPath: Joe. Analysis.Result
      description: Analysis Results
    description: Submit a sample for analysis.
