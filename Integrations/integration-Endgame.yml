commonfields:
  id: Endgame
  version: -1
name: Endgame
display: Endgame
category: Endpoint
description: Endpoint protection built to stop advanced attacks before damage and loss occurs
image: data:image/jpeg;base64,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
configuration:
- display: 'Server URL (Example: https://me.endgame.com:2443)'
  name: url
  defaultvalue: https://localhost:2443
  type: 0
  required: true
- display: Username
  name: username
  defaultvalue: ""
  type: 9
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |-
    var host = params.url;
    var insecure = params.insecure;
    var proxy = params.proxy;
    var username = params.username.identifier;
    var password = params.username.password;
    var loginArgs = { username : username, password : password };
    var headers = { 'Content-Type': ['application/json'] };
    var token = params.token;

    var makeArray = function(obj){
        if(obj && !Array.isArray(obj))
         return [obj];
        else return obj;
    };

    var headerTransform = function(dict){
        return function(obj){
            return dict[obj];
        };
    };

    //returns single object withing entity (i.e. File[0])
    var jsonToEntityObject = function(origObj, keyTransform){
        var ret = {};
        for(var key in origObj){
            if(keyTransform(key)){
                ret[keyTransform(key)] = dq(origObj, key);
            }
        }
        return ret;
    };

    //returns entire entity array (i.e. File)
    var jsonToEntity = function(origObj, keyTransform){
        var j;
        if(!Array.isArray(origObj)){
            return jsonToEntityObject(origObj, keyTransform);
        }
        else if(origObj.length > 0){ //makes sure no empty arrays are pushed
            var ret = [];
            for(j=0; j<origObj.length; j++){
                ret.push(jsonToEntityObject(origObj[j], keyTransform));
            }
            return ret;
        }
    };

    var commandToResult = {
        'endgame-deploy' : [{
            contextPath : 'EndGame.Deployment(val.Key==obj.Key)',
            title: 'Deployment Status',
            MDdata:{
                'deployment_profile': 'Sensor ID',
                'domain': 'Domain',
                'id': 'Deploy ID'
            }
        }],
        'endgame-get-deployment-profiles' : [{
            contextPath : 'EndGame.SensorProfiles(val.Id==obj.Id)',
            title: 'Deployment Profiles',
            MDdata:{
                'api_key': 'API Key',
                'created_at':'Created At',
                'id':'ID',
                'name':'Name',
                'receiver':'Receiver',
                'sensor_directory':'Sensor Directory',
                'sensor_version':'Sensor Version',
                'updated_at':'Updated At'
            }
        }],
        'endgame-get-unmanaged-endpoints' : [{
            contextPath : 'EndGame.Endpoints(val.Id==obj.Id)',
            title: 'Unmanagaed Endpoints',
            MDdata:{
                'core_os': 'Core OS',
                'created_at': 'Created At',
                'id': 'ID',
                'name': 'Name',
                'display_operating_system': 'Display Operating System',
                'domain': 'Domain',
                'machine_id': 'Machine ID',
                'status': 'Status',
                'mac_address' : 'MAC Address',
                'operating_system' : 'Operating System',
                'ip_address' : 'IP Address'
            }
        }],
        'endgame-get-endpoint-status' : [{
            contextPath : 'EndGame.Endpoints(val.MachineId==obj.MachineId)',
            title: 'Endpoint Status',
            MDdata:{
                'status': 'Status',
                'machine_id':'Machine ID',
                'ip_address' : 'Machine IP',
                'hostname' : 'Name'
            }
        }],
        'endgame-create-sensor-profile' : [{
            contextPath : 'EndGame.SensorProfiles(val.Id==obj.Id)',
            title: 'Sensor Profile',
            MDdata:{
                'id':'ID',
                'name':'Name'
            }
        }],
        'endgame-get-sensor' : [{
            contextPath : 'EndGame.SensorProfiles(val.Id==obj.Id)',
            title: 'Deployment Profile',
            MDdata:{
                'api_key': 'API Key',
                'created_at':'Created At',
                'id':'ID',
                'name':'Name',
                'receiver':'Receiver',
                'sensor_directory':'Sensor Directory',
                'sensor_version':'Sensor Version',
                'updated_at':'Updated At'
            }
        }],
        'endgame-create-investigation' : [{
            contextPath : 'EndGame.Investigations(val.Id==obj.Id)',
            title: 'Investigation',
            MDdata:{
                'id' : 'ID'
            }
        }],
        'endgame-get-investigations' : [{
            contextPath : 'EndGame.Investigations(val.Id==obj.Id)',
            title: 'Investigations',
            MDdata:{
                'id':'ID',
                'core_os' : 'Core OS',
                'created_by_user_display_name' : 'Created By',
                'hunt_count' : 'Hunt Count',
                'name' : 'Name',
                'updated_at' : 'Updated At',
                'user_display_name' : 'User'
            }
        }]
    };

    var sendRequest = function(url, method, queryParams, data, isLogout) {
        if (url[url.length - 1] === '/') {
            url = url.substring(0, url.length - 1);
        }

        var requestUrl = host + url;
        if (queryParams) {
            requestUrl += encodeToURLQuery(queryParams);
        }

        var res = http(
            requestUrl,
            {
                Method: method,
                Headers: headers,
                Body: data? JSON.stringify(data) : undefined
            },
            insecure,
            proxy
        );

        if (res.StatusCode >= 300 || res.StatusCode < 200) {
            if(token && !isLogout){
                  logout();
            }
            throw 'Request Failed.\nStatus code: ' + res.StatusCode + '.\nResponse Body: ' + res.Body;
        }
        try {
            return JSON.parse(res.Body);
        } catch (err) {
            return res.Body;
        }

    };

    var get = function(url, queryParams, isLogout){
        return sendRequest(url, 'GET', queryParams, undefined, isLogout);
    };

    var post = function(url, queryParams, data){
        return sendRequest(url, 'POST', queryParams, data);
    };

    var login = function(){
        if (!token) {
            try {
                resp = post('/api/v1/auth/login', undefined, loginArgs);
                token = resp.metadata.token;
                headers = { 'Content-Type': ['application/json'], 'Authorization': ['JWT ' + token] };
            } catch (err) {
                throw 'ERROR: failure while authenticating to platform: ' + err;
            }
        }
    };

    var logout = function(){
        return get('/api/v1/auth/logout/', undefined, true);
    };

    /**** Get Commands ****/
    var getDeploymentProfiles = function(){
        return get('/api/v1/deployment-profiles/').data;
    };

    var getUnmanagedEndpoints = function(){
        return get('/api/v1/endpoints/', {'core_os' : 'windows', 'status':'not-installed'});
    };

    var getUsers = function(){
        return get('/api/v1/users');
    };

    var getInvestigations = function(){
        return get('/api/v1/investigations?archived=false').data;
    };

    var getSensor = function(sensor_id){
        return get('/api/v1/deployment-profiles/'+sensor_id).data;
    };

    var getUserID = function(name){
        res = getUsers().data;
            for(var i=0; i<res.length; i++){
                if(res[i].username === name){
                    return res[i].id;
                }
            }
        return -1;
    };

    var getSensorIDs = function(endpoints){
        var ret= [];
            var res = get('/api/v1/sensors').results;
            if(!Array.isArray(endpoints)){
                endpoints = [endpoints];
            }
            for(var i=0; i<endpoints.length; i++){
                for(var j=0; j<res.length; j++){
                    if(endpoints[i] === res[j].endpoint.name){
                        ret.push(res[j].id);
                    }
                }
            }
        return ret;
    };

    var getEndpointStatus = function(args){
        if(!args.ip_address && !args.name && !args.machine_id)
            throw 'Missing arguments. Must have one of the following: ip, name, uuid';
        var res = get('/api/v1/endpoints', args);
        return res.data[0];
    };

    var getInvestigationStatus = function(inv_id){
        var task_completion = get('/api/v1/investigations/'+inv_id+'/').data.task_completion;
        var completed = task_completion.completed_tasks;
        var total = task_completion.total_tasks;
        var context = {};
        var md = '';
        if(total === completed){
            md = 'Investigation Completed';
            context['EndGame.Investigations(val.Id=='+inv_id+')'] = {'Status' : 'completed', 'Id':inv_id};
        }
        else{
            md = 'Investigation not completed';
            context['EndGame.Investigations(val.Id==obj.Id)'] = {'Status' : completed+'/'+total, 'Id' : inv_id};
        }
        return {
            Type: entryTypes.note,
            Contents: task_completion,
            ContentsFormat: formats.json,
            ReadableContentsFormat : formats.notes,
            EntryContext : context,
            HumanReadable: md
        };
    };

    var getInvestigationResults = function(inv_id){
        var task_types = {'user_sessions':'Usernames', 'file_list':'Files', 'processes':'Processes', 'connections':'Networks', 'values':'Registries'};
        var task_type_keys = Object.keys(task_types);
        var contents = [];
        var tasks = makeArray(get('/api/v1/investigations/'+inv_id+'/').data.tasks);
        var context = {};
        var md = '';
        for(var i=0; i<tasks.length; i++){
            var collection_id = get('/api/v1/tasks/'+tasks[i]).data.tasks[0].metadata.collection_id;
            for(var j=0; j<task_type_keys.length;j++){
                var results = get('/api/v1/collections/'+collection_id+'/?scope='+task_type_keys[j]).data.data.results;
                if(results && Array.isArray(results) && results.length > 0){
                    context[task_types[task_type_keys[j]]] = results;
                    md += tableToMarkdown('Investigation '+task_types[task_type_keys[j]]+' Results', results);
                    contents.push(results);
                }
            }
        }
        return {
            Type: entryTypes.note,
            Contents: contents,
            ContentsFormat: formats.json,
            ReadableContentsFormat : formats.markdown,
            EntryContext : {'EndGame.InvestigationResults' : context},
            HumanReadable: md
        };
    }

    /**** Create / Set Commands ****/
    var createSensorProfile = function(name, receiver, sensor_version, sensor_directory, api_key){
        reqBody = {
            'name' : name,
            'receiver' : receiver,
            'sensor_version' : sensor_version,
            'sensor_directory' : sensor_directory,
            'api_key' : api_key,
            'config':{
                'Mitigation':{
                    'dbi_dll_name':'esensordbi.dll',
                    'popup_exe_name':'useralert.exe'
                },
                'Kernel':{
                    'sys_name':'esensor.sys',
                    'service_name':'esensordrv',
                    'service_display_name':'esensordrv'
                },
                'Installation':{
                    'dll_path':'%SYSTEMROOT%\\System32\\esensor.exe',
                    'service_name':'esensor',
                    'service_display_name':'EndpointSensor'
                }
            }
        };
        res =  post('/api/v1/deployment-profiles/', undefined, reqBody).data;
        res.id = res.success? res.success : 'Sensor profile creation failed';
        res.success = undefined;
        res.name = name;
        return res;
    }

    var createInvestigation = function(name, assignee, sensors, endpoints, args){
            var taskDescriptions = get('/api/v1/task-descriptions/').data;
            var iocTaskId = '35b6f686-dece-545f-8314-56936abec6ba';
            for(var i=0; i<taskDescriptions.length; i++){
                if(taskDescriptions[i]['name'] === 'iocSearchRequest' && taskDescriptions[i]['sensor_type'] === 'windows'){
                    log('found it!');
                    iocTaskId = taskDescriptions[i]['id'];
                    break;
                }
            }
            url = '/api/v1/investigations';
            reqBody = {
                'name' : name,
                'assign_to' : assignee,
                'sensor_ids' : sensors ? (makeArray(sensors)) : getSensorIDs(endpoints),
                'tasks': {},
                'assign_to': getUserID(assignee? assignee : params.username),
                'core_os' : 'windows'
            };
            reqBody.tasks[iocTaskId] = {'task_list' : createTask(args)}
            return post(url, undefined, reqBody).data;
    };

    var deploy = function(domain, username, password, api_key, endpoint_transaction, deployment_order, endpoint_ips, endpoint_ids){
        url = '/api/v1/deploy';
        requestBody = {
            'username' : username,
            'password' : password,
            'domain' : domain,
            'api_key' : api_key,
            'deployment_order' : deployment_order
        };

        if(endpoint_transaction){
          requestBody['endpoint_transaction'] = endpoint_transaction;
        }

        else if(endpoint_ips && endpoint_ids){
            if(endpoint_ips.length !== endpoint_ids.length){
                throw 'IP addresses don\'t match Endpoint IDs'
            }
            var targets = [];
            for(var i=0; i<endpoint_ips.length; i++){
                targets.push({'ip_address' : endpoint_ips[i], 'endpoint_uuid' : endpoint_ids[i]});
            }
            requestBody['targets'] = targets;
        }
        res = post(url, undefined, requestBody);
        return res.data;
    };

    var createTask = function(args){
        task = [];
        if(args.network_local_ip || args.network_remote_ips || args.network_port){
            task.push({
               'network_search':{
                  'with_state':'ANY',
                  'find_local_ip_address': args.network_local_ip,
                  'protocol': args.network_protocol,
                  'find_remote_ip_address':makeArray(args.network_remote_ips),
                  'port':{
                        'port':args.network_port,
                        'key': args.network_remote === 'false' ? 'local' : 'remote'
                    }
                }
            });
        }
        if(args.process_md5s || args.process_sha256s || args.process_sha1s || args.process){
            task.push({
               "process_search":{
                  "with_md5_hash":makeArray(args.process_md5s),
                  "with_sha256_hash":makeArray(args.process_sha256s),
                  "with_sha1_hash":makeArray(args.process_sha1s),
                  "find_process":args.process
               }
            });
        }
        if(args.file_md5s || args.file_sha256s || args.file_sha1s){
            task.push({
               'file_search':{
                    'with_md5_hash':makeArray(args.file_md5s),
                    'with_sha1_hash':makeArray(args.file_sha1s),
                    'with_sha256_hash':makeArray(args.file_sha256s),
                    'regexes':makeArray(args.file_regexes),
                    'directory': args.file_dir
                }
            });
        }
        if(args.registry_key){
            task.push({
                'registry_search':{
                    'hive':'ALL',
                    'min_size':args.registry_min_size,
                    'max_size':args.registry_max_size,
                    'key': makeAray(args.registry_key)
                }
            });
        }
        if(args.user_search || args.user_search_domain){
            task.push({
               'username_search':{
                    'find_username': makeArray(args.user_search),
                    'domain': args.user_search_domain
                }
            });
        }
        return task;
    };

    var resToEntry = function(results){
        currentCommand = commandToResult[command];
        var entries = [];
        for (var j in currentCommand) {
            var current = currentCommand[j];
            var entry = {
                Type: entryTypes.note,
                Contents: results,
                ContentsFormat: formats.json
                ReadableContentsFormat : formats.markdown,
                EntryContext : {}
            };
            entry.HumanReadable = tableToMarkdown(current.title, results, Object.keys(current.MDdata), undefined, headerTransform(current.MDdata));
            entry.EntryContext[current.contextPath] = jsonToEntity(results, underscoreToCamelCase);
            entries.push(entry);
        }
        return entries;
    }

    var results;
    login();
    switch (command) {
        case 'test-module':
            return 'ok';
        case 'endgame-investigation-results':
            results = getInvestigationResults(args.investigation_id);
            logout();
            return results;
        case 'endgame-investigation-status':
            return getInvestigationStatus(args.investigation_id)
        case 'endgame-get-unmanaged-endpoints':
            results = getUnmanagedEndpoints();
            res = resToEntry(results.data);
            res[0].EntryContext['EndGame(true)'] = {'TransactionID' : results.metadata.transaction_id};
            logout();
            return res;
        case 'endgame-get-deployment-profiles':
            results = getDeploymentProfiles();
            break;
        case 'endgame-get-endpoint-status':
            results = getEndpointStatus(args);
            break;
        case 'endgame-create-sensor-profile':
            results = createSensorProfile(args.name, args.transceiver, args.sensor_version, args.sensor_directory, args.api_key);
            break;
        case 'endgame-create-investigation':
            results = createInvestigation(args.investigation_name, args.assign_to ? args.assign_to : params.username.identifier, args.sensors, args.endpoints, args);
            break;
        case 'endgame-get-investigations':
            results = getInvestigations();
            break;
        case 'endgame-get-sensor':
            results = getSensor(args.sensor_id);
            break;
        case 'endgame-deploy':
            results = deploy(args.domain, args.username, args.password, args.api_key, args.endpoints_transaction_id, args.deployment_profile, makeArray(args.endpoint_ips), makeArray(args.endpoint_ids));
            if(results.submitted){
                results.deployment_profile = args.deployment_profile;
                results.id = results.submitted;
                results.domain = args.domain;
                results.submitted = undefined;
            }
            break;
    }
    logout();
    return resToEntry(results);
  type: javascript
  commands:
  - name: endgame-deploy
    arguments:
    - name: domain
      required: true
      description: Deployment domain
    - name: username
      required: true
      description: Machine username
    - name: password
      required: true
      description: Machine password
    - name: api_key
      required: true
      description: API key
    - name: deployment_profile
      required: true
      description: Sensor profile to be deployed
    - name: endpoints_transaction_id
      description: Last transaction id
    - name: endpoint_ids
      description: ID's of endpoints to be deployed. Must provide IP's as well
    - name: endpoint_ips
      description: IP addresses of endpoints to be deployed. Must provide ID's as
        well
    outputs:
    - contextPath: EndGame.Deployment.DeploymentProfile
      description: The deployed sensor profile
    - contextPath: EndGame.Deployment.Domain
      description: The deployed domain
    - contextPath: EndGame.Deployment.Submitted.Id
      description: Deploy ID
    description: 'Deploy sensor profile to unmanaged endpoints. '
  - name: endgame-get-deployment-profiles
    arguments: []
    outputs:
    - contextPath: EndGame.SensorProfiles.ApiKey
      description: API Key of sensor profile
    - contextPath: EndGame.SensorProfiles.Id
      description: ID of sensor profile
    - contextPath: EndGame.SensorProfiles.SensorDirectory
      description: DIrectory of the sensor profile
    - contextPath: EndGame.SensorProfiles.Name
      description: Name of sensor profile
    - contextPath: EndGame.SensorProfiles.UpdatedAt
      description: Last time sensor was updated
    - contextPath: EndGame.SensorProfiles.Receiver
      description: Receiver IP address
    - contextPath: EndGame.SensorProfiles.CreatedAt
      description: Date and time sensor was created
    - contextPath: EndGame.SensorProfiles.SensorVersion
      description: Version of sensor
    - contextPath: EndGame.SensorProfiles.Config
      description: Sensor profile configuration
    description: Get all deployment (sensor) profiles
  - name: endgame-get-unmanaged-endpoints
    arguments: []
    outputs:
    - contextPath: EndGame.TransactionID
      description: id of transaction to use when deploying
    - contextPath: EndGame.Endpoints.MachineId
      description: Endgame id of the machine
    - contextPath: EndGame.Endpoints.CoreOs
      description: Core OS of the machine
    - contextPath: EndGame.Endpoints.Name
      description: Name of the machine
    - contextPath: EndGame.Endpoints.Status
      description: Status of hte machine
    - contextPath: EndGame.Endpoints.IpAddress
      description: IP address of the machine
    - contextPath: EndGame.Endpoints.UpdatedAt
      description: Last updates time
    description: Get all unmanaged endpoint details
  - name: endgame-get-endpoint-status
    arguments:
    - name: ip_address
      description: IP address of machine
    - name: name
      description: Name of machine
    - name: machine_id
      description: EndGame machine ID
    outputs:
    - contextPath: EndGame.TransactionID
      description: id of transaction to use when deploying
    - contextPath: EndGame.Endpoints.MachineId
      description: Endgame id of the machine
    - contextPath: EndGame.Endpoints.CoreOs
      description: Core OS of the machine
    - contextPath: EndGame.Endpoints.Name
      description: Name of the machine
    - contextPath: EndGame.Endpoints.Status
      description: Status of hte machine
    - contextPath: EndGame.Endpoints.IpAddress
      description: IP address of the machine
    - contextPath: EndGame.Endpoints.UpdatedAt
      description: Last updates time
    description: Get specified endpoint status. Must provide at least one argument
  - name: endgame-create-sensor-profile
    arguments:
    - name: name
      required: true
      description: Name of sensor profile
    - name: transceiver
      required: true
      description: Transceiver address of sensor profile
    - name: sensor_version
      required: true
      description: Version of sensor profile
    - name: api_key
      required: true
      description: API key of sensor profile
    - name: sensor_directory
      required: true
      description: Sensor profile directory
    outputs:
    - contextPath: EndGame.SensorProfiles.Id
      description: EndGame ID of created sensor profile
    - contextPath: EndGame.SensorProfiles.Name
      description: Name of created sensor profile
    description: Create deployment (sensor) profile
  - name: endgame-get-investigations
    arguments: []
    outputs:
    - contextPath: EndGame.Investigations.TaskCompletion
      description: Task completion status
    - contextPath: EndGame.Investigations.Name
      description: Name of investigation
    - contextPath: EndGame.Investigations.EndpointCount
      description: Number of endpoints for investigation
    - contextPath: EndGame.Investigations.CreatedAt
      description: Time created
    - contextPath: EndGame.Investigations.UpdatedAt
      description: Time last updated
    - contextPath: EndGame.Investigations.UserDisplayName
      description: Display name of user that created th investigation
    - contextPath: EndGame.Investigations.CoreOs
      description: Core OS of investigation
    description: Get all endgame investigations
  - name: endgame-create-investigation
    arguments:
    - name: investigation_name
      required: true
      description: Name of investigation
    - name: sensors
      description: Sensor ID's of machines to investigate. Overrides endpoints argument
    - name: endpoints
      description: Names of machines to investigate. Overridden by sensors argument
    - name: assign_to
      description: Default is the username given in the instance credentials
    - name: network_local_ip
      description: local ip address for network search
    - name: network_protocol
      description: protocol for netwprk search
    - name: network_remote_ips
      description: remote ips (comma separated) for network search
    - name: network_port
      description: port for network search
    - name: network_remote
      description: true for remote, false otherwise. Used for network search
    - name: process
      description: name of process to search
    - name: process_sha1s
      description: sha1s of process (comma separated)
    - name: process_md5s
      description: md5s of process (comma separated)
    - name: process_sha256s
      description: sha256s of process (comma separated)
    - name: file_dir
      description: Directory of file to search
      defaultValue: 'C:'
    - name: file_regexes
      description: regexes of file to search
    - name: file_sha256s
      description: sha256s of files to search (comma separated)
    - name: file_sha1s
      description: sha1s of files to search (comma separated)
    - name: file_md5s
      description: md5s of files to search (comma separated)
    - name: registry_key
      description: Registry Key or Value Name Containing
    - name: registry_max_size
      description: max size of registry to search
    - name: registry_min_size
      description: min size of registry to search
    - name: user_search_domain
      description: Domain to search
    - name: user_search
      description: username to search
    outputs:
    - contextPath: EndGame.Investigations.Id
      description: Id of created investigation
    description: 'Create endgame IOC investigation. '
  - name: endgame-get-sensor
    arguments:
    - name: sensor_id
      required: true
      description: ID of sensor profile
    outputs:
    - contextPath: EndGame.SensorProfiles.Config
      description: Sensor profile configuration details
    - contextPath: EndGame.SensorProfiles.ApiKey
      description: API key of sesnor profile
    - contextPath: EndGame.SensorProfiles.AccountId
      description: Account ID
    - contextPath: EndGame.SensorProfiles.Name
      description: Name of sensor profile
    - contextPath: EndGame.SensorProfiles.UpdatedAt
      description: Date and time sensor was last changed
    - contextPath: EndGame.SensorProfiles.Receiver
      description: Receiver of sensor profile
    - contextPath: EndGame.SensorProfiles.SensorDirectory
      description: Directory of sensor profile
    - contextPath: EndGame.SensorProfiles.Deleted
      description: Is sensor profile deleted
    - contextPath: EndGame.SensorProfiles.CreatedAt
      description: Date and time sensor profile was created
    - contextPath: EndGame.SensorProfiles.Id
      description: Id of sensor
    - contextPath: EndGame.SensorProfiles.SensorVersion
      description: Version of given sensor
    description: Get sensor data by id
  - name: endgame-investigation-results
    description: Get investigation results by id
    arguments:
    - name: investigation_id
      description: Id of investigation
    outputs:
    - contextPath: EndGame.InvestigationResults.Files
      description: File investigation results
    - contextPath: EndGame.InvestigationResults.Usernames
      description: Username investigation results
    - contextPath: EndGame.InvestigationResults.Processes
      description: Processes investigation results
    - contextPath: EndGame.InvestigationResults.Registries
      description: Registries investigation results
    - contextPath: EndGame.InvestigationResults.Networks
      description: Networks investigation results
  - name: endgame-investigation-status
    arguments:
    - name: investigation_id
      required: true
      description: Id of investigation
    outputs:
    - contextPath: EndGame.Investigations.Id
      description: Endgame ID of investigation
    - contextPath: EndGame.Investigations.Status
      description: Endgame investigation status
    description: Returns the current investigation status
