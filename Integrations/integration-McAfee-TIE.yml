commonfields:
  id: McAfee Threat Intelligence Exchange
  version: -1
name: McAfee Threat Intelligence Exchange
display: McAfee Threat Intelligence Exchange
category: Data Enrichment
image: data:image/png;base64,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
description: Connect to TIE using its DXL client
detaileddescription: |-
  ### Prerequisites - Connect to McAfee Threat Intelligence Exchange (TIE) using the DXL TIE client.
  [Create certificates & configure dxl](https://opendxl.github.io/opendxl-client-python/pydoc/index.html). After this phase you must have:
   * Broker CA certificates ('brokercerts.crt'  file)
   * Client certificate ('client.crt' file)
   * Client private key ('client.key' file)
   * Broker list properties file ('brokerlist.properties' file)

   To use 'tie-set-file-reputation' - you must have an appropriate permission. Follow [this insructions](https://opendxl.github.io/opendxl-client-python/pydoc/marsendauth.html), and ** with the exception of swapping the 'Active Response Server API' in 'TIE Server Set Enterprise Reputation'**

  ### Dependencies (Python packages) - No need to install, already installed in docker image :
  dxlclient [docs](https://opendxl.github.io/opendxl-client-python/pydoc/index.html)
  dxltieclient [docs](https://opendxl.github.io/opendxl-tie-client-python/pydoc/)
configuration:
- display: Broker CA certificates content (see `brokercerts.crt` in instructions)
  name: broker_ca_bundle
  defaultvalue: ""
  type: 12
  required: true
- display: Client certificates content (see `client.crt` in instructions)
  name: cert_file
  defaultvalue: ""
  type: 12
  required: true
- display: Client private key path (e.g. /usr/config/client.key)
  name: private_key
  defaultvalue: ""
  type: 14
  required: true
- display: Brokers urls (comma separated list in the form of - [ssl://]<hostname>[:port])
    - get hostname & port from `brokerlist.properties` file in instructions. Note
    that the broker should be reachable from demisto server
  name: broker_urls
  defaultvalue: ""
  type: 0
  required: true
script:
  script: |
    from dxlclient.client_config import DxlClientConfig
    from dxlclient.client import DxlClient
    from dxlclient.broker import Broker
    from dxltieclient import TieClient
    from dxltieclient.constants import HashType
    from datetime import datetime

    VENDOR_NAME = 'McAfee Threat Intelligence Exchange'

    broker_ca_bundle = './brokercerts.crt'
    with open(broker_ca_bundle, "w") as text_file:
        text_file.write(demisto.params()['broker_ca_bundle'])

    cert_file = './cert_file.crt'
    with open(cert_file, "w") as text_file:
        text_file.write(demisto.params()['cert_file'])

    private_key = './private_key.key'
    with open(private_key, "w") as text_file:
        text_file.write(demisto.params()['private_key'])

    broker_urls = demisto.params()['broker_urls'].split(',')

    HASH_TYPE_KEYS = {
        'md5': HashType.MD5,
        'sha1': HashType.SHA1,
        'sha256': HashType.SHA256
    }

    TRUST_LEVELS = {
        '0': 'NOT_SET',
        '1': 'KNOWN_MALICIOUS',
        '15': 'MOST_LIKELY_MALICIOUS',
        '30': 'MIGHT_BE_MALICIOUS',
        '50': 'UNKNOWN',
        '70': 'MIGHT_BE_TRUSTED',
        '85': 'MOST_LIKELY_TRUSTED',
        '99': 'KNOWN_TRUSTED',
        '100': 'KNOWN_TRUSTED_INSTALLER'
    }

    POVIDER = {
        '1': 'Global Threat Intelligence (GTI)',
        '3': 'Enterprise reputation',
        '5': 'Advanced Threat Defense (ATD)',
        '7': 'Web Gateway (MWG)'
    }

    def create_error_entry(contents):
        return { 'ContentsFormat': formats['text'], 'Type': entryTypes['error'], 'Contents': contents };

    def get_client_config():
        config = DxlClientConfig(
            broker_ca_bundle=broker_ca_bundle,
            cert_file=cert_file,
            private_key=private_key,
            brokers=[Broker.parse(url) for url in broker_urls]
        )

        config.connect_retries = 1
        config.reconnect_delay = 1
        config.reconnect_delay_max = 10

        return config

    def get_provider(provider_id):
        provider_id_str = str(provider_id)
        return POVIDER.get(provider_id_str, provider_id_str)

    def parse_reputation(rep):
        # get trust level
        trust_level = str(rep.get('trustLevel'))
        verbose_trust_level = TRUST_LEVELS.get(trust_level, trust_level)

        # get provider
        provider_id = rep.get('providerId')
        provider = get_provider(provider_id)

        # get date
        create_date = rep.get('createDate')
        create_date_str = str(datetime.fromtimestamp(create_date))

        res = {
            'Trust level': trust_level,
            'Trust level (verbose)': verbose_trust_level,
            'Provider ID': provider_id,
            'Provider (verbose)': provider,
            'Created date': create_date_str
        }

        return res

    def parse_reference(reference):
        agent_guid = reference.get('agentGuid')
        return {
            'Date': str(datetime.fromtimestamp(reference.get('date'))),
            'AgentGuid': agent_guid.replace('{', '').replace('}', '') # remove brackets if exist
        }

    def reputations_to_table(reputations):
        return [parse_reputation(rep) for rep in reputations]

    def references_to_table(references):
        return [parse_reference(ref) for ref in references]

    def trust_level_to_score(trust_level):
        if (trust_level >= 70):
            return 1
        elif (trust_level >= 30):
            return 2
        elif (trust_level >= 30):
            return 3
        else:
            return 0

    def get_thrust_level_and_score(reputations):
        trust_level = 101 # more than the highst possible trust level
        vendor = VENDOR_NAME

        for rep in reputations:
            rep_trust_level = rep.get('trustLevel', 0)
            if  rep_trust_level != 0 and rep_trust_level < trust_level:
                trust_level = rep.get('trustLevel')
                vendor = get_provider(rep.get('providerId'))

        if trust_level == 101:
            # no trust_level found
            return {
                'trust_level': 0,
                'score': 0,
                'vendor': vendor
            }

        score = trust_level_to_score(trust_level)

        if (vendor == 'Enterprise reputation'):
            vendor = VENDOR_NAME
        return {
            'trust_level': trust_level,
            'score': score,
            'vendor': vendor
            }

    def test():
        config = get_client_config()
        with DxlClient(config) as client:
            client.connect()
            client.disconnect()

    def file(hash):
        config = get_client_config()
        with DxlClient(config) as client:
            client.connect()
            # Create the McAfee Threat Intelligence Exchange (TIE) client
            tie_client = TieClient(client)

            hash_type = get_hash_type(hash)
            hash_type_key = HASH_TYPE_KEYS.get(hash_type)
            if not hash_type_key:
                return create_error_entry('file argument must be sha1(40 charecters) or sha256(64 charecters) or md5(32 charecters)')

            hash_param = {}
            hash_param[hash_type_key] = hash

            res = tie_client.get_file_reputation(hash_param)
            reputations = res.values()

            table = reputations_to_table(reputations)

            # creaet context
            context_file = {}
            hash_type_uppercase = hash_type.upper()
            tl_score = get_thrust_level_and_score(reputations)

            context_file[hash_type_uppercase] = hash
            context_file['TrustLevel'] = tl_score['trust_level']
            context_file['Vendor'] = tl_score['vendor']

            dbot_score = {'Indicator': hash, 'Type': 'hash', 'Vendor': tl_score['vendor'], 'Score': tl_score['score']};
            if tl_score['score'] >= 2:
                context_file['Malicious'] = {
                   'Vendor': tl_score['vendor'],
                   'Score': tl_score['score'],
                   'Description': 'Trust level is ' + str(tl_score['trust_level'])
               }
            ec = {
                'DBotScore': dbot_score
            }
            ec[outputPaths['file']] = context_file

            return {
                'Type': entryTypes['note'],
                'ContentsFormat': formats['json'],
                'Contents': reputations,
                'ReadableContentsFormat': formats['markdown'],
                'HumanReadable': tableToMarkdown('McAfee TIE Hash Reputations For %s:' % (hash,), table),
                'EntryContext': ec
            }

    def file_references(hash):
        config = get_client_config()
        with DxlClient(config) as client:
            client.connect()
            # Create the McAfee Threat Intelligence Exchange (TIE) client
            tie_client = TieClient(client)

            hash_type = get_hash_type(hash)
            hash_type_key = HASH_TYPE_KEYS.get(hash_type)
            if not hash_type_key:
                return create_error_entry('file argument must be sha1(40 charecters) or sha256(64 charecters) or md5(32 charecters)')

            hash_param = {}
            hash_param[hash_type_key] = hash

            references = tie_client.get_file_first_references(hash_param)

            table = references_to_table(references)

            # creaet context
            context_file = {}
            hash_type_uppercase = hash_type.upper()

            context_file[hash_type_uppercase] = hash
            context_file['References'] = table
            ec = {}
            ec[outputPaths['file']] = context_file
            return {
                'Type': entryTypes['note'],
                'ContentsFormat': formats['json'],
                'Contents': references,
                'ReadableContentsFormat': formats['markdown'],
                'HumanReadable': tableToMarkdown('References for hash %s' % (hash,), table),
                'EntryContext': ec
            }

            return res

    def set_file_reputation(hash, trust_level, filename, comment):
        config = get_client_config()

        # find trust_level key
        trust_level_key = None
        for k, v in TRUST_LEVELS.iteritems():
            if v == trust_level:
                trust_level_key = k

        if not trust_level_key:
            return create_error_entry('illigale argument trust_level %s. Choose value from predefined values' % (trust_level, ))


        with DxlClient(config) as client:
            client.connect()
            tie_client = TieClient(client)

            hash_type = get_hash_type(hash)
            hash_type_key = HASH_TYPE_KEYS.get(hash_type)
            if not hash_type_key:
                return create_error_entry('file argument must be sha1(40 charecters) or sha256(64 charecters) or md5(32 charecters)')

            hash_param = {}
            hash_param[hash_type_key] = hash

            try:
                tie_client.set_file_reputation(trust_level_key, hash_param, filename, comment)
                return 'Successfully set file repuation'
            except Exception as ex:
                return create_error_entry(str(ex))


    args = demisto.args()
    if demisto.command() == 'test-module':
        test()
        demisto.results('ok')
        sys.exit(0)
    elif demisto.command() == 'file':
        results = file(args.get('file'))
        demisto.results(results)
        sys.exit(0)
    elif demisto.command() == 'tie-file-references':
        results = file_references(args.get('file'))
        demisto.results(results)
        sys.exit(0)
    elif demisto.command() == 'tie-set-file-reputation':
        results = set_file_reputation(
            args.get('file'),
            args.get('trust_level'),
            args.get('filename'),
            args.get('comment')
        )
        demisto.results(results)
        sys.exit(0)
  type: python
  commands:
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: '  Hash of the file to query. Supports MD5 SHA1 & SHA256'
    outputs:
    - contextPath: File.MD5
      description: file's hash MD5 (if supplied)
    - contextPath: File.SHA1
      description: file's hash SHA1 (if supplied)
    - contextPath: File.SHA256
      description: file's hash MD5 (if supplied)
    - contextPath: File.TrustLevel
      description: File lowest trust level
    - contextPath: File.Vendor
      description: File lowest trust level's vendor
    - contextPath: DBotScore.Score
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Vendor
      description: The actual score
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Indicator
      description: The given file's hash
    important:
    - contextPath: File(val.Malicious)
      description: Malicious Files
      related: ""
    description: Retrieves the reputations for the specified hash ( Supports MD5 SHA1
      & SHA256)
  - name: tie-set-file-reputation
    arguments:
    - name: file
      required: true
      default: true
      description: '  Hash of the file to set. Supports MD5 SHA1 & SHA256'
    - name: trust_level
      required: true
      auto: PREDEFINED
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      description: The new trust level for the file
    - name: filename
      description: A file name to associate with the file
    - name: comment
      description: A comment to associate with the file
    description: Sets the “Enterprise” reputation (trust level) of a specified file.
      NOTE - invoking this method must have permissions - 'How-to' in instance instruction)
  - name: tie-file-references
    arguments:
    - name: file
      required: true
      default: true
      description: '  Hash of the file to search on. Supports MD5 SHA1 & SHA256'
    outputs:
    - contextPath: File.MD5
      description: file's hash MD5 (if supplied)
    - contextPath: File.SHA1
      description: file's hash SHA1 (if supplied)
    - contextPath: File.SHA256
      description: file's hash SHA256 (if supplied)
    - contextPath: File.References.AgentGuid
      description: The GUID of the system that referenced the file
    - contextPath: File.References.Date
      description: The time the system first referenced the file
    description: Retrieves the set of systems which have referenced (typically executed)
      the specified file
  dockerimage: demisto/dxl
releaseNotes: "-"