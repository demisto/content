commonfields:
  id: AWS - IAM
  version: -1
name: AWS - IAM
display: AWS - IAM
category: IT Services
image: data:image/png;base64,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
description: Amazon Web Services Identity and Access Management (IAM)
configuration:
- display: Role Arn
  name: roleArn
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Name
  name: roleSessionName
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Duration
  name: sessionDuration
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |+
    import boto3
    import datetime

    AWS_DEFAULT_REGION = None
    AWS_roleArn = demisto.params()['roleArn']
    AWS_roleSessionName = demisto.params()['roleSessionName']
    AWS_roleSessionDuration = demisto.params()['sessionDuration']
    AWS_rolePolicy = None

    def aws_session(service='iam',region=None,roleArn=None,roleSessionName=None,roleSessionDuration=None,rolePolicy=None):
          kwargs = {}
          if roleArn and roleSessionName is not None:
              kwargs.update({
                  'RoleArn':roleArn,
                  'RoleSessionName':roleSessionName,
                  })
          elif AWS_roleArn and AWS_roleSessionName is not None:
              kwargs.update({
                  'RoleArn':AWS_roleArn,
                  'RoleSessionName':AWS_roleSessionName,
                  })

          if roleSessionDuration is not None:
              kwargs.update({'DurationSeconds':int(roleSessionDuration)})
          elif AWS_roleSessionDuration is not None:
              kwargs.update({'DurationSeconds':int(AWS_roleSessionDuration)})

          if rolePolicy is not None:
              kwargs.update({'Policy':rolePolicy})
          elif AWS_rolePolicy is not None:
              kwargs.update({'Policy':AWS_rolePolicy})

          if kwargs:
              sts_client = boto3.client('sts')
              sts_response = sts_client.assume_role(**kwargs)
              if region is not None:
                  client = boto3.client(
                      service_name=service,
                      region_name=region,
                      aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                      aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                      aws_session_token=sts_response['Credentials']['SessionToken']
                      )
              else:
                  client = boto3.client(
                      service_name=service,
                      region_name=AWS_DEFAULT_REGION,
                      aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                      aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                      aws_session_token=sts_response['Credentials']['SessionToken']
                      )
          else:
              if region is not None:
                  client = boto3.client(service_name=service,region_name=region)
              else:
                  client = boto3.client(service_name=service,region_name=AWS_DEFAULT_REGION)

          return client

    class DatetimeEncoder(json.JSONEncoder):
      def default(self, obj):
        if isinstance (obj, datetime.datetime):
            return obj.strftime ('%Y-%m-%dT%H:%M:%S')
        elif isinstance (obj, datetime.date):
            return obj.strftime ('%Y-%m-%d')
        elif isinstance(obj, datetime):
            return obj.strftime('%Y-%m-%dT%H:%M:%S')
        elif isinstance(obj, date):
            return obj.strftime('%Y-%m-%d')
        # Let the base class default method raise the TypeError
        return json.JSONEncoder.default(self, obj)

    def create_entry(title,data, ec):
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': data,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, data) if data else 'No result were found',
            'EntryContext': ec
        }

    def raise_error(error):
        return {
            'Type' : entryTypes['error'],
            'ContentsFormat' : formats['text'],
            'Contents' : str(error)
        }

    def create_user(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'UserName':args.get('userName')}
            if args.get('path'):
                kwargs.update({'Path':args.get('path')})

            response = client.create_user(**kwargs)
            user = response['User']
            data = ({
                'UserName': user['UserName'],
                'UserId': user['UserId'],
                'Arn': user['Arn'],
                'CreateDate': datetime.datetime.strftime(user['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                'Path':user['Path'],
            })
            ec = {'AWS.IAM.Users': data}
            return create_entry('AWS IAM Users', data, ec)

        except Exception as e:
            return raise_error(e)

    def create_login_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'UserName':args.get('userName'),
                'Password':args.get('password')
                }
            if args.get('passwordResetRequired'):
                kwargs.update({'PasswordResetRequired':True if args.get('passwordResetRequired') == 'True'  else False})

            response = client.create_login_profile(**kwargs)
            LoginProfile = response['LoginProfile']
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "Login Profile Was Created For user {0} ".format(args.get('userName'))

        except Exception as e:
            return raise_error(e)

    def get_user(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.get_user(UserName=args.get('userName'))
            user = response['User']
            data = ({
                'UserName': user['UserName'],
                'UserId': user['UserId'],
                'Arn': user['Arn'],
                'CreateDate': datetime.datetime.strftime(user['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                'Path':user['Path'],
            })
            ec = {'AWS.IAM.Users': data}
            return create_entry('AWS IAM Users', data, ec)

        except Exception as e:
            return raise_error(e)

    def list_users(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            paginator = client.get_paginator('list_users')
            for response in paginator.paginate():
                for user in response['Users']:
                    data.append ({
                        'UserName': user['UserName'],
                        'UserId': user['UserId'],
                        'Arn': user['Arn'],
                        'CreateDate': datetime.datetime.strftime(user['CreateDate'], '%Y-%m-%d %H:%M:%S'),
                        'Path': user['Path'],
                    })
            ec = {'AWS.IAM.Users': data}
            return create_entry('AWS IAM Users', data, ec)

        except Exception as e:
            return raise_error(e)

    def update_user(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'UserName': args.get('oldUserName')}
            if args.get('newUserName'):
                kwargs.update({'NewUserName':args.get('newUserName')})
            if args.get('newPath'):
                kwargs.update({'NewPath':args.get('newPath')})

            response = client.update_user(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "Changed UserName {0} To: {1}".format(args.get('oldUserName'), args.get('newUserName'))

        except Exception as e:
            return raise_error(e)

    def delete_user(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_user(UserName=args.get('userName'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'The User {0} has been deleted'.format(args.get('userName'))

        except Exception as e:
            return raise_error(e)

    def update_login_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.update_login_profile(
                Password=args.get('newPassword'),
                UserName=args.get('userName'),
                 PasswordResetRequired=True if args.get('passwordResetRequired') == 'True'  else False
                )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The user {0} Password was changed".format(args.get('userName'))

        except Exception as e:
            return raise_error(e)

    def create_group(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'GroupName':args.get('groupName')}
            if args.get('path') is not None:
                kwargs.update({'Path':args.get('path')})

            response = client.create_group(**kwargs)
            group = response['Group']
            data = ({
                'GroupName': group['GroupName'],
                'GroupId': group['GroupId'],
                'Arn': group['Arn'],
                'CreateDate': datetime.datetime.strftime(group['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                'Path': group['Path'],
            })
            ec = {'AWS.IAM.Groups': data}
            return create_entry('AWS IAM Groups', data, ec)

        except Exception as e:
            return raise_error(e)

    def list_groups(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            paginator = client.get_paginator('list_groups')
            for response in paginator.paginate():
                for group in response['Groups']:
                    data.append ({
                        'GroupName': group['GroupName'],
                        'GroupId': group['GroupId'],
                        'Arn': group['Arn'],
                        'CreateDate': datetime.datetime.strftime(group['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                        'Path': group['Path'],
                    })
            ec = {'AWS.IAM.Groups': data}
            return create_entry('AWS IAM Groups', data, ec)

        except Exception as e:
            return raise_error(e)

    def list_groups_for_user(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data=[]
            response = client.list_groups_for_user(UserName=args.get('userName'))
            for group in response['Groups']:
                data.append ({
                    'UserName': args.get('userName'),
                    'GroupName': group['GroupName'],
                    'GroupId': group['GroupId'],
                    'Arn': group['Arn'],
                    'CreateDate': datetime.datetime.strftime(group['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                    'Path': group['Path'],
                    })

            ec = {'AWS.IAM.Users(val.UserName === obj.UserName).Groups': data}
            return create_entry('AWS IAM User Groups', data, ec)

        except Exception as e:
            return raise_error(e)

    def add_user_to_group(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.add_user_to_group(
                GroupName=args.get('groupName'),
                UserName=args.get('userName')
            )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The user {0} was added to the IAM group: {1}".format(args.get('userName'), args.get('groupName'))

        except Exception as e:
            return raise_error(e)

    def create_access_key(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.create_access_key(UserName=args.get('userName'))
            AccessKey = response['AccessKey']
            data = ({
                'UserName': AccessKey['UserName'],
                'AccessKeyId': AccessKey['AccessKeyId'],
                'SecretAccessKey': AccessKey['SecretAccessKey'],
                'Status': AccessKey['Status'],
                'CreateDate': datetime.datetime.strftime(AccessKey['CreateDate'], '%Y-%m-%dT%H:%M:%S')
            })

            ec = {'AWS.IAM.Users(val.UserName === obj.UserName).AccessKeys': data}
            return create_entry('AWS IAM Users', data, ec)

        except Exception as e:
            return raise_error(e)

    def update_access_key(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.update_access_key(
                UserName=args.get('userName'),
                AccessKeyId=args.get('accessKeyId'),
                Status=args.get('status')
                )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "Access Key with ID {0} was set to status: {1}".format(args.get('accessKeyId'),args.get('status'))

        except Exception as e:
            return raise_error(e)

    def list_access_key_for_user(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data =[]
            response = client.list_access_keys(UserName=args.get('userName'))
            for accesskey in response['AccessKeyMetadata']:
                data.append({
                    'UserName': accesskey['UserName'],
                    'AccessKeyId': accesskey['AccessKeyId'],
                    'Status': accesskey['Status'],
                    'CreateDate': datetime.datetime.strftime(accesskey['CreateDate'], '%Y-%m-%dT%H:%M:%S')
                })

            ec = {'AWS.IAM.Users(val.UserName === obj.UserName).AccessKeys': data}
            return create_entry('AWS IAM Users Access Keys', data, ec)

        except Exception as e:
            return raise_error(e)

    def list_policies(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            response = client.list_policies(
                Scope=args.get('scope'),
                OnlyAttached=True if args.get('onlyAttached') == 'True'  else False
                )
            for policy in response['Policies']:
                data.append({
                    'PolicyName': policy['PolicyName'],
                    'PolicyId': policy['PolicyId'],
                    'Arn': policy['Arn'],
                    'Path': policy['Path'],
                    'DefaultVersionId': policy['DefaultVersionId'],
                    'IsAttachable': policy['IsAttachable'],
                    'AttachmentCount': policy['AttachmentCount'],
                    'CreateDate': datetime.datetime.strftime(policy['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                    'UpdateDate': datetime.datetime.strftime(policy['UpdateDate'], '%Y-%m-%dT%H:%M:%S'),
                })
            ec = {'AWS.IAM.Policies': data}
            return create_entry('AWS IAM Policies', data, ec)

        except Exception as e:
            return raise_error(e)

    def list_roles(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            output = []
            paginator = client.get_paginator('list_roles')
            for response in paginator.paginate():
                for role in response['Roles']:
                    data.append ({
                        'RoleName': role['RoleName'],
                        'RoleId': role['RoleId'],
                        'Arn': role['Arn'],
                        'CreateDate': datetime.datetime.strftime(role['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                        'Path': role['Path'],
                    })
                    output.append(role)

            raw = json.loads(json.dumps(output, cls=DatetimeEncoder))
            ec = {'AWS.IAM.Roles': raw}
            return create_entry('AWS IAM Roles', data, ec)

        except Exception as e:
            return raise_error(e)


    def attach_policy(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            if args.get('type') == 'User':
                response = client.attach_user_policy(
                    UserName=args.get('entityName'),
                    PolicyArn=args.get('policyArn')
                )
            if args.get('type') == 'Group':
                response = client.attach_group_policy(
                    GroupName=args.get('entityName'),
                    PolicyArn=args.get('policyArn')
                )
            if args.get('type') == 'Role':
                response = client.attach_role_policy(
                    RoleName=args.get('entityName'),
                    PolicyArn=args.get('policyArn')
                )

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "Policy was attached to {0}: {1} ".format(args.get('type'),args.get('entityName'))

        except Exception as e:
            return raise_error(e)

    def detach_policy(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            if args.get('type') == 'User':
                response = client.detach_user_policy(
                    UserName=args.get('entityName'),
                    PolicyArn=args.get('policyArn')
                )
            if args.get('type') == 'Group':
                response = client.detach_group_policy(
                    GroupName=args.get('entityName'),
                    PolicyArn=args.get('policyArn')
                )
            if args.get('type') == 'Role':
                response = client.detach_role_policy(
                    RoleName=args.get('entityName'),
                    PolicyArn=args.get('policyArn')
                )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "Policy was detached from {0}: {1} ".format(args.get('type'),args.get('entityName'))

        except Exception as e:
            return raise_error(e)

    def delete_login_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_login_profile(UserName=args.get('userName'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The user {0} login profile has been deleted".format(args.get('userName'))

        except Exception as e:
            return raise_error(e)

    def delete_group(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_group(GroupName=args.get('groupName'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Group {0} has been deleted".format(args.get('groupName'))

        except Exception as e:
            return raise_error(e)

    def remove_user_from_group(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.remove_user_from_group(
                GroupName=args.get('groupName'),
                UserName=args.get('userName')
            )
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The User {0} has been removed from the group {1}".format(args.get('userName'),args.get('groupName'))

        except Exception as e:
            return raise_error(e)

    def delete_access_key(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'UserName':args.get('userName'),
                'AccessKeyId':args.get('AccessKeyId')
                }

            response = client.delete_access_key(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Access Key was deleted"

        except Exception as e:
            return raise_error(e)

    def create_instance_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'InstanceProfileName':args.get('instanceProfileName')}
            if args.get('path') is not None:
                kwargs.update({'Path':args.get('path')})

            response = client.create_instance_profile(**kwargs)
            instanceProfile = response['InstanceProfile']
            data = ({
                'Path': instanceProfile['Path'],
                'InstanceProfileName': instanceProfile['InstanceProfileName'],
                'InstanceProfileId': instanceProfile['Path'],
                'Arn': instanceProfile['Arn'],
                'CreateDate': datetime.datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            })

            ec = {'AWS.IAM.InstanceProfiles': data}
            return create_entry('AWS IAM InstanceProfile', data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_instance_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_instance_profile(InstanceProfileName=args.get('instanceProfileName'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The InstanceProfile: {0} was deleted".format(args.get('instanceProfileName'))

        except Exception as e:
            return raise_error(e)

    def list_instance_profiles(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            output =[]
            data = []
            paginator = client.get_paginator('list_instance_profiles')
            for response in paginator.paginate():
                for instanceProfile in response['InstanceProfiles']:
                    data.append({
                        'Path': instanceProfile['Path'],
                        'InstanceProfileName': instanceProfile['InstanceProfileName'],
                        'InstanceProfileId': instanceProfile['InstanceProfileId'],
                        'CreateDate': datetime.datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                    })
                    output.append(instanceProfile)

            raw = json.loads(json.dumps(output, cls=DatetimeEncoder))
            ec = {'AWS.IAM.InstanceProfiles': raw}
            return create_entry('AWS IAM Instance Profiles', data, ec)

        except Exception as e:
            return raise_error(e)

    def add_role_to_instance_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'InstanceProfileName':args.get('instanceProfileName'),
                'RoleName':args.get('roleName')
            }

            response = client.add_role_to_instance_profile(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Role: {0} was added to the Instance Profile: {1}".format(args.get('roleName'),args.get('instanceProfileName'))

        except Exception as e:
            return raise_error(e)

    def remove_role_from_instance_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'InstanceProfileName':args.get('instanceProfileName'),
                'RoleName':args.get('roleName')
            }

            response = client.remove_role_from_instance_profile(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Role: {0} was removed from the Instance Profile: {1}".format(args.get('roleName'),args.get('instanceProfileName'))

        except Exception as e:
            return raise_error(e)

    def list_instance_profiles_for_role(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            output =[]
            data = []
            paginator = client.get_paginator('list_instance_profiles_for_role')
            for response in paginator.paginate(RoleName=args.get('roleName')):
                for instanceProfile in response['InstanceProfiles']:
                    data.append ({
                        'Path': instanceProfile['Path'],
                        'InstanceProfileName': instanceProfile['InstanceProfileName'],
                        'InstanceProfileId': instanceProfile['InstanceProfileId'],
                        'CreateDate': datetime.datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                        'Arn': instanceProfile['Arn'],
                    })
                    output.append(instanceProfile)

            raw = json.loads(json.dumps(instanceProfile, cls=DatetimeEncoder))
            ec = {'AWS.IAM.InstanceProfiles': raw}
            return create_entry('AWS IAM Instance Profiles', data, ec)

        except Exception as e:
            return raise_error(e)

    def get_instance_profile(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.get_instance_profile(InstanceProfileName=args.get('instanceProfileName'))
            instanceProfile = response['InstanceProfile']
            data = ({
                'Path': instanceProfile['Path'],
                'InstanceProfileName': instanceProfile['InstanceProfileName'],
                'InstanceProfileId': instanceProfile['InstanceProfileId'],
                'CreateDate': datetime.datetime.strftime(instanceProfile['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            })

            raw = json.loads(json.dumps(instanceProfile, cls=DatetimeEncoder))
            ec = {'AWS.IAM.InstanceProfiles': raw}
            return create_entry('AWS IAM Instance Profiles', data, ec)

        except Exception as e:
            return raise_error(e)

    def get_role(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.get_role(RoleName=args.get('roleName'))
            role = response['Role']
            data = ({
                'RoleName': role['RoleName'],
                'RoleId': role['RoleId'],
                'Arn': role['Arn'],
                'CreateDate': datetime.datetime.strftime(role['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                'Path': role['Path'],
            })

            raw = json.loads(json.dumps(response['Role'], cls=DatetimeEncoder))
            ec = {'AWS.IAM.Roles': raw}
            return create_entry('AWS IAM Roles', data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_role(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_role(RoleName=args.get('roleName'))

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Role: {0} was deleted".format(args.get('roleName'))

        except Exception as e:
            return raise_error(e)

    def create_role(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {
                'RoleName':args.get('roleName'),
                'AssumeRolePolicyDocument':json.dumps(json.loads(args.get('assumeRolePolicyDocument')))
            }
            if args.get('path') is not None:
                kwargs.update({'Path':args.get('path')})
            if args.get('description') is not None:
                kwargs.update({'Description':args.get('description')})
            if args.get('maxSessionDuration') is not None:
                kwargs.update({'MaxSessionDuration':int(args.get('maxSessionDuration'))})
            #return kwargs
            response = client.create_role(**kwargs)
            role = response['Role']
            data = ({
                'RoleName': role['RoleName'],
                'RoleId': role['RoleId'],
                'Arn': role['Arn'],
                'Path': role['Path'],
            })

            raw = json.loads(json.dumps(response['Role'], cls=DatetimeEncoder))
            ec = {'AWS.IAM.Roles': raw}
            return create_entry('AWS IAM Roles', data, ec)

        except Exception as e:
            return raise_error(e)

    def create_policy(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {
                'PolicyName':args.get('policyName'),
                'PolicyDocument':json.dumps(json.loads(args.get('policyDocument')))
            }
            if args.get('path') is not None:
                kwargs.update({'Path':args.get('path')})
            if args.get('description') is not None:
                kwargs.update({'Description':args.get('description')})

            response = client.create_policy(**kwargs)
            policy = response['Policy']
            data = ({
                'PolicyName': policy['PolicyName'],
                'PolicyId': policy['PolicyId'],
                'Arn': policy['Arn'],
                'Path': policy['Path'],
                'CreateDate': datetime.datetime.strftime(policy['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            })

            raw = json.loads(json.dumps(response['Policy'], cls=DatetimeEncoder))
            ec = {'AWS.IAM.Policies': raw}
            return create_entry('AWS IAM Policies', data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_policy(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_policy(PolicyArn=args.get('policyArn'))

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Policy: {0} was deleted".format(args.get('policyArn'))

        except Exception as e:
            return raise_error(e)

    def create_policy_version(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {
                'PolicyArn':args.get('policyArn'),
                'PolicyDocument':json.dumps(json.loads(args.get('policyDocument')))
            }
            if args.get('setAsDefault') is not None:
                kwargs.update({'SetAsDefault':True if args.get('setAsDefault') == 'True'  else False})

            response = client.create_policy_version(**kwargs)
            policy = response['PolicyVersion']
            data = ({
                'PolicyArn': args.get('policyArn'),
                'VersionId': policy['VersionId'],
                'IsDefaultVersion': policy['IsDefaultVersion'],
                'CreateDate': datetime.datetime.strftime(policy['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            })

            ec = {'AWS.IAM.Policies(val.PolicyArn === obj.PolicyArn).Versions': data}
            return create_entry('New AWS IAM Policy Version', data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_policy_version(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwars = {
                'PolicyArn':args.get('policyArn'),
                'VersionId':args.get('versionId')
            }
            response = client.delete_policy_version(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Policy Version was deleted"

        except Exception as e:
            return raise_error(e)

    def list_policy_versions(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            response = client.list_policy_versions(PolicyArn=args.get('policyArn'))
            for version in response['Versions']:
                data.append({
                    'PolicyArn': args.get('policyArn'),
                    'VersionId': version['VersionId'],
                    'IsDefaultVersion': version['IsDefaultVersion'],
                    'CreateDate': datetime.datetime.strftime(version['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
                })
            ec = {'AWS.IAM.Policies(val.PolicyArn === obj.PolicyArn).Versions': data}
            return create_entry('AWS IAM Policy Versions', data, ec)

        except Exception as e:
            return raise_error(e)

    def get_policy_version(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {
                'PolicyArn':args.get('policyArn'),
                'VersionId':args.get('versionId')
            }
            response = client.get_policy_version(**kwargs)
            version = response['PolicyVersion']
            data.append({
                'PolicyArn': args.get('policyArn'),
                'Document': version['Document'],
                'VersionId': version['VersionId'],
                'IsDefaultVersion': version['IsDefaultVersion'],
                'CreateDate': datetime.datetime.strftime(version['CreateDate'], '%Y-%m-%dT%H:%M:%S'),
            })
            ec = {'AWS.IAM.Policies(val.PolicyArn === obj.PolicyArn).Versions': data}
            return create_entry('AWS IAM Policy Version', data, ec)

        except Exception as e:
            return raise_error(e)

    def set_default_policy_version(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {
                'PolicyArn':args.get('policyArn'),
                'VersionId':args.get('versionId')
            }
            response = client.set_default_policy_version(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Default Policy Version was set to {0}".format(args.get('versionId'))

        except Exception as e:
            return raise_error(e)

    def create_account_alias(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {'AccountAlias':args.get('accountAlias')}
            response = client.create_account_alias(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Account Alias was created"

        except Exception as e:
            return raise_error(e)

    def delete_account_alias(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {'AccountAlias':args.get('accountAlias')}
            response = client.delete_account_alias(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Account Alias was deleted"

        except Exception as e:
            return raise_error(e)

    def test_function():
        try:
            client = aws_session()
            response = client.list_users()
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'ok'
        except Exception as e:
            return raise_error(e)

    # The command demisto.command() holds the command sent from the user.
    if demisto.command() == 'test-module':
        result = test_function()

    if demisto.command() == 'aws-iam-create-user':
        result = create_user(demisto.args())

    if demisto.command() == 'aws-iam-create-login-profile':
        result = create_login_profile(demisto.args())

    if demisto.command() == 'aws-iam-get-user':
        result = get_user(demisto.args())

    if demisto.command() == 'aws-iam-list-users':
        result = list_users(demisto.args())

    if demisto.command() == 'aws-iam-update-user':
        result = update_user(demisto.args())

    if demisto.command() == 'aws-iam-delete-user':
        result = delete_user(demisto.args())

    if demisto.command() == 'aws-iam-update-login-profile':
        result = update_login_profile(demisto.args())

    if demisto.command() == 'aws-iam-create-group':
        result = create_group(demisto.args())

    if demisto.command() == 'aws-iam-list-groups':
        result = list_groups(demisto.args())

    if demisto.command() == 'aws-iam-list-groups-for-user':
        result = list_groups_for_user(demisto.args())

    if demisto.command() == 'aws-iam-create-access-key':
        result = create_access_key(demisto.args())

    if demisto.command() == 'aws-iam-update-access-key':
        result = update_access_key(demisto.args())

    if demisto.command() == 'aws-iam-list-access-keys-for-user':
        result = list_access_key_for_user(demisto.args())

    if demisto.command() == 'aws-iam-list-policies':
        result = list_policies(demisto.args())

    if demisto.command() == 'aws-iam-list-roles':
        result = list_roles(demisto.args())

    if demisto.command() == 'aws-iam-attach-policy':
        result = attach_policy(demisto.args())

    if demisto.command() == 'aws-iam-detach-policy':
        result = detach_policy(demisto.args())

    if demisto.command() == 'aws-iam-delete-login-profile':
        result = delete_login_profile(demisto.args())

    if demisto.command() == 'aws-iam-add-user-to-group':
        result = add_user_to_group(demisto.args())

    if demisto.command() == 'aws-iam-delete-group':
        result = delete_group(demisto.args())

    if demisto.command() == 'aws-iam-remove-user-from-group':
        result = remove_user_from_group(demisto.args())

    if demisto.command() == 'aws-iam-delete-access-key':
        result = delete_access_key(demisto.args())

    if demisto.command() == 'aws-iam-create-instance-profile':
        result = create_instance_profile(demisto.args())

    if demisto.command() == 'aws-iam-delete-instance-profile':
        result = delete_instance_profile(demisto.args())

    if demisto.command() == 'aws-iam-list-instance-profiles':
        result = list_instance_profiles(demisto.args())

    if demisto.command() == 'aws-iam-add-role-to-instance-profile':
        result = add_role_to_instance_profile(demisto.args())

    if demisto.command() == 'aws-iam-remove-role-from-instance-profile':
        result = remove_role_from_instance_profile(demisto.args())

    if demisto.command() == 'aws-iam-list-instance-profiles-for-role':
        result = list_instance_profiles_for_role(demisto.args())

    if demisto.command() == 'aws-iam-get-instance-profile':
        result = get_instance_profile(demisto.args())

    if demisto.command() == 'aws-iam-get-role':
        result = get_role(demisto.args())

    if demisto.command() == 'aws-iam-delete-role':
        result = delete_role(demisto.args())

    if demisto.command() == 'aws-iam-create-role':
        result = create_role(demisto.args())

    if demisto.command() == 'aws-iam-create-policy':
        result = create_policy(demisto.args())

    if demisto.command() == 'aws-iam-delete-policy':
        result = delete_policy(demisto.args())

    if demisto.command() == 'aws-iam-create-policy-version':
        result = create_policy_version(demisto.args())

    if demisto.command() == 'aws-iam-delete-policy-version':
        result = delete_policy_version(demisto.args())

    if demisto.command() == 'aws-iam-list-policy-versions':
        result = list_policy_versions(demisto.args())

    if demisto.command() == 'aws-iam-get-policy-version':
        result = get_policy_version(demisto.args())

    if demisto.command() == 'aws-iam-set-default-policy-version':
        result = set_default_policy_version(demisto.args())

    if demisto.command() == 'aws-iam-create-account-alias':
        result = create_account_alias(demisto.args())

    if demisto.command() == 'aws-iam-delete-account-alias':
        result = delete_account_alias(demisto.args())

    demisto.results(result)
    sys.exit(0)

  type: python
  commands:
  - name: aws-iam-create-user
    arguments:
    - name: userName
      required: true
      description: The name of the user to create.
    - name: path
      description: The path for the user name. This parameter is optional. If it is
        not included, it defaults to a slash (/).
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Users.UserName
      description: The friendly name identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.UserId
      description: The stable and unique string identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.Arn
      description: The Amazon Resource Name (ARN) that identifies the user.
      type: string
    - contextPath: AWS.IAM.Users.CreateDate
      description: The date and time, when the user was created.
      type: date
    - contextPath: AWS.IAM.Users.Path
      description: The path to the user.
      type: string
    description: Creates a new IAM user for your AWS account.
  - name: aws-iam-get-user
    arguments:
    - name: userName
      required: true
      description: The name of the user to get information about.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Users.UserName
      description: The friendly name identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.UserId
      description: The stable and unique string identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.Arn
      description: The Amazon Resource Name (ARN) that identifies the user.
      type: string
    - contextPath: AWS.IAM.Users.CreateDate
      description: The date and time when the user was created.
      type: date
    - contextPath: AWS.IAM.Users.Path
      description: The path to the user.
      type: string
    - contextPath: AWS.IAM.Users.PasswordLastUsed
      description: The date and time,  when the user's password was last used to sign
        in to an AWS website.
      type: date
    description: Retrieves information about the specified IAM user, including the
      user's creation date, path, unique ID, and ARN.
  - name: aws-iam-list-users
    arguments:
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Users.UserName
      description: The friendly name identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.UserId
      description: The stable and unique string identifying the user.
      type: string
    - contextPath: AWS.IAM.Users.Arn
      description: The Amazon Resource Name (ARN) that identifies the user.
      type: string
    - contextPath: AWS.IAM.Users.CreateDate
      description: The date and time when the user was created.
      type: date
    - contextPath: AWS.IAM.Users.Path
      description: The path to the user.
      type: string
    description: Lists the IAM users, returns all users in the AWS account.
  - name: aws-iam-update-user
    arguments:
    - name: oldUserName
      required: true
      description: Name of the user to update.
    - name: newUserName
      description: New name for the user. Include this parameter only if you're changing
        the user's name.
    - name: newPath
      description: New path for the IAM user. Include this parameter only if you're
        changing the user's path.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Updates the name and/or the path of the specified IAM user.
  - name: aws-iam-delete-user
    arguments:
    - name: userName
      required: true
      description: The name of the user to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified IAM user. The user must not belong to any groups
      or have any access keys, signing certificates, or attached policies.
  - name: aws-iam-update-login-profile
    arguments:
    - name: userName
      required: true
      description: The name of the user whose password you want to update.
    - name: newPassword
      required: true
      description: The new password for the specified IAM user.
    - name: passwordResetRequired
      required: true
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Allows this new password to be used only once by requiring the
        specified IAM user to set a new password on next sign-in.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Changes the password for the specified IAM user.
  - name: aws-iam-create-group
    arguments:
    - name: groupName
      description: The name of the group to create. Do not include the path in this
        value.
    - name: path
      description: The path to the group.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Groups.GroupName
      description: The friendly name that identifies the group.
      type: string
    - contextPath: AWS.IAM.Groups.GroupId
      description: The stable and unique string identifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.Arn
      description: The Amazon Resource Name (ARN) specifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.CreateDate
      description: The date and time when the group was created.
      type: date
    - contextPath: AWS.IAM.Groups.Path
      description: The path to the group.
      type: string
    description: Creates a new iam group.
  - name: aws-iam-list-groups
    arguments:
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Groups.GroupName
      description: The friendly name that identifies the group.
      type: string
    - contextPath: AWS.IAM.Groups.GroupId
      description: The stable and unique string identifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.Arn
      description: The Amazon Resource Name (ARN) specifying the group.
      type: string
    - contextPath: AWS.IAM.Groups.CreateDate
      description: The date and time when the group was created.
      type: date
    - contextPath: AWS.IAM.Groups.Path
      description: The path to the group.
      type: string
    description: Lists all the IAM groups in the AWS account
  - name: aws-iam-list-groups-for-user
    arguments:
    - name: userName
      required: true
      description: The name of the user to list groups for.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Users.Groups.GroupName
      description: The friendly name that identifies the group.
      type: string
    - contextPath: AWS.IAM.Users.Groups.GroupId
      description: The stable and unique string identifying the group
      type: string
    - contextPath: AWS.IAM.Users.Groups.Arn
      description: The Amazon Resource Name (ARN) specifying the group.
      type: string
    - contextPath: AWS.IAM.Users.Groups.CreateDate
      description: The date and time when the group was created.
      type: date
    - contextPath: AWS.IAM.Users.Groups.Path
      description: The path to the group.
      type: string
    description: Lists the IAM groups that the specified IAM user belongs to.
  - name: aws-iam-add-user-to-group
    arguments:
    - name: userName
      required: true
      description: The name of the user to add.
    - name: groupName
      required: true
      description: The name of the group to update.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Adds the specified user to the specified group.
  - name: aws-iam-create-access-key
    arguments:
    - name: userName
      required: true
      description: The name of the IAM user that the new key will belong to.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Users.AccessKeys.AccessKeyId
      description: The ID for this access key.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.SecretAccessKey
      description: The secret key used to sign requests.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.Status
      description: The status of the access key. Active means that the key is valid
        for API calls, while Inactive means it is not.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.CreateDate
      description: The date when the access key was created.
      type: date
    description: Creates a new AWS secret access key and corresponding AWS access
      key ID for the specified user. The default status for new keys is Active .
  - name: aws-iam-update-access-key
    arguments:
    - name: userName
      required: true
      description: The name of the user whose key you want to update.
    - name: accessKeyId
      required: true
      description: The access key ID of the secret access key you want to update.
    - name: status
      required: true
      auto: PREDEFINED
      predefined:
      - Active
      - Inactive
      description: The status you want to assign to the secret access key. Active
        means that the key can be used for API calls to AWS, while Inactive means
        that the key cannot be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Changes the status of the specified access key from Active to Inactive,
      or vice versa. This operation can be used to disable a user's key as part of
      a key rotation workflow.
  - name: aws-iam-list-access-keys-for-user
    arguments:
    - name: userName
      required: true
      description: The name of the user.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Users.AccessKeys.AccessKeyId
      description: The ID for this access key.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.Status
      description: The status of the access key. Active means the key is valid for
        API calls; Inactive means it is not.
      type: string
    - contextPath: AWS.IAM.Users.AccessKeys.CreateDate
      description: The date when the access key was created.
      type: date
    - contextPath: AWS.IAM.Users.AccessKeys.UserName
      description: The name of the IAM user that the key is associated with.
      type: string
    description: Returns information about the access key IDs associated with the
      specified IAM user.
  - name: aws-iam-list-policies
    arguments:
    - name: scope
      auto: PREDEFINED
      predefined:
      - All
      - AWS
      - Local
      description: The scope to use for filtering the results. To list only AWS managed
        policies, set Scope to AWS. To list only the customer managed policies in
        your AWS account, set Scope to Local.
      defaultValue: All
    - name: onlyAttached
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: A flag to filter the results to only the attached policies.  When
        OnlyAttached is true , the returned list contains only the policies that are
        attached to an IAM user, group, or role. When OnlyAttached is false , or when
        the parameter is not included, all policies are returned.
      defaultValue: "False"
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Policies.PolicyName
      description: The friendly name (not ARN) identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.PolicyId
      description: The stable and unique string identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.Arn
      description: The Amazon Resource Name (ARN).
      type: string
    - contextPath: AWS.IAM.Policies.Path
      description: The path to the policy.
      type: string
    - contextPath: AWS.IAM.Policies.DefaultVersionId
      description: The identifier for the version of the policy that is set as the
        default version.
      type: string
    - contextPath: AWS.IAM.Policies.IsAttachable
      description: Specifies whether the policy can be attached to an IAM user, group,
        or role.
      type: string
    - contextPath: AWS.IAM.Policies.CreateDate
      description: when the policy was created.
      type: date
    - contextPath: AWS.IAM.Policies.UpdateDate
      description: when the policy was last updated.
      type: date
    - contextPath: AWS.IAM.Policies.AttachmentCount
      description: The number of entities (users, groups, and roles) that the policy
        is attached to.
      type: number
    description: Lists all the managed policies that are available in your AWS account,
      including your own customer-defined managed policies and all AWS managed policies.
  - name: aws-iam-list-roles
    arguments:
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.CreateDate
      description: The date and time when the role was created.
      type: date
    - contextPath: AWS.IAM.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
        Anyone who uses the AWS CLI or API to assume the role can specify the duration
        using the optional DurationSeconds API parameter or duration-seconds CLI parameter.
      type: number
    description: Lists all IAM roles
  - name: aws-iam-attach-policy
    arguments:
    - name: type
      required: true
      auto: PREDEFINED
      predefined:
      - User
      - Group
      - Role
      description: The Type of IAM Entity
    - name: entityName
      description: The name (friendly name, not ARN) of the IAM Entity to attach the
        policy to.
    - name: policyArn
      description: The Amazon Resource Name (ARN) of the IAM policy you want to attach.
    description: Attaches the specified managed policy to the specified IAM Entity.
  - name: aws-iam-detach-policy
    arguments:
    - name: type
      required: true
      auto: PREDEFINED
      predefined:
      - User
      - Group
      - Role
      description: IAM Entity Type
    - name: entityName
      description: The name (friendly name, not ARN) of the IAM Entity to detach the
        policy from.
    - name: policyArn
      description: The Amazon Resource Name (ARN) of the IAM policy you want to detach.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Removes the specified managed policy from the specified IAM Entity.
  - name: aws-iam-delete-login-profile
    arguments:
    - name: userName
      required: true
      description: The name of the user whose password you want to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the password for the specified IAM user, which terminates
      the user's ability to access AWS services through the AWS Management Console.
  - name: aws-iam-delete-group
    arguments:
    - name: groupName
      required: true
      description: The name of the IAM group to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified IAM group. The group must not contain any users
      or have any attached policies.
  - name: aws-iam-remove-user-from-group
    arguments:
    - name: userName
      required: true
      description: The name of the user to remove.
    - name: groupName
      required: true
      description: The name of the group to update.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Removes the specified user from the specified group.
  - name: aws-iam-create-login-profile
    arguments:
    - name: userName
      required: true
      description: The name of the IAM user to create a password for. The user must
        already exist.
    - name: password
      required: true
      description: The new password for the user.
    - name: passwordResetRequired
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether the user is required to set a new password on
        next sign-in.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Creates a password for the specified user, giving the user the ability
      to access AWS services through the AWS Management Console.
  - name: aws-iam-delete-access-key
    arguments:
    - name: userName
      required: true
      description: he name of the user whose access key pair you want to delete.
    - name: AccessKeyId
      required: true
      description: The access key ID for the access key ID and secret access key you
        want to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the access key pair associated with the specified IAM user.
  - name: aws-iam-create-instance-profile
    arguments:
    - name: instanceProfileName
      required: true
      description: The name of the instance profile to create.
    - name: path
      description: The path to the instance profile.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    description: Creates a new instance profile.
  - name: aws-iam-delete-instance-profile
    arguments:
    - name: instanceProfileName
      required: true
      description: The name of the instance profile to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified instance profile. The instance profile must
      not have an associated role.
  - name: aws-iam-list-instance-profiles
    arguments:
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Lists all the instance profiles tin your AWS account.
  - name: aws-iam-add-role-to-instance-profile
    arguments:
    - name: instanceProfileName
      required: true
      description: The name of the instance profile to update.
    - name: roleName
      required: true
      description: The name of the role to add.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Adds the specified IAM role to the specified instance profile. An
      instance profile can contain only one role, and this limit cannot be increased.
      You can remove the existing role and then add a different role to an instance
      profile.
  - name: aws-iam-remove-role-from-instance-profile
    arguments:
    - name: instanceProfileName
      required: true
      description: The name of the instance profile to update.
    - name: roleName
      required: true
      description: The name of the role to remove.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Removes the specified IAM role from the specified EC2 instance profile.
  - name: aws-iam-list-instance-profiles-for-role
    arguments:
    - name: roleName
      required: true
      description: The name of the role to list instance profiles for.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Lists the instance profiles that have the specified associated IAM
      role.
  - name: aws-iam-get-instance-profile
    arguments:
    - name: instanceProfileName
      required: true
      description: The name of the instance profile to get information about.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.InstanceProfiles.Path
      description: The path to the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileName
      description: The name identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.InstanceProfileId
      description: The stable and unique string identifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Arn
      description: The Amazon Resource Name (ARN) specifying the instance profile.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.CreateDate
      description: The date when the instance profile was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.InstanceProfiles.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.InstanceProfiles.Roles. MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Retrieves information about the specified instance profile.
  - name: aws-iam-get-role
    arguments:
    - name: roleName
      required: true
      description: The name of the IAM role to get information about.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.Roles.AssumeRolePolicyDocument
      description: The policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Retrieves information about the specified role.
  - name: aws-iam-delete-role
    arguments:
    - name: roleName
      required: true
      description: The name of the role to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: 'Deletes the specified role. The role must not have any policies
      attached. '
  - name: aws-iam-create-role
    arguments:
    - name: roleName
      required: true
      description: The name of the role to create.
    - name: assumeRolePolicyDocument
      required: true
      description: The trust relationship policy document that grants an entity permission
        to assume the role.
    - name: path
      description: The path to the role.
    - name: description
      description: A description of the role.
    - name: maxSessionDuration
      description: The maximum session duration (in seconds) that you want to set
        for the specified role. If you do not specify a value for this setting, the
        default maximum of one hour is applied. This setting can have a value from
        1 hour to 12 hours.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Roles.RoleName
      description: The friendly name that identifies the role.
      type: string
    - contextPath: AWS.IAM.Roles.RoleId
      description: The stable and unique string identifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.Arn
      description: The Amazon Resource Name (ARN) specifying the role.
      type: string
    - contextPath: AWS.IAM.Roles.CreateDate
      description: The date and time, when the role was created.
      type: date
    - contextPath: AWS.IAM.Roles.Path
      description: The path to the role.
      type: string
    - contextPath: AWS.IAM.Roles.AssumeRolePolicyDocument
      description: he policy that grants an entity permission to assume the role.
      type: string
    - contextPath: AWS.IAM.Roles.Description
      description: A description of the role that you provide.
      type: string
    - contextPath: AWS.IAM.Roles.MaxSessionDuration
      description: The maximum session duration (in seconds) for the specified role.
      type: number
    description: Creates a new role for your AWS account.
  - name: aws-iam-create-policy
    arguments:
    - name: policyName
      required: true
      description: The friendly name of the policy.
    - name: policyDocument
      required: true
      description: The JSON policy document that you want to use as the content for
        the new policy.
    - name: path
      description: The path for the policy.
    - name: description
      description: A friendly description of the policy.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Policies.PolicyName
      description: The friendly name (not ARN) identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.PolicyId
      description: The stable and unique string identifying the policy.
      type: string
    - contextPath: AWS.IAM.Policies.Arn
      description: The Amazon Resource Name (ARN). ARNs are unique identifiers for
        AWS resources.
      type: string
    - contextPath: AWS.IAM.Policies.Path
      description: The path to the policy.
      type: string
    - contextPath: AWS.IAM.Policies.DefaultVersionId
      description: The identifier for the version of the policy that is set as the
        default version.
      type: string
    - contextPath: AWS.IAM.Policies.AttachmentCount
      description: The number of entities (users, groups, and roles) that the policy
        is attached to.
      type: number
    - contextPath: 'AWS.IAM.Policies.PermissionsBoundaryUsageCount '
      description: The number of entities (users and roles) for which the policy is
        used to set the permissions boundary.
      type: number
    - contextPath: AWS.IAM.Policies.IsAttachable
      description: Specifies whether the policy can be attached to an IAM user, group,
        or role.
      type: boolean
    - contextPath: AWS.IAM.Policies.Description
      description: A friendly description of the policy.
      type: string
    - contextPath: AWS.IAM.Policies.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        was created.
      type: date
    - contextPath: AWS.IAM.Policies.UpdateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        was last updated.
      type: date
    description: Creates a new managed policy for your AWS account.  This operation
      creates a policy version with a version identifier of v1 and sets v1 as the
      policy's default version.
    execution: true
  - name: aws-iam-delete-policy
    arguments:
    - name: policyArn
      required: true
      description: The Amazon Resource Name (ARN) of the IAM policy you want to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified managed policy.  Before you can delete a managed
      policy, you must first detach the policy from all users, groups, and roles that
      it is attached to. In addition you must delete all the policy's versions.
    execution: true
  - name: aws-iam-create-policy-version
    arguments:
    - name: policyArn
      required: true
      description: The Amazon Resource Name (ARN) of the IAM policy to which you want
        to add a new version.
    - name: policyDocument
      required: true
      description: The JSON policy document that you want to use as the content for
        this new version of the policy.
    - name: setAsDefault
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether to set this version as the policy's default version.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Policies.Versions.Document
      description: The policy document.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.VersionId
      description: The identifier for the policy version.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.IsDefaultVersion
      description: The identifier for the policy version.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        version was created.
      type: string
    description: Creates a new version of the specified managed policy. To update
      a managed policy, you create a new policy version. A managed policy can have
      up to five versions. If the policy has five versions, you must delete an existing
      version using DeletePolicyVersion before you create a new version.  Optionally,
      you can set the new version as the policy's default version. The default version
      is the version that is in effect for the IAM users, groups, and roles to which
      the policy is attached.
    execution: true
  - name: aws-iam-delete-policy-version
    arguments:
    - name: policyArn
      required: true
      description: The Amazon Resource Name (ARN) of the IAM policy from which you
        want to delete a version.
    - name: versionId
      required: true
      description: The policy version to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified version from the specified managed policy.  You
      cannot delete the default version from a policy using this API. To delete the
      default version from a policy, use DeletePolicy . To find out which version
      of a policy is marked as the default version, use ListPolicyVersions .
    execution: true
  - name: aws-iam-list-policy-versions
    arguments:
    - name: policyArn
      required: true
      description: The Amazon Resource Name (ARN) of the IAM policy for which you
        want the versions.
    outputs:
    - contextPath: AWS.IAM.Policies.Versions.Document
      description: The policy document.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.VersionId
      description: The identifier for the policy version.
      type: string
    - contextPath: AWS.IAM.Policies.Versions.IsDefaultVersion
      description: Specifies whether the policy version is set as the policy's default
        version.
      type: boolean
    - contextPath: AWS.IAM.Policies.Versions.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        version was created.
      type: date
    description: Lists information about the versions of the specified managed policy,
      including the version that is currently set as the policy's default version.
  - name: aws-iam-get-policy-version
    arguments:
    - name: policyArn
      required: true
      description: The Amazon Resource Name (ARN) of the managed policy that you want
        information about.
    - name: versionId
      required: true
      description: Identifies the policy version to retrieve.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.IAM.Policies.Versions.Document
      description: The policy document.
    - contextPath: AWS.IAM.Policies.Versions.VersionId
      description: The identifier for the policy version.
    - contextPath: AWS.IAM.Policies.Versions.IsDefaultVersion
      description: Specifies whether the policy version is set as the policy's default
        version.
    - contextPath: AWS.IAM.Policies.Versions.CreateDate
      description: The date and time, in ISO 8601 date-time format , when the policy
        version was created.
    description: Retrieves information about the specified version of the specified
      managed policy, including the policy document.
  - name: aws-iam-set-default-policy-version
    arguments:
    - name: policyArn
      required: true
      description: The Amazon Resource Name (ARN) of the IAM policy whose default
        version you want to set.
    - name: versionId
      required: true
      description: The version of the policy to set as the default (operative) version.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Sets the specified version of the specified policy as the policy's
      default (operative) version.  This operation affects all users, groups, and
      roles that the policy is attached to.
    execution: true
  - name: aws-iam-create-account-alias
    arguments:
    - name: accountAlias
      required: true
      description: The account alias to create.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Creates an alias for your AWS account.
    execution: true
  - name: aws-iam-delete-account-alias
    arguments:
    - name: accountAlias
      required: true
      description: The name of the account alias to delete.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified AWS account alias.
    execution: true
  dockerimage: demisto/boto3
  runonce: false
releaseNotes: "Added New commands: aws-iam-create-policy, aws-iam-delete-policy, aws-iam-create-policy-version, aws-iam-delete-policy-version, aws-iam-list-policy-versions, aws-iam-get-policy-version, aws-iam-set-default-policy-version, aws-iam-create-account-alias, aws-iam-delete-account-alias"
tests:
  - No Tests