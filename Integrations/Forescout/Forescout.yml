category: Network Security
commonfields:
  id: Forescout
  version: -1
configuration:
- defaultvalue: https://{host-ip-address}.net
  display: |-
    The network address of the Forescout Enterprise Manager or
    standalone Appliance.
  name: url
  required: true
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- display: Data Exchange (DEX) Username
  name: dex_credentials
  required: false
  type: 9
- display: The Data Exchange (DEX) Account
  name: dex_account
  required: true
  type: 0
- defaultvalue: 'true'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
description: Unified Device Visibility and Control Platform for IT and OT Security.
display: Forescout
name: Forescout
script:
  commands:
  - arguments:
    - default: false
      description: Filter hosts by those selected by policies or policy sub-rules.
        Policies and/or rules should be specified by their IDs. To find policy and
        rule IDs by which you may filter, try executing the 'forescout-get-policies'
        command. If multiple policy and/or rule IDs are entered, only hosts that are
        selected by all of the policies and/or rules specifed will be returned. Multiple
        policy or rule IDs should be separated by a comma.
      isArray: true
      name: rule_ids
      required: false
      secret: false
    - default: false
      description: Filter hosts based on host property values. Enter properties with
        their associated values in the following format, '{prop_1}={val_1}&{prop_2}={val_2}
        â€¦ &{prop_n}={val_n}' where '{prop_1}' through '{prop_n}' are replaced by actual
        property names and '{val_1}' through '{val_n}' are replaced by the desired
        matching values. Note that a list property may be specified with the values
        separated by commas. Only hosts whose properties match all the specified values
        will be returned. A composite property may also be specified. If entered in
        the format where all the field-value pairs are in a single set of square brackets,
        for example, '{composite_prop}=[{field_1},{val_1},..,{field_n},{val_n}]' then
        only hosts for which the specified composite property's fields all match the
        values entered will be returned. If entered in the format, '{composite_prop}=[{field_1},{val}_1],..,[{field_n},{val_n}]'
        where each field-value pair is enclosed in its own set of brackets, then hosts
        for which the composite property's contains any of the field-values specified
        will be returned. Note that for composite properties, sub-fields should be
        entered as their internal representation in Forescout. To find internal representation
        for a composite property's sub-fields try executing 'forescout-get-host' command
        with the host specified in the 'identifier' argument and the name of the composite
        property entered in the 'fields'  argument of the command.
      isArray: false
      name: properties
      required: false
      secret: false
    deprecated: false
    description: Retrieve a list of active endpoints.
    execution: false
    name: forescout-get-hosts
    outputs:
    - contextPath: Forescout.Host.ID
      description: Forescout ID for the host.
      type: Number
    - contextPath: Forescout.Host.IP
      description: IP Address of the host.
      type: String
    - contextPath: Forescout.Host.MAC
      description: MAC Address of the host.
      type: String
    - contextPath: Forescout.Host.EndpointURL
      description: Endpoint URL to make an API call to in order to retrieve details
        about the host.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: true
      defaultValue: name
      description: Each host field has three searchable parts, the 'name', 'label'
        and 'description'. By default only the 'name' will be searched. If you want
        to expand the search to include the description as well, for example, you
        would enter 'name,description' for this argument.
      isArray: true
      name: search_in
      predefined:
      - name
      - description
      - label
      required: false
      secret: false
    - auto: PREDEFINED
      default: true
      defaultValue: 'False'
      description: Determines whether to match the case of the entered search term.
      isArray: false
      name: case_sensitive
      predefined:
      - 'False'
      - 'True'
      required: false
      secret: false
    - auto: PREDEFINED
      default: true
      defaultValue: 'False'
      description: Determines whether the search term is matched against the entirety
        of the potential hostfield instead of just seeing whether the hostfield contains
        the search term.
      isArray: false
      name: match_exactly
      predefined:
      - 'False'
      - 'True'
      required: false
      secret: false
    - default: false
      description: The term to filter hostfields by. By default the the search will
        be case insensive and checked to see if a hostfield contains the search term
        unless otherwise specified in the 'case_sensitive' and 'match_exactly' arguments
        respectively.
      isArray: false
      name: search_term
      required: false
      secret: false
    - auto: PREDEFINED
      default: true
      defaultValue: all_types
      description: Limit the search to host fields whose values of are a certain type.
        For example, to limit the search to host properties whose values are either
        boolean, ip or a date enter 'boolean,ip,date'.
      isArray: true
      name: host_field_type
      predefined:
      - string
      - boolean
      - appliance
      - port
      - service
      - list_change
      - change
      - ip
      - composite
      - ipv6
      - session
      - date
      - integer
      - tree_path
      required: false
      secret: false
    deprecated: false
    description: Retrieve an index of Forescout host properties that match the specified
      criteria.
    execution: false
    name: forescout-get-hostfields
    outputs:
    - contextPath: Forescout.HostField
      description: List index of host properties.
      type: Unknown
  - arguments:
    - default: false
      description: IP (ipv4), MAC address, or the object ID of the desired endpoint.
        Endpoint identifiers - IPs, MAC addresses and object IDs - can be found in
        the returned outputs when `forescout-get-hosts` is executed. To retrieve an
        endpoint by its IP address enter 'ip={ip-address}' where {ip-address} is replaced
        by the desired IP address. Similarly to search by MAC address or object ID
        enter 'mac={mac-address}' and 'id={object-id}' respectively where the contents
        between the curly braces is replaced by the actual identifier.
      isArray: false
      name: identifier
      required: true
      secret: false
    - default: false
      description: List of host properties to include in the output for the targeted
        endpoint. If a specified host property is not found, the property is omitted
        from the outputs. For a list of potential host properties that may be specified,
        try executing the 'forescout-get-hostfields' command. Requested fields should
        be comma separated.
      isArray: true
      name: fields
      required: false
      secret: false
    deprecated: false
    description: Retrieve specified host property values for an endpoint.
    execution: false
    name: forescout-get-host
    outputs:
    - contextPath: Forescout.Host.Field.MatchedFingerprint
      type: Unknown
    - contextPath: Forescout.Host.Field.EngineSeenPacket
      type: Unknown
    - contextPath: Forescout.Host.Field.Online
      type: Unknown
    - contextPath: Forescout.Host.Field.PrimClassification
      type: Unknown
    - contextPath: Forescout.Host.Field.MacVendorString
      type: Unknown
    - contextPath: Forescout.Host.Field.SambaOpenPort
      type: Unknown
    - contextPath: Forescout.Host.Field.UserDefFp
      type: Unknown
    - contextPath: Forescout.Host.Field.Vendor
      type: Unknown
    - contextPath: Forescout.Host.Field.AgentVersion
      type: Unknown
    - contextPath: Forescout.Host.Field.Fingerprint
      type: Unknown
    - contextPath: Forescout.Host.Field.AccessIP
      type: Unknown
    - contextPath: Forescout.Host.Field.VendorClassification
      type: Unknown
    - contextPath: Forescout.Host.Field.ManageAgent
      type: Unknown
    - contextPath: Forescout.Host.Field.Onsite
      type: Unknown
    - contextPath: Forescout.Host.Field.MacPrefix32
      type: Unknown
    - contextPath: Forescout.Host.Field.VaNetfunc
      type: Unknown
    - contextPath: Forescout.Host.Field.NmapDefFp7
      type: Unknown
    - contextPath: Forescout.Host.Field.NmapDefFp5
      type: Unknown
    - contextPath: Forescout.Host.Field.AgentInstallMode
      type: Unknown
    - contextPath: Forescout.Host.Field.NmapFp7
      type: Unknown
    - contextPath: Forescout.Host.Field.Time
      type: Unknown
    - contextPath: Forescout.Host.Field.ClType
      type: Unknown
    - contextPath: Forescout.Host.Field.ClRule
      type: Unknown
    - contextPath: Forescout.Host.Field.AgentVisibleMode
      type: Unknown
    - contextPath: Forescout.Host.Field.OSClassification
      type: Unknown
    - contextPath: Forescout.Host.Field.ClassificationSourceOS
      type: Unknown
    - contextPath: Forescout.Host.Field.LastNbtReportTime
      type: Unknown
    - contextPath: Forescout.Host.Field.Misc
      type: Unknown
    - contextPath: Forescout.Host.Field.ClassificationSourceFunc
      type: Unknown
    - contextPath: Forescout.Host.Field.NmapNetfunc7
      type: Unknown
    - contextPath: Forescout.Host.Field.MACAddress
      type: Unknown
    - contextPath: Forescout.Host.Field.OpenPort
      type: Unknown
    - contextPath: Forescout.Host.Field.GstSignedInStat
      type: Unknown
    - contextPath: Forescout.Host.Field.DhcpClass
      type: Unknown
    - contextPath: Forescout.Host.Field.ADM
      type: Unknown
    - contextPath: Forescout.Host.Field.DhcpReqFingerprint
      type: Unknown
    - contextPath: Forescout.Host.Field.DhcpOptFingerprint
      type: Unknown
    - contextPath: Forescout.Host.Field.MAC
      type: Unknown
    - contextPath: Forescout.Host.Field.Ipv4ReportTime
      type: Unknown
    - contextPath: Forescout.Host.Field.DhcpOS
      type: Unknown
    - contextPath: Forescout.Host.Field.DhcpHostname
      type: Unknown
    - contextPath: Forescout.Host.IP
      type: String
    - contextPath: Forescout.Host.MAC
      type: String
    - contextPath: Forescout.Host.EndpointURL
      type: String
    - contextPath: Forescout.Host.ID
      type: Number
  - deprecated: false
    description: |-
      Retrieves a list of all policies defined in the Forescout platform and
      their sub-rules.
    execution: false
    name: forescout-get-policies
    outputs:
    - contextPath: Forescout.Policy.ID
      description: Forescout ID for the policy.
      type: Number
    - contextPath: Forescout.Policy.Name
      description: Forescout name of the policy.
      type: String
    - contextPath: Forescout.Policy.Description
      description: Description of the policy.
      type: String
    - contextPath: Forescout.Policy.Rule
      description: List of rules that make up the policy.
      type: Unknown
  - arguments:
    - auto: PREDEFINED
      default: true
      defaultValue: update
      description: The type of update to perform on a host property.
      isArray: false
      name: update_type
      predefined:
      - update
      - delete
      required: true
      secret: false
    - default: false
      description: Enter the property names and their associated values in the following
        format, '{prop-1}={val-1}:{val-2}:{val-3}&{prop-2}={val-4}& ... &{prop-n}={val-n}'
        where {prop-1} through {prop-n} would be replaced by actual property names
        and {val-1} through {val-n} would be replaced by the values you wished to
        assign to the respective properties. Multiple property-value(s) pairs should
        be separated by an ampersand ('&') and in the case that the value of a property
        is a list, list values should be separated using a colon (':').
      isArray: false
      name: properties
      required: false
      secret: false
    - default: false
      description: The IP address of the target host. Required if 'updated_type' is
        'update' or 'delete'.
      isArray: false
      name: host_ip
      required: true
      secret: false
    - default: false
      description: 'Composite properties entered in JSON format. For example, ''{"Example_Composite":
        [{"Shape": "Triangle", "Color": "Beige"}, {"Shape": "Square", "Color": "Violet"}]}''
        where "Example_Composite" is the name of the Composite property in Forescout
        and "Shape" and "Color" are sub properties. If the composite property was
        defined in Forescout as an aggregate property then additional records will
        be appended, otherwise they will be overwritten. '
      isArray: false
      name: composite_property
      required: false
      secret: false
    deprecated: false
    description: Update a host's properties. Note that if a List Property or Composite
      Property has not been defined in Forescout to 'Aggregate new values from each
      update' that performing an update operation on a property will overwrite previous
      data written to that property.
    execution: false
    name: forescout-update-host-properties
  - arguments:
    - auto: PREDEFINED
      default: true
      defaultValue: add_list_values
      description: The type of update to perform on a Forescout list.
      isArray: false
      name: update_type
      predefined:
      - add_list_values
      - delete_list_values
      - delete_all_list_values
      required: true
      secret: false
    - default: false
      description: ' If the ''update_type'' is set to either ''add_list_values'' or
        ''delete_list_values'' then the lists along with their respective values (to
        add or delete) should be specified in the following format, ''{list-1}={val-1}:{val-2}:{val-3}&{list-2}={val-4}&
        ... &{list-n}={val-n}'' where {list-1} through {list-n} would be replaced
        by actual names of lists that have been created in Forescout and {val-1} through
        {val-n} would be replaced by the values you wished to add to or delete from
        the respective lists. Multiple list-value(s) pairs should be separated by
        an ampersand (''&'') and list values should be separated using a colon ('':'').
        If the value of ''update_type'' is set to ''delete_all_list_values'' then
        only list names should be entered with multiple list names separated by an
        ampersand (''&'').'
      isArray: false
      name: lists
      required: true
      secret: false
    deprecated: false
    description: Update Forescout lists.
    execution: false
    name: forescout-update-lists
  dockerimage: demisto/python3:3.7.3.221
  isfetch: false
  runonce: false
  script: '-'
  type: python
