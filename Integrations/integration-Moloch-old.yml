commonfields:
  id: Moloch
  version: -1
name: Moloch
display: Moloch
category: Network Security
image: data:image/png;base64,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
description: Uses the Moloch viewer API
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |-
    var username = params.credentials.identifier;
    var password = params.credentials.password;
    var server = params.server;
    var insecure = params.insecure;

    var sendRequest = function(url, queryName) {
        var res = http(
                server + '/' + url,
                {
                    Method: 'GET',
                    Username: username,
                    Password: password,
                    UseAuthDigest: true,
                },
                insecure
            );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Failed to ' + queryName + ', request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
        }
        return res.Body;
    }

    var urlDict = {
        'moloch_connections_json': 'connections.json',
        'moloch_connections_csv': 'connections.csv',
        'moloch_files_json': 'file/list',
        'moloch_sessions_json': 'sessions.json',
        'moloch_sessions_csv': 'sessions.csv',
        'moloch_sessions_pcap': 'sessions.pcap',
        'moloch_spigraph_json': 'spigraph.json',
        'moloch_spiview_json': 'spiview.json',
        'moloch_unique_json': 'unique.txt'
    }

    var prToName = {
        1: 'icmp',
        6: 'tcp',
        17: 'udp',
        47: 'gre',
        58: 'icmpv6'
    }

    var jsonResponses = ['moloch_connections_json', 'moloch_files_json', 'moloch_sessions_json', 'moloch_spigraph_json', 'moloch_spiview_json', 'moloch_unique_json'];
    var csvResponses = ['moloch_connections_csv', 'moloch_sessions_csv'];
    var pcapResponses = ['moloch_sessions_pcap'];

    var parseSessions = function(response) {
        var outputs = [];
        var contexts = [];
        for (var i = 0, objects = response.data; i < objects.length; i++) {
            var output = {};

            output['ID'] = objects[i].id;
            output['Index'] = objects[i].index;
            output['Protocol'] = objects[i].pr in prToName ? prToName[objects[i].pr] : objects[i].pr;
            output['Start Time'] = convertTimestampToString(objects[i].fp);
            output['End Time'] = convertTimestampToString(objects[i].lp);
            output['Source IP'] = numToIp(objects[i].a1);
            output['Source Port'] = objects[i].p1;
            output['Source Packets'] = objects[i].pa1;
            output['Source Bytes'] = objects[i].by1;
            output['Source Databytes'] = objects[i].db1;
            output['Destination IP'] = numToIp(objects[i].a2);
            output['Destination Port'] = objects[i].p2;
            output['Destination Packets'] = objects[i].pa2;
            output['Destination Bytes'] = objects[i].by2;
            output['Destination Databytes'] = objects[i].db2;

            outputs.push(output);
            contexts.push(convertKeysToPascalCase(output));
        }

        entry = {
            Type: entryTypes.note,
            Contents: null,
            ContentsFormat: formats.json,
            EntryContext: {'Moloch.Sessions': contexts},
            HumanReadable: tableToMarkdown('Moloch Sessions Search', outputs)
        };

        return entry;
    }

    switch (command) {
        case 'test-module':
            if (sendRequest(urlDict['moloch_connections_json'], 'Test')) {
                return 'ok';
            }

            return 'not cool';

        default:
            var currentTime = new Date();

            if (!args.date) {
                args.date = -1;
            }

            var res = sendRequest(urlDict[command] + encodeToURLQuery(args), urlDict[command]);
            if (!res) {
                return 'empty';
            }

            if (jsonResponses.indexOf(command) !== -1) {
                if (command == 'moloch_sessions_json') {
                    return parseSessions(JSON.parse(res));
                } else {
                    return JSON.parse(res);
                }
            } else if (csvResponses.indexOf(command) !== -1) {
                return {Type: 9, FileID: saveFile(res), File: command + encodeToURLQuery(args).substr(1) + '_at_' + currentTime.getTime() + '.csv',  Contents: 'we must have contents for an entry'};
            } else if (pcapResponses.indexOf(command) !== -1) {
                return {Type: 9, FileID: saveFile(res), File: command + encodeToURLQuery(args).substr(1) + '_at_' + currentTime.getTime() + '.pcap',  Contents: 'we must have contents for an entry'};
            }

            return res;
    }
  type: javascript
  commands:
  - name: moloch_connections_json
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: dstField
      description: 'The source database field name (Default: a2)'
    - name: expression
      description: The expression string
    - name: iDisplayLength
      description: '< 0.12 - The number of items to return (Default: 5000, Max: 2000000)'
    - name: iDisplayStart
      description: '< 0.12 - The entry to start at (Default: 0)'
    - name: length
      description: '>= 0.12 - The number of items to return (Default: 5000, Max: 2000000)'
    - name: srcField
      description: 'The source database field name (Default: a1)'
    - name: start
      description: '>= 0.12 - The entry to start at (Default: 0)'
    - name: startTime
      description: If the date parameter is not set, this is the start time of data
        to return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the stop time of data to
        return. If and integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the connections data in json format
  - name: moloch_connections_csv
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: dstField
      description: 'The source database field name (Default: a2)'
    - name: expression
      description: The expression string
    - name: iDisplayLength
      description: '< 0.12 - The number of items to return (Default: 5000, Max: 2000000)'
    - name: iDisplayStart
      description: '< 0.12 - The entry to start at (Default: 0)'
    - name: length
      description: '>= 0.12 - The number of items to return (Default: 5000, Max: 2000000)'
    - name: srcField
      description: 'The source database field name (Default: a1)'
    - name: start
      description: '>= 0.12 - The entry to start at (Default: 0)'
    - name: startTime
      description: If the date parameter is not set, this is the start time of data
        to return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the stop time of data to
        return. If and integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the connections data in csv format
  - name: moloch_files_json
    arguments:
    - name: iDisplayLength
      description: '< 0.12 - The number of items to return (Default: 500, Max: 10000)'
    - name: iDisplayStart
      description: '< 0.12 - The entry to start at (Default: 0)'
    - name: length
      description: '>= 0.12 - The number of items to return (Default: 500, Max: 10000)'
    - name: start
      description: '>= 0.12 - The entry to start at (Default: 0)'
    description: Return a list of files that moloch knows about
  - name: moloch_sessions_json
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: expression
      description: The expression string
    - name: facets
      description: Also include the aggregation information for maps and time graphs
    - name: iDisplayLength
      description: '< 0.11 - The number of items to return (Default: 100, Max: 2000000)'
    - name: iDisplayStart
      description: '< 0.11 - The entry to start at (Default: 0)'
    - name: length
      description: '>= 0.12 - the number of items to return (Default: 100, Max: 2000000)'
    - name: start
      description: '>= 0.12 - The entry to start at (Default: 0)'
    - name: startTime
      description: If the date parameter is not set, this is the start time of data
        to return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the stop time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the session data in json format
  - name: moloch_sessions_csv
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: expression
      description: The expression string
    - name: facets
      description: Also include the aggregation information for maps and time graphs
    - name: iDisplayLength
      description: '< 0.11 - The number of items to return (Default: 100, Max: 2000000)'
    - name: iDisplayStart
      description: '< 0.11 - The entry to start at (Default: 0)'
    - name: length
      description: '>= 0.12 - the number of items to return (Default: 100, Max: 2000000)'
    - name: start
      description: '>= 0.12 - The entry to start at (Default: 0)'
    - name: startTime
      description: If the date parameter is not set, this is the start time of data
        to return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the stop time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the session data in csv format
  - name: moloch_sessions_pcap
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: expression
      description: The expression string, used if ids not set
    - name: ids
      description: The list of ids to return
    - name: iDisplayLength
      description: '< 0.12 - The number of items to return (Default: 100, Max: 2000000)'
    - name: iDisplayStart
      description: '< 0.12 - The entry to start at (Default: 0)'
    - name: length
      description: '>= 0.12 - The number of items to return (Default: 100, Max: 2000000)'
    - name: segments
      description: When set return linked segments
    - name: start
      description: '>= 0.12 - The entry to start at (Default: 0)'
    - name: startTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the raw session data in pcap format
  - name: moloch_spigraph_json
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: expression
      description: The expression string
    - name: field
      description: The database field name to spigraph on
    - name: size
      description: The number of unique values to return
    - name: startTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the spigraph data in json format
  - name: moloch_spiview_json
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: expression
      description: The expression string
    - name: spi
      description: A comma separated list of fields to return data for
    - name: startTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the spiview data in json format
  - name: moloch_unique_json
    arguments:
    - name: date
      description: The number of hours of data to return, -1 means all data
    - name: expression
      description: The expression string
    - name: field
      required: true
      default: true
      description: The database field name to unique on
    - name: startTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: stopTime
      description: If the date parameter not set, this is the start time of data to
        return. If an integer the number of seconds since Unix EPOC is used, otherwise
        parsed with javascript Date parser
    - name: strictly
      description: When set the entire session must be inside the date range to be
        observed, otherwise if it overlaps it is displayed
    - name: view
      description: The view name to apply before the expression
    description: Retrieve the unique data for a field in json format
hidden: false
toversion: 3.1.0
