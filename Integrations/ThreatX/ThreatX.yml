category: Network Security
commonfields:
  id: ThreatX
  version: -1
configuration:
- display: Customer Name
  name: customer_name
  required: true
  type: 0
- defaultvalue: https://provision.threatx.io
  display: ThreatX Server URL (e.g., https://provision.threatx.io)
  name: url
  required: true
  type: 0
- display: API Key
  name: api_key
  required: true
  type: 4
- defaultvalue: '70'
  display: IP Threshold. Minimum risk score from ThreatX to consider the IP malicious.
  name: dbot_threshold
  required: true
  type: 0
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: 'false'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: The ThreatX integration allows automated enforcement and intel gathering
  actions.
display: ThreatX
name: ThreatX
script:
  commands:
  - arguments:
    - default: false
      description: IP address or CIDR (e.g. 10.1.1.1 or 10.1.1.0/24)
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Temporarily block an IP or CIDR
    execution: true
    name: threatx-block-ip
    outputs:
    - contextPath: IP.Address
      description: IP address or CIDR blocked
      type: string
  - arguments:
    - default: false
      description: IP address or CIDR (e.g. 10.1.1.1 or 10.1.1.0/24)
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Unblock a blocked IP or CIDR
    execution: true
    name: threatx-unblock-ip
    outputs:
    - contextPath: IP.Address
      description: IP address or CIDR unblocked
      type: Unknown
  - arguments:
    - default: false
      description: IP address or CIDR (e.g. 10.1.1.1 or 10.1.1.0/24)
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Add an IP or CIDR to the Blacklist
    execution: true
    name: threatx-blacklist-ip
    outputs:
    - contextPath: IP.Address
      description: IP address or CIDR blacklisted
      type: string
  - arguments:
    - default: false
      description: IP address or CIDR (e.g. 10.1.1.1 or 10.1.1.0/24)
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Remove an IP or CIDR from the Blacklist
    execution: true
    name: threatx-unblacklist-ip
    outputs:
    - contextPath: IP.Address
      description: IP address or CIDR unblacklisted
      type: string
  - arguments:
    - default: false
      description: IP address or CIDR (e.g. 10.1.1.1 or 10.1.1.0/24)
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Add an IP or CIDR to the Whitelist
    execution: true
    name: threatx-whitelist-ip
    outputs:
    - contextPath: IP.Address
      description: IP address or CIDR whitelisted
      type: string
  - arguments:
    - default: false
      description: IP address or CIDR (e.g. 10.1.1.1 or 10.1.1.0/24)
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Remove an IP or CIDR from the Whitelist
    execution: true
    name: threatx-unwhitelist-ip
    outputs:
    - contextPath: IP.Address
      description: IP address or CIDR unwhitelisted
      type: string
  - arguments:
    - default: false
      description: One or more comma separated Entity names
      isArray: false
      name: entity_name
      required: false
      secret: false
    - default: false
      description: One or more comma separated Entity ID hashes
      isArray: false
      name: entity_id
      required: false
      secret: false
    - default: false
      description: One or more comma separated Entity IP addresses
      isArray: false
      name: entity_ip
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 1-Hour
      description: 'Look-back timeframe for the query. Options are 1-Hour, 1-Day,
        1-Week, 1-Month, or 3-Months. Note: long look-back timeframes for a large
        number of Entities can timeout.'
      isArray: false
      name: timeframe
      predefined:
      - 1-Hour
      - 1-Day
      - 1-Week
      - 1-Month
      - 3-Months
      required: true
      secret: false
    deprecated: false
    description: 'Get high-level Entity information via the Entity ID, Entity Name,
      or Entity IP. Example: !threatx-get-entities timeframe=1-Day entity_name=CynicalGraaf,MJ12Bot
      entity_id= 566056709675514809 entity_ip=12.12.12.12,14.14.14.14. Note: long
      look-back timeframes for a large number of Entities can timeout.'
    execution: false
    name: threatx-get-entities
    outputs:
    - contextPath: Threatx.Entity.ID
      description: ID hash of the Entity
      type: string
    - contextPath: Threatx.Entity.Name
      description: Name of the Entity
      type: string
    - contextPath: Threatx.Entity.IP
      description: IP address of the Entity
      type: string
    - contextPath: Threatx.Entity.Risk
      description: Risk score of the Entity
      type: Unknown
  - arguments:
    - default: false
      description: 'ID hash of the Entity. Note: this value can be retrieved using
        the "!threatx-get-entities" command.'
      isArray: false
      name: entity_id
      required: true
      secret: false
    deprecated: false
    description: Get the notes attached to an Entity by Entity ID
    execution: false
    name: threatx-get-entity-notes
    outputs:
    - contextPath: Threatx.Entity.Note
      description: Notes attached to the Entity
      type: number
    - contextPath: Threatx.Entity.ID
      description: ID hash of the Entity
      type: Unknown
    - contextPath: Threatx.Entity.Note.content
      description: Content of the Note
      type: Unknown
    - contextPath: Threatx.Entity.Note.timestamp
      description: Timestamp of the Note
      type: Unknown
    - contextPath: Threatx.Entity.Note.username
      description: Author of the Note
      type: Unknown
  - arguments:
    - default: false
      description: 'ID hash of the Entity. Note: this value can be retrieved using
        the "!threatx-get-entities" command.'
      isArray: false
      name: entity_id
      required: true
      secret: false
    - default: false
      description: Contents of the note
      isArray: false
      name: message
      required: true
      secret: false
    deprecated: false
    description: 'Add a new note to the Entity. Example: !threatx-add-entity-note
      entity_id=566056709695514809 message="test note"'
    execution: true
    name: threatx-add-entity-note
  isfetch: false
  runonce: false
  script: '-'
  type: python
image: ''
