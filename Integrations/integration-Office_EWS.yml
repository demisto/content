commonfields:
  id: Office EWS
  version: -1
name: Office EWS
display: Office EWS
category: Data Enrichment
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAyCAYAAAATIfj2AAAACXBIWXMAAAsTAAALEwEAmpwYAAA7oGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wMi0xNlQyMDozOTo1NCswMjowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE2LTAzLTA4VDE0OjI1OjQxKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wMy0wOFQxNDoyNTo0MSswMjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpmZDgyZDE4NC03OWNiLTQ5MDAtOGViNC00YzYyNWIxZjM3MGU8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnhtcC5kaWQ6ZTBhOGJjMDAtZTZlZS00NGRiLTg4NTYtYzliZWViMjcyYTgxPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6ZTBhOGJjMDAtZTZlZS00NGRiLTg4NTYtYzliZWViMjcyYTgxPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y3JlYXRlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmUwYThiYzAwLWU2ZWUtNDRkYi04ODU2LWM5YmVlYjI3MmE4MTwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMi0xNlQyMDozOTo1NCswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjIwNWQ5NmJmLTY5MmUtNDRiMS1hNTMwLWFjN2VjOGRhYjY3MDwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMi0xOFQxMjo1MzoyNiswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmZkODJkMTg0LTc5Y2ItNDkwMC04ZWI0LTRjNjI1YjFmMzcwZTwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMy0wOFQxNDoyNTo0MSswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjUyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjUwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg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
description: Exchange Web Services
detaileddescription: |-
  Default version is used when accessing the EWS API to determine the API version.
  By default Demisto uses the Exchange2010 version.
  It is recommended not to change this value unless you run into issues.
  The default value can be bypassed in individual exchange commands by adding "version=Exhcange{yyyy}" where yyyy is the exchange version.
configuration:
- display: Server URL
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: ""
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Domain
  name: domain
  defaultvalue: ""
  type: 0
  required: true
- display: Default Version
  name: defaultServerVersion
  defaultvalue: Exchange2010
  type: 0
  required: false
- display: Authentication Type (NTLM or Basic)
  name: authType
  defaultvalue: NTLM
  type: 0
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |
    var server = params.server.replace(/[\/]+$/, '') + '/';

    var commandsDictionary = {
        'ews-get-folder': {
            arrayArgName: 'folders-ids',
            template:
               '<?xml version="1.0" encoding="utf-8"?>' +
               '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"' +
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types\">' +
                '<soap:Header>' +
                '<t:RequestServerVersion Version="%version%" />' +
                '<t:ExchangeImpersonation>' +
                '<t:ConnectingSID>' +
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>' +
                '</t:ConnectingSID>' +
                '</t:ExchangeImpersonation>' +
                '</soap:Header>' +
                '<soap:Body>' +
                '<GetFolder xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"' +
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">' +
                '<FolderShape>' +
                '<t:BaseShape>Default</t:BaseShape>' +
                '</FolderShape>' +
                '<FolderIds>' +
                '%folders-ids%' +
                '</FolderIds>' +
                '</GetFolder>' +
                '</soap:Body>' +
                '</soap:Envelope>'
            },
        'ews-delete-items': {
            arrayArgName: 'item-ids',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<DeleteItem DeleteType="HardDelete" xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">'+
                '<ItemIds>'+
                '%item-ids%'+
                '</ItemIds>'+
                '</DeleteItem>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-get-items': {
            arrayArgName: 'item-ids',
            defaultArgs: {
                'include-mime-content': false
            },
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'+
                ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<GetItem xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<ItemShape>' +
                '<t:BaseShape>Default</t:BaseShape>' +
                '<t:IncludeMimeContent>%include-mime-content%</t:IncludeMimeContent>'+
                '</ItemShape>' +
                '<ItemIds>'+
                '%item-ids%'+
                '</ItemIds>'+
                '</GetItem>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-search-mailbox': {
            arrayArgName: 'folders-ids',
            defaultArgs: {
                'max-entries-returned': 10
            },
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                    ' xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"'+
                    ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"'+
                    ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'+
                    '<soap:Header>'+
                        '<t:RequestServerVersion Version="%version%" />'+
                        '<t:ExchangeImpersonation>'+
                            '<t:ConnectingSID>'+
                            '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                            '</t:ConnectingSID>'+
                        '</t:ExchangeImpersonation>'+
                    '</soap:Header>'+
                    '<soap:Body>'+
                        '<m:FindItem Traversal="Shallow">'+
                        '<m:ItemShape>' +
                            '<t:BaseShape>Default</t:BaseShape>' +
                        '</m:ItemShape>' +
                        '<m:IndexedPageItemView MaxEntriesReturned="%max-entries-returned%" Offset="0" BasePoint="Beginning" />'+
                        '<m:ParentFolderIds>'+
                            '%folders-ids%'+
                        '</m:ParentFolderIds>'+
                        '<m:QueryString>%query%</m:QueryString>'+
                        '</m:FindItem>'+
                    '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-get-contacts': {
            arrayArgName: 'item-ids',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'+
                ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<GetItem xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">'+
                '<ItemShape>'+
                '<t:BaseShape>Default</t:BaseShape>'+
                '</ItemShape>'+
                '<ItemIds>'+
                '%item-ids%'+
                '</ItemIds>'+
                '</GetItem>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-delete-attachments': {
            arrayArgName: 'item-ids',
            fillerName: 'attachments-ids',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'+
                ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<DeleteAttachment xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<AttachmentIds>'+
                '%item-ids%'+
                '</AttachmentIds>'+
                '</DeleteAttachment>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'folders-ids': {
            template:
                '<t:DistinguishedFolderId Id="%id%" />'
        },
        'item-ids': {
            template:
                '<t:ItemId Id="%id%" />'
        },
        'attachments-ids': {
            template:
                '<t:AttachmentId Id="%id%" />'
        }
    };

    var send = function(body) {
        var httpParams = {
                Method: 'POST',
                Headers: {
                    'Content-Type': ['text/xml; charset=utf-8']
                },
                Username: params.credentials.identifier,
                Password: params.credentials.password,
                Domain: params.domain,
                AuthProtocol: [params.authType],
                Body: body,
            };
        var res = http(server, httpParams, params.insecure, params.proxy);
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Got status code ' + res.StatusCode + ' from EWS with body ' + res.Body;
        }
        return JSON.parse(x2j(res.Body));
    }

    function buildBody(command, args) {
        var currentCommand = commandsDictionary[command];
        if (currentCommand.defaultArgs) {
            for (var j in currentCommand.defaultArgs) {
                if (!args[j]) {
                    args[j] = currentCommand.defaultArgs[j];
                }
            }
        }
        console.log(JSON.stringify(args))
        if (currentCommand.arrayArgName) {
            var items = args[currentCommand.arrayArgName].split(',');
            var itemsStr = '';
            for (var i in items) {
                itemsStr += replaceInTemplates(commandsDictionary[currentCommand.fillerName || currentCommand.arrayArgName].template, {id: items[i]});
            }
            args[currentCommand.arrayArgName] = itemsStr;
        }
        return replaceInTemplates(currentCommand.template, args);
    }

    if (!args.version) {
        args.version = params.defaultServerVersion;
    }
    switch (command) {
        case 'test-module':
            args['folders-ids'] = 'inbox';
            args['target-mailbox'] = params.credentials.identifier + '@' + params.domain;
            send(buildBody('ews-get-folder', args));
            return 'ok'; // need to implement the test
        default:
            return send(buildBody(command, args));
    }
  type: javascript
  commands:
  - name: ews-get-folder
    arguments:
    - name: folders-ids
      required: true
      description: The Item IDs (result of the ews-search-mailbox command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: ews.folders
      description: Array of folders
    description: Get a folder from a mailbox in the Exchange store.
  - name: ews-delete-items
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The item IDs (result of the ews-search-mailbox)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: ews.deletedItems
      description: Array of deleted items
    description: Delete an item (e.g. an e-mail) from a mailbox in the Exchange store
  - name: ews-delete-attachments
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The attachment IDs  (result of the ews-get-items command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: ews.deletedAttachments
      description: Array of deleted attachments
    description: Delete an attachment from the Exchange store
  - name: ews-get-items
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The Item IDs (result of the ews-search-mailbox command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    - name: include-mime-content
      description: Include file content
    outputs:
    - contextPath: ews.items
      description: Array of items (which includes items ID and other important information
        including file content)
    description: Get the item ID and other important information including file content
  - name: ews-search-mailbox
    arguments:
    - name: query
      required: true
      default: true
      description: A mailbox query string based on Advanced Query Syntax (AQS).
    - name: folders-ids
      required: true
      description: The folders where the query will run
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    - name: max-entries-returned
      description: Stop querying after specified number is reached
    outputs:
    - contextPath: ews.seachItems
      description: Array of mailbox items
    description: 'Find items in a mailbox. The user account which is used to interact
      with the Exchange MUST have permissions to impersonate other users. Otherwise,
      any operation on a mailbox that does not belong to that user will fail. Instructions
      on how to configure exchange impersonation can be found here: https://msdn.microsoft.com/en-us/library/bb204095.aspx'
  - name: ews-get-contacts
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The item IDs (result of the ews-search-mailbox command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: ews.contacts
      description: Array of contacts
    description: Retrieve contact items from the Contacts folder
hidden: false
