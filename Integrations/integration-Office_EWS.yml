commonfields:
  id: EWS
  version: -1
name: EWS
display: EWS
category: Data Enrichment
fromversion: 2.6.0
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAyCAYAAAATIfj2AAAACXBIWXMAAAsTAAALEwEAmpwYAAA7oGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNi0wMi0xNlQyMDozOTo1NCswMjowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE2LTAzLTA4VDE0OjI1OjQxKzAyOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxNi0wMy0wOFQxNDoyNTo0MSswMjowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpmZDgyZDE4NC03OWNiLTQ5MDAtOGViNC00YzYyNWIxZjM3MGU8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnhtcC5kaWQ6ZTBhOGJjMDAtZTZlZS00NGRiLTg4NTYtYzliZWViMjcyYTgxPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6ZTBhOGJjMDAtZTZlZS00NGRiLTg4NTYtYzliZWViMjcyYTgxPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y3JlYXRlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmUwYThiYzAwLWU2ZWUtNDRkYi04ODU2LWM5YmVlYjI3MmE4MTwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMi0xNlQyMDozOTo1NCswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjIwNWQ5NmJmLTY5MmUtNDRiMS1hNTMwLWFjN2VjOGRhYjY3MDwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMi0xOFQxMjo1MzoyNiswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmZkODJkMTg0LTc5Y2ItNDkwMC04ZWI0LTRjNjI1YjFmMzcwZTwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMy0wOFQxNDoyNTo0MSswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjUyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjUwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg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
description: Exchange Web Services and Office 365
detaileddescription: |-
  For Office 365, use https://outlook.office365.com/EWS/Exchange.asmx (default) as the Server  URL.
  Default version is used when accessing the EWS API to determine the API version.
  By default Demisto uses the Exchange2010 version.
  It is recommended not to change this value unless you run into issues.
  The default value can be bypassed in individual exchange commands by adding "version=Exhcange{yyyy}" where yyyy is the exchange version.
configuration:
- display: Server URL
  name: server
  defaultvalue: https://outlook.office365.com/EWS/Exchange.asmx/
  type: 0
  required: true
- display: ""
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Domain
  name: domain
  defaultvalue: ""
  type: 0
  required: true
- display: Default Version
  name: defaultServerVersion
  defaultvalue: Exchange2010
  type: 0
  required: false
- display: Authentication Type (NTLM or Basic)
  name: authType
  defaultvalue: NTLM
  type: 0
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |
    var server = params.server.replace(/[\/]+$/, '') + '/';
    var office365address = 'https://outlook.office365.com/EWS/Exchange.asmx/';
    var commandsDictionary = {
        'ews-get-folder': {
            arrayArgName: 'folders-ids',
            contextKey: 'EWS.Folders(val.ID == obj.ID)',
            innerPath: 'Envelope.Body.GetFolderResponse.ResponseMessages.GetFolderResponseMessage.Folders.Folder',
            translator: [
                {to: 'ChildFolderCount', from: 'ChildFolderCount'},
                {to: 'DisplayName', from: 'DisplayName'},
                {to: 'TotalCount', from: 'TotalCount'},
                {to: 'UnreadCount', from: 'UnreadCount'},
                {to: 'FolderID-ID', from: 'FolderId.-Id'},
                {to: 'FolderID-ChangeKey', from: 'FolderId.-ChangeKey'},
            ],
            tableTitle: 'EWS get folder for %target-mailbox% folders %folders-ids%',
            template:
               '<?xml version="1.0" encoding="utf-8"?>' +
               '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"' +
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types\">' +
                '<soap:Header>' +
                '<t:RequestServerVersion Version="%version%" />' +
                '<t:ExchangeImpersonation>' +
                '<t:ConnectingSID>' +
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>' +
                '</t:ConnectingSID>' +
                '</t:ExchangeImpersonation>' +
                '</soap:Header>' +
                '<soap:Body>' +
                '<GetFolder xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"' +
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">' +
                '<FolderShape>' +
                '<t:BaseShape>Default</t:BaseShape>' +
                '</FolderShape>' +
                '<FolderIds>' +
                '%folders-ids%' +
                '</FolderIds>' +
                '</GetFolder>' +
                '</soap:Body>' +
                '</soap:Envelope>'
            },
        'ews-delete-items': {
            arrayArgName: 'item-ids',
            innerPath: 'Envelope.Body.DeleteItemResponse.ResponseMessages.DeleteItemResponseMessage',
            translator: [
                {to: 'Class', from: '-ResponseClass'},
                {to: 'ResponseCode', from: 'ResponseCode'},
                {to: 'Message', from: 'MessageText'},
                {to: 'Link', from: 'DescriptiveLinkKey'},
            ],
            tableTitle: 'EWS delete items items for %target-mailbox% items %item-ids%',
            deleteContextKey: 'EWS.DeletedItems',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<DeleteItem DeleteType="HardDelete" xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">'+
                '<ItemIds>'+
                '%item-ids%'+
                '</ItemIds>'+
                '</DeleteItem>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-get-items': {
            arrayArgName: 'item-ids',
            innerPath: 'Envelope.Body.GetItemResponse.ResponseMessages.GetItemResponseMessage.Items.Message',
            translator: [
                {to: 'BodyType', from: 'Body.-BodyType'},
                {to: 'Body', from: 'Body.#text'},
                {to: 'Created', from: 'DateTimeCreated'},
                {to: 'Sent', from: 'DateTimeSent'},
                {to: 'From-Email', from: 'From.Mailbox.EmailAddress'},
                {to: 'From-Name', from: 'From.Mailbox.Name'},
                {to: 'From-RoutingType', from: 'From.Mailbox.RoutingType'},
                {to: 'To-Email', from: 'ToRecipients.Mailbox.EmailAddress'},
                {to: 'To-Name', from: 'ToRecipients.Mailbox.Name'},
                {to: 'To-RoutingType', from: 'ToRecipients.Mailbox.RoutingType'},
                {to: 'HasAttachments', from: 'HasAttachments'},
                {to: 'IsAssociated', from: 'IsAssociated'},
                {to: 'IsRead', from: 'IsRead'},
                {to: 'Sensitivity', from: 'Sensitivity'},
                {to: 'Size', from: 'Size'},
                {to: 'ID', from: 'ItemId.-Id'},
                {to: 'Subject', from: 'Subject'},
                {to: 'Attachment-ID', from: 'Attachments.FileAttachment.AttachmentId.-Id'},
                {to: 'Attachment-IsContactPhoto', from: 'Attachments.FileAttachment.IsContactPhoto'},
                {to: 'Attachment-IsInline', from: 'Attachments.FileAttachment.IsInline'},
                {to: 'Attachment-LastModifiedTime', from: 'Attachments.FileAttachment.LastModifiedTime'},
                {to: 'Attachment-Name', from: 'Attachments.FileAttachment.Name'},
                {to: 'Attachment-Size', from: 'Attachments.FileAttachment.Size'},
            ],
            tableTitle: 'EWS get items for %target-mailbox% items %item-ids% items',
            nonDisplayItems: ['Body'],
            contextKey: 'EWS.Items(val.ID == obj.ID)',
            defaultArgs: {
                'include-mime-content': false
            },
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'+
                ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<GetItem xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<ItemShape>' +
                '<t:BaseShape>Default</t:BaseShape>' +
                '<t:IncludeMimeContent>%include-mime-content%</t:IncludeMimeContent>'+
                '</ItemShape>' +
                '<ItemIds>'+
                '%item-ids%'+
                '</ItemIds>'+
                '</GetItem>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-search-mailbox': {
            arrayArgName: 'folders-ids',
            innerPath: 'Envelope.Body.FindItemResponse.ResponseMessages.FindItemResponseMessage.RootFolder.Items.Message',
            defaultArgs: {
                'max-entries-returned': 10
            },
            translator: [
                {to: 'Created', from: 'DateTimeCreated'},
                {to: 'Sent', from: 'DateTimeSent'},
                {to: 'From-Email', from: 'From.Mailbox.EmailAddress'},
                {to: 'From-Name', from: 'From.Mailbox.Name'},
                {to: 'HasAttachments', from: 'HasAttachments'},
                {to: 'IsAssociated', from: 'IsAssociated'},
                {to: 'IsRead', from: 'IsRead'},
                {to: 'Sensitivity', from: 'Sensitivity'},
                {to: 'Size', from: 'Size'},
                {to: 'ID', from: 'ItemId.-Id'},
                {to: 'Subject', from: 'Subject'},
            ],
            tableTitle: 'EWS search mailbox %target-mailbox% folder %folders-ids% with query %query%',
            contextKey: 'EWS.SearchItems(val.ID == obj.ID)',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                    ' xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"'+
                    ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"'+
                    ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">'+
                    '<soap:Header>'+
                        '<t:RequestServerVersion Version="%version%" />'+
                        '<t:ExchangeImpersonation>'+
                            '<t:ConnectingSID>'+
                            '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                            '</t:ConnectingSID>'+
                        '</t:ExchangeImpersonation>'+
                    '</soap:Header>'+
                    '<soap:Body>'+
                        '<m:FindItem Traversal="Shallow">'+
                        '<m:ItemShape>' +
                            '<t:BaseShape>Default</t:BaseShape>' +
                        '</m:ItemShape>' +
                        '<m:IndexedPageItemView MaxEntriesReturned="%max-entries-returned%" Offset="0" BasePoint="Beginning" />'+
                        '<m:ParentFolderIds>'+
                            '%folders-ids%'+
                        '</m:ParentFolderIds>'+
                        '<m:QueryString>%query%</m:QueryString>'+
                        '</m:FindItem>'+
                    '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-get-contacts': {
            arrayArgName: 'item-ids',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'+
                ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<GetItem xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">'+
                '<ItemShape>'+
                '<t:BaseShape>Default</t:BaseShape>'+
                '</ItemShape>'+
                '<ItemIds>'+
                '%item-ids%'+
                '</ItemIds>'+
                '</GetItem>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-delete-attachments': {
            arrayArgName: 'item-ids',
            fillerName: 'attachments-ids',
            innerPath: 'Envelope.Body.DeleteAttachmentResponse.ResponseMessages.DeleteAttachmentResponseMessage',
            translator: [
                {to: 'Class', from: '-ResponseClass'},
                {to: 'ResponseCode', from: 'ResponseCode'},
                {to: 'Message', from: 'MessageText'},
                {to: 'Link', from: 'DescriptiveLinkKey'},
            ],
            tableTitle: 'EWS delete attachments items for %target-mailbox% items %attachments-ids%',
            deleteContextKey: 'EWS.DeletedAttachments',
            template:
                '<?xml version="1.0" encoding="utf-8"?>'+
                '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'+
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'+
                ' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<soap:Header>'+
                '<t:RequestServerVersion Version="%version%" />'+
                '<t:ExchangeImpersonation>'+
                '<t:ConnectingSID>'+
                '<t:PrimarySmtpAddress>%target-mailbox%</t:PrimarySmtpAddress>'+
                '</t:ConnectingSID>'+
                '</t:ExchangeImpersonation>'+
                '</soap:Header>'+
                '<soap:Body>'+
                '<DeleteAttachment xmlns="http://schemas.microsoft.com/exchange/services/2006/messages"'+
                ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">'+
                '<AttachmentIds>'+
                '%item-ids%'+
                '</AttachmentIds>'+
                '</DeleteAttachment>'+
                '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-get-searchable-mailboxes': {
            fillerName: 'attachments-ids',
            tableTitle: 'EWS get searchable mail boxes',
            innerPath: 'Envelope.Body.GetSearchableMailboxesResponse.SearchableMailboxes.SearchableMailbox',
            translator: [
                {to: 'MailAddress', from: 'PrimarySmtpAddress'},
                {to: 'ReferenceId', from: 'ReferenceId'},
                {to: 'IsExternal', from: 'IsExternalMailbox'},
                {to: 'Display', from: 'DisplayName'},
            ],
            defaultArgs: {
                'filter': ' '
            },
            contextKey: 'EWS.Mailboxes',
            template:
                '<?xml version="1.0" encoding="UTF-8"?>'+
                '<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"'+
                              ' xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"'+
                              ' xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages">'+
                   '<soap:Header>'+
                      '<t:RequestServerVersion Version="Exchange2013" />'+
                   '</soap:Header>'+
                   '<soap:Body >'+
                      '<m:GetSearchableMailboxes>'+
                         '<m:SearchFilter>%filter%</m:SearchFilter>'+
                         '<m:ExpandGroupMembership>false</m:ExpandGroupMembership>'+
                      '</m:GetSearchableMailboxes>'+
                   '</soap:Body>'+
                '</soap:Envelope>'
            },
        'ews-search-mailboxes': {
          arrayArgName: 'mailbox-search-scope',
          tableTitle: 'EWS search mail boxes result for filter %filter%',
          template:
            '<?xml version="1.0" encoding="utf-8"?>' +
            '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ' +
                           'xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" ' +
                           'xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" ' +
                           'xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
                '<soap:Header>' +
                    '<t:RequestServerVersion Version="%version%"/>' +
                    '<t:ExchangeImpersonation>' +
                        '<t:ConnectingSID>' +
                            '<t:SmtpAddress>%impersonating-mailbox%</t:SmtpAddress>' +
                        '</t:ConnectingSID>' +
                    '</t:ExchangeImpersonation>' +
                '</soap:Header>' +
                '<soap:Body>' +
                    '<m:SearchMailboxes>' +
                        '<m:SearchQueries>' +
                            '<t:MailboxQuery>' +
                                '<t:Query>%filter%</t:Query>' +
                                '<t:MailboxSearchScopes>' +
                                    '%mailbox-search-scope%'+
                                '</t:MailboxSearchScopes>' +
                            '</t:MailboxQuery>' +
                        '</m:SearchQueries>' +
                        '<m:ResultType>PreviewOnly</m:ResultType>' +
                        '<m:Deduplication>false</m:Deduplication>' +
                        '<m:PageSize>1000</m:PageSize>' +
                        '<m:PageDirection>Next</m:PageDirection>' +
                    '</m:SearchMailboxes>' +
                '</soap:Body>' +
            '</soap:Envelope>',
            innerPath: 'Envelope.Body.SearchMailboxesResponse.ResponseMessages.SearchMailboxesResponseMessage.SearchMailboxesResult.Items.SearchPreviewItem',
            translator: [
                {to: 'MailAddress', from: 'Mailbox.PrimarySmtpAddress'},
                {to: 'ItemID', from: 'OwaLink=function(link){ if (link) { var regexp=/&ItemID=(.*)$/; var match = regexp.exec(link); if (match && match[1]) { return match[1];}} return undefined;}(val)'},
            ],
            contextKey: 'EWS.Searchs.Search(obj.filter==val.filter)',
            contextArrayName: 'Results',
            argsToContext: ['filter'],
        },
        'folders-ids': {
            template:
                '<t:DistinguishedFolderId Id="%id%" />'
        },
        'item-ids': {
            template:
                '<t:ItemId Id="%id%" />'
        },
        'attachments-ids': {
            template:
                '<t:AttachmentId Id="%id%" />'
        },
        'mailbox-search-scope': {
            template:
                '<t:MailboxSearchScope>' +
                    '<t:Mailbox>%id%</t:Mailbox>' +
                    '<t:SearchScope>All</t:SearchScope>' +
                    '<t:ExtendedAttributes/>' +
                '</t:MailboxSearchScope>'
        }
    };

    var mapObjFunction = function(mapFields) {
        var transformSingleObj= function(obj) {
            var res = {};
            mapFields.forEach(function(f) {
               res[f.to] = dq(obj, f.from);
            });
            return res;
        };
        return function(obj) {
            if (obj instanceof Array) {
                var res = [];
                for (var j=0; j < obj.length; j++) {
                    res.push(transformSingleObj(obj[j]));
                }
                return res;
            }
            return transformSingleObj(obj);
        }
    }

    var createContext = function(data) {
        var createContextSingle = function(obj) {
            var res = {};
            var keys = Object.keys(obj);
            keys.forEach(function(k) {
                var values = k.split('-');
                var current = res;
                for (var j = 0; j<values.length - 1; j++) {
                    if (!current[values[j]]) {
                        current[values[j]] = {};
                    }
                    current = current[values[j]];
                }
                current[values[j]] = obj[k];
            });
            return res;
        };
        if (data instanceof Array) {
            var res = [];
            for (var j=0; j < data.length; j++) {
                res.push(createContextSingle(data[j]));
            }
            return res;
        }
        return createContextSingle(data);
    }

    var buildDisplay = function(currentCommand, translated) {
        var createDisplaySingle = function(obj) {
            var disp = {};
            var keys = Object.keys(obj);
            for (var k in keys) {
                if ((!currentCommand.nonDisplayItems || currentCommand.nonDisplayItems.indexOf(keys[k]) === -1) && obj[keys[k]]) {
                    disp[keys[k]] = obj[keys[k]];
                }
            }
            return disp;
        };
        if (translated instanceof Array) {
            var res = [];
            for (var j=0; j < translated.length; j++) {
                res.push(createDisplaySingle(translated[j]));
            }
            return res;
        }
        return createDisplaySingle(translated);
    }

    var execute = function(command, args) {
        var currentCommand = commandsDictionary[command];
        var hrTitle = command;
        if (currentCommand.tableTitle) {
            hrTitle = replaceInTemplates(currentCommand.tableTitle,args);
        }
        if (currentCommand.defaultArgs) {
            var keys = Object.keys(currentCommand.defaultArgs);
            for (var j in keys) {
                if (!args[keys[j]]) {
                    args[keys[j]] = currentCommand.defaultArgs[keys[j]];
                }
            }
        }
        var ids = [];
        if (currentCommand.deleteContextKey && args[currentCommand.arrayArgName]) {
            if (Array.isArray(args[currentCommand.arrayArgName])) {
                ids = args[currentCommand.arrayArgName];
            } else {
                ids = args[currentCommand.arrayArgName].split(',');
            }
        }
        var httpParams = {
                Method: 'POST',
                Headers: {
                    'Content-Type': ['text/xml; charset=utf-8']
                },
                Username: params.credentials.identifier + (server === office365address ? ('@' + params.domain) : ''),
                Password: params.credentials.password,
                Domain: params.domain,
                AuthProtocol: [params.authType],
                Body: buildBody(command, args),
            };
        var res = http(server, httpParams, params.insecure, params.proxy);
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Got status code ' + res.StatusCode + ' from EWS with body ' + res.Body + ' with headers ' + JSON.stringify(res.Headers);
        }
        var bdy = res.Body.replace(/&#x0;/g, "");
        var raw = JSON.parse(x2j(bdy));
        var entry = {
            Type: entryTypes.note,
            Contents: raw,
            ContentsFormat: formats.json,
            ReadableContentsFormat: formats.markdown,
        };
        if (currentCommand.innerPath) {
            var data = dq(raw, currentCommand.innerPath);
            if (currentCommand.translator) {
                if (data) {
                    var translated = mapObjFunction(currentCommand.translator)(data);
                    if (currentCommand.contextKey) {
                        entry.EntryContext = {};
                        var arrContext;
                        if (currentCommand.contextArrayName) {
                            arrContext = {};
                            arrContext[currentCommand.contextArrayName] = createContext(translated);
                        }
                        entry.EntryContext[currentCommand.contextKey] = arrContext ? arrContext : createContext(translated);
                        if (currentCommand.argsToContext) {
                            for (var k in currentCommand.argsToContext) {
                                entry.EntryContext[currentCommand.contextKey][currentCommand.argsToContext[k]] = args[currentCommand.argsToContext[k]];
                            }
                        }
                    } else if (currentCommand.deleteContextKey && ids.length) {
                        entry.EntryContext = {};
                        entry.EntryContext[currentCommand.deleteContextKey] = ids;
                    }
                    var disp = buildDisplay(currentCommand, translated);
                    entry.HumanReadable = tableToMarkdown(
                        hrTitle,
                        disp
                    );
                } else {
                    entry.HumanReadable = 'No results';
                }
            }
        }
        return entry;
    }

    function buildBody(command, args) {
        var currentCommand = commandsDictionary[command];
        if (currentCommand.defaultArgs) {
            for (var j in currentCommand.defaultArgs) {
                if (!args[j]) {
                    args[j] = currentCommand.defaultArgs[j];
                }
            }
        }
        if (currentCommand.arrayArgName) {
            var items = [];
            if (Array.isArray(args[currentCommand.arrayArgName])) {
                items = args[currentCommand.arrayArgName];
            } else {
                items = args[currentCommand.arrayArgName].split(',');
            }
            var itemsStr = '';
            for (var i in items) {
                itemsStr += replaceInTemplates(commandsDictionary[currentCommand.fillerName || currentCommand.arrayArgName].template, {id: items[i]});
            }
            args[currentCommand.arrayArgName] = itemsStr;
        }
        return replaceInTemplates(currentCommand.template, args);
    }

    if (!args.version) {
        args.version = params.defaultServerVersion;
    }
    switch (command) {
        case 'test-module':
            args['folders-ids'] = 'inbox';
            args['target-mailbox'] = params.credentials.identifier + '@' + params.domain;
            execute('ews-get-folder', args);
            return 'ok'; // need to implement the test
        case 'ews-search-mailboxes':
            if (!args['mailbox-search-scope']) {
                var mailboxes = execute('ews-get-searchable-mailboxes', {});
                args['mailbox-search-scope'] = dq(mailboxes, 'Contents.Envelope.Body.GetSearchableMailboxesResponse.SearchableMailboxes.SearchableMailbox.ReferenceId');
            } else {
                if (!Array.isArray(args['mailbox-search-scope'])) {
                    args['mailbox-search-scope'] = args['mailbox-search-scope'].split(';');
                }
            }
            args['mailbox-search-scope'] = args['mailbox-search-scope'].map(function(a) { return a.trim(); });
            args['impersonating-mailbox'] = params.credentials.identifier + '@' + params.domain;
        default:
            return execute(command, args);
    }
  type: javascript
  commands:
  - name: ews-get-folder
    arguments:
    - name: folders-ids
      required: true
      description: The Item IDs (result of the ews-search-mailbox command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: EWS.Folders.ChildFolderCount
      description: Folder child folder count
    - contextPath: EWS.Folders.DisplayName
      description: Folder display name
    - contextPath: EWS.Folders.TotalCount
      description: Folder total count
    - contextPath: EWS.Folders.UnreadCount
      description: Folder unread count
    - contextPath: EWS.Folders.FolderID.ID
      description: Folder id
    - contextPath: EWS.Folders.FolderID.ChangeKey
      description: Folder change key
    description: Get a folder from a mailbox in the Exchange store.
  - name: ews-delete-items
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The item IDs (result of the ews-search-mailbox)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: EWS.DeletedItems.ID
      description: ID of deleted items
    description: Delete an item (e.g. an e-mail) from a mailbox in the Exchange store
  - name: ews-delete-attachments
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The attachment IDs (result of the ews-get-items command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    outputs:
    - contextPath: EWS.DeletedAttachments.ID
      description: ID of the deleted attachment
    description: Delete an attachment from the Exchange store
  - name: ews-get-items
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The Item IDs (result of the ews-search-mailbox command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    - name: include-mime-content
      description: Include file content
    outputs:
    - contextPath: EWS.Items.Created
      description: Time where the element was created
    - contextPath: EWS.Items.Sent
      description: Time where the element was sent
    - contextPath: EWS.Items.From.Email
      description: Sender of the email ID
    - contextPath: EWS.Items.From.Name
      description: Sender of the email name
    - contextPath: EWS.Items.HasAttachments
      description: Mail has attachements
    - contextPath: EWS.Items.IsAssociated
      description: Is mail associated
    - contextPath: EWS.Items.IsRead
      description: Is mail read
    - contextPath: EWS.Items.Sensitivity
      description: Mail severity
    - contextPath: EWS.Items.Size
      description: Mail size
    - contextPath: EWS.SeachItems.Subject
      description: Mail subject
    description: Get the item ID and other important information including file content
  - name: ews-search-mailbox
    arguments:
    - name: query
      required: true
      default: true
      description: A mailbox query string based on Advanced Query Syntax (AQS).
    - name: folders-ids
      required: true
      description: The folders where the query will run
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    - name: max-entries-returned
      description: Stop querying after specified number is reached
    outputs:
    - contextPath: EWS.SeachItems.Created
      description: Time where the element was created
    - contextPath: EWS.SeachItems.Sent
      description: Time where the element was sent
    - contextPath: EWS.SeachItems.From.Email
      description: Sender of the email ID
    - contextPath: EWS.SeachItems.From.Name
      description: Sender of the email name
    - contextPath: EWS.SeachItems.To.Email
      description: Recipient of the email ID
    - contextPath: EWS.SeachItems.To.Name
      description: Recipient of the email name
    - contextPath: EWS.SeachItems.To.RoutingType
      description: Recipient of the mail routing type
    - contextPath: EWS.SeachItems.HasAttachments
      description: Mail has attachements
    - contextPath: EWS.SeachItems.IsAssociated
      description: Is mail associated
    - contextPath: EWS.SeachItems.IsRead
      description: Is mail read
    - contextPath: EWS.SeachItems.Sensitivity
      description: Mail severity
    - contextPath: EWS.SeachItems.Size
      description: Mail size
    - contextPath: EWS.SeachItems.Subject
      description: Mail subject
    - contextPath: EWS.SeachItems.Attachment.ID
      description: Mail attachment ID
    - contextPath: EWS.SeachItems.Attachment.IsContactPhoto
      description: Mail attachment is contact photo
    - contextPath: EWS.SeachItems.Attachment.IsInline
      description: Mail attachment is inline
    - contextPath: EWS.SeachItems.Attachment.LastModifiedTime
      description: Mail attachment last modified date
    - contextPath: EWS.SeachItems.Attachment.Name
      description: Mail attachment name
    - contextPath: EWS.SeachItems.Attachment.Size
      description: Mail attachment size
    description: 'Find items in a mailbox. The user account which is used to interact
      with the Exchange MUST have permissions to impersonate other users. Otherwise,
      any operation on a mailbox that does not belong to that user will fail. Instructions
      on how to configure exchange impersonation can be found here: https://msdn.microsoft.com/en-us/library/bb204095.aspx'
  - name: ews-get-contacts
    arguments:
    - name: item-ids
      required: true
      default: true
      description: The item IDs (result of the ews-search-mailbox command)
    - name: target-mailbox
      required: true
      description: The user email address
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    description: Retrieve contact items from the Contacts folder
  - name: ews-get-searchable-mailboxes
    arguments:
    - name: filter
      description: Search filter, default is empty
    outputs:
    - contextPath: EWS.Mailboxes.MailAddress
      description: Searchable mail address
    - contextPath: EWS.Mailboxes.IsExternal
      description: Searchable mail external
    - contextPath: EWS.Mailboxes.Display
      description: Searchable mail display name
    - contextPath: EWS.Mailboxes.ReferenceId
      description: Reference ID of the mail box, for further use on other ews queries
  - name: ews-search-mailboxes
    arguments:
    - name: filter
      required: true
      description: Filter to search upon
    - name: version
      description: Exchange version (by default 2010, change to 2013 if using 2013).
        This can also be set in the settings/integrations page
    - name: mailbox-search-scope
      description: An array of mail boxes references id, or string semicolon separated
        ids
      isArray: true
    outputs:
     - contextPath: EWS.Searchs.Search.Results.ItemID
       description: Results item ID
     - contextPath: EWS.Searchs.Search.Results.MailAddress
       description: Results mail address
     - contextPath: EWS.Searchs.Search.Filter
       description: Search filter
    description: Search across mailboxes using a filter
hidden: false
releaseNotes: "Support querying multiple mailboxes"
