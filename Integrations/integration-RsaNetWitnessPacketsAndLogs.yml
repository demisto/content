commonfields:
  id: RSA NetWitness Packets and Logs
  version: -1
name: RSA NetWitness Packets and Logs
display: RSA NetWitness Packets and Logs
category: Analytics & SIEM
image: data:image/png;base64,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
description: RSA NetWitness Logs and Packets decoders are responsible for the real-time
  collection of network data. The decode captures data in real time and can normalize
  and reconstruct data for full session analysis. In addition, the decoder can collect
  flow and endpoint data.
configuration:
- display: Server URL (e.g. http(s)://192.168.0.1)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Appliance Port - Logs(50102) / Packets(50104) / Concentrator (50105) /
    Broker (50103)
  name: port
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: username
  defaultvalue: admin
  type: 0
  required: true
- display: Password
  name: password
  defaultvalue: ""
  type: 4
  required: true
- display: Validate server certificate
  name: secure
  defaultvalue: "true"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Expiration time
  name: expiry
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |-
    var RESPONSE_TYPES = {
        'json': 'application/json',
        'html': 'text/html',
        'text': 'text/plain',
        'xml': 'text/xml',
        'octet-stream': 'application/octet-stream'
    };
    var SSL_PORT = '56105';
    var NON_SSL_PORT = '50105';
    var LAST_HOURS = 'lastHours';
    var LAST_MINUTES = 'lastMinutes';
    var QUERY = 'query';
    var USER_NAME = params.username;
    var PASSWORD = params.password;

    function fixUrl(base) {
        var url = base.trim();
        if (base.indexOf('http://') !== 0 && base.indexOf('https://') !== 0) {
            url = "http://" + url;
        }

        url = url.replace(/\/$/, '');

        return url;
    }

    var BASE_URL = getUrl(fixUrl(params.url) + ':' + params.port);

    // Check if concentrator IP and/or port were provided, if yes, then the url will be changed to the assigned concentrator.
    function getUrl(currentUrl){
        var urlToReturn;
        if(args && args.concentratorIP){
            // Check if port was provided, omit it if yes
            var match = args.concentratorIP.match(/(https{0,1}:\/\/?.*):/);
            urlToReturn = match ? match[1] : args.concentratorIP;
            var port = args.concentratorPort;
            if(port){
                if(port === SSL_PORT){
                    urlToReturn = urlToReturn.indexOf('https://') === -1 ? 'https://' + urlToReturn : urlToReturn;
                }
                else{
                    urlToReturn = urlToReturn.indexOf('http://') === -1 ? 'http://' + urlToReturn : urlToReturn;
                }
            }
            else{
                urlToReturn = urlToReturn.indexOf('http://') === -1 ? 'http://' + urlToReturn : urlToReturn;
                port = NON_SSL_PORT;
            }

            urlToReturn = urlToReturn + ":" + port;

            delete(args.concentratorIP);
            delete(args.concentratorPort);
        }
        else {
            urlToReturn = currentUrl;
        }

        return urlToReturn;
    }

    function isObjectEmpty(obj) {
        for(var key in obj) {
            if(obj.hasOwnProperty(key))
                return false;
        }
        return true;
    }

    /* Example transformation:
     {
        "fields": [
            {
                "count": 0,
                "flags": 0,
                "format": 8,
                "group": 13,
                "id1": 504,
                "id2": 504,
                "type": "sessionid",
                "value": "13"
            },
            {
                "count": 0,
                "flags": 0,
                "format": 32,
                "group": 13,
                "id1": 505,
                "id2": 505,
                "type": "time",
                "value": 1372882420
            },
            {
                "count": 0,
                "flags": 0,
                "format": 6,
                "group": 13,
                "id1": 506,
                "id2": 506,
                "type": "size",
                "value": "16452"
            },
            {
                "count": 0,
                "flags": 0,
                "format": 6,
                "group": 13,
                "id1": 507,
                "id2": 507,
                "type": "payload",
                "value": "13590"
            },
            {
                "count": 0,
                "flags": 0,
                "format": 2,
                "group": 13,
                "id1": 508,
                "id2": 508,
                "type": "medium",
                "value": "1"
            }
        ],
        "id1": 509,
        "id2": 3938
    }

    To:

    {
        sessionid: 13,
        paylod: 13590,
        size: 16542,
        time: 1372882420
    }

    */

    function mapQueryResults(fields, queryResults) {
        var TYPE  = 'type';
        var VALUE = 'value';
        var GROUP = 'group';
        if(fields && Array.isArray(fields)) {
            fields.forEach(function (element) {
                if (element[TYPE] && element[VALUE]) {
                    var index = element[GROUP] || 0;
                    if(!(queryResults[index])){
                        queryResults[index] = {};
                    }
                    // Dot to camel case
                    var type = element[TYPE].replace(/\.([a-z,A-Z,0-9])/g, function (g) {
                        return g[1].toUpperCase();
                    });

                    if(!(queryResults[index][type])) {
                        queryResults[index][type] = element[VALUE];
                    }
                    else{
                        if(!(queryResults[index][type] instanceof Array)){
                            var currValue = queryResults[index][type];
                            // Ignore duplicates
                            if(currValue !== element[VALUE]){
                                queryResults[index][type] = [currValue];
                                queryResults[index][type].push(element[VALUE]);
                            }
                        }
                        else {
                            // Ignore duplicates
                            if(queryResults[index][type].indexOf(element[VALUE]) === -1){
                                queryResults[index][type].push(element[VALUE]);
                            }
                        }
                    }
                }
            });
        }
    }

    /*
    Example transformation:
    {
        "fields": [
            {
                "count": 1,
                "flags": 0,
                "format": 65,
                "group": 0,
                "id1": 25,
                "id2": 25,
                "type": "client",
                "value": "opera mail/12.11"
            },
            {
                "count": 5,
                "flags": 0,
                "format": 65,
                "group": 0,
                "id1": 13,
                "id2": 63,
                "type": "client",
                "value": "mozilla/5.0"
            },
            {
                "count": 31,
                "flags": 0,
                "format": 65,
                "group": 0,
                "id1": 14,
                "id2": 61,
                "type": "client",
                "value": "mozilla/4.0"
            },
            {
                "count": 2,
                "flags": 0,
                "format": 65,
                "group": 0,
                "id1": 5,
                "id2": 6,
                "type": "client",
                "value": "e1e8d428-5bf1-4323-8808-d138a039102f"
            }
        ],
        "id1": 0,
        "id2": 0
    }

    To:

    [
        {
            client: opera mail/12.11
        },
        {
            client: mozilla/5.0,
        },
        {
            client: mozilla/4.0,
        },
        {
            client: e1e8d428-5bf1-4323-8808-d138a039102f
        }
    ]
    */

    function mapArrayResults(fields, arrayResults){
        var TYPE  = 'type';
        var VALUE = 'value';
        if(fields && Array.isArray(fields)) {
            fields.forEach(function (element) {
                var currObject = {};
                // Dot to camel case ip.src => ipSrc
                // The reason for this transformation is to allow use in context
                var type = element[TYPE].replace(/\.([a-z,A-Z,0-9])/g, function (g) {
                    return g[1].toUpperCase();
                });
                currObject[type] = element[VALUE];
                arrayResults.push(currObject);
            });
        }
    }

    function extractFromData(data, mapper, results){
        if (Array.isArray(data)) {
            data.forEach(function (element) {
                var fields = dq(element, 'results.fields');
                mapper(fields, results);
            });
        } else if ((typeof data) ==='object') {
            var fields = dq(data, 'results.fields');
            mapper(fields, results);
        }
    }

    function buildQueryMdAndContext(response) {
        var data = parseResponse(response);

        var queryResults = {};
        extractFromData(data, mapQueryResults, queryResults);
        var flatQueryResult = [];
        if(!isObjectEmpty(queryResults)) {
            for(var key in queryResults) {
                flatQueryResult.push(queryResults[key]);
            }
            var hr = tableToMarkdown(command, flatQueryResult);
            return {
                Type: entryTypes.note,
                Contents: data,
                ContentsFormat: formats.json,
                HumanReadable: hr,
                EntryContext: {
                    'NetWitness.Events': flatQueryResult
                },
                ReadableContentsFormat: formats.markdown
            };
        } else {
            return "No results found.";
        }
    }

    function buildMSearchMdAndContext(response) {
        var data = parseResponse(response);

        var queryResults = {};
        extractFromData(data, mapQueryResults, queryResults);
        var flatQueryResult = [];
        if(!isObjectEmpty(queryResults)) {
            for(var key in queryResults) {
                flatQueryResult.push(queryResults[key]);
            }
            var hr = tableToMarkdown(command, flatQueryResult);
            return {
                Type: entryTypes.note,
                Contents: data,
                ContentsFormat: formats.json,
                HumanReadable: hr,
                EntryContext: {
                    'NetWitness.SearchHits': flatQueryResult
                },
                ReadableContentsFormat: formats.markdown
            };
        } else {
            return "No results found.";
        }
    }

    function buildValuesMdAndContext(response) {
        var data = parseResponse(response);

        var arrayResults = [];
        extractFromData(data, mapArrayResults, arrayResults);
        if(arrayResults.length !== 0) {
        var typeDict = {};
                for(var index in arrayResults){
                    var type = Object.keys(arrayResults[index])[0];
                    if(!typeDict[type]){
                        typeDict[type] = [];
                    }

                    typeDict[type].push(arrayResults[index][type]);
                }
                var arr = [];
                var maxLength = 0;
                for(var key in typeDict){
                    if(maxLength < typeDict[key].length){
                        maxLength = typeDict[key].length;
                    }
                }

                for(var i = 0; i < maxLength; i++){
                    var currObj = {};
                    for(var key in typeDict){
                        currObj[key] = typeDict[key][i];
                    }
                    if(!isObjectEmpty(currObj)){
                        arr.push(currObj);
                    }
                }

                var hr = tableToMarkdown(command, arr);
                return {
                    Type: entryTypes.note,
                    Contents: data,
                    ContentsFormat: formats.json,
                    HumanReadable: hr,
                    EntryContext: {
                        'NetWitness.Values': arrayResults
                    },
                    ReadableContentsFormat: formats.markdown
                };
        } else {
            return "No results found.";
        }
    }

    function buildTimelineMdAndContext(response) {
        var data = parseResponse(response);

        var arrayResults = [];
        extractFromData(data, mapArrayResults, arrayResults);
        if(arrayResults.length !== 0) {
            var hr = tableToMarkdown(command, arrayResults);
            return {
                Type: entryTypes.note,
                Contents: data,
                ContentsFormat: formats.json,
                HumanReadable: hr,
                EntryContext: {
                    'NetWitness.Timeline': arrayResults
                },
                ReadableContentsFormat: formats.markdown
            };
        } else {
            return "No results found.";
        }
    }
    function buildNodeMdAndContext(response){
        var data = parseResponse(response);
        var nodes = data.nodes ? data.nodes : [data.node];

        return {
            Type: entryTypes.note,
            Contents: nodes,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown(command, nodes),
            EntryContext: {
                'NetWitness.Node(val.handle==obj.handle)' : nodes
            },
            ReadableContentsFormat: formats.markdown
        };
    }

    function buildStringMdAndContext(response){
        var data = parseResponse(response);
        var string = data.string;
        var md =  '### Results for ' + command + ':\n' + string;
        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: md
        };
    }

    function buildParamsMd(response){
        var data = parseResponse(response);
        var resultParams= data.params;

        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown(command, resultParams)
        };
    }

    function buildDatabaseMetaMdContext(response){
        var data = parseResponse(response);
        var resultParams = data.params;
        if(!resultParams || resultParams.length === 0){
            return 'No results found';
        }

        // First element of the response
        var metaArray = resultParams[0]['MetaArray'];
        var dbFile = resultParams[0]['dbFile'];

        results = {};

        mapQueryResults(resultParams, results);
        var flattenedResult = [];
        for(var key in results){
            results[key]['MetaArray'] = metaArray;
            results[key]['dbFile'] = dbFile;
            flattenedResult.push(results[key]);
        }

        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown('Database dump meta', flattenedResult),
            EntryContext: {
                'NetWitness.DatabaseDump(val.sessionid == obj.sessionid)': flattenedResult
            },
            ReadableContentsFormat: formats.markdown
        };
    }

    function parseResponse(resp, isXml) {
        if (resp.StatusCode === 200) {
            try {
                var body = resp.Body;
                if(isXml){
                    body = x2j(body);
                }
                var res = JSON.parse(body);

                return res;
            } catch (e) {
                return body;
            }
        } else {
            err = resp.Status;
            if (resp.Body) {
                err += '\n' + resp.Body;
            }
            throw err;
        }
    }

    function createFileEntry(data, extension){
        var currentTime = new Date();
        var fileName = command + '_at_' + currentTime.getTime();
        if(extension){
            fileName += extension;
        }

        return {
            Type: 3,
            FileID: saveFile(data),
            File: fileName,
            Contents: fileName
        };
    }

    function parseDownloadResponse(resp) {
        if (resp.StatusCode === 200) {
            try {
                var extension;
                if(args && args.fileExt){
                    extension = args.fileExt;
                }
                return createFileEntry(resp.Bytes, extension);
            } catch (e) {
                return e;
            }
        } else {
            err = resp.Status;
            if (resp.Body) {
                err += '\n' + resp.Body;
            }
            throw err;
        }
    }

    function handleTimeFilter(args) {
        if(LAST_HOURS in args || LAST_MINUTES in args) {
            var now = new Date();
            var dt = new Date();
            if (args[LAST_HOURS]) {
                dt.setHours(dt.getHours() - parseInt(args[LAST_HOURS]))
            }
            if (args[LAST_MINUTES]) {
                dt.setMinutes(dt.getMinutes() - parseInt(args[LAST_MINUTES]))
            }
            var buildDateFormat = function () {
                return dt.toISOString().slice(0,19).replace('T',' ') + '"-"' + now.toISOString().slice(0,19).replace('T',' ') + '"';
            };
            //if query is empry string
            if(!args || !args[QUERY]) {
                args[QUERY] = 'select * where time = "' + buildDateFormat();
            }
            //if query has select and where statements
            else if(args[QUERY] && args[QUERY].toLowerCase().indexOf('select') > -1 && args[QUERY].toLowerCase().indexOf('where') > -1) {
                args[QUERY] = args[QUERY] + ' && time = "' + buildDateFormat();
            }
            //id query contains just select
            else if(args[QUERY] && args[QUERY].toLowerCase().indexOf('select') > -1) {
                args[QUERY] = args[QUERY] + ' where time = "' + buildDateFormat();
            }
        }
    }

    function encodeParams(p) {
        var q = '';
        if (p) {
            var argsToIgnore = {
                responseType: true,
                using: true
            };
            handleTimeFilter(p);
            var keys = Object.keys(p);
            if (keys.length > 0) {
                q = '&';
                for (var i = 0; i < keys.length; i++) {
                    if (argsToIgnore[keys[i]]) {
                        continue;
                    } else if (i !== 0) {
                        q += '&';
                    }
                    q += encodeURIComponent(keys[i]) + '=' + encodeURIComponent(p[keys[i]]);
                }
            }
        }
        return q;
    }

    function doReq(method, path, args, responseType, body) {
        var parametersUrl = encodeParams(args);
        var fullUrl = BASE_URL + path + parametersUrl;
        if(responseType){
            fullUrl += ('&force-content-type=' + responseType);
        }

        if (params.expiry) {
            fullUrl += '&expiry=' + params.expiry;
        }

        var res = http(
            fullUrl,
            {
                Method: method,
                Username: USER_NAME,
                Password: PASSWORD,
                Accept: responseType || '',
                Body: body || ''
            },
            !params.secure,
            params.proxy
        );

        if (res.StatusCode !== 200 && res.StatusCode !== 201) {
            throw 'Failed to perform request to: ' + fullUrl + '. StatusCode: ' + res.StatusCode + '. Status: ' + res.Status + '. Error: ' + res.Body;
        }

        return res;
    }

    function decoderImport(path) {
        var fileParam = args.entryID ? args.entryID : args.fileID;
        var fullUrl = BASE_URL + path;
        var res = httpMultipart(
            fullUrl,
            fileParam,
            { // HTTP Request Headers
                Method: 'POST',
                ContentType: 'appliaction/json',
                Accept: 'application/json',
                Username: USER_NAME,
                Password: PASSWORD
            },
            null,
            !params.secure,
            params.proxy
        );

        var data = parseResponse(res, true);

        return {
            Type: entryTypes.note,
            Contents: data,
            ContentsFormat: formats.json,
            HumanReadable: tableToMarkdown(command, data.import.data)
        };

    }

    var commandToPath = {
        'netwitness-msearch': '/sdk?msg=msearch',
        'netwitness-search': '/sdk?msg=search',
        'netwitness-query': '/sdk?msg=query',
        'netwitness-packets': '/sdk/packets?',
        'nw-sdk-session': '/sdk?msg=session',
        'nw-sdk-cancel': '/sdk?msg=cancel',
        'nw-sdk-query': '/sdk?msg=query',
        'nw-sdk-validate': '/sdk?msg=validate',
        'nw-sdk-aliases': '/sdk?msg=aliases',
        'nw-sdk-content': '/sdk/?msg=content',
        'nw-sdk-ls': '/sdk?msg=ls',
        'nw-sdk-count': '/sdk?msg=count',
        'nw-sdk-timeline': '/sdk?msg=timeline',
        'nw-sdk-mon': '/sdk?msg=mon',
        'nw-sdk-stopMon': '/sdk?msg=stopMon',
        'nw-sdk-msearch': '/sdk?msg=msearch',
        'nw-sdk-precache': '/sdk?msg=precache',
        'nw-sdk-delCache': '/sdk?msg=delCache',
        'nw-sdk-info': '/sdk?msg=info',
        'nw-sdk-search': '/sdk?msg=search',
        'nw-sdk-language': '/sdk?msg=language',
        'nw-sdk-packets': '/sdk?msg=packets',
        'nw-sdk-summary': '/sdk?msg=summary',
        'nw-sdk-reconfig': '/sdk?msg=reconfig',
        'nw-sdk-values': '/sdk?msg=values',
        'nw-sdk-xforms': '/sdk?msg=xforms',
        'nw-database-info': '/database?msg=info',
        'nw-database-count': '/database?msg=count',
        'nw-database-dbState': '/database?msg=dbState',
        'nw-database-dump': '/database?msg=dump',
        'nw-database-hashnw-loInfo': '/database?msg=hashInfo',
        'nw-database-resetMax': '/database?msg=resetMax',
        'nw-database-optimize': '/database?msg=optimize',
        'nw-database-reconfig': '/database?msg=reconfig',
        'nw-database-ls': '/database?msg=ls',
        'nw-database-timeRoll': '/database?msg=timeRoll',
        'nw-database-stopMon': '/database?msg=stopMon',
        'nw-database-manifest': '/database?msg=manifest',
        'nw-database-wipe': '/database?msg=wipe',
        'nw-database-sizeRoll': '/database?msg=sizeRoll',
        'nw-database-mon': '/database?msg=mon',
        'nw-decoder-reset': '/decoder?msg=reset',
        'nw-decoder-info': '/decoder?msg=info',
        'nw-decoder-reconfig': '/decoder?msg=reconfig',
        'nw-decoder-agg': '/decoder?msg=agg',
        'nw-decoder-stop': '/decoder?msg=stop',
        'nw-decoder-count': '/decoder?msg=count',
        'nw-decoder-start': '/decoder?msg=start',
        'nw-decoder-meta': '/decoder?msg=meta',
        'nw-decoder-ls': '/decoder?msg=ls',
        'nw-decoder-stopMon': '/decoder?msg=stopMon',
        'nw-decoder-resetMax': '/decoder?msg=resetMax',
        'nw-decoder-whoAgg': '/decoder?msg=whoAgg',
        'nw-decoder-logStats': '/decoder?msg=logStats',
        'nw-decoder-select': '/decoder?msg=select',
        'nw-decoder-mon': '/decoder?msg=mon',
        'nw-index-ls': '/index?msg=ls',
        'nw-index-mon': '/index?msg=mon',
        'nw-index-save': '/index?msg=save',
        'nw-index-info': '/index?msg=info',
        'nw-index-drop': '/index?msg=drop',
        'nw-index-count': '/index?msg=count',
        'nw-index-values': '/index?msg=values',
        'nw-index-profile': '/index?msg=profile',
        'nw-index-stopMon': '/index?msg=stopMon',
        'nw-index-inspect': '/index?msg=inspect',
        'nw-index-language': '/index?msg=language',
        'nw-index-reconfig': '/index?msg=reconfig',
        'nw-index-sizeRoll': '/index?msg=sizeRoll',
        'nw-decoderParsers-ls': '/decoder/parsers?msg=ls',
        'nw-decoderParsers-mon': '/decoder/parsers?msg=mon',
        'nw-decoderParsers-feed': '/decoder/parsers?msg=feed',
        'nw-decoderParsers-info': '/decoder/parsers?msg=info',
        'nw-decoderParsers-count': '/decoder/parsers?msg=count',
        'nw-decoderParsers-schema': '/decoder/parsers?msg=schema',
        'nw-decoderParsers-reload': '/decoder/parsers?msg=reload',
        'nw-decoderParsers-upload': '/decoder/parsers?msg=upload',
        'nw-decoderParsers-delete': '/decoder/parsers?msg=delete',
        'nw-decoderParsers-stopMon': '/decoder/parsers?msg=stopMon',
        'nw-decoderParsers-devices': '/decoder/parsers?msg=devices',
        'nw-decoderParsers-content': '/decoder/parsers?msg=content',
        'nw-decoderParsers-ipdevice': '/decoder/parsers?msg=ipdevice',
        'nw-decoderParsers-iptmzone': '/decoder/parsers?msg=iptmzone',
        'nw-logs-ls': '/logs?msg=ls',
        'nw-logs-mon': '/logs?msg=mon',
        'nw-logs-pull': '/logs?msg=pull',
        'nw-logs-info': '/logs?msg=info',
        'nw-logs-count': '/logs?msg=count',
        'nw-logs-stopMon': '/logs?msg=stopMon',
        'nw-logs-download': '/logs?msg=download',
        'nw-logs-timeRoll': '/logs?msg=timeRoll',
        'nw-sys-ls': '/sys?msg=ls',
        'nw-sys-mon': '/sys?msg=mon',
        'nw-sys-save': '/sys?msg=save',
        'nw-sys-info': '/sys?msg=info',
        'nw-sys-count': '/sys?msg=count',
        'nw-sys-caCert': '/sys?msg=caCert',
        'nw-sys-stopMon': '/sys?msg=stopMon',
        'nw-sys-shutdown': '/sys?msg=shutdown',
        'nw-sys-fileEdit': '/sys?msg=fileEdit',
        'nw-sys-peerCert': '/sys?msg=peerCert',
        'nw-sys-servCert': '/sys?msg=servCert',
        'nw-sys-statHist': '/sys?msg=statHist',
        'nw-users-ls': '/users?msg=ls',
        'nw-users-mon': '/users?msg=mon',
        'nw-users-info': '/users?msg=info',
        'nw-users-auths': '/users?msg=auths',
        'nw-users-count': '/users?msg=count',
        'nw-users-delete': '/users?msg=delete',
        'nw-users-unlock': '/users?msg=unlock',
        'nw-users-stopMon': '/users?msg=stopMon',
        'nw-users-addOrMod': '/users?msg=addOrMod',
        'nw-concentrator-ls': '/concentrator?msg=ls',
        'nw-concentrator-add': '/concentrator?msg=add',
        'nw-concentrator-mon': '/concentrator?msg=mon',
        'nw-concentrator-meta': '/concentrator?msg=meta',
        'nw-concentrator-info': '/concentrator?msg=info',
        'nw-concentrator-help': '/concentrator?msg=help',
        'nw-concentrator-stop': '/concentrator?msg=stop',
        'nw-concentrator-edit': '/concentrator?msg=edit',
        'nw-concentrator-reset': '/concentrator?msg=reset',
        'nw-concentrator-count': '/concentrator?msg=count',
        'nw-concentrator-start': '/concentrator?msg=start',
        'nw-concentrator-delete': '/concentrator?msg=delete',
        'nw-concentrator-whoAgg': '/concentrator?msg=whoAgg',
        'nw-concentrator-status': '/concentrator?msg=status',
        'nw-concentrator-stopMon': '/concentrator?msg=stopMon',
        'nw-concentrator-reconfig': '/concentrator?msg=reconfig',
        'nw-concentrator-resetMax': '/concentrator?msg=resetMax',
        'nw-broker-ls': '/broker?msg=ls',
        'nw-broker-add': '/broker?msg=add',
        'nw-broker-mon': '/broker?msg=mon',
        'nw-broker-meta': '/broker?msg=meta',
        'nw-broker-info': '/broker?msg=info',
        'nw-broker-help': '/broker?msg=help',
        'nw-broker-stop': '/broker?msg=stop',
        'nw-broker-edit': '/broker?msg=edit',
        'nw-broker-reset': '/broker?msg=reset',
        'nw-broker-count': '/broker?msg=count',
        'nw-broker-start': '/broker?msg=start',
        'nw-broker-delete': '/broker?msg=delete',
        'nw-broker-whoAgg': '/broker?msg=whoAgg',
        'nw-broker-status': '/broker?msg=status',
        'nw-broker-stopMon': '/broker?msg=stopMon',
        'nw-broker-reconfig': '/broker?msg=reconfig',
        'nw-broker-resetMax': '/broker?msg=resetMax'
    };


    // The command input arg holds the command sent from the user.
    switch (command) {
        // This is the call made when pressing the integration test button.
        case 'test-module':
            doReq('GET', '/sdk?msg=help&op=messages');
            return true;
        case 'nw-decoder-import':
            return decoderImport('/decoder/import');
        case 'netwitness-packets':
            return parseDownloadResponse(doReq('GET', commandToPath[command], args));
        case 'nw-sdk-content':
            return parseDownloadResponse(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['octet-stream']));
        case 'netwitness-msearch':
        case 'netwitness-search':
            return buildMSearchMdAndContext(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        case 'netwitness-query':
            return buildQueryMdAndContext(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        case 'nw-sdk-timeline':
            return buildTimelineMdAndContext(doReq('GET', commandToPath[command], RESPONSE_TYPES['json']));
        case 'nw-sdk-values':
            return buildValuesMdAndContext(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        case 'nw-sdk-info':
        case 'nw-sdk-ls':
        case 'nw-broker-ls':
        case 'nw-concentrator-ls':
        case 'nw-database-info':
        case 'nw-database-ls':
        case 'nw-decoder-info':
        case 'nw-decoder-ls':
        case 'nw-decoderParsers-info':
        case 'nw-decoderParsers-ls':
        case 'nw-index-info':
        case 'nw-index-ls':
        case 'nw-logs-info':
        case 'nw-logs-ls':
        case 'nw-sys-info':
        case 'nw-sys-ls':
        case 'nw-users-info':
        case 'nw-users-ls':
            return buildNodeMdAndContext(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        case 'nw-decoderParsers-ipdevice':
        case 'nw-sdk-validate':
        case 'nw-users-unlock':
        case 'nw-sdk-summary':
            return buildStringMdAndContext(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        case 'nw-sdk-session':
        case 'nw-logs-pull':
        case 'nw-decoder-logStats':
            return buildParamsMd(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        case 'nw-database-dump':
            return buildDatabaseMetaMdContext(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
        default:
            return parseResponse(doReq('GET', commandToPath[command], args, RESPONSE_TYPES['json']));
    }
  type: javascript
  commands:
  - name: netwitness-msearch
    arguments:
    - name: sessions
      description: <string> The session ID ranges to search
    - name: packets
      description: <string> The packet ID ranges to search
    - name: search
      required: true
      description: '<string> The search string to use. Example: "select hit, pretext,
        posttext where keyword=’netwitness’ sp ci ds". sp = Search Packets ci = Case
        Insensitive ds = Decode Sessions (e.g., convert email attachments before searching).
        For regular expressions, change “keyword” to “regex” '
    - name: where
      description: <string> The where clause used to identify sessions to consider
        for the search
    - name: limit
      description: <uint64> The maximum number of sessions to traverse for this search
    - name: flags
      description: <string> Flags to use for search.  This is a comma separated list
        of one or more of the flag values regex, sp(scan raw packet data), sm(scan
        all metadata), si(index lookup for all search parametes before scanning meta),
        ci(case insensitive)
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator IP
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    outputs:
    - contextPath: NetWitness.SearchHits.hit
      description: all search hits in netwitness
    description: Search for pattern matches in many sessions or packets
  - name: netwitness-search
    deprecated: true
    arguments:
    - name: session
      required: true
      description: <uint64> The session id to search
    - name: size
      required: true
      description: <uint32, {range:1 to 1677721}> The max number of entries to return
    - name: search
      required: true
      description: <string> The search string to use
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator address
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    outputs:
    - contextPath: NetWitness.SearchHits
      description: all search hits in netwitness
    description: Searches for matches in session/packet content
  - name: netwitness-query
    arguments:
    - name: id1
      description: <uint64> The starting meta id (to run the query from most recent
        to oldest meta, make id1 larger than id2)
    - name: id2
      description: <uint64> The ending meta id
    - name: size
      description: <uint32> The max number of entries to return, or just stream back
        all results if zero
    - name: query
      description: <string> The query string to use
    - name: flags
      description: <string> The flags to use for query.  Can be a number (bitwise
        mask) or comma separated values like query-log.
    - name: threshold
      description: <uint64> Query optimization to stop processing results after the
        threshold is reached (useful with select aggregate functions).  Zero means
        no threshold (the default).
    - name: lastHours
      description: <uint64> Filter by last hours
    - name: lastMinutes
      description: <uint64> Filter by last minutes
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator address
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    outputs:
    - contextPath: NetWitness.Events.ipSrc
      description: Source IP
    - contextPath: NetWitness.Events.aliasIp
      description: Destination IP
    - contextPath: NetWitness.Events.aliasHost
      description: describes hostname or FQDN.
    - contextPath: NetWitness.Events.ipDst
      description: IP Destination of the event
    - contextPath: NetWitness.Events.userSrc
      description: Source user
    - contextPath: NetWitness.Events.userDst
      description: Destination user
    - contextPath: NetWitness.Events.username
      description: Field includes any username meta available – both source and destination
        – as defined by the user. This is an optional field that will only appear
        if configured by the end user.
    - contextPath: NetWitness.Events.service
      description: Field describes the service that created the session (if available)
    - contextPath: NetWitness.Events.sessionid
      description: NW Specific field that contains a NW specific ‘serial number’ of
        the Session. Allows a user to specify a session to retrieve from a Concentrator.
    - contextPath: NetWitness.Events.deviceType
      description: Field describes the type of system that generated a log message
        (ex. SQUID / Windows / rhlinux)
    - contextPath: NetWitness.Events.direction
      description: 'Traffic flow direction (e.g. Inbound/outbound) '
    - contextPath: NetWitness.Events.did
      description: Specific Decoder a session was captured on
    - contextPath: NetWitness.Events.ioc
      description: Endpoint specific meta that describes malware on an endpoint.
    description: Performs a query against the meta database
  - name: netwitness-packets
    arguments:
    - name: op
      auto: PREDEFINED
      predefined:
      - start
      - cancel
      - processed
      description: <string, {enum-one:start|cancel|processed}> The operation to perform
        (start, cancel, processed)
    - name: sessions
      required: true
      description: <string> A comma separated list of session ids or session id ranges
        (#-#) whose packets will be streamed back.
    - name: packets
      description: <string> A comma separated list of packet ids or session/packet
        ids (#&#) that will be streamed back.
    - name: where
      description: <string> Where clause which will be evaluated to determine which
        sessions to stream back
    - name: time1
      description: <date-time> A starting time range (UTC) where matching packets
        will be streamed back ("2010-Apr-20 09:00:00")
    - name: time2
      description: <date-time> An ending time range (UTC) where matching packets will
        be streamed back ("2010-Apr-20 10:00:00")
    - name: flags
      description: <uint32> Additional flags as defined by the NwPackets SDK function
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator address
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    - name: render
      description: <string> The render type - pcap, logs, logs (csv), logs (xml) or
        logs (json)
    description: Stream packets back based on the input parameters provided
  - name: nw-sdk-session
    arguments:
    - name: id1
      required: true
      description: <uint64> The starting session id
    - name: id2
      required: true
      description: <uint64> The ending session id
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator IP
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    description: Retrieves the meta id range for the session range
  - name: nw-sdk-content
    arguments:
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator IP
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    - name: session
      required: true
      description: <uint64> The session id that will be returned in the response.
    - name: renderType
      auto: PREDEFINED
      predefined:
      - text
      - hex
      - packets
      - web
      - mail
      - raw
      - rtp
      - voip
      - meta
      - im
      - files
      - pcap
      - filelist
      description: '<string> The render type (defined in NwSDK.h) for content or one
        of the following render types: text, hex, packets, web, mail, raw, rtp, voip,
        meta, im, files or pcap'
    - name: maxSize
      description: <uint64> The maximum size of the session returned (bytes), zero
        is unlimited. Default is zero.
    - name: base64
      description: <binary> If 1, encode the multipart/mixed response as base64. Otherwise
        binary is the default.
    - name: flags
      description: <string> Optional flags for content rendering, see the SDK header
        file NwContent flags parameter for more info.
    - name: includeFileTypes
      description: <string> Semicolon separated list of file extensions that will
        be extracted (e.g. .ext1;.ext2).
    - name: excludeFileTypes
      description: <string> Semicolon separated list of file extensions that will
        be excluded (e.g. .ext1;.ext2).
    - name: renameFileTypes
      description: '<string> Used to rename certain files from one or more extensions
        to another. For example: renameFileTypes=.download|.octet-stream|.program|.exe;.jpeg|.jpg'
    - name: fileExt
      description: <string> Extension of the file (e.g. .zip, .exe etc.)
    - name: where
      description: <string> Where clause which will be evaluated to determine which
        sessions to stream back
    - name: subdirFileTypes
      description: <string> Group these files into the specified directory, e.g. documents=.doc;.xls;.pdf;
        images=.png;.gif;.jpg;.jpeg;
    - name: maxDirSize
      description: <uint32> Once the toplevel directory exceeds this size, the oldest
        files will get cleaned up.
    - name: renderFlags
      description: ' <uint32> Bitwise mask to control options, (see NwContentFlags
        in NwSDK.h)'
    description: Returns the packet content for a session
  - name: nw-sdk-summary
    arguments:
    - name: flags
      description: <string> Optional SDK flags.  Can be a number (bitwise mask) or
        comma separated values like default or ignore-cache.
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator IP
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    description: Retrieves summary information from the databases
  - name: nw-sdk-values
    arguments:
    - name: id1
      description: <uint64> The starting meta id
    - name: id2
      description: <uint64> The ending meta id
    - name: size
      description: <uint32, {range:1 to 1677721}> The max number of entries to return,
        default 100
      defaultValue: "100"
    - name: flags
      description: <string> The flags to use for values.  Can be a number (bitwise
        mask) or comma separated values like sessions, size, packets, aggregate, sort-total,
        sort-value, order-ascending, order-descending, ignore-cache, clear-cache,
        query-log or database-scan.
    - name: threshold
      description: <uint64> Query optimization to stop processing large session counts
    - name: fieldName
      required: true
      description: <string> The field to retrieve values for
    - name: where
      description: <string> The filter criteria for the values
    - name: aggregateFunction
      description: <string, {enum-one:count|sum}> The aggregate operation to be applied
        where the aggregate flag is set
    - name: aggregateFieldName
      description: <string> The meta field to aggregate in the aggregateFunction
    - name: min
      description: <string> The lower limit of values to return.  Only values greater
        than this value will be returned.
    - name: max
      description: <string> The upper limit of values to return.  Only values less
        than this value will be returned.
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator IP
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    outputs:
    - contextPath: NetWitness.Values.ipSrc
      description: Source IP
    - contextPath: NetWitness.Values.aliasIp
      description: Destination IP
    - contextPath: NetWitness.Values.aliasHost
      description: describes hostname or FQDN.
    - contextPath: NetWitness.Values.ipDst
      description: IP Destination of the event
    - contextPath: NetWitness.Values.userSrc
      description: Source user
    - contextPath: NetWitness.Values.userDst
      description: Destination user
    - contextPath: NetWitness.Values.username
      description: Field includes any username meta available – both source and destination
        – as defined by the user. This is an optional field that will only appear
        if configured by the end user.
    - contextPath: NetWitness.Values.service
      description: Field describes the service that created the session (if available)
    - contextPath: NetWitness.Values.sessionid
      description: NW Specific field that contains a NW specific ‘serial number’ of
        the Session. Allows a user to specify a session to retrieve from a Concentrator.
    - contextPath: NetWitness.Values.deviceType
      description: Field describes the type of system that generated a log message
        (ex. SQUID / Windows / rhlinux)
    - contextPath: NetWitness.Values.direction
      description: 'Traffic flow direction (e.g. Inbound/outbound) '
    - contextPath: NetWitness.Values.did
      description: Specific Decoder a session was captured on
    - contextPath: NetWitness.Values.ioc
      description: Endpoint specific meta that describes malware on an endpoint.
    description: Performs a value count query and returns the matching values for
      a report
  - name: nw-database-dump
    arguments:
    - name: session
      required: true
      description: <uint64> The session id to dump
    - name: type
      description: <string, {enum-one:db|nwd}> The dump type
    - name: source
      description: <string, {enum-any:s|m|p}> The types of data to dump, default is
        m
      defaultValue: m
    - name: verbose
      description: <bool> If true (default is false), dumps more information
    - name: file
      description: <string> Optional filename to use for NWD type, otherwise filename
        is assumed to be _sessionid_.nwd
    - name: concentratorIP
      description: <string> Use the instance that is mapped to this concentrator IP
    - name: concentratorPort
      description: <uint32> Port to use with concentratorIP, 50105 for Non SSL and
        56105 for SSL
    description: Dumps information out of the database in nwd formatted files
fromversion: 3.5.0
