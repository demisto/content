category: Database
commonfields:
  id: MongoDBKeyValueStore
  version: -1
configuration:
- display: MongoDB Username
  name: credentials
  required: true
  type: 9
- display: URI (mongodb://<IP/FQDN>:<Port Number>)
  name: uri
  required: true
  type: 0
- defaultvalue: demisto
  display: MongoDB Database Name
  name: database
  required: true
  type: 0
- defaultvalue: generic
  display: MongoDB Collection Name
  name: collection
  required: true
  type: 0
description: Manipulates key/value pairs by incident - utilizing the MongoDB collection
  named "generic".
display: MongoDBKeyValueStore
name: MongoDBKeyValueStore
script:
  commands:
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    - default: false
      description: Assign a Value for the Name/Key
      isArray: false
      name: value
      required: true
      secret: false
    deprecated: false
    description: Adds a key/value record for the incident.  If the key exists, any
      existing value will be overwritten.
    execution: false
    name: mongodb-write-key-value
    outputs:
    - contextPath: MongoDB.Entry.ID
      description: Entry ID.
      type: String
    - contextPath: MongoDB.Entry.Incident
      description: Incident ID.
      type: String
    - contextPath: MongoDB.Entry.Key
      description: Incident key.
      type: String
    - contextPath: MongoDB.Entry.Value
      description: Incident value.
      type: String
    - contextPath: MongoDB.Entry.Modified
      description: Incident modified date.
      type: Date
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    deprecated: false
    description: Returns an Incident's Value stored for the specified Name/Key.
    execution: false
    name: mongodb-get-key-value
    outputs:
    - contextPath: MongoDB.Entry.Incident
      description: Incident ID.
      type: String
    - contextPath: MongoDB.Entry.Key
      description: Incident key.
      type: String
    - contextPath: MongoDB.Entry.Value
      description: The value of the key.
      type: String
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Lists the keys and their values assigned for specified incident.
    execution: false
    name: mongodb-list-key-values
    outputs:
    - contextPath: MongoDB.Incident.Incident
      description: Incident ID.
      type: String
    - contextPath: MongoDB.Incident.Key
      description: Incident key.
      type: String
    - contextPath: MongoDB.Incident.Value
      description: The value of the key.
      type: String
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    deprecated: false
    description: Deletes the key/value record for an incident.
    execution: false
    name: mongodb-delete-key
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Purges ALL key/values for an incident.  Possibly called when closing
      an incident to clear entries from database.
    execution: false
    name: mongodb-purge-keys
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    deprecated: false
    description: Returns the key/value with last modified timestamp.
    execution: false
    name: mongodb-get-key-info
    outputs:
    - contextPath: MongoDB.Entry.Key
      description: The entry key.
      type: String
    - contextPath: MongoDB.Entry.Modified
      description: Entry modified time.
      type: Date
    - contextPath: MongoDB.Entry.Value
      description: The value of the key.
      type: String
    - contextPath: MongoDB.Entry.Incident
      description: Incident ID.
      type: String
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Returns the number of key/value pairs for an incident.
    execution: false
    name: mongodb-get-keys-number
  dockerimage: demisto/mongoclient1:latest
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
