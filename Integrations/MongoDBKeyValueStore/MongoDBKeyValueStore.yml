category: Database
commonfields:
  id: MongoDBKeyValueStore
  version: -1
configuration:
- display: MongoDB Username
  name: credentials
  required: true
  type: 9
- defaultvalue: mongodb://172.16.202.134:27017
  display: mongodb://<IP/FQDN>:<Port Number>
  name: URI
  required: true
  type: 0
- defaultvalue: demisto
  display: MongoDB Database Name
  name: DB
  required: true
  type: 0
- defaultvalue: generic
  display: MongoDB Collection Name
  name: COLLECTION
  required: true
  type: 0
description: "Manipulates key/value pairs by incident - utilizing the MongoDB collection\
  \ named \"generic\". \n\nThis Integration needs to be run in a Docker container\
  \ which has the pymongo dependency added.\n\nIntegration uses SCRAM-SHA-1 authentication\
  \ to the backend Mongo database, but functions with noauth as well (MongoDB configuration).\
  \  This was limited by the supported pymongo, further limited by the Python version\
  \ supported by Demisto (read: Wanted to use SCRAM-SHA-256)."
display: MongoDBKeyValueStore
name: MongoDBKeyValueStore
script:
  commands:
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    - default: false
      description: Assign a Value for the Name/Key
      isArray: false
      name: value
      required: true
      secret: false
    deprecated: false
    description: Adds a key/value record for the incident.  If the key exists, any
      existing value will be overwritten.
    execution: false
    name: WriteKeyValue
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    deprecated: false
    description: Returns an Incident's Value stored for the specified Name/Key.
    execution: false
    name: GetKeyValue
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Lists the keys and their values assigned for specified incident.
    execution: false
    name: ListKeyValues
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    deprecated: false
    description: Deletes the key/value record for an incident.
    execution: false
    name: DeleteKey
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Purges ALL key/values for an incident.  Possibly called when closing
      an incident to clear entries from database.
    execution: false
    name: PurgeKeys
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name/Key
      isArray: false
      name: key
      required: true
      secret: false
    deprecated: false
    description: Returns the key/value with last modified timestamp.
    execution: false
    name: GetKeyInfo
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Returns the number of key/value pairs for an incident.
    execution: false
    name: NumKeys
  dockerimage: demisto/mongoclient1:latest
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
