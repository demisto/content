commonfields:
  id: AWS Sagemaker
  version: -1
name: AWS Sagemaker
display: AWS Sagemaker
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,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
description: AWS Sagemaker - Demisto Phishing Email Classifier
configuration:
- display: AWS access key
  name: AWSAccessKey
  defaultvalue: ""
  type: 0
  required: true
- display: AWS secret key
  name: AWSSecretKey
  defaultvalue: ""
  type: 4
  required: true
- display: AWS Region code
  name: AWSRegion
  defaultvalue: us-east-2
  type: 0
  required: false
- display: Endpoint Name
  name: EndpointName
  defaultvalue: ""
  type: 0
  required: true
script:
  script: |-
    import json, boto3, sys

    def invoke_enpoint(runtime, endpoint_name, payload):
        return runtime.invoke_endpoint(EndpointName=ENDPOINT_NAME, ContentType='application/json', Body=json.dumps(payload, ensure_ascii=False).encode('utf-8', 'ignore'))

    runtime = boto3.Session(aws_access_key_id=demisto.params()['AWSAccessKey'],
    aws_secret_access_key=demisto.params()['AWSSecretKey'],
    region_name=demisto.params()['AWSRegion']).client('runtime.sagemaker')
    ENDPOINT_NAME = demisto.params()['EndpointName']

    def parse_results(result):
        res = []
        for r in result:
            res.append({
                'Label': r['label'][0],
                'Probability': r['probability']
            })
        return res

    if demisto.command() == 'test-module':
        response = invoke_enpoint(runtime, ENDPOINT_NAME, ["test"])
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
            demisto.results('ok')
        sys.exit(0)
    if demisto.command() == 'predict-phishing':
        input_text = demisto.args()['inputText']
        if type(input_text) != list:
           input_text = [input_text]
        response = invoke_enpoint(runtime, ENDPOINT_NAME, input_text)
        if response['ResponseMetadata']['HTTPStatusCode'] != 200:
            raise Exception("Failed to invoke enpoint")
        result = json.loads(response['Body'].read().decode())
        predictions = parse_results(result)

        context = {
            "DBotPhishingPrediction": predictions
        }
        demisto.results({
                  'ContentsFormat': formats['json'],
                  'Type': entryTypes['note'],
                  'Contents': predictions,
                  'EntryContext':context,
                  "HumanReadable": tableToMarkdown('DBot label suggestion', predictions),
                  "HumanReadableFormat" : formats["markdown"]
        })
        sys.exit(0)
  type: python
  commands:
  - name: predict-phishing
    arguments:
    - name: inputText
      description: The input text (usually email subject + body)
    outputs:
    - contextPath: DBotPhishingPrediction.Label
      description: The predicated label
      type: string
    - contextPath: DBotPhishingPrediction.Probability
      description: The predication probability
      type: number
  dockerimage: demisto/boto3
  runonce: false
releaseNotes: "Add new integration"
tests:
- Test_Sagemaker