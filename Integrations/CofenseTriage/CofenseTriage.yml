category: Data Enrichment & Threat Intelligence
commonfields:
  id: Cofense Triage
  version: -1
configuration:
- display: Server URL (e.g., https://192.168.0.1)
  name: host
  required: true
  type: 0
- display: User
  name: user
  required: true
  type: 0
- display: API Token
  name: token
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: 3 days
  display: First fetch time (<number> <time unit>, e.g., 12 hours, 7 days, 3 months,
    1 year)
  name: date_range
  required: false
  type: 0
- display: Category ID to fetch - corresponds to the ranking that determines the Cofense
    Triage prioritization (1-5)
  name: category_id
  required: false
  type: 0
- display: Match Priority - the highest match priority based on rule hits for the
    report
  name: match_priority
  required: false
  type: 0
- display: Tags - CSV list of tags of processed reports by which to filter
  name: tags
  required: false
  type: 0
- defaultvalue: '30'
  display: Maximum number of incidents to fetch each time
  name: max_fetch
  required: false
  type: 0
- defaultvalue: 'false'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Use the Cofense Triage integration to manage reports and attachments.
display: Cofense Triage
name: Cofense Triage
script:
  commands:
  - arguments:
    - default: false
      description: File hash, MD5 or SHA256.
      isArray: false
      name: file_hash
      required: false
      secret: false
    - default: false
      description: The reported URLs.
      isArray: false
      name: url
      required: false
      secret: false
    - default: false
      description: Report's subject
      isArray: false
      name: subject
      required: false
      secret: false
    - default: false
      defaultValue: 60 days
      description: 'Retrieve reports that were reported after this time, for example:
        "2 hours, 4 minutes, 6 month, 1 day".'
      isArray: false
      name: reported_at
      required: false
      secret: false
    - default: false
      defaultValue: 60 days
      description: 'Retrieve reports that were created after this time, for example:
        "2 hours, 4 minutes, 6 month, 1 day".'
      isArray: false
      name: created_at
      required: false
      secret: false
    - default: false
      description: Name or ID of the reporter.
      isArray: false
      name: reporter
      required: false
      secret: false
    - default: true
      defaultValue: '30'
      description: Maximum number of matches to fetch. Default is 30.
      isArray: false
      name: max_matches
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Returns all fields of a report.
      isArray: false
      name: verbose
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    deprecated: false
    description: Runs a query for reports.
    execution: false
    name: cofense-search-reports
    outputs:
    - contextPath: Report.ID
      description: ID number of the report.
      type: Unknown
    - contextPath: Report.EmailAttachments
      description: Email attachments.
      type: Unknown
    - contextPath: Report.EmailAttachments.id
      description: Email attachment ID.
      type: Unknown
    - contextPath: Report.Tags
      description: Report tags.
      type: string
    - contextPath: Report.ClusterId
      description: Cluster ID number.
      type: number
    - contextPath: Report.CategoryId
      description: Report category.
      type: number
    - contextPath: Report.CreatedAt
      description: Report creation date.
      type: date
    - contextPath: Report.ReportedAt
      description: Reporting time.
      type: string
    - contextPath: Report.MatchPriority
      description: The highest match priority based on rule hits for the report.
      type: number
    - contextPath: Report.ReporterId
      description: Reporter ID.
      type: number
    - contextPath: Report.Location
      description: Location of the report.
      type: string
    - contextPath: Report.Reporter
      description: Reporter email address.
      type: string
    - contextPath: Report.SuspectFromAddress
      description: Suspect from address.
      type: string
    - contextPath: Report.ReportSubject
      description: Report subject.
      type: string
    - contextPath: Report.ReportBody
      description: Report body.
      type: string
    - contextPath: Report.Md5
      description: MD5 hash of the file.
      type: number
    - contextPath: Report.Sha256
      description: SHA256 hash of the file.
      type: Unknown
  - arguments:
    - default: false
      description: ID of the attachment.
      isArray: false
      name: attachment_id
      required: true
      secret: false
    deprecated: false
    description: Retrieves an attachment by the attachment ID number.
    execution: false
    name: cofense-get-attachment
    outputs:
    - contextPath: Attachment.ID
      description: The ID number of the report that contains the attachment.
      type: string
    - contextPath: File.Size
      description: The date and time (in UTC) when the threat was found on the device.
      type: string
    - contextPath: File.EntryID
      description: The file path where the threat was found on the device.
      type: string
    - contextPath: File.Name
      description: The name of the threat.
      type: string
    - contextPath: File.SHA1
      description: The SHA1 hash of the threat.
      type: string
    - contextPath: File.SHA256
      description: The SHA256 hash of the threat.
      type: string
    - contextPath: File.MD5
      description: The MD5 hash of the threat.
      type: string
  - arguments:
    - default: false
      description: ID of the reporter.
      isArray: false
      name: reporter_id
      required: true
      secret: false
    deprecated: false
    description: Retrieves Email address of the reporter by ID
    execution: false
    name: cofense-get-reporter
    outputs:
    - contextPath: Report.ID
      description: ID of the reporter.
      type: Unknown
    - contextPath: Report.Email
      description: Reporter email address.
      type: Unknown
  - arguments:
    - default: false
      description: ID of the report
      isArray: false
      name: report_id
      required: true
      secret: false
    deprecated: false
    description: Retrieves a report by the report ID number.
    execution: false
    name: cofense-get-report-by-id
    outputs:
    - contextPath: Report.ID
      description: ID number of the report
      type: Unknown
    - contextPath: Report.EmailAttachments
      description: Email attachments.
      type: Unknown
    - contextPath: Report.EmailAttachments.id
      description: Email attachment ID.
      type: Unknown
    - contextPath: Report.Tags
      description: Report tags.
      type: string
    - contextPath: Report.ClusterId
      description: Cluster ID number.
      type: number
    - contextPath: Report.CategoryId
      description: Report category.
      type: number
    - contextPath: Report.CreatedAt
      description: Report creation date.
      type: date
    - contextPath: Report.ReportedAt
      description: Reporting time.
      type: string
    - contextPath: Report.MatchPriority
      description: The highest match priority based on rule hits for the report.
      type: number
    - contextPath: Report.ReporterId
      description: Reporter ID.
      type: number
    - contextPath: Report.Location
      description: Location of the report.
      type: string
    - contextPath: Report.Reporter
      description: Reporter email address.
      type: string
    - contextPath: Report.SuspectFromAddress
      description: Suspect from address.
      type: string
    - contextPath: Report.ReportSubject
      description: Report subject.
      type: string
    - contextPath: Report.ReportBody
      description: Report body.
      type: string
    - contextPath: Report.Md5
      description: MD5 hash of the file.
      type: number
    - contextPath: Report.Sha256
      description: SHA256 hash of the file.
      type: Unknown
  dockerimage: demisto/python3:3.7.2.200
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- Cofense Triage Test
