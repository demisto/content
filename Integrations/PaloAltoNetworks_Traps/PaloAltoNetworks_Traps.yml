category: Authentication
commonfields:
  id: Traps
  version: -1
configuration:
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Server URL
  name: url
  required: true
  type: 0
- display: Application ID
  name: application_id
  required: true
  type: 0
- display: Private Key
  name: private_key
  required: false
  type: 14
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Endpoint protection and response stops threats on endpoints and coordinates
  enforcement with network and cloud security to prevent successful cyberattacks.
display: Palo Alto Networks Traps
name: Traps
script:
  commands:
  - arguments:
    - default: false
      description: Endpoint ID.
      isArray: true
      name: endpoint_id
      required: true
      secret: false
    deprecated: false
    description: Get endpoint details by agent id.
    execution: false
    name: traps-get-endpoint-by-id
    outputs:
    - contextPath: Traps.Endpoint.ID
      description: Endpoint ID.
      type: String
    - contextPath: Traps.Endpoint.Name
      description: Endpoint name.
      type: String
    - contextPath: Traps.Endpoint.Domain
      description: Endpoint domain.
      type: date
    - contextPath: Traps.Endpoint.Platform
      description: The OS of the endpoint.
      type: String
    - contextPath: Traps.Endpoint.Status
      description: Endpoint status.
      type: String
    - contextPath: Traps.Endpoint.IP
      description: Endpoint IP.
      type: String
    - contextPath: Traps.Endpoint.ComputerSid
      description: Computer SID.
      type: String
    - contextPath: Traps.Endpoint.IsCompromised
      description: 'Is compremised. '
      type: String
    - contextPath: Traps.Endpoint.OsVersion
      description: Endpoint OS versoin.
      type: String
    - contextPath: Traps.Endpoint.OsProductType
      description: Endpoint OS type.
      type: String
    - contextPath: Traps.Endpoint.OsProductName
      description: Endpoint OS name.
      type: String
    - contextPath: Traps.Endpoint.Is64
      description: Is the endpoint 64b or 32b.
      type: StringIsCompromised
    - contextPath: Traps.Endpoint.LastSeen
      description: Last active ping.
      type: String
    - contextPath: Traps.Endpoint.LastUser
      description: Last active user on the machine.
      type: String
  - arguments:
    - default: false
      description: Endpoint ID.
      isArray: false
      name: endpoint_id
      required: true
      secret: false
    - default: false
      description: File name to retrieve (including path)
      isArray: false
      name: file_name
      required: true
      secret: false
    - default: false
      description: Event ID.
      isArray: false
      name: event_id
      required: true
      secret: false
    deprecated: false
    description: Execute a file retrieve action / SAM on specified agent.
    execution: false
    name: traps-endpoint-files-retrieve
    outputs:
    - contextPath: Traps.FileRetrieve.EndpointID
      description: Endpoint ID.
      type: String
    - contextPath: Traps.FileRetrieve.OperationID
      description: Operation ID. Use this to retrieve status / results.
      type: String
    - contextPath: Traps.FileRetrieve.Type
      description: Operation type.
      type: String
  - arguments:
    - default: false
      description: Endpoint ID.
      isArray: false
      name: endpoint_id
      required: true
      secret: false
    deprecated: false
    description: Perform scan operation on specified endpoint.
    execution: false
    name: traps-endpoint-scan
    outputs:
    - contextPath: Traps.Scan.EndpointID
      description: Endpoint ID.
      type: String
    - contextPath: Traps.Scan.OperationID
      description: Operation ID. Use this to retrieve status / results.
      type: String
    - contextPath: Traps.Scan.Type
      description: Operation type.
      type: String
  - arguments:
    - default: false
      description: Event ID.
      isArray: false
      name: event_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Event status.
      isArray: false
      name: status
      predefined:
      - new
      - investigating
      - closed
      required: false
      secret: false
    - default: false
      description: Event comment.
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Change status and add a comment to an existing event.
    execution: false
    name: traps-event-update
  - arguments:
    - default: false
      description: Event IDs.
      isArray: true
      name: event_ids
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Event status.
      isArray: false
      name: status
      predefined:
      - new
      - investigating
      - closed
      required: true
      secret: false
    deprecated: false
    description: Change the status of multiple events.
    execution: false
    name: traps-event-bulk-update-status
  - arguments:
    - default: false
      description: Hash ID (MD5)
      isArray: false
      name: hash_id
      required: true
      secret: false
    deprecated: false
    description: Blacklist specified hash.
    execution: false
    name: traps-hash-blacklist
    outputs:
    - contextPath: Traps.File.BlacklistStatus
      description: blacklisted / none.
      type: String
    - contextPath: Traps.File.MD5
      description: File MD5.
      type: String
  - arguments:
    - default: false
      description: Hash ID (MD5)
      isArray: false
      name: hash_id
      required: true
      secret: false
    deprecated: false
    description: Remove a given hash from blacklist.
    execution: false
    name: traps-hash-blacklist-remove
    outputs:
    - contextPath: Traps.File.BlacklistStatus
      description: blacklisted / none.
      type: String
    - contextPath: Traps.File.MD5
      description: File MD5.
      type: String
  - arguments:
    - default: false
      description: List of hash IDs (MD5)
      isArray: true
      name: hash_ids
      required: true
      secret: false
    deprecated: false
    description: Get blacklist status of guven hashes.
    execution: false
    name: traps-hashes-blacklist-status
    outputs:
    - contextPath: Traps.File.BlacklistStatus
      description: blacklisted / none.
      type: String
    - contextPath: Traps.File.MD5
      description: File MD5.
      type: String
  - arguments:
    - default: false
      description: Event ID.
      isArray: false
      name: event_id
      required: true
      secret: false
    deprecated: false
    description: Create quarantine entry for given event.
    execution: false
    name: traps-event-quarantine
    outputs:
    - contextPath: Traps.Quarantine.EventID
      description: Event ID.
      type: String
    - contextPath: Traps.Quarantine.OperationID
      description: Operation ID. Use this to retrieve status / results.
      type: String
    - contextPath: Traps.Quarantine.Type
      description: Operation type.
      type: String
  - arguments:
    - default: false
      description: Endpoint ID.
      isArray: false
      name: endpoint_id
      required: true
      secret: false
    deprecated: false
    description: Isolate an endpoint.
    execution: false
    name: traps-endpoint-isolate
    outputs:
    - contextPath: Traps.Isolate.EndpointID
      description: Endpoint ID.
      type: String
    - contextPath: Traps.Isolate.OperationID
      description: Operation ID. Use this to retrieve status / results.
      type: String
    - contextPath: Traps.Isolate.Type
      description: Operation type.
      type: String
  - arguments:
    - default: false
      description: Operation ID. Use this to retrieve status / results.
      isArray: false
      name: operation_id
      required: true
      secret: false
    deprecated: false
    description: Get result of event quarantine operation.
    execution: false
    name: traps-event-quarantine-result
    outputs:
    - contextPath: Traps.QuarantineResult.MD5
      description: File MD5.
      type: String
    - contextPath: Traps.QuarantineResult.FilePath
      description: File path on endpoint.
      type: String
    - contextPath: Traps.QuarantineResult.OperationID
      description: peration ID.
      type: String
    - contextPath: Traps.QuarantineResult.Status
      description: Quarantine status.
      type: String
  - arguments:
    - default: false
      description: Operation ID. Use this to retrieve status / results.
      isArray: false
      name: operation_id
      required: true
      secret: false
    deprecated: false
    description: Status of endpoint isolate operation.
    execution: false
    name: traps-endpoint-isolate-status
    outputs:
    - contextPath: Traps.IsolateResult.OperationID
      description: Operation ID. Use this to retrieve status / results.
      type: String
    - contextPath: Traps.IsolateResult.Status
      description: Isolation status.
      type: String
  - arguments:
    - default: false
      description: Operation ID. Use this to retrieve status / results.
      isArray: false
      name: operation_id
      required: true
      secret: false
    deprecated: false
    description: Get endpoint file retrieve result.
    execution: false
    name: traps-endpoint-files-retrieve-result
  - arguments:
    - default: false
      description: Operation ID. Use this to retrieve status / results.
      isArray: false
      name: operation_id
      required: true
      secret: false
    deprecated: false
    description: Get results of an endpoint scam operation.
    execution: false
    name: traps-endpoint-scan-result
    outputs:
    - contextPath: Traps.ScanResult.FileScanned
      description: Amount of scanned files.
      type: Number
    - contextPath: Traps.ScanResult.FilesFailed
      description: Amount of failed files.
      type: Number
    - contextPath: Traps.ScanResult.MalwareFound
      description: Amount of malware found
      type: Number
    - contextPath: Traps.ScanResult.OperationID
      description: Operation ID. Use this to retrieve status / results.
      type: String
    - contextPath: Traps.ScanResult.Status
      description: Scan status
      type: String
  dockerimage: demisto/pyjwt3:1.0.0.1284
  subtype: python3
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
- Traps test
