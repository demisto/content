commonfields:
  id: AWS - CloudTrail
  version: -1
name: AWS - CloudTrail
display: AWS - CloudTrail
category: IT Services
image: data:image/png;base64,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
description: Amazon Web Services CloudTrail.
configuration:
- display: Default Region
  name: defaultRegion
  defaultvalue: ""
  type: 0
  required: true
- display: Role Arn
  name: roleArn
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Name
  name: roleSessionName
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Duration
  name: sessionDuration
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |-
    import boto3
    import datetime

    AWS_DEFAULT_REGION = demisto.params()['defaultRegion']
    AWS_roleArn = demisto.params()['roleArn']
    AWS_roleSessionName = demisto.params()['roleSessionName']
    AWS_roleSessionDuration = demisto.params()['sessionDuration']
    AWS_rolePolicy = None

    def aws_session(service='cloudtrail',region=None,roleArn=None,roleSessionName=None,roleSessionDuration=None,rolePolicy=None):
        kwargs = {}
        if roleArn and roleSessionName is not None:
            kwargs.update({
                'RoleArn':roleArn,
                'RoleSessionName':roleSessionName,
                })
        elif AWS_roleArn and AWS_roleSessionName is not None:
            kwargs.update({
                'RoleArn':AWS_roleArn,
                'RoleSessionName':AWS_roleSessionName,
                })

        if roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(roleSessionDuration)})
        elif AWS_roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(AWS_roleSessionDuration)})

        if rolePolicy is not None:
            kwargs.update({'Policy':rolePolicy})
        elif AWS_rolePolicy is not None:
            kwargs.update({'Policy':AWS_rolePolicy})

        if kwargs:
            sts_client = boto3.client('sts')
            sts_response = sts_client.assume_role(**kwargs)
            if region is not None:
                client = boto3.client(
                    service_name=service,
                    region_name=region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
            else:
                client = boto3.client(
                    service_name=service,
                    region_name=AWS_DEFAULT_REGION,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
        else:
            if region is not None:
                client = boto3.client(service_name=service,region_name=region)
            else:
                client = boto3.client(service_name=service,region_name=AWS_DEFAULT_REGION)

        return client

    class DatetimeEncoder(json.JSONEncoder):
      def default(self, obj):
        if isinstance (obj, datetime.datetime):
            return obj.strftime ('%Y-%m-%dT%H:%M:%S')
        elif isinstance (obj, datetime.date):
            return obj.strftime ('%Y-%m-%d')
        elif isinstance(obj, datetime):
            return obj.strftime('%Y-%m-%dT%H:%M:%S')
        elif isinstance(obj, date):
            return obj.strftime('%Y-%m-%d')
        # Let the base class default method raise the TypeError
        return json.JSONEncoder.default(self, obj)

    def parse_resource_ids(resource_id):
        id_list = resource_id.replace(" ", "")
        resourceIds = id_list.split(",")
        return resourceIds

    def create_entry(title,data, ec):
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': data,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, data) if data else 'No result were found',
            'EntryContext': ec
        }

    def raise_error(error):
        return {
            'Type' : entryTypes['error'],
            'ContentsFormat' : formats['text'],
            'Contents' : str(error)
        }

    def create_trail(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            obj = vars(client._client_config)
            kwargs = {
                'Name':args.get('name'),
                'S3BucketName':args.get('s3BucketName'),
            }

            if args.get('s3KeyPrefix') is not None:
                kwargs.update({'S3KeyPrefix':args.get('s3KeyPrefix')})
            if args.get('snsTopicName') is not None:
                kwargs.update({'SnsTopicName':args.get('snsTopicName')})
            if args.get('includeGlobalServiceEvents') is not None:
                kwargs.update({'IncludeGlobalServiceEvents':True if args.get('includeGlobalServiceEvents') == 'True'  else False})
            if args.get('isMultiRegionTrail') is not None:
                kwargs.update({'IsMultiRegionTrail':True if args.get('isMultiRegionTrail') == 'True'  else False})
            if args.get('enableLogFileValidation') is not None:
                kwargs.update({'EnableLogFileValidation':True if args.get('enableLogFileValidation') == 'True'  else False})
            if args.get('cloudWatchLogsLogGroupArn') is not None:
                kwargs.update({'CloudWatchLogsLogGroupArn':args.get('cloudWatchLogsLogGroupArn')})
            if args.get('cloudWatchLogsRoleArn') is not None:
                kwargs.update({'CloudWatchLogsRoleArn':args.get('cloudWatchLogsRoleArn')})
            if args.get('kmsKeyId') is not None:
                kwargs.update({'KmsKeyId':args.get('kmsKeyId')})

            response = client.create_trail(**kwargs)

            data = ({
                'Name': response['Name'],
                'S3BucketName': response['S3BucketName'],
                'IncludeGlobalServiceEvents': response['IncludeGlobalServiceEvents'],
                'IsMultiRegionTrail': response['IsMultiRegionTrail'],
                'TrailARN': response['TrailARN'],
                'LogFileValidationEnabled':response['LogFileValidationEnabled'],
                'HomeRegion': obj['_user_provided_options']['region_name']
            })
            if 'SnsTopicName' in response:
                data.updtae({'SnsTopicName':response['SnsTopicName']})
            if 'S3KeyPrefix' in response:
                data.updtae({'S3KeyPrefix':response['S3KeyPrefix']})
            if 'SnsTopicARN' in response:
                data.updtae({'SnsTopicARN':response['SnsTopicARN']})
            if 'CloudWatchLogsLogGroupArn' in response:
                data.updtae({'CloudWatchLogsLogGroupArn':response['CloudWatchLogsLogGroupArn']})
            if 'CloudWatchLogsRoleArn' in response:
                data.updtae({'CloudWatchLogsRoleArn':response['CloudWatchLogsRoleArn']})
            if 'KmsKeyId' in response:
                data.updtae({'KmsKeyId':response['KmsKeyId']})

            ec = {'AWS.CloudTrail.Trails(val.Name == obj.Name)': data}
            return create_entry('AWS CloudTrail Trails',data, ec)


        except Exception as e:
            return raise_error(e)

    def delete_trail(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {'Name':args.get('name')}

            response = client.delete_trail(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Trail {0} was deleted".format(args.get('name'))

        except Exception as e:
            return raise_error(e)


    def describe_trails(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {}
            data =[]
            output = []
            if args.get('trailNameList') is not None:
                kwargs.update({'trailNameList':parse_resource_ids(args.get('trailNameList'))})
            if args.get('includeShadowTrails') is not None:
                kwargs.update({'includeShadowTrails':True if args.get('includeShadowTrails') == 'True'  else False})

            response = client.describe_trails(**kwargs)
            for trail in response['trailList']:
                data.append({
                    'Name': trail['Name'],
                    'S3BucketName': trail['S3BucketName'],
                    'IncludeGlobalServiceEvents': trail['IncludeGlobalServiceEvents'],
                    'IsMultiRegionTrail': trail['IsMultiRegionTrail'],
                    'TrailARN': trail['TrailARN'],
                    'LogFileValidationEnabled': trail['LogFileValidationEnabled'],
                    'HomeRegion': trail['HomeRegion'],
                })
                output.append(trail)

            raw = json.loads(json.dumps(output))
            ec = {'AWS.CloudTrail.Trails(val.Name == obj.Name)': raw}
            return  create_entry('AWS CloudTrail Trails',data, ec)


        except Exception as e:
            return raise_error(e)

    def update_trail(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            obj = vars(client._client_config)
            kwargs = {
                'Name':args.get('name'),
            }

            if args.get('s3BucketName') is not None:
                kwargs.update({'S3BucketName':args.get('s3BucketName')})
            if args.get('s3KeyPrefix') is not None:
                kwargs.update({'S3KeyPrefix':args.get('s3KeyPrefix')})
            if args.get('snsTopicName') is not None:
                kwargs.update({'SnsTopicName':args.get('snsTopicName')})
            if args.get('includeGlobalServiceEvents') is not None:
                kwargs.update({'IncludeGlobalServiceEvents':True if args.get('includeGlobalServiceEvents') == 'True'  else False})
            if args.get('isMultiRegionTrail') is not None:
                kwargs.update({'IsMultiRegionTrail':True if args.get('isMultiRegionTrail') == 'True'  else False})
            if args.get('enableLogFileValidation') is not None:
                kwargs.update({'EnableLogFileValidation':True if args.get('enableLogFileValidation') == 'True'  else False})
            if args.get('cloudWatchLogsLogGroupArn') is not None:
                kwargs.update({'CloudWatchLogsLogGroupArn':args.get('cloudWatchLogsLogGroupArn')})
            if args.get('cloudWatchLogsRoleArn') is not None:
                kwargs.update({'CloudWatchLogsRoleArn':args.get('cloudWatchLogsRoleArn')})
            if args.get('kmsKeyId') is not None:
                kwargs.update({'KmsKeyId':args.get('kmsKeyId')})

            response = client.update_trail(**kwargs)

            data = ({
                'Name': response['Name'],
                'S3BucketName': response['S3BucketName'],
                'IncludeGlobalServiceEvents': response['IncludeGlobalServiceEvents'],
                'IsMultiRegionTrail': response['IsMultiRegionTrail'],
                'TrailARN': response['TrailARN'],
                'LogFileValidationEnabled':response['LogFileValidationEnabled'],
                'HomeRegion': obj['_user_provided_options']['region_name']
            })
            if 'SnsTopicName' in response:
                data.updtae({'SnsTopicName':response['SnsTopicName']})
            if 'S3KeyPrefix' in response:
                data.updtae({'S3KeyPrefix':response['S3KeyPrefix']})
            if 'SnsTopicARN' in response:
                data.updtae({'SnsTopicARN':response['SnsTopicARN']})
            if 'CloudWatchLogsLogGroupArn' in response:
                data.updtae({'CloudWatchLogsLogGroupArn':response['CloudWatchLogsLogGroupArn']})
            if 'CloudWatchLogsRoleArn' in response:
                data.updtae({'CloudWatchLogsRoleArn':response['CloudWatchLogsRoleArn']})
            if 'KmsKeyId' in response:
                data.updtae({'KmsKeyId':response['KmsKeyId']})

            ec = {'AWS.CloudTrail.Trails(val.Name == obj.Name)': data}
            return  create_entry('AWS CloudTrail Trails',data, ec)


        except Exception as e:
            return raise_error(e)

    def start_logging(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {'Name':args.get('name')}

            response = client.start_logging(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Trail {0} started logging".format(args.get('name'))

        except Exception as e:
            return raise_error(e)

    def stop_logging(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {'Name':args.get('name')}

            response = client.stop_logging(**kwargs)

            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Trail {0} stopped logging".format(args.get('name'))

        except Exception as e:
            return raise_error(e)


    def lookup_events(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {
                'LookupAttributes':[{
                    'AttributeKey': args.get('attributeKey'),
                    'AttributeValue': args.get('attributeValue')
                }]
            }

            if args.get('startTime') is not None:
                kwargs.update({'StartTime':datetime.datetime.strptime(args.get('startTime'), "%Y-%m-%dT%H:%M:%S")})
            if args.get('endTime') is not None:
                kwargs.update({'EndTime':datetime.datetime.strptime(args.get('endTime'), "%Y-%m-%dT%H:%M:%S")})


            response = client.lookup_events(**kwargs)
            paginator = client.get_paginator('lookup_events')
            for response in paginator.paginate(**kwargs):
                for event in response['Events']:
                    data.append({
                        'EventId': event['EventId'],
                        'EventName': event['EventName'],
                        'EventTime': datetime.datetime.strftime(event['EventTime'], '%Y-%m-%dT%H:%M:%S'),
                        'EventSource': event['EventSource'],
                        'Username': event['Username'],
                        'ResourceName':event['Resources'][0]['ResourceName'],
                        'ResourceType':event['Resources'][0]['ResourceType'],
                        'CloudTrailEvent': event['CloudTrailEvent']
                    })
            ec = {'AWS.CloudTrail.Trails(val.Name == obj.Name)': data}
            return  create_entry('AWS CloudTrail Trails',data, ec)

        except Exception as e:
            return raise_error(e)


    def test_function():
        try:
            client = aws_session()
            response = client.describe_trails()
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'ok'

        except Exception as error:
            return error

    if demisto.command() == 'test-module':
        # This is the call made when pressing the integration test button.
        result = test_function()

    if demisto.command() == 'aws-cloudtrail-create-trail':
        result = create_trail(demisto.args())

    if demisto.command() == 'aws-cloudtrail-delete-trail':
        result = delete_trail(demisto.args())

    if demisto.command() == 'aws-cloudtrail-describe-trails':
        result = describe_trails(demisto.args())

    if demisto.command() == 'aws-cloudtrail-update-trail':
        result = update_trail(demisto.args())

    if demisto.command() == 'aws-cloudtrail-start-logging':
        result = start_logging(demisto.args())

    if demisto.command() == 'aws-cloudtrail-stop-logging':
        result = stop_logging(demisto.args())

    if demisto.command() == 'aws-cloudtrail-lookup-events':
        result = lookup_events(demisto.args())

    demisto.results(result)
    sys.exit(0)
  type: python
  commands:
  - name: aws-cloudtrail-create-trail
    arguments:
    - name: name
      required: true
      description: Specifies the name of the trail.
    - name: s3BucketName
      required: true
      description: Specifies the name of the Amazon S3 bucket designated for publishing
        log files.
    - name: s3KeyPrefix
      description: Specifies the Amazon S3 key prefix that comes after the name of
        the bucket you have designated for log file delivery.
    - name: snsTopicName
      description: Specifies the name of the Amazon SNS topic defined for notification
        of log file delivery.
    - name: includeGlobalServiceEvents
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether the trail is publishing events from global services
        such as IAM to the log files.
    - name: isMultiRegionTrail
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether the trail is created in the current region or
        in all regions. The default is false.
    - name: enableLogFileValidation
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether log file integrity validation is enabled. The
        default is false.
    - name: cloudWatchLogsLogGroupArn
      description: Specifies a log group name using an Amazon Resource Name (ARN),
        a unique identifier that represents the log group to which CloudTrail logs
        will be delivered. Not required unless you specify CloudWatchLogsRoleArn.
    - name: cloudWatchLogsRoleArn
      description: Specifies the role for the CloudWatch Logs endpoint to assume to
        write to a user's log group.
    - name: kmsKeyId
      description: Specifies the KMS key ID to use to encrypt the logs delivered by
        CloudTrail. The value can be an alias name prefixed by "alias/", a fully specified
        ARN to an alias, a fully specified ARN to a key, or a globally unique identifier.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudTrail.Trails.Name
      description: Specifies the name of the trail.
      type: string
    - contextPath: AWS.CloudTrail.Trails.S3BucketName
      description: Specifies the name of the Amazon S3 bucket designated for publishing
        log files.
      type: string
    - contextPath: AWS.CloudTrail.Trails.IncludeGlobalServiceEvents
      description: Specifies whether the trail is publishing events from global services
        such as IAM to the log files.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.IsMultiRegionTrail
      description: Specifies whether the trail exists in one region or in all regions.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.TrailARN
      description: Specifies the ARN of the trail that was created.
      type: string
    - contextPath: AWS.CloudTrail.Trails.LogFileValidationEnabled
      description: Specifies whether log file integrity validation is enabled.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.SnsTopicARN
      description: Specifies the ARN of the Amazon SNS topic that CloudTrail uses
        to send notifications when log files are delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trails.S3KeyPrefix
      description: pecifies the Amazon S3 key prefix that comes after the name of
        the bucket you have designated for log file delivery.
      type: string
    - contextPath: AWS.CloudTrail.Trails.CloudWatchLogsLogGroupArn
      description: Specifies the Amazon Resource Name (ARN) of the log group to which
        CloudTrail logs will be delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trails.CloudWatchLogsRoleArn
      description: Specifies the role for the CloudWatch Logs endpoint to assume to
        write to a user's log group.
      type: string
    - contextPath: AWS.CloudTrail.Trails.KmsKeyId
      description: Specifies the KMS key ID that encrypts the logs delivered by CloudTrail.
      type: string
    - contextPath: AWS.CloudTrail.Trails.HomeRegion
      description: The region in which the trail was created.
      type: string
    description: Creates a trail that specifies the settings for delivery of log data
      to an Amazon S3 bucket. A maximum of five trails can exist in a region, irrespective
      of the region in which they were created.
    execution: true
  - name: aws-cloudtrail-delete-trail
    arguments:
    - name: name
      required: true
      description: 'Specifies the name or the CloudTrail ARN of the trail to be deleted.
        The format of a trail ARN is: arn:aws:cloudtrail:us-east-1:123456789012:trail/MyTrail'
    description: Deletes a trail. This operation must be called from the region in
      which the trail was created. DeleteTrail cannot be called on the shadow trails
      (replicated trails in other regions) of a trail that is enabled in all regions.
    execution: true
  - name: aws-cloudtrail-describe-trails
    arguments:
    - name: trailNameList
      description: Specifies a list of trail names, trail ARNs, or both, of the trails
        to describe. If an empty list is specified, information for the trail in the
        current region is returned.
    - name: includeShadowTrails
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether to include shadow trails in the response. A shadow
        trail is the replication in a region of a trail that was created in a different
        region. The default is true.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudTrail.Trails.Name
      description: Name of the trail set by calling CreateTrail.
      type: string
    - contextPath: AWS.CloudTrail.Trails.S3BucketName
      description: Name of the Amazon S3 bucket into which CloudTrail delivers your
        trail files.
      type: string
    - contextPath: AWS.CloudTrail.Trails.S3KeyPrefix
      description: Specifies the Amazon S3 key prefix that comes after the name of
        the bucket you have designated for log file delivery.
      type: string
    - contextPath: AWS.CloudTrail.Trails.SnsTopicARN
      description: Specifies the ARN of the Amazon SNS topic that CloudTrail uses
        to send notifications when log files are delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trails.IncludeGlobalServiceEvents
      description: Set to True to include AWS API calls from AWS global services such
        as IAM. Otherwise, False.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.IsMultiRegionTrail
      description: Specifies whether the trail belongs only to one region or exists
        in all regions.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.HomeRegion
      description: The region in which the trail was created.
      type: string
    - contextPath: AWS.CloudTrail.Trails.TrailARN
      description: Specifies the ARN of the trail.
      type: string
    - contextPath: AWS.CloudTrail.Trails.LogFileValidationEnabled
      description: Specifies whether log file validation is enabled.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.CloudWatchLogsLogGroupArn
      description: Specifies an Amazon Resource Name (ARN), a unique identifier that
        represents the log group to which CloudTrail logs will be delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trails.CloudWatchLogsRoleArn
      description: Specifies the role for the CloudWatch Logs endpoint to assume to
        write to a user's log group.
      type: string
    - contextPath: AWS.CloudTrail.KmsKeyId
      description: Specifies the KMS key ID that encrypts the logs delivered by CloudTrail.
      type: string
    - contextPath: AWS.CloudTrail.HasCustomEventSelectors
      description: Specifies if the trail has custom event selectors.
      type: boolean
    description: Retrieves settings for the trail associated with the current region
      for your account.
  - name: aws-cloudtrail-update-trail
    arguments:
    - name: name
      required: true
      description: Specifies the name of the trail or trail ARN.
    - name: s3BucketName
      description: Specifies the name of the Amazon S3 bucket designated for publishing
        log files.
    - name: s3KeyPrefix
      description: Specifies the Amazon S3 key prefix that comes after the name of
        the bucket you have designated for log file delivery.
    - name: snsTopicName
      description: Specifies the name of the Amazon SNS topic defined for notification
        of log file delivery.
    - name: includeGlobalServiceEvents
      description: Specifies whether the trail is publishing events from global services
        such as IAM to the log files.
    - name: isMultiRegionTrail
      description: Specifies whether the trail applies only to the current region
        or to all regions. The default is false. If the trail exists only in the current
        region and this value is set to true, shadow trails (replications of the trail)
        will be created in the other regions. If the trail exists in all regions and
        this value is set to false, the trail will remain in the region where it was
        created, and its shadow trails in other regions will be deleted.
    - name: enableLogFileValidation
      description: Specifies whether log file validation is enabled. The default is
        false.
    - name: cloudWatchLogsLogGroupArn
      description: Specifies a log group name using an Amazon Resource Name (ARN),
        a unique identifier that represents the log group to which CloudTrail logs
        will be delivered. Not required unless you specify CloudWatchLogsRoleArn.
    - name: cloudWatchLogsRoleArn
      description: Specifies the role for the CloudWatch Logs endpoint to assume to
        write to a user's log group.
    - name: kmsKeyId
      description: Specifies the KMS key ID to use to encrypt the logs delivered by
        CloudTrail.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudTrail.Trails.Name
      description: Specifies the name of the trail.
      type: string
    - contextPath: AWS.CloudTrail.Trails.S3BucketName
      description: Specifies the name of the Amazon S3 bucket designated for publishing
        log files.
      type: string
    - contextPath: AWS.CloudTrail.Trails.IncludeGlobalServiceEvents
      description: Specifies whether the trail is publishing events from global services
        such as IAM to the log files.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.IsMultiRegionTrail
      description: Specifies whether the trail exists in one region or in all regions.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.TrailARN
      description: Specifies the ARN of the trail that was created.
      type: string
    - contextPath: AWS.CloudTrail.Trails.LogFileValidationEnabled
      description: Specifies whether log file integrity validation is enabled.
      type: boolean
    - contextPath: AWS.CloudTrail.Trails.SnsTopicARN
      description: Specifies the ARN of the Amazon SNS topic that CloudTrail uses
        to send notifications when log files are delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trails.S3KeyPrefix
      description: pecifies the Amazon S3 key prefix that comes after the name of
        the bucket you have designated for log file delivery.
      type: string
    - contextPath: AWS.CloudTrail.Trails.CloudWatchLogsLogGroupArn
      description: Specifies the Amazon Resource Name (ARN) of the log group to which
        CloudTrail logs will be delivered.
      type: string
    - contextPath: AWS.CloudTrail.Trails.CloudWatchLogsRoleArn
      description: Specifies the role for the CloudWatch Logs endpoint to assume to
        write to a user's log group.
      type: string
    - contextPath: AWS.CloudTrail.Trails.KmsKeyId
      description: Specifies the KMS key ID that encrypts the logs delivered by CloudTrail.
      type: string
    - contextPath: AWS.CloudTrail.Trails.HomeRegion
      description: The region in which the trail was created.
      type: string
    description: Updates the settings that specify delivery of log files. Changes
      to a trail do not require stopping the CloudTrail service.
    execution: true
  - name: aws-cloudtrail-start-logging
    arguments:
    - name: name
      required: true
      description: Specifies the name or the CloudTrail ARN of the trail for which
        CloudTrail logs AWS API calls.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Starts the recording of AWS API calls and log file delivery for a
      trail. For a trail that is enabled in all regions, this operation must be called
      from the region in which the trail was created. This operation cannot be called
      on the shadow trails (replicated trails in other regions) of a trail that is
      enabled in all regions.
    execution: true
  - name: aws-cloudtrail-stop-logging
    arguments:
    - name: name
      required: true
      description: Specifies the name or the CloudTrail ARN of the trail for which
        CloudTrail logs AWS API calls.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Suspends the recording of AWS API calls and log file delivery for
      the specified trail. Under most circumstances, there is no need to use this
      action. You can update a trail without stopping it first. This action is the
      only way to stop recording. For a trail enabled in all regions, this operation
      must be called from the region in which the trail was created, or an InvalidHomeRegionException
      will occur. This operation cannot be called on the shadow trails (replicated
      trails in other regions) of a trail enabled in all regions.
    execution: true
  - name: aws-cloudtrail-lookup-events
    arguments:
    - name: attributeKey
      required: true
      auto: PREDEFINED
      predefined:
      - EventId
      - EventName
      - Username
      - ResourceType
      - ResourceName
      - EventSource
      description: Specifies an attribute on which to filter the events returned.
    - name: attributeValue
      required: true
      description: Specifies a value for the specified AttributeKey.
    - name: startTime
      description: Specifies that only events that occur after or at the specified
        time are returned.
    - name: endTime
      description: Specifies that only events that occur before or at the specified
        time are returned.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudTrail.Trails.Events.EventId
      description: The CloudTrail ID of the event returned.
      type: string
    - contextPath: AWS.CloudTrail.Trails.Events.EventName
      description: The name of the event returned.
      type: string
    - contextPath: AWS.CloudTrail.Trails.Events.EventTime
      description: The date and time of the event returned.
      type: date
    - contextPath: AWS.CloudTrail.Trails.Events.EventSource
      description: The AWS service that the request was made to.
      type: string
    - contextPath: AWS.CloudTrail.Trails.Events.Username
      description: A user name or role name of the requester that called the API in
        the event returned.
      type: string
    - contextPath: AWS.CloudTrail.Trails.Events.ResourceName
      description: 'The type of a resource referenced by the event returned. When
        the resource type cannot be determined, null is returned. Some examples of
        resource types are: Instance for EC2, Trail for CloudTrail, DBInstance for
        RDS, and AccessKey for IAM. '
      type: string
    - contextPath: AWS.CloudTrail.Trails.Events.ResourceType
      description: The name of the resource referenced by the event returned. These
        are user-created names whose values will depend on the environment. For example,
        the resource name might be "auto-scaling-test-group" for an Auto Scaling Group
        or "i-1234567" for an EC2 Instance.
      type: string
    - contextPath: AWS.CloudTrail.Trails.Events.CloudTrailEvent
      description: A JSON string that contains a representation of the event returned.
      type: string
    description: Looks up API activity events captured by CloudTrail that create,
      update, or delete resources in your account. Events for a region can be looked
      up for the times in which you had CloudTrail turned on in that region during
      the last seven days.
  dockerimage: demisto/boto3
  runonce: false
tests:
  - No test
