commonfields:
  id: fireeye
  version: -1
name: fireeye
fromversion: 3.0.0
display: FireEye (AX Series)
category: Forensics & Malware Analysis
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAAAhCAYAAADqBZQaAAAACXBIWXMAAAsTAAALEwEAmpwYAAA5o2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTYtMDItMTZUMjA6MzU6MDQrMDI6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNi0wMy0wN1QxOTozNDo1OCswMjowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTYtMDMtMDdUMTk6MzQ6NTgrMDI6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6NjcyNWNjN2EtMWIwNi00YmFkLWE5NWYtOGZhYjhlOTM2MzkyPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjU3NjcwNUE4QUJGRDExRTRBNkRGQTdERTVEODg4RERDPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOjU3NjcwNUE1QUJGRDExRTRBNkRGQTdERTVEODg4RERDPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOjU3NjcwNUE2QUJGRDExRTRBNkRGQTdERTVEODg4RERDPC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6NTc2NzA1QThBQkZEMTFFNEE2REZBN0RFNUQ4ODhEREM8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjY3MjVjYzdhLTFiMDYtNGJhZC1hOTVmLThmYWI4ZTkzNjM5Mjwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMy0wN1QxOTozNDo1OCswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjExNTwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zMzwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+v9TwCwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAKLklEQVR42uyae3BU1R3HP+fuZjck5AmJIIKKWkUpoC2+sHUc1Ep9V2oVtUWpWKtWKVZGW7XWtmqtM2KLtTi+Kg8piEhVBHxMBx/1gVqLaAvKK0AeELPJ5rXJ3tM/7nfluu5uNiES2tnfzJ3N3px7zrm/x/f3/f3Omo8OHksvSDEwAniD/wMxuk7fvJV1sXZ928v26DjgfH5fToHj4Oz+3FFgEjCMnPSZOCujzcQs9Hcc8o0hz/TIC13gTeDSnEr7TgLPNMVZ2BSlyXUJYmi3lv3yggDEuzfXf4DpwBqg5v8BZudFmqiPx/dOmDUGkgLPwEDA6jIUOA7nFBUxpbSEEeEQnUCL62a7xpPAduDqXM7sg5y5a/sOYGhxLfMiDZy5pYqLtm5nebSZQsfJ9nUc4NAc4PWNBNPZpMW1vNzcxNutLYQHD+akwgJaXBebAbKBQ4BVObX2EQHqIqXS5FqmbNvOnIYI+ZmZ71HAvsBs4HLgyJx69ypjehDcYeHG2loWRBoJGZMOcs8DHgVqgd8BhTn17nXG3DX0hppqZtU3MDAQSDZoULnyHn2WAmNz6t1rjekN/2N9Pb/asZMixyG0ixoPBaqArcAg3ZsODM+peK81pqHVwsydO7lk63aqOjopdRzyjKlX4yAP+ArwEyACLMSrfXKyZ0qqnurapTwQ5MKSYr5fUsKwUHBsp6XOWmvisKHd2tHAS0A9MAFYn6szv9w60+xe4HjNhmInyMWlxRyVn48DFAcCjAqHcbFHA88CHcB3gH90gRIhTZqNvts1tgIoEPFq7V1jVrEuFks2pslyj/8zxjR4JyUFXn1p42CjDqbJxeXSkjJurayg1boYGA28oOdOAd5LM+cRwDzVq4EuauN64GygGngKOAc4HXiut4yZ7ximV9eyqLHRn43OBH4NtHWxR4B+wDVCpz1izGA3ns8HjhVkjgUOVvmhJqFpd+F9cOY/29z82NXx8iEVwcCxza670MDJeqlngOOALSnmD8ugAaCxC2OGfcos0meotxRlAdfC1LIynmlqps1+FohlwCj93dkF/gbk8HsqK7jZROYhwCXy/q+mGRMHNgvmwuB+dFZR4bR7Bw2+OG7Ji2NvAr4tyF0EfDfFHEcC7wCbgPEyaCZnqxHpGgNUAu8Cdb2ppSLHYUZNLXMikUR0TgLmAm8D58pgJkPaqAZavpzINOA4RsF1EPBSJmUNBX4K/BDo7zNaAzDAN+514Aawb4KNgQmAOX5pU2T0oeHQndMHVKz+NB5fa2AOMBO4FjgNeD5DYOwQG85GPlakNyahSKXyag1QApwAHIh3gP6Wb2x/4HDgMCFNnZxqY8xad3JpKYsao/7oRE5bleX+yrVGi94rnVQqbdUnvcs+2t8QocF64EPr2mbjkC87VQIDU5UmJcBvgLXAddrIZuBPwDgZJCEfehHrvrJPMBi7cWAFS4fuF58zZN9VX8svevKt1tbWNtd90IFb5al3iAxN7AI2ulMyPS4lneK7901gI/CQjLRaEP8H4Ee+cRcD78vAjwH3q5xaB8xtt7by8HCIicVFAoEelXRHa753gP3TjBkJfCAn298H6ffLWV/Se87XmH8C51rXbQWeFtq9E0zC+IvwFD8caNIETwMrfd5yhe+Ze8HWji/sz8xB+1AecAIxa6cEjflgWF7w1ajrEocq6+XXY4HXgL8Dx0ghbhrI7uyGssIpFJyAv4O1/wpgie6t9zU1fq/15khhTVLmZOACYHjM2tPOLy76dE6kMRk9spUVeAf3J2je21KMuUL1+BLgXzLk3xQ8Wzw987F4wTjZaTGunWKt+7AJONV+MjEGuF3evQO4S16xOQ0BSbzQ+wBTy0opDzg0uu71QJG1dvbgYJCAMbRbe5rZBSOoPLlcUNjyheLVg42VGQhGId656e0Zi2BPDgVeAU4Ctvn+P0bog9LIo0nPPyAnGN9u7fUjwqGfjwyHWdPeltjSGEWzk4Gk7VCOrQMekTEvA2Ylwe1+cpzEumhv4xSBE/DOiBPyZ2C5HPAOrF1hO+NVGG/R8wU/JarVTgQ+yqCotT44LAWv8d7pOesE4B4jd49be7XxXqAD+ETPNQKxNFGZ6CId04W3v5tlVETwfsqyLen+uXLih1MYEqAZuBkYb+HCkGPu6ueYxsQBvlLPURnIT0C5OuH4fxX/OEIl1UO+sWcrKl+UkQbgHVq4wNQkQyZkLnCWbDcRuBfrLfa4oOd2scj7NFlTmo0+BcxQM30SuM8vi0Y5qbCADuNuilk7H1hgvF/rHadnHkxEsXq3G1WrpfLoKtVzkTRs1ukGOVqfpvM0ypfPVqQoa6yU2QEcaC0jXHjDZ7u31QRJx2aNkKVW36NCullyrkc0fz8ZLBFxKDVUiGTd6Cs9/NIuLgBwvGD4M2W9DpwKTBNJeVmW35Zio/9WJN/sEQhnyV8ijYvbLMwYUH794LxgKXBZ1HWJWdskFvsz3/PfkEOkk05gQzcMlknS/YypwEf2QmkaAFYELy8FnLamqZUzySLpbBzwLWCZdDwK7/dTy3zs2mhPY7R+ug7YZqHIF5oGLt4R1mJ50Rol5oUpJrtFMHUD8ETc8sv5kYaZy6PRumvKy84rDTjDRobDZQeGQts6ra32EYZJWue+XmSzXRXUqWSDL0f91kei/NKhvYZSOEVP9lcrWL9JjHoZ8AP9b5aiFzlJTCXgccDOFMgRlzEdv7GdNC86AbhKxnoK+HqKcTNULz7rMUNnVX08Pvu2urrrplVXddyzs2Z12JjtPkNeoM1f5PemPpIX9fljMff2FNf5QqhbjCFuPk9i4z1cd7aMc6IaJycqrcxL0v97qi+vlFM1J115CrwFysNdtvPmiypfLs9Zpyh9zddpWa6ryGOhphPc6tH5RY2TS8vpsDYBFd9TlFyoorg3pSdN7yXqF58MLFUj400prr/2ezfQL2TM3RtiHaxpa/f7fqU6Yk6G6M8Tuq3x3dskJj5VPKJAuXJHEiLcpXG3aI37pXNHpdOdytmrVJ9m1ZttFSQ+oEL8LGCKIGO1ap+Ngoa1ANcOGMiVZaUUOM7IZtc92XgbeMy/aIb2F2lyVCbJS/EuoS7er0OONVdc4QXBWqMiIiynuyRkzHMros202TjgJOD4sC7yvq8OZ1qK6JysfB1RMyZZFkvPs4BfiHNs0r6GSj8r1fRo251TkwLVbwfJS2o8Q9p1JYFA06sH7E+hY/LarR0iBTVkOe8gwXCDjN+W5XMTpdwnfMx1uGB9s+qxdBICzhAhGaWo3KrGxgIHPumwcMaWLWyIdQBmlOAxm0POsGD6xTTIcLYi7qoMcxwulDhBuu5U7fm0DN7WG0dgKdGu2AnwwgFDKQ8E6LR9fuS32xIA2qzl1E1b2N7ZSS8dUg9WS26ImO1r3SRzNtNxUk56TIp7JDfLkEu7YcisuEHOmHtGrlAODOEd1ke7aEf2SJycnveIhMQxysSaJ6mL1Kvy3wEAd/c2OL0LiVgAAAAASUVORK5CYII=
description: Perform malware dynamic analysis
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: false
- display: clientToken
  name: Client token
  defaultvalue: ""
  type: 4
  required: false
- display: Version
  name: version
  defaultvalue: 1.1.0
  type: 0
  required: false
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "true"
  type: 8
  required: false
script:
  script: |-
    server = params.server.replace(/[\/]+$/, '') + '/wsapis/v' + params.version + '/';
    commandDictionary = {
        login: {
            url: 'auth/login',
            method: 'POST',
        },
        logout: {
            url: 'auth/logout',
            method: 'POST',
        },
        'fe-report': {
            url: 'reports/report',
            method: 'GET',
        },
        'fe-submit-status': {
            url: 'submissions/status/%submission_Key%',
            method: 'GET',
            setContentType: true,
            extended: true,
            translator: [
                {
                    contextPath: 'FireEyeAX.Submissions(val.Key==obj.Key)',
                    title: 'FireEye Submission',
                    data: [
                        {to: 'Key', from: 'submission_Key'},
                        {to: 'Status', from: 'submissionStatus'},
                    ]
                }
            ],
        },
        'fe-alert': {
            url: 'alerts',
            method: 'GET',
            setContentType: true,
        },
        'fe-submit-result': {
            url: 'submissions/results/%submission_Key%',
            method: 'GET',
            setContentType: true,
            extended: true,
            translator: [
                {
                    contextPath: 'FireEyeAX.Submissions(val.Key==obj.Key)',
                    title: 'FireEye Submission Result',
                    data: [
                        {to: 'Key', from: 'submission_Key'},
                        {to: 'Severity', from: 'alerts.alert.-severity'},
                    ]
                }
            ],
        },
        'fe-config': {
            url: 'config',
            method: 'GET',
            extended: true,
            translator: [
                {
                    contextPath: 'FireEyeAX.Sensors(val.ID==obj.ID)',
                    title: 'FireEye Configuration',
                    data: [
                        {to: 'Address', from: 'sysconfig.sensors.sensor.-address'},
                        {to: 'ID', from: 'sysconfig.sensors.sensor.-id'},
                        {to: 'SensorName', from: 'sysconfig.sensors.sensor.-sensor_name'},
                        {to: 'Profiles-ID', from: 'sysconfig.sensors.sensor.profiles.profile.-id'},
                        {to: 'Profiles-Name', from: 'sysconfig.sensors.sensor.profiles.profile.-name'},
                        {to: 'Profile-Applications', from: 'sysconfig.sensors.sensor.profiles.profile.applications.application'}
                    ]
                }
            ],
        },
        'fe-submit': {
            extended: true,
            translator: [
                {
                    contextPath: 'FireEyeAX.Submissions(val.Key==obj.Key)',
                    title: 'FireEye Submission',
                    data: [
                        {to: 'Key', from: 'ID'},
                    ]
                }
            ],
        }
    };

    function createContext(data, id) {
        var createContextSingle = function(obj) {
            var res = {};
            var keys = Object.keys(obj);
            keys.forEach(function(k) {
                var values = k.split('-');
                var current = res;
                for (var j = 0; j<values.length - 1; j++) {
                    if (!current[values[j]]) {
                        current[values[j]] = {};
                    }
                    current = current[values[j]];
                }
                current[values[j]] = obj[k];
            });
            if (!res.ID && id) {
                res.ID = id;
            }
            return res;
        };
        if (data instanceof Array) {
            var res = [];
            for (var j=0; j < data.length; j++) {
                res.push(createContextSingle(data[j]));
            }
            return res;
        }
        return createContextSingle(data);
    }

    function mapObjFunction(mapFields, filter) {
        var transformSingleObj= function(obj) {
            var res = {};
            mapFields.forEach(function(f) {
                res[f.to] = dq(obj, f.from);
            });
            if (filter && !filter(res)) {
                return undefined;
            }
            return res;
        };
        return function(obj) {
            if (obj instanceof Array) {
                var res = [];
                for (var j=0; j < obj.length; j++) {
                    var current = transformSingleObj(obj[j]);
                    if (current) {
                        res.push(current);
                    }
                }
                return res;
            }
            return transformSingleObj(obj);
        };
    }

    var submissionKey = args['submission_Key'];

    var getFileName = function(args) {
        var reportType = args['report_type'] || 'unknown';
        var startTime = args['start_time'] ||  'unknown';
        var endTime = args['end_time'] || 'unknown';
        var type = args['type'] || 'unknown';
        return reportType + '_from_' + startTime + '_to_' + endTime + '.' + type;
    }

    var sendRequest = function(url, method, token, setContentType, args) {
        var headers = {};
        if (setContentType) {
          headers['Content-Type'] = ['application/json'];
        }
        var httpParams = {
           Method: method,
           Body: (method === ('POST' && args) ? encodeToURLQuery(args).replace(/^\?/, '') : undefined)
        };
        if (params.clientToken) {
            headers['X-FeClient-Token'] = [params.clientToken];
        }
        if (token) {
           headers['X-FeApi-Token'] = token;
        } else {
           httpParams.Username = params.credentials.identifier;
           httpParams.Password = params.credentials.password;
        }
        httpParams.Headers = headers;
        var res = http(
                server + url + (method === 'GET' && method ? encodeToURLQuery(args) : ''),
                httpParams,
                params.insecure,
                params.proxy
            );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            if (url !== commandDictionary.login.url && url !== commandDictionary.logout.url) {
              sendRequest(commandDictionary.logout.url, commandDictionary.logout.method, token);
            }
            throw 'Request submissions failed, request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
        }
        return res;
    }

    var token = sendRequest(commandDictionary.login.url, commandDictionary.login.method).Headers['X-Feapi-Token'];
    var result;
    switch (command) {
        case 'test-module':
            sendRequest(commandDictionary.logout.url, commandDictionary.logout.method, token);
            return 'ok';
        case 'fe-report':
            var response = sendRequest(commandDictionary[command].url, commandDictionary[command].method, token, commandDictionary[command].setContentType, args);
            var filename = getFileName(args);
            result = {Type: 9, FileID: saveFile(response.Body), File: filename, Contents: filename};
            break;
        case 'fe-submit':
            if (args.profiles) {
                args.profiles = args.profiles.split(',');
                for (var k in args.profiles) {
                  args.profiles[k] = args.profiles[k].trim();
                }
            }
            id = args.upload || args.uploadFile;
            delete(args.upload)
            delete(args.uploadFile)
            res = httpMultipart(
                 server + 'submissions',
                 id,
                 {
                     Headers: {
                        'X-FeClient-Token': params.clientToken ? [params.clientToken] : undefined,
                        'X-FeApi-Token': token,
                        'Accept': ['*/*']
                     },
                 },
                 {
                    'options': JSON.stringify(args)
                 },
                 params.insecure,
                 params.proxy,
                 undefined,
                 'filename'
             );
             if (res.StatusCode < 200 || res.StatusCode >= 300) {
               sendRequest(commandDictionary.logout.url, commandDictionary.logout.method, token);
               throw 'Request submissions failed, request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
              }
              result = JSON.parse(res.Body);
              break;
        default:
            respoonse = sendRequest(replaceInTemplatesAndRemove(commandDictionary[command].url, args), commandDictionary[command].method, token, commandDictionary[command].setContentType, args);
            result = respoonse.Body;
            contentType = respoonse.Headers && respoonse.Headers['Content-Type'] && respoonse.Headers['Content-Type'][0];
            if (contentType && contentType.indexOf('application/json') !== -1) {
              result = JSON.parse(respoonse.Body);
            }
            if (contentType && contentType.indexOf('application/xml') !== -1) {
              result = JSON.parse(x2j(respoonse.Body));
            }
    }
    sendRequest(commandDictionary.logout.url, commandDictionary.logout.method, token);

    if (typeof result === 'object' && !result['submission_Key']) {
      result['submission_Key'] = submissionKey;
    }

    currentCommand = commandDictionary[command];
    var entries = [];
    if (currentCommand.extended) {
        for (var j in currentCommand.translator) {
            var current = currentCommand.translator[j];
            var entry = {
                Type: entryTypes.note,
                Contents: result,
                ContentsFormat: formats.json,
            };
            var currentContent = current.innerPath ? dq(result, current.innerPath) : result;
            var translated = mapObjFunction(current.data) (current.countingDict ? toArray(currentContent) : currentContent);
            entry.ReadableContentsFormat = formats.markdown;
            entry.HumanReadable = tableToMarkdown(current.title,translated);
            entry.EntryContext = {};
            var context = createContext(translated);
            entry.EntryContext[current.contextPath] = context;

            if(command === 'fe-submit-result'){
                var md5 = result.alerts.alert.explanation['malware-detected'].malware.md5sum;
                if(context.Severity === 'majr'){
                    entry.EntryContext.DBotScore = [{'Indicator': md5, 'Type': 'hash', 'Vendor': 'Fireeye', 'Score': 3}];
                    var malFile = {};
                    addMalicious(malFile, outputPaths.file, {
                            MD5: md5,
                            Malicious: {Vendor: 'Fireeye'}
                    });
                    entry.EntryContext[outputPaths.file] =[malFile[outputPaths.file]];
                }
                else{
                    entry.EntryContext.DBotScore = [{'Indicator': md5, 'Type': 'hash', 'Vendor': 'Fireeye', 'Score': 0}];
                }
            }
            entries.push(entry);
        }
    }
    else {return result};
    return entries;
  type: javascript
  commands:
  - name: fe-report
    arguments:
    - name: report_type
      required: true
      description: commands.server.feReport.arguments.reportType.description
    - name: type
      required: true
      description: commands.server.feReport.arguments.type.description
    - name: start_time
      required: true
      description: Report start time
    - name: end_time
      required: true
      description: Report end time
    - name: command
      description: Report command
    - name: module
      description: Report module
    - name: frame
      description: commands.server.feReport.arguments.frame.description
    description: commands.server.feReport.description
  - name: fe-submit-status
    arguments:
    - name: submission_Key
      required: true
      description: commands.server.feSubmit.arguments.submissionKey.description
    outputs:
    - contextPath: FireEyeAX.Submissions.Key
      description: The file submission key
    - contextPath: FireEyeAX.Submissions.Status
      description: The file submission status
    description: commands.server.feSubmitStatus.description
  - name: fe-alert
    arguments:
    - name: duration
      description: commands.server.feAlert.arguments.duration.description
    - name: start_time
      description: commands.server.feAlert.arguments.startTime.description
    - name: end_time
      description: commands.server.feAlert.arguments.endTime.description
    - name: src_ip
      description: commands.server.feAlert.arguments.srcIP.description
    - name: dst_ip
      description: commands.server.feAlert.arguments.dstIP.description
    - name: malware_name
      description: commands.server.feAlert.arguments.malwareName.description
    - name: malware_type
      description: commands.server.feAlert.arguments.malwareType.description
    - name: sender_email
      description: commands.server.feAlert.arguments.senderMail.description
    - name: recipient_email
      description: commands.server.feAlert.arguments.recipientEMail.description
    - name: file_name
      description: commands.server.feAlert.arguments.fileName.description
    - name: file_type
      description: commands.server.feAlert.arguments.fileType.description
    - name: url
      description: commands.server.feAlert.arguments.url.description
    - name: md5
      description: commands.server.feAlert.arguments.md5.description
    - name: info_level
      description: commands.server.feAlert.arguments.infoLevel.description
    - name: callback_domain
      description: commands.server.feAlert.arguments.callbackDomain.description
    description: commands.server.feAlert.description
  - name: fe-submit-result
    arguments:
    - name: submission_Key
      description: commands.server.feSubmit.arguments.submissionKey.description
    - name: info_level
      description: commands.server.feAlert.arguments.infoLevel.description
    outputs:
    - contextPath: FireEyeAX.Submissions.Key
      description: The submission key
    - contextPath: FireEyeAX.Submissions.Severity
      description: The severity level of the file
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: File.MD5
      description: Bad hash found
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    description: commands.server.feSubmit.arguments.submissionKey.description
  - name: fe-submit
    arguments:
    - name: upload
      description: commands.server.feSubmit.arguments.uploadFile.description
    - name: uploadFile
      description: commands.server.feSubmit.arguments.uploadFile.description
    - name: analysistype
      required: true
      description: commands.server.feSubmit.arguments.analysisType.description
    - name: profiles
      required: true
      description: commands.server.feSubmit.arguments.profile.description
    - name: application
      required: true
      description: commands.server.feSubmit.arguments.application.description
    - name: priority
      required: true
      description: commands.server.feSubmit.arguments.priority.description
    - name: force
      required: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: commands.server.feSubmit.arguments.force.description
    - name: prefetch
      required: true
      description: commands.server.feSubmit.arguments.prefetch.description
    - name: timeout
      required: true
      description: commands.server.feSubmit.arguments.timeout.description
    outputs:
    - contextPath: FireEyeAX.Submissions.Key
      description: The file submission key
    description: commands.server.feSubmit.description
  - name: fe-config
    arguments: []
    description: commands.server.feConfig.description
    outputs:
    - contextPath: FireEyeAX.Sensors.Address
      description: Sensor IP address
    - contextPath: FireEyeAX.Sensors.ID
      description: Sensor FireEye id
    - contextPath: FireEyeAX.Sensors.Name
      description: Sensor name
    - contextPath: FireEyeAX.Sensors.Profiles.ID
      description: ID of FireEye sensor profile
    - contextPath: FireEyeAX.Sensors.Profiles.Name
      description: Name of FireEye sensor name
    - contextPath: FireEyeAX.Sensors.Profiles.Applications.-id
      description: FireEye application ID
    - contextPath: FFireEyeAX.Sensors.Profiles.Applications.-name
      description: FireEye application name
