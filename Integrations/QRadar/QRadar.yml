category: Analytics & SIEM
commonfields:
  id: QRadar
  version: -1
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- display: Username
  name: credentials
  required: false
  type: 9
- display: Authentication token
  name: token
  required: false
  type: 4
- display: Query to fetch offenses
  name: query
  required: false
  type: 0
- defaultvalue: '50'
  display: Number of offenses to pull per API call
  name: offensesPerCall
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: Full Incident Enrichment
  defaultvalue: 'true'
  hidden: false
  name: full_enrich
  required: false
  type: 8
description: Fetch offenses as incidents and search QRadar
display: IBM QRadar
name: QRadar
script:
  commands:
  - arguments:
    - default: false
      description: 'Query to filter offenses. For refernce please consult: https://www.ibm.com/support/knowledgecenter/en/SS42VS_7.3.1/com.ibm.qradar.doc/c_rest_api_filtering.html'
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: 'Range of results to return. e.g.: 0-20'
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: Gets offenses from QRadar
    execution: false
    name: qradar-offenses
    outputs:
    - contextPath: QRadar.Offense.Followup
      description: Offense followup.
      type: boolean
    - contextPath: QRadar.Offense.ID
      description: The ID of the offense.
      type: number
    - contextPath: QRadar.Offense.Description
      description: The description of the offense.
      type: string
    - contextPath: QRadar.Offense.SourceAddress
      description: The source addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.DestinationAddress
      description: The local destination addresses that are associated with the offense.
        If your offense has a remote destination, you will need to use QRadarFullSearch
        playbook with the following query - SELECT destinationip FROM events WHERE
        inOffense(<offenseID>) GROUP BY destinationip
      type: Unknown
    - contextPath: QRadar.Offense.RemoteDestinationCount
      description: The remote destination that are associated with the offesne. If
        this value is greater than 0 that means your offense has a remote destination,
        you will need to use QRadarFullSearch playbook with the following query -
        SELECT destinationip FROM events WHERE inOffense(<offenseID>) GROUP BY destinationip
      type: Unknown
    - contextPath: QRadar.Offense.StartTime
      description: The time (ISO) when the offense was started.
      type: date
    - contextPath: QRadar.Offense.EventCount
      description: The number of events that are associated with the offense.
      type: number
    - contextPath: QRadar.Offense.Magnitude
      description: The magnitude of the offense.
      type: number
    - contextPath: QRadar.Offense.LastUpdatedTime
      description: The time (ISO) when the offense was last updated.
      type: date
    - contextPath: QRadar.Offense.OffenseType
      description: The offense type (due to API limitations if username and password
        were not provided, this value will be the id of offense type)
      type: string
  - arguments:
    - default: true
      description: Offense ID
      isArray: false
      name: offense_id
      required: true
      secret: false
    - default: false
      description: 'Query to filter offense. For refernce please consult: https://www.ibm.com/support/knowledgecenter/en/SS42VS_7.3.1/com.ibm.qradar.doc/c_rest_api_filtering.html'
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-offense_id-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: Gets offense with matching offense ID from qradar
    execution: false
    name: qradar-offense-by-id
    outputs:
    - contextPath: QRadar.Offense.Credibility
      description: The credibility of the offense
      type: number
    - contextPath: QRadar.Offense.Relevance
      description: The relevance of the offense
      type: number
    - contextPath: QRadar.Offense.Severity
      description: The severity of the offense
      type: number
    - contextPath: QRadar.Offense.SourceAddress
      description: The source addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.DestinationAddress
      description: The local destination addresses that are associated with the offense.
        If your offense has a remote destination, you will need to use QRadarFullSearch
        playbook with the following query - SELECT destinationip FROM events WHERE
        inOffense(<offenseID>) GROUP BY destinationip
      type: Unknown
    - contextPath: QRadar.Offense.RemoteDestinationCount
      description: The remote destination that are associated with the offesne. If
        this value is greater than 0 that means your offense has a remote destination,
        you will need to use QRadarFullSearch playbook with the following query -
        SELECT destinationip FROM events WHERE inOffense(<offenseID>) GROUP BY destinationip
      type: Unknown
    - contextPath: QRadar.Offense.AssignedTo
      description: The user the offense is assigned to.
      type: string
    - contextPath: QRadar.Offense.StartTime
      description: The time (ISO) when the offense was started.
      type: date
    - contextPath: QRadar.Offense.ID
      description: The ID of the offense.
      type: int
    - contextPath: QRadar.Offense.DestinationHostname
      description: Destintion hostname
      type: Unknown
    - contextPath: QRadar.Offense.Description
      description: The description of the offense.
      type: string
    - contextPath: QRadar.Offense.EventCount
      description: The number of events that are associated with the offense.
      type: number
    - contextPath: QRadar.Offense.OffenseSource
      description: The source of the offense.
      type: string
    - contextPath: QRadar.Offense.Status
      description: The status of the offense. One of "OPEN", "HIDDEN", or "CLOSED".
      type: string
    - contextPath: QRadar.Offense.Magnitude
      description: The magnitude of the offense.
      type: number
    - contextPath: QRadar.Offense.ClosingUser
      description: The user that closed the offense
      type: string
    - contextPath: QRadar.Offense.ClosingReason
      description: The offense closing reason.
      type: string
    - contextPath: QRadar.Offense.CloseTime
      description: The time when the offense was closed.
      type: date
    - contextPath: QRadar.Offense.LastUpdatedTime
      description: The time (ISO) when the offense was last updated.
      type: date
    - contextPath: QRadar.Offense.Categories
      description: Event categories that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.FlowCount
      description: The number of flows that are associated with the offense.
      type: number
    - contextPath: QRadar.Offense.FollowUp
      description: Offense followup.
      type: boolean
    - contextPath: QRadar.Offense.OffenseType
      description: A number that represents the offense type
      type: string
    - contextPath: QRadar.Offense.Protected
      description: Is the offense protected
      type: boolean
  - arguments:
    - default: true
      description: The query expressions in AQL (for more information about Ariel
        Query Language please review "https://www.ibm.com/support/knowledgecenter/en/SS42VS_7.3.0/com.ibm.qradar.doc/c_aql_intro.html")
      isArray: false
      name: query_expression
      required: true
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: Searches in QRadar using AQL. It is highly recommended to use the
      playbook 'QRadarFullSearch' instead of this command - it will execute the search,
      and will return the result.
    execution: false
    name: qradar-searches
    outputs:
    - contextPath: QRadar.Search.ID
      description: Search ID
      type: number
    - contextPath: QRadar.Search.Status
      description: The status of the search.
      type: string
  - arguments:
    - default: true
      description: The search id
      isArray: false
      name: search_id
      required: true
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: Gets a specific search id and status
    execution: false
    name: qradar-get-search
    outputs:
    - contextPath: QRadar.Search.ID
      description: Search ID
      type: number
    - contextPath: QRadar.Search.Status
      description: The status of the search.
      type: string
  - arguments:
    - default: true
      description: The search id
      isArray: false
      name: search_id
      required: true
      secret: false
    - default: false
      description: 'Range of results to return. e.g.: 0-20'
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    - default: false
      description: Replaces the default context output path for the query result (QRadar.Search.Result).
        e.g. for output_path=QRadar.Correlations the result will be under the key
        "QRadar.Correlations" in the context data.
      isArray: false
      name: output_path
      required: false
      secret: false
    deprecated: false
    description: Gets search results
    execution: false
    name: qradar-get-search-results
    outputs:
    - contextPath: QRadar.Search.Result
      description: The result of the search
      type: Unknown
  - arguments:
    - default: true
      description: The ID of the offense to update
      isArray: false
      name: offense_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Set to true to protect the offense
      isArray: false
      name: protected
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Set to true to set the follow up flag on the offense
      isArray: false
      name: follow_up
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new status for the offense
      isArray: false
      name: status
      predefined:
      - OPEN
      - HIDDEN
      - CLOSED
      required: false
      secret: false
    - default: false
      description: 'The id of a closing reason. You must provide a valid closing_reason_name
        when you close an offense. The default  closing_reasons are: (1) False-Positive,
        Tuned (2) Non-Issues (3) Policy Violation'
      isArray: false
      name: closing_reason_id
      required: false
      secret: false
    - default: false
      description: 'The name of a closing reason. You must provide a valid closing_reason_name
        when you close an offense. The default  closing_reasons are: (1) False-Positive,
        Tuned (2) Non-Issues (3) Policy Violation'
      isArray: false
      name: closing_reason_name
      required: false
      secret: false
    - default: false
      description: A user to assign the offense to
      isArray: false
      name: assigned_to
      required: false
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    - default: false
      description: Use this parameter to specify which fields you would like to get
        back in the response. Fields that are not named are excluded. Specify subfields
        in brackets and multiple fields in the same object are separated by commas.
        Please consult - https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-offense_id-POST.html
      isArray: false
      name: fields
      required: false
      secret: false
    deprecated: false
    description: Update an offense
    execution: false
    name: qradar-update-offense
    outputs:
    - contextPath: QRadar.Offense.Credibility
      description: The credibility of the offense
      type: number
    - contextPath: QRadar.Offense.Relevance
      description: The relevance of the offense
      type: number
    - contextPath: QRadar.Offense.Severity
      description: The severity of the offense
      type: number
    - contextPath: QRadar.Offense.SourceAddress
      description: The source addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.DestinationAddress
      description: The destination addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.AssignedTo
      description: The user the offense is assigned to.
      type: string
    - contextPath: QRadar.Offense.StartTime
      description: The time (ISO) when the offense was started.
      type: date
    - contextPath: QRadar.Offense.ID
      description: The ID of the offense.
      type: int
    - contextPath: QRadar.Offense.DestinationHostname
      description: Destintion hostname
      type: Unknown
    - contextPath: QRadar.Offense.Description
      description: The description of the offense.
      type: string
    - contextPath: QRadar.Offense.EventCount
      description: The number of events that are associated with the offense.
      type: number
    - contextPath: QRadar.Offense.OffenseSource
      description: The source of the offense.
      type: string
    - contextPath: QRadar.Offense.Status
      description: The status of the offense. One of "OPEN", "HIDDEN", or "CLOSED".
      type: string
    - contextPath: QRadar.Offense.Magnitude
      description: The magnitude of the offense.
      type: number
    - contextPath: QRadar.Offense.ClosingUser
      description: The user that closed the offense
      type: string
    - contextPath: QRadar.Offense.ClosingReason
      description: The offense closing reason.
      type: string
    - contextPath: QRadar.Offense.CloseTime
      description: The time when the offense was closed.
      type: date
    - contextPath: QRadar.Offense.LastUpdatedTime
      description: The time (ISO) when the offense was last updated.
      type: date
    - contextPath: QRadar.Offense.Categories
      description: Event categories that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.FlowCount
      description: The number of flows that are associated with the offense.
      type: number
    - contextPath: QRadar.Offense.FollowUp
      description: Offense followup.
      type: boolean
    - contextPath: QRadar.Offense.OffenseType
      description: A number that represents the offense type
      type: string
    - contextPath: QRadar.Offense.Protected
      description: Is the offense protected
      type: boolean
  - arguments:
    - default: false
      description: 'Query to filter assets. For refernce please consult: https://www.ibm.com/support/knowledgecenter/en/SS42VS_7.3.1/com.ibm.qradar.doc/c_rest_api_filtering.html'
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--asset_model-assets-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: 'Range of results to return. e.g.: 0-20'
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: List all assets found in the model
    execution: false
    name: qradar-get-assets
    outputs:
    - contextPath: QRadar.Assets.ID
      description: The ID of the asset
      type: number
    - contextPath: Endpoint.IPAddress
      description: IP address of the asset
      type: Unknown
    - contextPath: QRadar.Assets.Name.Value
      description: Name of the asset
      type: string
    - contextPath: Endpoint.OS
      description: Asset OS
      type: number
    - contextPath: QRadar.Assets.AggregatedCVSSScore.Value
      description: CVSSScore
      type: number
    - contextPath: QRadar.Assets.AggregatedCVSSScore.LastUser
      description: Last user who updated the Aggregated CVSS Score
      type: string
    - contextPath: QRadar.Assets.Weight.Value
      description: Asset weight
      type: number
    - contextPath: QRadar.Assets.Weight.LastUser
      description: Last user who updated the weight
      type: string
    - contextPath: QRadar.Assets.Name.LastUser
      description: Last user who updated the name
      type: string
  - arguments:
    - default: true
      description: The ID of the requested asset.
      isArray: false
      name: asset_id
      required: true
      secret: false
    deprecated: false
    description: Retrieves the asset by id
    execution: false
    name: qradar-get-asset-by-id
    outputs:
    - contextPath: QRadar.Assets.ID
      description: The ID of the asset.
      type: number
    - contextPath: Endpoint.MACAddress
      description: Asset MAC address.
      type: Unknown
    - contextPath: Endpoint.IPAddress
      description: It's in ip_addresses - value
      type: Unknown
    - contextPath: QRadar.Assets.ComplianceNotes.Value
      description: Compliance notes
      type: string
    - contextPath: QRadar.Assets.CompliancePlan.Value
      description: Compliance plan
      type: string
    - contextPath: QRadar.Assets.CollateralDamagePotential.Value
      description: Collateral damage potential
      type: Unknown
    - contextPath: QRadar.Assets.AggregatedCVSSScore.Value
      description: CVSSScore
      type: number
    - contextPath: QRadar.Assets.Name.Value
      description: Name of the asset
      type: string
    - contextPath: QRadar.Assets.GroupName
      description: Name of the asset's group
      type: string
    - contextPath: Endpoint.Domain
      description: DNS name
      type: Unknown
    - contextPath: Endpoint.OS
      description: Asset OS
      type: Unknown
    - contextPath: QRadar.Assets.Weight.Value
      description: Asset weight
      type: number
    - contextPath: QRadar.Assets.Vulnerabilities.Value
      description: Vulnerabilities
      type: Unknown
    - contextPath: QRadar.Assets.Location
      description: Location.
      type: string
    - contextPath: QRadar.Assets.Description
      description: The asset description.
      type: string
    - contextPath: QRadar.Assets.SwitchID
      description: Switch ID
      type: number
    - contextPath: QRadar.Assets.SwitchPort
      description: Switch port.
      type: number
    - contextPath: QRadar.Assets.Name.LastUser
      description: Last user who updated the name
      type: string
    - contextPath: QRadar.Assets.AggregatedCVSSScore.LastUser
      description: Last user who updated the Aggregated CVSS Score
      type: string
    - contextPath: QRadar.Assets.Weight.LastUser
      description: Last user who updated the weight
      type: string
    - contextPath: QRadar.Assets.ComplianceNotes.LastUser
      description: Last user who updated the compliance notes
      type: string
    - contextPath: QRadar.Assets.CompliancePlan.LastUser
      description: Last user who updated the compliance plan
      type: string
    - contextPath: QRadar.Assets.CollateralDamagePotential.LastUser
      description: Last user who updated the collateral damage potential
      type: string
    - contextPath: QRadar.Assets.Vulnerabilities.LastUser
      description: Last user who updated the vulnerabilities
      type: string
  - arguments:
    - default: true
      description: The query expressions in AQL (for more information about Ariel
        Query Language please review https://www.ibm.com/support/knowledgecenter/en/SS42VS_7.3.0/com.ibm.qradar.doc/c_aql_intro.html)
      isArray: false
      name: query_expression
      required: true
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: true
    description: Searches in QRadar
    execution: false
    name: qr-searches
    outputs:
    - contextPath: QRadar.Search.ID
      description: Search ID
      type: number
    - contextPath: QRadar.Search.State
      description: The state of the search.
      type: string
  - arguments:
    - default: true
      description: The search id
      isArray: false
      name: search_id
      required: true
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: true
    description: Gets a specific search id and state
    execution: false
    name: qr-get-search
    outputs:
    - contextPath: QRadar.Search.ID
      description: Search ID
      type: number
    - contextPath: QRadar.Search.State
      description: The state of the search.
      type: string
  - arguments:
    - default: true
      description: The search id
      isArray: false
      name: search_id
      required: true
      secret: false
    - default: false
      description: Number of results in return
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: true
    description: Gets search results
    execution: false
    name: qr-get-search-results
    outputs:
    - contextPath: QRadar.Search.Result
      description: The result of the search
      type: Unknown
  - arguments:
    - default: false
      description: The ID of a closing reason. You must provide a valid closing_reason_id
        when you close an offense
      isArray: false
      name: closing_reason_id
      required: false
      secret: false
    - default: true
      description: The ID of the offense to update
      isArray: false
      name: offense_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Set to true to protect the offense
      isArray: false
      name: protected
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Set to true to set the follow up flag on the offense
      isArray: false
      name: follow_up
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new status for the offense
      isArray: false
      name: status
      predefined:
      - OPEN
      - HIDDEN
      - CLOSED
      required: false
      secret: false
    - default: false
      description: 'The name of a closing reason. You must provide a valid closing_reason_name
        when you close an offense. The default  closing_reasons are: (1) False-Positive,
        Tuned (2) Non-Issues (3) Policy Violation'
      isArray: false
      name: closing_reason_name
      required: false
      secret: false
    - default: false
      description: A user to assign the offense to
      isArray: false
      name: assigned_to
      required: false
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    - default: false
      description: Use this parameter to specify which fields you would like to get
        back in the response. Fields that are not named are excluded. Specify subfields
        in brackets and multiple fields in the same object are separated by commas
      isArray: false
      name: fields
      required: false
      secret: false
    deprecated: true
    description: Update an offense
    execution: false
    name: qr-update-offense
    outputs:
    - contextPath: QRadar.Offense.Followup
      description: Offense followup.
      type: Unknown
    - contextPath: QRadar.Offense.ID
      description: The ID of the offense.
      type: number
    - contextPath: QRadar.Offense.Description
      description: The description of the offense.
      type: Unknown
    - contextPath: QRadar.Offense.SourceAddress
      description: The source addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.DestinationAddress
      description: The destination addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.StartTime
      description: The time (ISO) when the offense was started.
      type: Unknown
    - contextPath: QRadar.Offense.EventCount
      description: The number of events that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.FlowCount
      description: The number of flows that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.OffenseSource
      description: The source of the offense.
      type: Unknown
    - contextPath: QRadar.Offense.Magnitude
      description: The magnitude of the offense.
      type: Unknown
    - contextPath: QRadar.Offense.LastUpdatedTime
      description: The time (ISO) when the offense was last updated.
      type: Unknown
    - contextPath: QRadar.Offense.OffenseType
      description: A number that represents the offense type
      type: Unknown
    - contextPath: QRadar.Offense.Protected
      description: Is the offense protected
      type: Unknown
  - arguments:
    - default: false
      description: Number of results in return
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Fields to filter in
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Query to filter offenses
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: true
    description: List all assets found in the model
    execution: false
    name: qr-get-assets
    outputs:
    - contextPath: QRadar.Assets.ID
      description: The ID of the asset
      type: number
    - contextPath: Endpoint.IPAddress
      description: IP address of the asset
      type: Unknown
    - contextPath: QRadar.Assets.Name.Value
      description: Name of the asset
      type: Unknown
    - contextPath: Endpoint.OS
      description: Asset OS
      type: Unknown
    - contextPath: QRadar.Assets.AggregatedCVSSScore.Value
      description: CVSSScore
      type: Unknown
    - contextPath: QRadar.Assets.Weight.Value
      description: Asset weight
      type: Unknown
    - contextPath: QRadar.Assets.Name.LastUser
      description: Last user who updated the name
      type: Unknown
    - contextPath: QRadar.Assets.AggregatedCVSSScore.LastUser
      description: Last user who updated the Aggregated CVSS Score
      type: Unknown
    - contextPath: QRadar.Assets.Weight.LastUser
      description: Last user who updated the weight
      type: Unknown
  - arguments:
    - default: false
      description: Query to filter offenses
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: 'Fields to filter in '
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Number of results in return
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Table headers
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: true
    description: Gets offenses from QRadar
    execution: false
    name: qr-offenses
    outputs:
    - contextPath: QRadar.Offense.Followup
      description: Offense followup.
      type: Unknown
    - contextPath: QRadar.Offense.ID
      description: The ID of the offense.
      type: number
    - contextPath: QRadar.Offense.Description
      description: The description of the offense.
      type: Unknown
    - contextPath: QRadar.Offense.SourceAddress
      description: The source addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.DestinationAddress
      description: The destination addresses that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.StartTime
      description: The time (ISO) when the offense was started.
      type: Unknown
    - contextPath: QRadar.Offense.EventCount
      description: The number of events that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.FlowCount
      description: The number of flows that are associated with the offense.
      type: Unknown
    - contextPath: QRadar.Offense.OffenseSource
      description: The source of the offense.
      type: Unknown
    - contextPath: QRadar.Offense.Magnitude
      description: The magnitude of the offense.
      type: Unknown
    - contextPath: QRadar.Offense.LastUpdatedTime
      description: The time (ISO) when the offense was last updated.
      type: Unknown
    - contextPath: QRadar.Offense.OffenseType
      description: A number that represents the offense type
      type: Unknown
  - arguments:
    - auto: PREDEFINED
      default: false
      defaultValue: 'true'
      description: If true, reserved closing reasons are included in the response
      isArray: false
      name: include_reserved
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'true'
      description: If true, deleted closing reasons are included in the response
      isArray: false
      name: include_deleted
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: 'Query to filter results. For refernce please consult: https://www.ibm.com/support/knowledgecenter/en/SS42VS_7.3.1/com.ibm.qradar.doc/c_rest_api_filtering.html'
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offense_closing_reasons-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: 'Range of results to return. e.g.: 0-20'
      isArray: false
      name: range
      required: false
      secret: false
    deprecated: false
    description: Get closing reasons
    execution: false
    name: qradar-get-closing-reasons
    outputs:
    - contextPath: QRadar.Offense.ClosingReasons.ID
      description: Closing reason ID
      type: number
    - contextPath: QRadar.Offense.ClosingReasons.Name
      description: Closing reason name
      type: string
  - arguments:
    - default: true
      description: The offense ID to add the note to
      isArray: false
      name: offense_id
      required: true
      secret: false
    - default: false
      description: The note text
      isArray: false
      name: note_text
      required: true
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-offense_id-notes-POST.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: Create a note on an offense
    execution: false
    name: qradar-create-note
    outputs:
    - contextPath: QRadar.Note.ID
      description: Note ID
      type: number
    - contextPath: QRadar.Note.Text
      description: Note text
      type: string
    - contextPath: QRadar.Note.CreateTime
      description: The creation time of the note
      type: date
    - contextPath: QRadar.Note.CreatedBy
      description: The user who created the note
      type: string
  - arguments:
    - default: true
      description: The offense ID to retrieve the note from
      isArray: false
      name: offense_id
      required: true
      secret: false
    - default: false
      description: The note ID
      isArray: false
      name: note_id
      required: false
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-offense_id-notes-note_id-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    deprecated: false
    description: Retrieve a note for an offense
    execution: false
    name: qradar-get-note
    outputs:
    - contextPath: QRadar.Note.ID
      description: Note ID
      type: number
    - contextPath: QRadar.Note.Text
      description: Note text
      type: string
    - contextPath: QRadar.Note.CreateTime
      description: The creation time of the note
      type: date
    - contextPath: QRadar.Note.CreatedBy
      description: The user who created the note
      type: string
  - arguments:
    - default: true
      description: The name of the requestered reference.
      isArray: false
      name: ref_name
      required: true
      secret: false
    - default: false
      description: Table headers to use the human readable output (if none provided,
        will show all table headers)
      isArray: false
      name: headers
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: If set to true will try to convert the data values to ISO-8601
        string.
      isArray: false
      name: date_value
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Information about the reference set that had data added or updated.
      This returns information set but not the contained data. This feature is supported
      from version 8.1 and upward.
    execution: false
    name: qradar-get-reference-by-name
    outputs:
    - contextPath: QRadar.Reference.Name
      description: The name of the reference set.
      type: string
    - contextPath: QRadar.Reference.CreationTime
      description: The creation time (ISO) of the reference.
      type: date
    - contextPath: QRadar.Reference.ElementType
      description: Reference element type.
      type: string
    - contextPath: QRadar.Reference.NumberOfElements
      description: Number of elements.
      type: number
    - contextPath: QRadar.Reference.TimeToLive
      description: Reference time to live.
      type: string
    - contextPath: QRadar.Reference.TimeoutType
      description: 'Reference timeout type. One of: UNKNOWN, FIRST_SEEN, LAST_SEEN'
      type: string
    - contextPath: QRadar.Reference.Data
      description: Reference set items
      type: Unknown
  - arguments:
    - default: false
      description: Reference name to be created
      isArray: false
      name: ref_name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'The element type for the values allowed in the reference set.
        The allowed values are: ALN (alphanumeric), ALNIC (alphanumeric ignore case),
        IP (IP address), NUM (numeric), PORT (port number) or DATE. Note that date
        values need to be represented in milliseconds since the Unix Epoch January
        1st 1970.'
      isArray: false
      name: element_type
      predefined:
      - ALN
      - ALNIC
      - IP
      - NUM
      - PORT
      - DATE
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The allowed values are "FIRST_SEEN", LAST_SEEN and UNKNOWN. The
        default value is UNKNOWN.
      isArray: false
      name: timeout_type
      predefined:
      - FIRST_SEEN
      - LAST_SEEN
      - UNKNOWN
      required: false
      secret: false
    - default: false
      description: 'The time to live interval, for example: "1 month" or "5 minutes"'
      isArray: false
      name: time_to_live
      required: false
      secret: false
    deprecated: false
    description: Creates a new reference set. If the provided name is already in use,
      this command will fail
    execution: false
    name: qradar-create-reference-set
    outputs:
    - contextPath: QRadar.Reference.CreationTime
      description: Creation time of the reference set.
      type: date
    - contextPath: QRadar.Reference.ElementType
      description: 'The element type for the values allowed in the reference set.
        The allowed values are: ALN (alphanumeric), ALNIC (alphanumeric ignore case),
        IP (IP address), NUM (numeric), PORT (port number) or DATE.'
      type: string
    - contextPath: QRadar.Reference.Name
      description: Name of the reference set.
      type: string
    - contextPath: QRadar.Reference.NumberOfElements
      description: Number of elements in the created reference set.
      type: number
    - contextPath: QRadar.Reference.TimeoutType
      description: Timeout type of the reference. The allowed values are FIRST_SEEN,
        LAST_SEEN and UNKNOWN.
      type: string
  - arguments:
    - default: true
      description: The name of reference set to delete.
      isArray: false
      name: ref_name
      required: true
      secret: false
    deprecated: false
    description: Deletes a reference set corresponding to the name provided.
    execution: false
    name: qradar-delete-reference-set
  - arguments:
    - default: false
      description: The name of the reference set to add or update a value in.
      isArray: false
      name: ref_name
      required: true
      secret: false
    - default: false
      description: 'The value to add or update in the reference set. Note: Date values
        must be represented in epoch in reference sets (milliseconds since the Unix
        Epoch January 1st 1970). If ''date_value'' is set to ''True'', then the argument
        will be converted from date in format: ''%Y-%m-%dT%H:%M:%S.%f000Z'' (e.g.
        ''2018-11-06T08:56:41.000000Z'') to epoch.'
      isArray: false
      name: value
      required: true
      secret: false
    - default: false
      description: An indication of where the data originated. The default value is
        'reference data api'.
      isArray: false
      name: source
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: 'If set to True will convert ''value'' argument from date in format:
        ''%Y-%m-%dT%H:%M:%S.%f000Z'' (e.g. ''2018-11-06T08:56:41.000000Z'') to epoch.'
      isArray: false
      name: date_value
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Add or update a value in a reference set.
    execution: false
    name: qradar-create-reference-set-value
    outputs:
    - contextPath: QRadar.Reference.Name
      description: The name of the reference set.
      type: string
    - contextPath: QRadar.Reference.CreationTime
      description: The creation time (ISO) of the reference.
      type: date
    - contextPath: QRadar.Reference.ElementType
      description: Reference element type.
      type: string
    - contextPath: QRadar.Reference.NumberOfElements
      description: Number of elements.
      type: number
    - contextPath: QRadar.Reference.TimeoutType
      description: 'Reference timeout type. One of: UNKNOWN, FIRST_SEEN, LAST_SEEN'
      type: string
  - arguments:
    - default: false
      description: The name of the reference set to add or update a value in.
      isArray: false
      name: ref_name
      required: true
      secret: false
    - default: false
      description: 'The value to add or update in the reference set. Note: Date values
        must be represented in milliseconds since the Unix Epoch January 1st 1970.'
      isArray: false
      name: value
      required: true
      secret: false
    - default: false
      description: An indication of where the data originated. The default value is
        'reference data api'.
      isArray: false
      name: source
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: 'If set to True will convert ''value'' argument from date in format:
        ''%Y-%m-%dT%H:%M:%S.%f000Z'' (e.g. ''2018-11-06T08:56:41.000000Z'') to epoch.'
      isArray: false
      name: date_value
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Add or update a value in a reference set.
    execution: false
    name: qradar-update-reference-set-value
    outputs:
    - contextPath: QRadar.Reference.Name
      description: The name of the reference set.
      type: string
    - contextPath: QRadar.Reference.CreationTime
      description: The creation time (ISO) of the reference.
      type: date
    - contextPath: QRadar.Reference.ElementType
      description: Reference element type.
      type: string
    - contextPath: QRadar.Reference.NumberOfElements
      description: Number of elements.
      type: number
    - contextPath: QRadar.Reference.TimeoutType
      description: 'Reference timeout type. One of: UNKNOWN, FIRST_SEEN, LAST_SEEN'
      type: string
  - arguments:
    - default: false
      description: The name of the reference set to remove a value from.
      isArray: false
      name: ref_name
      required: true
      secret: false
    - default: false
      description: The value to remove from the reference set.
      isArray: false
      name: value
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: 'If set to True will convert ''value'' argument from date in format:
        ''%Y-%m-%dT%H:%M:%S.%f000Z'' (e.g. ''2018-11-06T08:56:41.000000Z'') to epoch.'
      isArray: false
      name: date_value
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Deletes a value in a reference set.
    execution: false
    name: qradar-delete-reference-set-value
    outputs:
    - contextPath: QRadar.Reference.Name
      description: The name of the reference set.
      type: string
    - contextPath: QRadar.Reference.CreationTime
      description: The creation time (ISO) of the reference.
      type: date
    - contextPath: QRadar.Reference.ElementType
      description: Reference element type.
      type: string
    - contextPath: QRadar.Reference.NumberOfElements
      description: Number of elements.
      type: number
    - contextPath: QRadar.Reference.TimeoutType
      description: 'Reference timeout type. One of: UNKNOWN, FIRST_SEEN, LAST_SEEN'
      type: string
  - arguments:
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-offense_id-notes-note_id-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Number of results in return
      isArray: false
      name: range
      required: false
      secret: false
    - default: false
      description: Query to filter offenses
      isArray: false
      name: filter
      required: false
      secret: false
    deprecated: false
    description: Retrieve all Domains
    execution: false
    name: qradar-get-domains
    outputs:
    - contextPath: QRadar.Domains.AssetScannerIDs
      description: Array of Asset Scanner IDs.
      type: Number
    - contextPath: QRadar.Domains.CustomProperties
      description: Custom properties of the domain.
      type: String
    - contextPath: QRadar.Domains.Deleted
      description: Indicates if the domain is deleted.
      type: Boolean
    - contextPath: QRadar.Domains.Description
      description: Description of the domain.
      type: String
    - contextPath: QRadar.Domains.EventCollectorIDs
      description: Array of Event Collector IDs.
      type: Number
    - contextPath: QRadar.Domains.FlowCollectorIDs
      description: Array of Flow Collector IDs.
      type: Number
    - contextPath: QRadar.Domains.FlowSourceIDs
      description: Array of Flow Source IDs.
      type: Number
    - contextPath: QRadar.Domains.ID
      description: ID of the domain.
      type: Number
    - contextPath: QRadar.Domains.LogSourceGroupIDs
      description: Array of Log Source Group IDs.
      type: Number
    - contextPath: QRadar.Domains.LogSourceIDs
      description: Array of Log Source IDs.
      type: Number
    - contextPath: QRadar.Domains.Name
      description: Name of the Domain.
      type: String
    - contextPath: QRadar.Domains.QVMScannerIDs
      description: Array of QVM Scanner IDs.
      type: Number
    - contextPath: QRadar.Domains.TenantID
      description: ID of the Domain tenant.
      type: Number
  - arguments:
    - default: false
      description: ID of the domain
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not named are excluded. Specify subfields in brackets
        and multiple fields in the same object are separated by commas. The filter
        uses QRadar''s field names, for reference please consult: https://www.ibm.com/support/knowledgecenter/SSKMKU/com.ibm.qradar.doc_cloud/9.1--siem-offenses-offense_id-notes-note_id-GET.html'
      isArray: false
      name: fields
      required: false
      secret: false
    deprecated: false
    description: Retrieves Domain information By ID
    execution: false
    name: qradar-get-domain-by-id
    outputs:
    - contextPath: QRadar.Domains.AssetScannerIDs
      description: Array of Asset Scanner IDs.
      type: Number
    - contextPath: QRadar.Domains.CustomProperties
      description: Custom properties of the domain.
      type: String
    - contextPath: QRadar.Domains.Deleted
      description: Indicates if the domain is deleted.
      type: Boolean
    - contextPath: QRadar.Domains.Description
      description: Description of the domain.
      type: String
    - contextPath: QRadar.Domains.EventCollectorIDs
      description: Array of Event Collector IDs.
      type: Number
    - contextPath: QRadar.Domains.FlowCollectorIDs
      description: Array of Flow Collector IDs.
      type: Number
    - contextPath: QRadar.Domains.FlowSourceIDs
      description: Array of Flow Source IDs.
      type: Number
    - contextPath: QRadar.Domains.ID
      description: ID of the domain.
      type: Number
    - contextPath: QRadar.Domains.LogSourceGroupIDs
      description: Array of Log Source Group IDs.
      type: Number
    - contextPath: QRadar.Domains.LogSourceIDs
      description: Array of Log Source IDs.
      type: Number
    - contextPath: QRadar.Domains.Name
      description: Name of the Domain.
      type: String
    - contextPath: QRadar.Domains.QVMScannerIDs
      description: Array of QVM Scanner IDs.
      type: Number
    - contextPath: QRadar.Domains.TenantID
      description: ID of the Domain tenant.
      type: Number
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python2
  type: python
tests:
- test_Qradar
