commonfields:
  id: C2sec irisk
  version: -1
name: C2sec irisk
display: C2sec irisk
category: Data Enrichment & Threat Intelligence
description: Understand Your Cyber Exposure as Easy as a Google Search
configuration:
- display: API URL (e.g https://api.c2sec.com/api)
  name: endpointURL
  defaultvalue: ""
  type: 0
  required: true
- display: API Key
  name: apikey
  defaultvalue: ""
  type: 4
  required: true
- display: Default Domain Name
  name: domainName
  defaultvalue: ""
  type: 0
  required: true
- display: Trust any certificate (not secure)
  name: unsecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
script:
  script: '-'
  type: python
  commands:
  - name: irisk-add-domain
    arguments:
    - name: domain
      description: Domain to be added into the portfolio (if empty default domain will be used)
    - name: newscan
      required: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Flag to indicate whether we would always start a new scan for the
        domain
      defaultValue: "true"
    outputs:
    - contextPath: C2Sec.Domain.result
      description: result status of adding the new company.
    - contextPath: C2Sec.Domain.Name
      description: The name of the searched domain.
    description: Add a domain into portfolio
  - name: irisk-get-scan-status
    arguments:
    - name: id
      required: true
      description: Domain workitemid whose status to be checked
    outputs:
    - contextPath: C2sec.Domain.Scan.domain
      description: The name of the scanned domain.
      type: string
    - contextPath: C2sec.Domain.Scan.workitemid
      description: The ID of the current scan.
      type: number
    - contextPath: C2sec.Domain.Scan.domain
      description: The scanned domain name.
      type: string
    - contextPath: C2sec.Domain.Scan.completeTime
      description: The time in which the scan was completed.
      type: date
    - contextPath: C2sec.Domain.Scan.creationTime
      description: The time in which the scan was initiated.
      type: date
    - contextPath: C2sec.Domain.Scan.status
      description: The status of the current scan.(processing/completed)
      type: number
    description: Query scan status
  - name: irisk-rescan-domain
    arguments:
    - name: domain
      description: Domain to be rescaned (if empty default domain will be used)
    outputs:
    - contextPath: C2sec.Domain.Scan.domain
      description: The name of the scanned domain.
      type: string
    - contextPath: C2sec.Domain.Scan.workitemid
      description: Scan ID
      type: number
    - contextPath: C2sec.Domain.Scan.result
      description: The scan result status.
      type: string
    description: Initiate a rescan for domain inside portfolio
  - name: irisk-get-domain-issues
    arguments:
    - name: domain
      description: Domain to be queried (if empty default domain it will be used)
    - name: severity
      description: Get issues with severity equal to the one provieded.
    outputs:
    - contextPath: C2sec.Domain.Name
      description: The name of the domain we ran the check against.
      type: string
    - contextPath: C2sec.Domain.Issue.ID
      description: The ID of the issue.
      type: string
    - contextPath: C2sec.Domain.Issue.Asset
      description: Asset associated with the issues. Example, ip addresses, website URLs, etc.
      type: string
    - contextPath: C2sec.Domain.Issue.Component
      description: The component used in the issue.
      type: string
    - contextPath: C2sec.Domain.Issue.ComponentDisplay
      description: The display name of the component being used.
      type: string
    - contextPath: C2sec.Domain.Issue.Details
      description: The details for the issue.
      type: string
    - contextPath: C2sec.Domain.Issue.Issue
      description: The name of the issue.
      type: string
    - contextPath: C2sec.Domain.Issue.Severity
      description: The severity of the issue.
      type: string
    description: Get the issues located under the provided domain.
  - name: irisk-get-scan-results
    arguments:
    - name: domain
      required: true
      description: Domain to be queried (if empty default domain will be used)
    - name: component
      required: true
      auto: PREDEFINED
      predefined:
      - credential
      - network
      - application
      description: Component to be queried
    outputs:
    - contextPath: C2sec.Domain.application.result
      description: Query Status
      type: string
    - contextPath: C2sec.Domain.application.Domain
      description: The domain name being queried.
      type: string
    - contextPath: C2sec.Domain.application.data.appdetail
      description: Details about the app being checked.
      type: string
    - contextPath: C2sec.Domain.application.data.info
      description: Info regarding the data being processed.
      type: string
    - contextPath: C2sec.Domain.application.data.website
      description: Website address being processed.
      type: string
    - contextPath: C2sec.Domain.credential.result
      description: Query Status
      type: string
    - contextPath: C2sec.Domain.credential.Domain
      description: The domain name being queried.
      type: string
    - contextPath: C2sec.Domain.credential.data.user
      description: User name.
      type: string
    - contextPath: C2sec.Domain.credential.data.pw
      description: User password.
      type: string
    - contextPath: C2sec.Domain.network.result
      description: Query Status
      type: string
    - contextPath: C2sec.Domain.network.Domain
      description: The domain name being queried.
      type: string
    - contextPath: C2sec.Domain.network.data.firewall
      description: Firewall status.
      type: string
    - contextPath: C2sec.Domain.network.data.port
      description: Port being used.
      type: string
    - contextPath: C2sec.Domain.network.data.IP
      description: IP address.
      type: string
    - contextPath: C2sec.Domain.network.data.Name
      description: Name of the user.
      type: string
    - contextPath: C2sec.Domain.network.data.service
      description: Name of the service being used.
      type: string
    - contextPath: C2sec.Domain.network.data.protocol
      description: Name of the protocol being used.
      type: string
    - contextPath: C2sec.Domain.network.data.state
      description: State of the network application(open/closed).
      type: string
    description: Query Data for specific component for companies in the portfolio
  runonce: false
