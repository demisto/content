category: Authentication
commonfields:
  id: AutoFocus V2
  version: -1
configuration:
- display: API Key
  name: api_key
  required: true
  type: 4
- defaultvalue: 'true'
  display: Trust any certificate (insecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
description: Integration Template
display: Palo Alto AutoFocus V2
name: AutoFocus V2
script:
  commands:
  - arguments:
    - default: false
      description: The query to retrieve samples
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      defaultValue: '30'
      description: Number of results to provide.
      isArray: false
      name: max_results
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Field to sort by
      isArray: false
      name: sort
      predefined:
      - App Name
      - App Packagename
      - File type
      - Size
      - Finish Date
      - First Seen (Create Date)
      - Last Updated (Update Date)
      - MD5
      - SHA1
      - SHA256
      - Ssdeep Fuzzy Hash
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Order of sort
      isArray: false
      name: order
      predefined:
      - Ascending
      - Descending
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: ' Scope of search'
      isArray: false
      name: scope
      predefined:
      - Private
      - Public
      - Global
      required: true
      secret: false
    deprecated: false
    description: 'Search for samples. To view results run autofocus-samples-search-results
      with the returned Af Cookie. Note: The AF Cookie expires 120 seconds after the
      search completes.'
    execution: false
    name: autofocus-search-samples
    outputs:
    - contextPath: AutoFocus.SamplesSearch.AFCookie
      description: AutoFocus search ID. Use this ID to get search results. The AF
        Cookie expires 120 seconds after the search completes.
      type: String
    - contextPath: AutoFocus.SamplesSearch.SearchStatus
      description: in progress / complete
      type: String
  - arguments:
    - default: false
      description: The query to retrieve samples
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      defaultValue: '30'
      description: Number of results to provide.
      isArray: false
      name: max_results
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Field to sort by
      isArray: false
      name: sort
      predefined:
      - Application
      - Device Country
      - Device Country Code
      - Device Hostname
      - Device Serial
      - Device vsys
      - Destination Country
      - Destination Country Code
      - Destination IP
      - Destination Port
      - Email Charset
      - Industry
      - Source Country
      - Source Country Code
      - Source IP
      - Source Port
      - SHA256
      - Time
      - Upload source
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Order of sort
      isArray: false
      name: order
      predefined:
      - Ascending
      - Descending
      required: false
      secret: false
    deprecated: false
    description: 'Search for sessions. To view results run autofocus-sessions-search-results
      with the returned Af Cookie. Note: The AF Cookie expires 120 seconds after the
      search completes.'
    execution: false
    name: autofocus-search-sessions
    outputs:
    - contextPath: AutoFocus.SessionsSearch.AFCookie
      description: AutoFocus search ID. Use this ID to get search results. The AF
        Cookie expires 120 seconds after the search completes.
      type: String
    - contextPath: AutoFocus.SessionsSearch.SearchStatus
      description: in progress / complete
      type: String
  - arguments:
    - default: false
      description: 'The AF Cookie for retrieving results of previous search. Note:
        The AF Cookie expires 120 seconds after the search completes.'
      isArray: false
      name: af_cookie
      required: true
      secret: false
    deprecated: false
    description: Get results of a previous samples search
    execution: false
    name: autofocus-samples-search-results
    outputs:
    - contextPath: AutoFocus.SamplesResults.Size
      description: File size in bytes
      type: String
    - contextPath: AutoFocus.SamplesResults.SHA1
      description: File SHA1
      type: String
    - contextPath: AutoFocus.SamplesResults.SHA256
      description: File SHA256
      type: String
    - contextPath: AutoFocus.SamplesResults.Created
      description: Date created
      type: Date
    - contextPath: AutoFocus.SamplesResults.Finished
      description: Date finshed
      type: Date
    - contextPath: AutoFocus.SamplesResults.Region
      description: Sample region
      type: String
    - contextPath: AutoFocus.SamplesResults.FileType
      description: File type
      type: String
    - contextPath: AutoFocus.SamplesResults.Tags
      description: Attached tags
      type: String
    - contextPath: AutoFocus.SamplesResults.Verdict
      description: Sample verdict
      type: Number
    - contextPath: AutoFocus.SamplesResults.TagGroups
      description: Groups of relevant tags
      type: String
  - arguments:
    - default: false
      description: 'The AF Cookie for retrieving results of previous search. Note:
        The AF Cookie expires 120 seconds after the search completes.'
      isArray: false
      name: af_cookie
      required: true
      secret: false
    deprecated: false
    description: Get results of a previous sessions search
    execution: false
    name: autofocus-sessions-search-results
    outputs:
    - contextPath: AutoFocus.SessionsResults.FileName
      description: File name
      type: String
    - contextPath: AutoFocus.SessionsResults.ID
      description: Session ID. Used to get session details
      type: String
    - contextPath: AutoFocus.SessionsResults.Industry
      description: Related industry
      type: String
    - contextPath: AutoFocus.SessionsResults.Region
      description: Session regions
      type: String
    - contextPath: AutoFocus.SessionsResults.SHA256
      description: SHA256
      type: String
    - contextPath: AutoFocus.SessionsResults.Seen
      description: Seen date
      type: String
    - contextPath: AutoFocus.SessionsResults.UploadSource
      description: Source uploaded the sample
      type: String
    - contextPath: AutoFocus.SessionsResults.FileURL
      description: File URL
      type: String
    - contextPath: AutoFocus.SessionsResults.Tags
      description: Relevant tags
      type: String
  - arguments:
    - default: false
      description: The session ID
      isArray: false
      name: session_id
      required: true
      secret: false
    deprecated: false
    description: Get session details by session ID
    execution: false
    name: autofocus-get-session-details
  - arguments:
    - default: false
      description: SHA256 of the sample to analyze
      isArray: false
      name: sample_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: Analysis environment
      isArray: false
      name: os
      predefined:
      - win7
      - winxp
      - android
      - static_analyzer
      - mac
      - bare_metal
      required: true
      secret: false
    deprecated: false
    description: Get properties, behaviors, and activities observed for a sample
    execution: false
    name: autofocus-sample-analysis
  - arguments:
    - default: false
      description: The public tag name, can be retreived from the top-tags command.
      isArray: false
      name: tag_name
      required: true
      secret: false
    deprecated: false
    description: Get details on a given tag
    execution: false
    name: autofocus-tag-details
    outputs:
    - contextPath: AutoFocus.Tag.TagName
      description: Tag simple name
      type: String
    - contextPath: AutoFocus.Tag.PublicTagName
      description: Tag public name. Usesd as an ID of the tag.
      type: String
    - contextPath: AutoFocus.Tag.Count
      description: Amount of samples matched this tag.
      type: Number
    - contextPath: AutoFocus.Tag.Lasthit
      description: Tag last encounter date.
      type: Date
    - contextPath: AutoFocus.Tag.TagDefinitionScope
      description: Scope of the tag - public/private/Unit42
      type: String
    - contextPath: AutoFocus.Tag.CustomerName
      description: Organization that created the tag.
      type: String
    - contextPath: AutoFocus.Tag.Source
      description: Organization or individual that discovered the threat defined in
        the tag
      type: String
    - contextPath: AutoFocus.Tag.TagClass
      description: Tag classification
      type: String
    - contextPath: AutoFocus.Tag.TagDefinitionStatus
      description: enabled/disabled/removing/rescoping
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Scope of the search
      isArray: false
      name: scope
      predefined:
      - industry
      - organization
      - all
      - global
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Tag class
      isArray: false
      name: class
      predefined:
      - actor
      - campaign
      - family
      - exploit
      - malicious_behavior
      - malware_family
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      isArray: false
      name: private
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      isArray: false
      name: public
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      isArray: false
      name: commodity
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      isArray: false
      name: unit42
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Perform a search to Identify the most popular tags
    execution: false
    name: autofocus-top-tags-search
    outputs:
    - contextPath: AutoFocus.TopTagsSearch.AFCookie
      description: AutoFocus search ID. Use this ID to get search results. The AF
        Cookie expires 120 seconds after the search completes.
      type: String
    - contextPath: AutoFocus.TopTagsSearch.SearchStatus
      description: in progress / complete
      type: String
  - arguments:
    - default: false
      description: 'The AF Cookie for retrieving results of previous search. Note:
        The AF Cookie expires 120 seconds after the search completes.'
      isArray: false
      name: af_cookie
      required: true
      secret: false
    deprecated: false
    description: Get the results of a previous top tags search
    execution: false
    name: autofocus-top-tags-results
    outputs:
    - contextPath: AutoFocus.TopTagsResults.Count
      description: Amount of samples matched this tag.
      type: Number
    - contextPath: AutoFocus.TopTagsResults.PublicTagName
      description: Tag public name. Usesd as an ID of the tag.
      type: String
    - contextPath: AutoFocus.TopTagsResults.TagName
      description: Tag simple name.
      type: String
    - contextPath: AutoFocus.TopTagsResults.Lasthit
      description: Tag last encounter date.
      type: Date
  dockerimage: demisto/python3:3.7.2.214
  isfetch: false
  runonce: false
  script: '-'
  type: python
