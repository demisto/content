commonfields:
  id: Fidelis Elevate Network
  version: -1
name: Fidelis Elevate Network
display: Fidelis Elevate Network
category: Network Security
description: Automate Detection and Response to Network Threats and data leakage in
  your organization with Fidelis Elevate Network Integration.
configuration:
- display: Server URL
  name: server_url
  defaultvalue: ""
  type: 0
  required: true
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Trust any certificate (not secure)
  name: unsecure
  defaultvalue: "True"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
- display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days, 3 months, 1 year)
  name: fetch_time
  defaultvalue: 3 days
  type: 0
  required: false
script:
  script: ''
  type: python
  commands:
  - name: fidelis-get-alert
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: string
    - contextPath: Fidelis.Alert.ThreatScore
      description: Alert threat score.
      type: number
    - contextPath: Fidelis.Alert.Time
      description: Alert time.
      type: date
    - contextPath: Fidelis.Alert.RuleID
      description: Related rule ID.
      type: string
    - contextPath: Fidelis.Alert.RuleName
      description: Related rule name.
      type: string
    - contextPath: Fidelis.Alert.Summary
      description: Alert summary.
      type: string
    - contextPath: Fidelis.Alert.PolicyName
      description: Related policy name.
      type: string
    - contextPath: Fidelis.Alert.Severity
      description: Alert severity.
      type: string
    - contextPath: Fidelis.Alert.Protocol
      description: Protocol involved in the alert.
      type: string
    - contextPath: Fidelis.Alert.Type
      description: Alert type.
      type: string
    - contextPath: Fidelis.Alert.AssignedUser
      description: Assigned user ID.
      type: string
    description: Gets alert details from Fidelis Elevate.
  - name: fidelis-delete-alert
    arguments:
    - name: alert_id
      required: true
      description: ID of the alert to delete.
      isArray: true
    description: Deletes an alert from Fidelis Elevate.
  - name: fidelis-get-malware-data
    arguments:
    - name: alert_id
      required: true
      description: Alert ID.
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: string
    - contextPath: Fidelis.Alert.Malware.Name
      description: Malware name.
      type: string
    - contextPath: Fidelis.Alert.Malware.Type
      description: Malware type.
      type: string
    - contextPath: Fidelis.Alert.Malware.Behavior
      description: Malware behavior.
      type: string
    - contextPath: Fidelis.Alert.Malware.Platform
      description: Malware platform.
      type: string
    - contextPath: Fidelis.Alert.Malware.DetailName
      description: Malware detail name from Fidelis Elevate.
      type: string
    - contextPath: Fidelis.Alert.Malware.Variant
      description: Malware variant.
      type: string
    - contextPath: Fidelis.Alert.Malware.Description
      description: Malware description from Fidelis Elevate.
      type: string
    description: Retrieves malware data related to a "Malware" type alert.
  - name: fidelis-get-alert-pcap
    deprecated: true
    arguments:
    - name: alert_id
      required: true
      description: ID of the alert for which to get the PCAP file.
    description: Retrieves the alert PCAP from Fidelis Elevate.
  - name: fidelis-get-alert-report
    arguments:
    - name: alert_id
      required: true
      description: Alert ID of the alert for which to download a PDF report.
    description: Downloads a PDF report for a specified alert.
  - name: fidelis-sandbox-upload
    arguments:
    - name: upload_item
      required: true
      description: The file or URL to upload to Fidelis Elevate for analysis.
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID generated from the upload.
      type: string
    description: Uploads a file or a URL for sandbox analysis in Fidelis Elevate.
  - name: fidelis-list-alerts
    arguments:
    - name: time_frame
      auto: PREDEFINED
      predefined:
      - Today
      - Yesterday
      - Last 7 Days
      - Last Hour
      - Last 24 Hours
      - Last 48 Hours
      - Last 30 Days
      - Custom
      description: Filter alerts by time frame, for example, Last 48 Hours.
    - name: start_time
      description: If the time_frame value is Custom, specify the start time for the
        time range, for example, 2017-06-01T12:48:16.734.
    - name: end_time
      description: If the time_frame value is Custom, specify the end time for the
        time range, for example, 2017-06-01T12:48:16.734.
    - name: severity
      auto: PREDEFINED
      predefined:
      - Low
      - Medium
      - High
      - Critical
      description: Filter alerts by alert severity.
    - name: type
      auto: PREDEFINED
      predefined:
      - Endpoint
      - DSI
      - DPI
      - DNS
      - Malware
      - Mail
      - File Upload
      - Collector Feed
      - Analytics
      description: Filter alerts by alert type.
    - name: threat_score
      description: Filter alerts by alert threat score threshold (higher than).
    - name: ioc
      description: Filter alerts that are related to a specified IOC.
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: string
    - contextPath: Fidelis.Alert.Time
      description: Alert time.
      type: date
    - contextPath: Fidelis.Alert.Summary
      description: Alert summary.
      type: string
    - contextPath: Fidelis.Alert.Severity
      description: Alert severity.
      type: string
    - contextPath: Fidelis.Alert.Type
      description: Alert type.
      type: string
    description: Returns a list of open alerts from Fidelis Elevate.
  - name: fidelis-upload-pcap
    arguments:
    - name: component_ip
      required: true
      description: Component IP address.
    - name: entry_id
      required: true
      description: War Room entry ID of the PCAP file, for example, "3245@6".
    description: Uploads a PCAP file to Fidelis Elevate for analysis.
  - name: fidelis-list-pcap-components
    arguments: []
    outputs:
    - contextPath: Fidelis.Component.Name
      description: Component name.
      type: string
    - contextPath: Fidelis.Component.IP
      description: Component IP address.
      type: string
    description: Gets PCAP components.
  - name: fidelis-run-pcap
    arguments:
    - name: component_ip
      required: true
      description: Component IP address. Run the 'fidelis-list-pcap-components' command
        to get this value.
    - name: files
      required: true
      description: CSV list of PCAP file names in Fidelis Elevate.
    description: Runs PCAP file analysis in Fidelis Elevate.
  - name: fidelis-get-alert-by-uuid
    arguments:
    - name: alert_uuid
      required: true
      description: The UUID of the alert.
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: Number
    - contextPath: Fidelis.Alert.Severity
      description: Alert severity.
      type: String
    - contextPath: Fidelis.Alert.Summary
      description: Alert summary.
      type: String
    - contextPath: Fidelis.Alert.Time
      description: Alert time.
      type: Date
    - contextPath: Fidelis.Alert.Type
      description: Alert type.
      type: String
    - contextPath: Fidelis.Alert.UUID
      description: Alert UUID.
      type: String
    description: Returns an alert, by UUID.
  - name: fidelis-list-metadata
    arguments:
    - name: time_frame
      auto: PREDEFINED
      predefined:
      - Today
      - Yesterday
      - Last 7 Days
      - Last Hour
      - Last 24 Hours
      - Last 48 Hours
      - Last 30 Days
      - Custom
      description: Filter alerts by time frame, for example, Last 48 Hours.
    - name: start_time
      auto: PREDEFINED
      predefined:
      - ""
      description: If the time_frame value is Custom, specify the start time for the
        time range, for example, 2017-06-01T12:48:16.734.
    - name: end_time
      description: If the time_frame value is Custom, specify the end time for the
        time range, for example,2017-06-01T12:48:16.734.
    - name: client_ip
      description: Filter alerts by client IP.
    - name: server_ip
      description: Filter alerts by server IP address.
    - name: request_direction
      auto: PREDEFINED
      predefined:
      - s2c
      - c2s
      description: Direction of the request. Can be "s2c" (server to client) or "c2s"
        (client to server).
    outputs:
    - contextPath: Fidelis.Metadata.MalwareName
      description: Malware name.
      type: String
    - contextPath: Fidelis.Metadata.ServerPort
      description: Server port number.
      type: Number
    - contextPath: Fidelis.Metadata.SHA256
      description: SHA256 hash of the file.
      type: String
    - contextPath: Fidelis.Metadata.FileName
      description: File name.
      type: String
    - contextPath: Fidelis.Metadata.PcapFilename
      description: PCAP file name.
      type: String
    - contextPath: Fidelis.Metadata.SessionDuration
      description: The event session duration.
      type: String
    - contextPath: Fidelis.Metadata.ServerIP
      description: The server IP address.
      type: String
    - contextPath: Fidelis.Metadata.ClientCountry
      description: The client country.
      type: String
    - contextPath: Fidelis.Metadata.ClientPort
      description: The client port number.
      type: Number
    - contextPath: Fidelis.Metadata.SessionStart
      description: The date/time that the session started.
      type: Date
    - contextPath: Fidelis.Metadata.MalwareType
      description: The malware type.
      type: String
    - contextPath: Fidelis.Metadata.URL
      description: Request URL.
      type: String
    - contextPath: Fidelis.Metadata.RequestDirection
      description: 'Request direction (s2c or c2s). '
      type: String
    - contextPath: Fidelis.Metadata.MalwareSeverity
      description: The severity of the malware.
      type: String
    - contextPath: Fidelis.Metadata.ClientIP
      description: The client IP address.
      type: String
    - contextPath: Fidelis.Metadata.ServerCountry
      description: The country of the server.
      type: String
    - contextPath: Fidelis.Metadata.PcapTimestamp
      description: PCAP timestamp.
      type: Date
    - contextPath: Fidelis.Metadata.SensorUUID
      description: Sensor UUID.
      type: String
    - contextPath: Fidelis.Metadata.Timestamp
      description: Timestamp of the event.
      type: Date
    - contextPath: Fidelis.Metadata.FileType
      description: File type.
      type: String
    - contextPath: Fidelis.Metadata.Protocol
      description: Event protocol.
      type: String
    - contextPath: Fidelis.Metadata.UserAgent
      description: User agent of the request.
      type: String
    - contextPath: Fidelis.Metadata.Type
      description: Type of the event.
      type: String
    - contextPath: Fidelis.Metadata.FileSize
      description: The size of the file.
      type: Number
    - contextPath: Fidelis.Metadata.MD5
      description: MD5 hash of the file.
      type: String
    description: Returns a metadata list.
  - name: fidelis-list-alerts-by-ip
    arguments:
    - name: time_frame
      description: Today,Yesterday,Last 7 Days,Last Hour,Last 24 Hours,Last 48 Hours,Last
        30 Days,Custom
    - name: start_time
      description: If the time_frame value is Custom, specify the start time for the
        time range, for example, 2017-06-01T12:48:16.734.
    - name: end_time
      description: If the time_frame value is Custom, specify the start time for the
        time range, for example, 2017-06-01T12:48:16.734.
    - name: src_ip
      description: Filter alerts by the source IP.
    - name: dest_ip
      description: Filter alerts by the destination IP address.
    outputs:
    - contextPath: Fidelis.Alert.SourceIP
      description: 'The alert source IP address. '
      type: String
    - contextPath: Fidelis.Alert.UserRating
      description: User rating.
      type: String
    - contextPath: Fidelis.Alert.DestinationCountry
      description: Destination country of the alert.
      type: String
    - contextPath: Fidelis.Alert.AssetID
      description: The ID of the asset.
      type: Number
    - contextPath: Fidelis.Alert.Time
      description: Date/time that the alert started.
      type: Date
    - contextPath: Fidelis.Alert.HostIP
      description: The host IP address of the alert.
      type: String
    - contextPath: Fidelis.Alert.DistributedAlertID
      description: Alert distributed ID.
      type: String
    - contextPath: Fidelis.Alert.DestinationIP
      description: Alert destination IP address.
      type: String
    - contextPath: Fidelis.Alert.AlertUUID
      description: The alert UUID.
      type: String
    - contextPath: Fidelis.Alert.Type
      description: The alert type.
      type: String
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: Number
    - contextPath: Fidelis.Alert.SourceCountry
      description: Alert source country
      type: String
    description: Returns a list of alerts, by source IP address or destination IP
      address.
  - name: fidelis-download-malware-file
    arguments:
    - name: alert_id
      required: true
      description: ID of the alert from which to download the file.
    outputs:
    - contextPath: File.Size
      description: The size of the file.
      type: Number
    - contextPath: File.Extension
      description: 'The file extension. '
      type: String
    - contextPath: File.Info
      description: Information about the file.
      type: String
    - contextPath: File.Name
      description: The name of the file.
      type: String
    - contextPath: File.SHA1
      description: SHA1 hash of the file.
      type: String
    - contextPath: File.Type
      description: The file type.
      type: String
    - contextPath: File.SHA256
      description: SHA256 hash of the file.
      type: String
    - contextPath: File.SSDeep
      description: SSDeep hash of the file.
      type: String
    - contextPath: File.EntryID
      description: File entry ID.
      type: String
    - contextPath: File.MD5
      description: MD5 hash of the file.
      type: String
    description: Downloads a malware file from a specified alert.
  - name: fidelis-download-pcap-file
    arguments:
    - name: alert_id
      required: true
      description: The ID of the alert from which to download the file.
    outputs:
    - contextPath: File.EntryID
      description: The entry ID of the file.
      type: String
    - contextPath: File.Info
      description: File information.
      type: String
    - contextPath: File.Name
      description: Name of the file.
      type: String
    - contextPath: File.Size
      description: File size
      type: Number
    - contextPath: File.Type
      description: File type.
      type: String
    - contextPath: File.SHA1
      description: SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: SHA256 hash of the file.
      type: String
    - contextPath: File.SSDeep
      description: SSDeep hash of the file.
      type: String
    - contextPath: File.MD5
      description: MD5 hash of the file.
      type: String
    description: Downloads the PCAP file from a specified alert.
  - name: fidelis-get-alert-sessiondata
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: string
    description: Returns the session information related to an alert
  - name: fidelis-get-alert-ef
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    outputs:
    - contextPath: Fidelis.Alert.ID
      description: Alert ID.
      type: string
    description: Pulls the exectution forensics for an alert
  - name: fidelis-get-alert-forensictext
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    description: Pulls the text of the forensic data
  - name: fidelis-get-alert-dpath
    description: Get alert dpath
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
  - name: fidelis-update-alertstatus
    description: Update alert status
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    - name: status
      auto: PREDEFINED
      predefined:
      - "1"
      - "2"
      - "3"
      - "4"
      description: status_score (1 False Positive, etc)
    - name: explicitScore
      required: true
      description: explicitScore
  - name: fidelis-alert-ef-submission
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    description: submits a file to the fidelis sandbox
  - name: fidelis-add-alert-comment
    arguments:
    - name: alert_id
      description: Alert ID
    - name: comment
      required: true
      description: comment
    description: adds a comment to an alert
  - name: fidelis-manage-alert-assignuser
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    - name: comment
      description: comment
    - name: assignToUser
      required: true
      description: assignToUser
    description: fidelis-manage-alert-assignuser
  - name: fidelis-manage-alert-closealert
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    - name: comment
      description: comment
    - name: assignToUser
      description: assignToUser
    - name: resolution
      required: true
      description: resolution
    description: closes a fidelis alert and can assign a user
  - name: fidelis-manage-alert-label
    arguments:
    - name: alert_id
      required: true
      description: Alert ID
    - name: label
      required: true
      description: label
    description: adds a label to an alert
  - name: fidelis-upload-URL
    arguments:
    - name: url
      required: true
      description: url
    description: uploads a URL to Fidelis
  isfetch: true
  runonce: false
