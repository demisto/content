commonfields:
  id: FireEye iSIGHT
  version: -1
name: FireEye iSIGHT
display: FireEye iSIGHT
category: Data Enrichment
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAAAhCAYAAADqBZQaAAAACXBIWXMAAAsTAAALEwEAmpwYAAA5o2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMTEgNzkuMTU4MzI1LCAyMDE1LzA5LzEwLTAxOjEwOjIwICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTYtMDItMTZUMjA6MzU6MDQrMDI6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNi0wMy0wN1QxOTozNDo1OCswMjowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTYtMDMtMDdUMTk6MzQ6NTgrMDI6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6NjcyNWNjN2EtMWIwNi00YmFkLWE5NWYtOGZhYjhlOTM2MzkyPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjU3NjcwNUE4QUJGRDExRTRBNkRGQTdERTVEODg4RERDPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOjU3NjcwNUE1QUJGRDExRTRBNkRGQTdERTVEODg4RERDPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOjU3NjcwNUE2QUJGRDExRTRBNkRGQTdERTVEODg4RERDPC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6NTc2NzA1QThBQkZEMTFFNEE2REZBN0RFNUQ4ODhEREM8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjY3MjVjYzdhLTFiMDYtNGJhZC1hOTVmLThmYWI4ZTkzNjM5Mjwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNi0wMy0wN1QxOTozNDo1OCswMjowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjExNTwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zMzwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+v9TwCwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAKLklEQVR42uyae3BU1R3HP+fuZjck5AmJIIKKWkUpoC2+sHUc1Ep9V2oVtUWpWKtWKVZGW7XWtmqtM2KLtTi+Kg8piEhVBHxMBx/1gVqLaAvKK0AeELPJ5rXJ3tM/7nfluu5uNiES2tnfzJ3N3px7zrm/x/f3/f3Omo8OHksvSDEwAniD/wMxuk7fvJV1sXZ928v26DjgfH5fToHj4Oz+3FFgEjCMnPSZOCujzcQs9Hcc8o0hz/TIC13gTeDSnEr7TgLPNMVZ2BSlyXUJYmi3lv3yggDEuzfXf4DpwBqg5v8BZudFmqiPx/dOmDUGkgLPwEDA6jIUOA7nFBUxpbSEEeEQnUCL62a7xpPAduDqXM7sg5y5a/sOYGhxLfMiDZy5pYqLtm5nebSZQsfJ9nUc4NAc4PWNBNPZpMW1vNzcxNutLYQHD+akwgJaXBebAbKBQ4BVObX2EQHqIqXS5FqmbNvOnIYI+ZmZ71HAvsBs4HLgyJx69ypjehDcYeHG2loWRBoJGZMOcs8DHgVqgd8BhTn17nXG3DX0hppqZtU3MDAQSDZoULnyHn2WAmNz6t1r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
description: FireEye cyber threat intelligence
configuration:
- display: Public Key
  name: publicKey
  defaultvalue: ""
  type: 0
  required: true
- display: Private Key
  name: privateKey
  defaultvalue: ""
  type: 4
  required: true
- display: Version
  name: version
  defaultvalue: "2.5"
  type: 0
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |

    var baseUrl = 'https://api.isightpartners.com'; // iSight base url
    var publicKey = params.publicKey;
    var privateKey = params.privateKey;
    var acceptVersion = params.version;
    var insecure = params.insecure;
    var proxy = params.proxy;

    var VENDOR_NAME = 'FireEye iSIGHT';

    // we use this to map record-type to dbot-score
    var intelligenceTypeToScore = {
        'overview': 1,
        'vulnerability': 2,
        'malware': 3,
        'threat': 3
    };

    // we use this to determine the order of reputation sevirity of the types
    var intelligenceTypeOrder = ['overview', 'vulnerability', 'malware', 'threat'];

    var epoch2DateStr = function(epochStr) {
        return new Date(parseInt(epochStr) * 1000).toString();
    }

    var createTableEntry = function (name, contents, table, context) {
        return {
            // type
            Type: entryTypes.note,
             // contents
            ContentsFormat: formats.json,
            Contents: contents,
            // human-readable
            ReadableContentsFormat: formats.markdown,
            HumanReadable: tableToMarkdown(name, table),
            // context
            EntryContext: context
        };
    }

    var getHeaders = function(query) {
        var timestamp = new Date().toUTCString();
        message = query + acceptVersion + 'application/json' + timestamp;
        hashed = HMAC_SHA256_MAC(privateKey, message);

        return {
            'Accept': ['application/json'],
            'Accept-Version': [acceptVersion],
            'X-Auth': [publicKey],
            'X-Auth-Hash': [hashed],
            'Date': [timestamp]
        }
    }

    var sendRequest = function(query) {
        var headers = getHeaders(query);
        var requestUrl = baseUrl + query;

        var res = http(
            requestUrl,
            {
                Method: 'GET',
                Headers: headers,
                Body: ''
            },
            insecure,
            proxy
        );

        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Request Failed.\nUrl: ' + requestUrl + '\nStatus code: ' + res.StatusCode + '.\nResult: ' + JSON.stringify(res);
        }

        if (res.StatusCode === 204) {
            return [];
        }

        var body = JSON.parse(res.Body);
        if (!body || !body.success) {
            throw 'Request Failed.\nResonse body: ' + body;
        }
        return body;
    };

    var basicSearch = function(key, value) {
        var basicSearchQuery = '/search/basic?' + key + '=' + encodeURIComponent(value);
        var res = sendRequest(basicSearchQuery);
        return res.message;
    }

    var createContextReportsAndScore = function(records) {
        var dbotScore = 0;
        var highetsRecordType = 'None';
        var reports = [];

        // 1. set dbotScore to to the highest record-type among all records
        // 2. create report context-object for each record
        records && records.forEach(function(record) {
           var recordType = record['intelligenceType'];
           var recordScore =  intelligenceTypeToScore[recordType] || 0;
           if (dbotScore < recordScore) {
               dbotScore = recordScore;
           }
           if(intelligenceTypeOrder.indexOf(highetsRecordType) < intelligenceTypeOrder.indexOf(recordType)) {
               highetsRecordType = recordType;
           }
           var reportUrl = record['reportLink'];
           reports.push({
               ID: record['reportId'],
               title: record['title'],
               publishDate: epoch2DateStr(record['publishDate']),
               intelligenceType: recordType
           });
        });

        return {
            dbotScore: dbotScore,
            reports: reports,
            highetsRecordType: highetsRecordType
        }
    }

    var basicSearchIP = function(ip) {
        var records = basicSearch('ip', ip);

        if (!records) {
            return "No items match your search";
        }

        var res = createContextReportsAndScore(records);
        var context = {
            DBotScore: {Indicator: ip, Type: 'IP', Vendor: VENDOR_NAME, Score: res.dbotScore},
            'Report(val.ID && val.ID == obj.ID)': res.reports
        };

        if (res.dbotScore > 2) {
            addMalicious(context, outputPaths.ip,{
                Address: ip,
                Malicious: {Vendor: VENDOR_NAME, Description: 'IP was identified as ' + res.highetsRecordType}
            });
        }

        return createTableEntry("Results:", records, records, context);
    }

    var basicSearchDomain = function(domain) {
        var records = basicSearch('domain', domain);

        if (!records) {
            return "No items match your search";
        }

        var res = createContextReportsAndScore(records);
        var context = {
            DBotScore: {Indicator: domain, Type: 'domain', Vendor: VENDOR_NAME, Score: res.dbotScore},
            'Report(val.ID && val.ID == obj.ID)': res.reports
        };

        if (res.dbotScore > 2) {
            addMalicious(context, outputPaths.domain,{
                Name: domain,
                Malicious: {Vendor: VENDOR_NAME, Description: 'domain was identified as ' + res.highetsRecordType}
            });
        }

        return createTableEntry("Results:", records, records, context);
    }

    var basicSearchfile = function(key, value) {
        var records = basicSearch(key, value);

        if (!records) {
            return "No items match your search";
        }

        var res = createContextReportsAndScore(records);
        var context = {
            DBotScore: {Indicator: value, Type: 'file', Vendor: VENDOR_NAME, Score: res.dbotScore},
            'Report(val.ID && val.ID == obj.ID)': res.reports
        };

        if (res.dbotScore > 2) {
            var malicuousObj = {
                Malicious: {
                    Vendor: VENDOR_NAME,
                    Description: 'file was identified as ' + res.highetsRecordType
                }
            };
            malicuousObj[key.toUpperCase()] = value;
            addMalicious(context, outputPaths.file, malicuousObj);
        }

        return createTableEntry("Results:", records, records, context);
    }

    var getReport = function(reportID) {
        var reportQuery = '/report/'+ encodeURIComponent(reportID);

        var res = sendRequest(reportQuery);
        var report = res.message.report;

        var context = {
            'Report(val.ID && val.ID == obj.ID)' : {
                ID: report.reportId,
                title: report.title,
                intelligenceType: report.intelligenceType,
                audience: report.audience,
                publishDate: report.publishDate,
                ThreatScape: report.ThreatScape.product,
                operatingSystems: report.operatingSystems,
                riskRating: report.riskRating,
                version: report.version,
                tagSection: report.tagSection
            }
        }

        var table = [{
            ID: report.reportId,
            title: report.title,
            intelligenceType: report.intelligenceType,
            audience: report.audience.join(),
            publishDate: report.publishDate,
            ThreatScape: report.ThreatScape.product.join(),
            operatingSystems: report.operatingSystems,
            riskRating: report.riskRating,
            version: report.version
        }];

        return createTableEntry("Report - " + reportID, res, table, context);
    }

    var submitFile = function(entryID, description, type) {
        var query = '/submit/data';
        var requestUrl = baseUrl + query;
        var headers = getHeaders(query);
        var res = httpMultipart(
                requestUrl, // URL
                entryID, // Optional - FilePath / EntryID
                { // HTTP Request Headers
                    Method: 'POST',
                    Headers: headers
                },
                { // Multipart Contents
                    type: type,
                    description: description
                },
                insecure,
                proxy
            );

        var statusCode = res && res.StatusCode;

        switch (statusCode) {
            case 200:
                return "The file was submitted sucessfully";
            case 403:
                throw "\nGot 403 error\nQuery valid but the response was refused because the user has exceeded their daily quota of submission requests";
            default:
                throw '\nSubmit File Failed.\nUrl: ' + requestUrl + '\nStatus code: ' + statusCode + '.\nResult: ' + JSON.stringify(res, null, 2);
        }
    }

    switch (command) {
        case 'test-module':
            basicSearch('ip', '66.34.253.56');
            return 'ok';
        case 'ip':
            return basicSearchIP(args.ip);
        case 'domain':
            return basicSearchDomain(args.domain);
        case 'file':
            var hash = args.file;
            var hashLength = hash && hash.length
            if(hashLength === 32) {
                return basicSearchfile('md5', hash);
            } else if(hashLength === 40) {
                return basicSearchfile('sha1', hash);
            } else {
                throw 'file argument must be md5(32 charecters) or sha1(40 charecters) ';
            }
        case 'isight-get-report':
            return getReport(args.reportID);
        case 'isight-submit-file':
            return submitFile(args.entryID, args.description, args.type);
    }
  type: javascript
  commands:
  - name: ip
    arguments:
    - name: ip
      required: true
      default: true
      description: ip to search by
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
    description: basic search reports by ip
  - name: domain
    arguments:
    - name: domain
      required: true
      default: true
      description: domain to search by
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
    description: basic search reports by domain
  - name: file
    arguments:
    - name: file
      description: md5 or sha1 to search by
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
    description: basic search file report by md5/sha1. NOTE - specify only one of
      md5/sha1 arguments
  - name: isight-get-report
    arguments:
    - name: reportID
      required: true
      default: true
      description: Report ID to search by
    outputs:
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
    - contextPath: Report.audience
      description: Report audience
    - contextPath: Report.ThreatScape
      description: Report threat scape
    - contextPath: Report.operatingSystems
      description: Report operating systems
    - contextPath: Report.riskRating
      description: Report risk rating
    - contextPath: Report.version
      description: Report version
    - contextPath: Report.tagSection
      description: Report tag section
    description: Get specific report
  - name: isight-submit-file
    arguments:
    - name: entryID
      required: true
      default: true
      description: entry-id of the file to submit (e.g. 41@18)
    - name: description
      required: true
      description: file description
    - name: type
      description: "Type of the given file"
      required: true
      auto: PREDEFINED
      predefined:
      - malware
      - other
    description: Submission of malware and other files for community sharing
hidden: false
