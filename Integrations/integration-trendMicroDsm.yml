commonfields:
  id: Trend Micro
  version: -1
name: Trend Micro
system: true
display: Trend Micro
category: Endpoint
image: data:image/png;base64,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
description: Uses Trend Micro Deep Security
detaileddescription: |+
  To enable API access, configure the following using the Web UI of the Trend Micro Deep Security Manager:
  - Enable the SOAP API:
  Administration -> System Settings -> Advanced -> SOAP Web Service API -> Enable
  -  Connecting user must have the role "Allow Access to web services API" checked.

configuration:
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Server URL and port (e.g. https://192.168.0.1:4119)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
script:
  script: |2+

    var username = params.credentials.identifier;
    var password = params.credentials.password;
    var server = params.server.replace(/[\/]+$/, '');
    var insecure = params.insecure;
    var proxy = params.proxy;
    var url = server + '/webservice/Manager';


    var responseDict = {
        'authenticate': /<authenticateReturn>(.*)<\/authenticateReturn/,
        'hostRetrieveAll': /<soapenv:Body>((.|\n)*)<\/soapenv:Body>/,
        'endSession': /<soapenv:Body><endSessionResponse xmlns=(.*)\/><\/soapenv:Body>/,
        'systemEventRetrieve': /<systemEventRetrieveResponse xmlns="urn:Manager">((.|\n)*)<\/systemEventRetrieveResponse>/,
        'antiMalwareEventRetrieve':/<antiMalwareEventRetrieveResponse xmlns="urn:Manager">((.|\n)*)<\/antiMalwareEventRetrieveResponse>/,
        'hostAntiMalwareScan':/<soapenv:Body>((.|\n)*)<\/soapenv:Body>/,
        'alertStatusRetrieve':/<soapenv:Body>((.|\n)*)<\/soapenv:Body>/,
        'securityProfileRetrieveAll': /<soapenv:Body>((.|\n)*)<\/soapenv:Body>/,
        'securityProfileAssignToHost': /<soapenv:Body>((.|\n)*)<\/soapenv:Body>/
    };



    var commandToMethod = {
        'trendmicro-host-antimalware-scan': 'hostAntiMalwareScan',
        'trendmicro-host-retrieve-all': 'hostRetrieveAll',
        'trendmicro-system-event-retrieve': 'systemEventRetrieve',
        'trendmicro-anti-malware-event-retrieve': 'antiMalwareEventRetrieve',
        'trendmicro-alert-status': 'alertStatusRetrieve',
        'trendmicro-security-profile-retrieve-all': 'securityProfileRetrieveAll',
        'trendmicro-security-profile-assign-to-host': 'securityProfileAssignToHost'
    };

    var sessionData = '<urn:sID>%sessionId%</urn:sID>';

    var methodDict = {
            'authenticate': '<urn:authenticate><urn:username>%username%</urn:username><urn:password>%password%</urn:password></urn:authenticate>',
            'endSession': '<urn:endSession>' + sessionData + '</urn:endSession>',
            'hostRetrieveAll': '<urn:hostRetrieveAll>' + sessionData + '</urn:hostRetrieveAll>',
            'systemEventRetrieve': '<urn:systemEventRetrieve>%timeFilter%%hostFilter%%eventIdFilter%<urn:includeNonHostEvents>%includeNonHostEvents%</urn:includeNonHostEvents>'+ sessionData +'</urn:systemEventRetrieve>',
            'antiMalwareEventRetrieve': '<urn:antiMalwareEventRetrieve>%timeFilter%%hostFilter%%eventIdFilter%'+ sessionData +'</urn:antiMalwareEventRetrieve>',
            'hostAntiMalwareScan': '<urn:hostAntiMalwareScan>%hostIDs%' + sessionData + '</urn:hostAntiMalwareScan>',
            'alertStatusRetrieve': '<urn:alertStatusRetrieve><urn:count>%count%</urn:count>' + sessionData + '</urn:alertStatusRetrieve>',
            'securityProfileRetrieveAll': '<urn:securityProfileRetrieveAll>' + sessionData + '</urn:securityProfileRetrieveAll>',
            'securityProfileAssignToHost':'<urn:securityProfileAssignToHost><urn:securityProfileID>%securityProfileID%</urn:securityProfileID>%hostIDs%' + sessionData + '</urn:securityProfileAssignToHost>'
    };

    var filterDict = {
        'timeFilter': '<urn:timeFilter>%timeFilter%</urn:timeFilter>',
        'hostFilter': '<urn:hostFilter>%hostFilter%</urn:hostFilter>',
        'eventIdFilter': '<urn:eventIdFilter>%eventIdFilter%</urn:eventIdFilter>'

    };



    var hostFilterDict = {
        'hostGroupID': '<urn:hostGroupID>%hostGroupID%</urn:hostGroupID>',
        'hostID': '<urn:hostID>%hostID%</urn:hostID>',
        'securityProfileID': '<urn:securityProfileID>%securityProfileID%</urn:securityProfileID>',
        'hostFilterType': '<urn:type>%hostFilterType%</urn:type>'

    };

    var timeFilterDict = {
      'rangeFrom': '<urn:rangeFrom>%rangeFrom%</urn:rangeFrom>',
      'rangeTo': '<urn:rangeTo>%rangeTo%</urn:rangeTo>',
      'specificTime': '<urn:specificTime>%specificTime%</urn:specificTime>',
      'timeFilterType': '<urn:type>%timeFilterType%</urn:type>'
    };

    var eventIdFilterDict = {
      'eventID': '<urn:id>%eventID%</urn:id>',
      'eventFilterOperator': '<urn:operator>%eventFilterOperator%</urn:operator>'
    };

    var filterContentDict = {
        'hostFilter': hostFilterDict,
        'timeFilter': timeFilterDict,
        'eventIdFilter': eventIdFilterDict
    };

    // Wrap host IDs array if exists
    if ('hostIDs' in args) {
            args.hostIDs = '<urn:hostIDs>' + args.hostIDs.split(',').join('</urn:hostIDs><urn:hostIDs>') + '</urn:hostIDs>';
    }

    function getFilterContent(filterName, args) {
        var filterContent = '';
        filterArgsDict = filterContentDict[filterName];
        var argNames = Object.keys(args);
        for (var i = 0; i < argNames.length; i++) {
            if (argNames[i] in filterArgsDict){
            filterContent += filterArgsDict[argNames[i]];
            }
        }
        if (!filterContent) {
            return '';
        }

        var  filterContents = {};
        filterContents[filterName] = filterContent;
        return replaceInTemplates(filterDict[filterName], filterContents);
    }

    // In requests with optional filters, the command arguemnts will determine which filters to add
    function AddFiltersIfNeeded(reqTemplate, args) {
        var filtersForRequest = {};
        var filterNames = Object.keys(filterDict);
        for (var i = 0; i < filterNames.length; i++) {
            var patt = new RegExp(filterNames[i]);
            if (patt.exec(reqTemplate)) {
                var filterContent = getFilterContent(filterNames[i], args);
                filtersForRequest[filterNames[i]] = filterContent;
            }
        }
        return  replaceInTemplates(reqTemplate, filtersForRequest);
    }

    function createSOAPRequest(methodName, args) {
        var request = '<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:urn="urn:Manager"><soapenv:Header/><soapenv:Body>%content%</soapenv:Body></soapenv:Envelope>';
        var bodyWithFilters = AddFiltersIfNeeded(methodDict[methodName], args);
        request = replaceInTemplates(request, {'content': bodyWithFilters}); // add body to request
        request = replaceInTemplates(request, args); // fill arguemnts
        return request;
    }

    function sendSOAPRequest(methodName, args) {
        var req = createSOAPRequest(methodName, args);
        var res = http(
            url,
            {
                Method: 'POST',
                Headers: {
                SOAPAction: [""]
                },
                Body: req
            },
            insecure,
            proxy
        );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
                throw 'Failed to ' + methodName + ', request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
            }
        return res.Body;
    }

    function sendAndParse(method, args) {
        var responseXML = sendSOAPRequest(method, args);
        var match = responseDict[method].exec(responseXML);
        if (match && match[1]) {
            return match[1];
        }
        throw method +' failed';
    }


    function createIncidentFromAlert(singleAlert) {
        var keys = Object.keys(singleAlert);
        var labels = [];
        for (var i = 0; i < keys.length; i++) {
            labels.push({'type': keys[i], 'value': String(singleAlert[keys[i]])});
        }
        var alertTime = new Date(singleAlert.alertDate);
        return {
                "name": singleAlert.alertType,
                "occurred": alertTime,
                "labels": labels,
                "rawJSON": JSON.stringify(singleAlert)
            }
    }

    function fetchIncidents() {
        var lastRun = getLastRun();
        var startTime = lastRun && lastRun.startTime ? lastRun.startTime : 0;
        var maxTime = startTime;
        args.sessionId = sendAndParse('authenticate', {username: username, password: password});
        args.count = 1000;
        var res = JSON.parse(x2j(sendAndParse('alertStatusRetrieve', args)));
        sendAndParse('endSession',args);
        var incidents = [];
        if (res && res.alertStatusRetrieveResponse){
            var alertsDict = res.alertStatusRetrieveResponse.alertStatusRetrieveReturn;
            for (var i in alertsDict) {
                var alertTime = new Date(alertsDict[i].alertDate);
                if (alertTime > startTime) {
                    incidents.push(createIncidentFromAlert(alertsDict[i]));
                    maxTime = Math.max(alertTime, maxTime);
                }
            }
        }
        setLastRun({startTime: maxTime});
        return JSON.stringify(incidents);
    }

    switch (command) {
        case 'test-module':
            if (sendAndParse('authenticate', {username: username, password: password})) {
                return 'ok';
            }
            return 'something is wrong';
        case 'fetch-incidents':
            return fetchIncidents();
        default:
            args.sessionId = sendAndParse('authenticate', {username: username, password: password});
            var res = JSON.parse(x2j(sendAndParse(commandToMethod[command], args)));
            sendAndParse('endSession',args);
            return res;
    }

  type: javascript
  commands:
  - name: trendmicro-host-retrieve-all
    arguments: []
    description: Get all hosts info
  - name: trendmicro-system-event-retrieve
    arguments:
    - name: rangeFrom
      description: Time interval start
    - name: rangeTo
      description: Time interval end
    - name: specificTime
      description: Specific time
    - name: timeFilterType
      auto: PREDEFINED
      predefined:
      - LAST_HOUR
      - LAST_24_HOURS
      - LAST_7_DAYS
      - CUSTOM_RANGE
      - SPECIFIC_TIME
      description: Define time filter mode. mandatory if filtering by time.
    - name: hostGroupID
      description: Filter by host group ID
    - name: hostID
      description: Filter by host ID
    - name: securityProfileID
      description: Filter by host security profile ID
    - name: hostFilterType
      auto: PREDEFINED
      predefined:
      - ALL_HOSTS
      - HOSTS_IN_GROUP
      - HOSTS_USING_SECURITY_PROFILE
      - HOSTS_IN_GROUP_AND_ALL_SUBGROUPS
      - SPECIFIC_HOST
      - MY_HOSTS
      description: Define host filter mode. mandatory if filtering by host/s.
    - name: eventID
      description: filter by event ID
    - name: eventFilterOperator
      auto: PREDEFINED
      predefined:
      - GREATER_THAN
      - LESS_THAN
      - EQUAL
      description: event ID operator
    - name: includeNonHostEvents
      description: Include non-host hevents in filter 
      required: true
      auto: PREDEFINED
      predefined:
      - "false"
      - "true"
    description: Get system events
  - name: trendmicro-host-antimalware-scan
    arguments:
    - name: hostIDs
      required: true
      description: list of host ids to scan, separated by commas
    description: scan computers by host ID list
    execution: true
  - name: trendmicro-alert-status
    arguments:
    - name: count
      required: true
      description: Number of alerts to fetch
    description: Get last alerts
  - name: trendmicro-security-profile-retrieve-all
    arguments: []
    description: Get all security profiles
  - name: trendmicro-security-profile-assign-to-host
    arguments:
    - name: securityProfileID
      required: true
      description: security profile ID that will be assigned to the hosts
    - name: hostIDs
      required: true
      description: list of host IDs, separated by commas
    execution: true
    description: Assign security profile to host
  - name: trendmicro-anti-malware-event-retrieve
    description: Retrive anti malware event
    arguments:
    - name: rangeFrom
      description: Time interval start
    - name: rangeTo
      description: Time interval end
    - name: specificTime
      description: Specific Time
    - name: timeFilterType
      auto: PREDEFINED
      predefined:
      - LAST_HOUR
      - LAST_24_HOURS
      - LAST_7_DAYS
      - CUSTOM_RANGE
      - SPECIFIC_TIME
      description: Define time filter mode. mandatory if filtering by time.
    - name: hostGroupID
      description: Filter by host group ID
    - name: hostID
      description: Filter by host ID
    - name: securityProfileID
      description: Filter by host security profile ID
    - name: hostFilterType
      auto: PREDEFINED
      predefined:
      - ALL_HOSTS
      - HOSTS_IN_GROUP
      - HOSTS_USING_SECURITY_PROFILE
      - HOSTS_IN_GROUP_AND_ALL_SUBGROUPS
      - SPECIFIC_HOST
      - MY_HOSTS
      description: Define host filter mode. mandatory if filtering by host/s.
    - name: eventID
      description: filter by event ID
    - name: eventFilterOperator
      auto: PREDEFINED
      predefined:
      - GREATER_THAN
      - LESS_THAN
      - EQUAL
      description: event ID operator
    description: Get anti malware events
  isfetch: true
