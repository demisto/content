category: Database
commonfields:
  id: MongoDBImpacted
  version: -1
configuration:
- display: MongoDB Username
  name: credentials
  required: true
  type: 9
- defaultvalue: mongodb://172.16.202.134:27017
  display: mongodb://<IP/FQDN>:<Port Number>
  name: URI
  required: true
  type: 0
- defaultvalue: demisto
  display: MongoDB Database Name
  name: DB
  required: true
  type: 0
- defaultvalue: impacted
  display: MongoDB Collection Name
  name: COLLECTION
  required: true
  type: 0
description: "Manipulates a collection of impacted entities -  - utilizing the MongoDB\
  \ collection named \"impacted\". \n\nThis Integration needs to be run in a Docker\
  \ container which has the pymongo dependency added.\n\nIntegration uses SCRAM-SHA-1\
  \ authentication to the backend Mongo database, but functions with noauth as well\
  \ (MongoDB configuration). This was limited by the supported pymongo, further limited\
  \ by the Python version supported by Demisto (read: Wanted to use SCRAM-SHA-256)."
display: MongoDBImpacted
name: MongoDBImpacted
script:
  commands:
  - arguments:
    - default: false
      description: Demisto's Incident Number
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name of the impacted entity
      isArray: false
      name: name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Impacted entity Category
      isArray: false
      name: category
      predefined:
      - user
      - server
      - endpoint
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Impacted entity Classification
      isArray: false
      name: classification
      predefined:
      - associate
      - privileged
      - service
      required: false
      secret: false
    - default: false
      description: Action(s) performed
      isArray: false
      name: action
      required: false
      secret: false
    deprecated: false
    description: Adds an impacted entity for the incident.  If an impacted record
      already exists, previous values are overwritten.
    execution: false
    name: WriteImpacted
  - arguments:
    - default: false
      description: Incident ID
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name of impacted entity
      isArray: false
      name: name
      required: true
      secret: false
    deprecated: false
    description: Return record of incident's impacted entity.
    execution: false
    name: GetImpacted
  - arguments:
    - default: false
      description: Incident ID
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Returns json of impacted entities.
    execution: false
    name: ListImpacted
  - arguments:
    - default: false
      description: Incident ID
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Returns the total number of impacted entities for an incident.
    execution: false
    name: NumImpacted
  - arguments:
    - default: false
      description: Incident ID
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Name of the impacted entity
      isArray: false
      name: name
      required: true
      secret: false
    deprecated: false
    description: Deletes an incident's impacted entity.
    execution: false
    name: DeleteImpacted
  - arguments:
    - default: false
      description: Incident ID
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Purges ALL impacted entities for an incident.  Possibly called when
      closing an incident to clear entries from database.
    execution: false
    name: PurgeImpacted
  dockerimage: demisto/mongoclient1:latest
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: true
  script: '-'
  subtype: python3
  type: python
sourcemoduleid: MongoDBImpacted
