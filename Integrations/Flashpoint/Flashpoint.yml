commonfields:
  id: Flashpoint
  version: -1
name: Flashpoint
display: Flashpoint
category: Data Enrichment & Threat Intelligence
description: Use flashpoint integration for reduced business risk.
configuration:
- display: URL
  name: url
  defaultvalue: "https://fp.tools"
  type: 0
  required: true
- display: API Key
  name: api_key
  defaultvalue: ""
  type: 12
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: ''
  type: python
  commands:
  - name: ip
    arguments:
    - name: ip
      default: true
      required: false
      description: The IP to check the given ip is malicious or suspicious.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: IP.Address
      description: IP address
      type: string
    - contextPath: IP.Malicious.Description
      description: Description of malicious ip.
      type: string
    - contextPath: IP.Malicious.Vendor
      description: Vandor of malicious ip.
      type: string
    - contextPath: Flashpoint.IP.Event.Href
      description: List of reference link of the indicator
      type: string
    - contextPath: Flashpoint.IP.Event.Address
      description: IP address of the indicator
      type: string
    - contextPath: Flashpoint.IP.Event.EventDetails
      description: Event details in which the indicator observed
    - contextPath: Flashpoint.IP.Event.Category
      description: Category of the indicator
      type: string
    - contextPath: Flashpoint.IP.Event.Fpid
      description: Fp-id of the indicator
      type: string
    - contextPath: Flashpoint.IP.Event.Timestamp
      description: Time at which indicaor observed
      type: string
    - contextPath: Flashpoint.IP.Event.Type
      description: Type of the indicator
      type: string
    - contextPath: Flashpoint.IP.Event.Uuid
      description: uuid of the indicator
      type: string
    - contextPath: Flashpoint.IP.Event.Comment
      description: Comment which was provided when the indicator was observed
      type: string
    description: Lookup the "IP" type indicator details. The reputation of IP is considered Malicious 
      if there's at least one IOC event in Flashpoint database matching the IP indicator. 
      Alternately the IP address is considered Suspicious if it matches with any one of the Torrent's Peer IP Address or Forum Visit's Peer IP Address.
  - name: domain
    arguments:
    - name: domain
      required: false
      default: true
      description: The domain name to check.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: Flashpoint.Domain.Event.Href
      description: List of reference link of the indicator
      type: string
    - contextPath: Flashpoint.Domain.Event.Domain
      description: Domain of the indicator
      type: string
    - contextPath: Flashpoint.Domain.Event.EventDetails
      description: Event details in which the indicator observed
    - contextPath: Flashpoint.Domain.Event.Category
      description: Category of the indicator
      type: string
    - contextPath: Flashpoint.Domain.Event.Fpid
      description: Fp-id of the indicator
      type: string
    - contextPath: Flashpoint.Domain.Event.Timestamp
      description: Time at which indicaor observed
      type: string
    - contextPath: Flashpoint.Domain.Event.Type
      description: Type of the indicator
      type: string
    - contextPath: Flashpoint.Domain.Event.Uuid
      description: uuid of the indicator
      type: string
    - contextPath: Flashpoint.Domain.Event.Comment
      description: Comment which was provided when the indicator was observed
      type: string
    - contextPath: Domain.Malicious.Description
      description: Description of malicious indicator.
      type: string
    - contextPath: Domain.Malicious.Vendor
      description: Vendor of malicious indicator.
      type: string
    - contextPath: Domain.Name
      description: Name of domain.
      type: string
    description: Lookup the "Domain" type indicator details. The reputation of Domain is considered Malicious 
      if there's at least one IOC event in Flashpoint database matching the Domain indicator.
  - name: filename
    arguments:
    - name: filename
      required: false
      default: true
      description: The file name to check.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: Flashpoint.Filename.Event.Href
      description: List of reference link of the indicator
      type: string
    - contextPath: Flashpoint.Filename.Event.Filename
      description: Filename of the indicator
      type: string
    - contextPath: Flashpoint.Filename.Event.EventDetails
      description: Event details in which the indicator observed
    - contextPath: Flashpoint.Filename.Event.Category
      description: Category of the indicator
      type: string
    - contextPath: Flashpoint.Filename.Event.Fpid
      description: Fp-id of the indicator
      type: string
    - contextPath: Flashpoint.Filename.Event.Timestamp
      description: Time at which indicaor observed
      type: string
    - contextPath: Flashpoint.Filename.Event.Type
      description: Type of the indicator
      type: string
    - contextPath: Flashpoint.Filename.Event.Uuid
      description: uuid of the indicator
      type: string
    - contextPath: Flashpoint.Filename.Event.Comment
      description: Comment which was provided when the indicator was observed
      type: string
    description: Lookup the "Filename" type indicator details. The reputation of Filename is considered Malicious 
      if there's at least one IOC event in Flashpoint database matching the Filename indicator.
  - name: url
    arguments:
    - name: url
      required: false
      default: true
      description: The url to check.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: Flashpoint.Url.Event.Href
      description: List of reference link of the indicator
      type: string
    - contextPath: Flashpoint.Url.Event.Url
      description: Url of the indicator
      type: string
    - contextPath: Flashpoint.Url.Event.EventDetails
      description: Event details in which the indicator observed
    - contextPath: Flashpoint.Url.Event.Category
      description: Category of the indicator
      type: string
    - contextPath: Flashpoint.Url.Event.Fpid
      description: Fp-id of the indicator
      type: string
    - contextPath: Flashpoint.Url.Event.Timestamp
      description: Time at which indicaor observed
      type: string
    - contextPath: Flashpoint.Url.Event.Type
      description: Type of the indicator
      type: string
    - contextPath: Flashpoint.Url.Event.Uuid
      description: uuid of the indicator
      type: string
    - contextPath: Flashpoint.Url.Event.Comment
      description: Comment which was provided when the indicator was observed
      type: string
    - contextPath: URL.Malicious.Description
      description: Description of malicious url.
      type: string
    - contextPath: URL.Malicious.Vendor
      description: Vendor of malicious url.
      type: string
    description: Lookup the "URL" type indicator details. The reputation of Url is considered Malicious 
      if there's at least one IOC event in Flashpoint database matching the Url indicator.
  - name: file
    arguments:
    - name: file
      required: false
      default: true
      description: The file to check. It may sha1, md5, sha256 etc.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: Flashpoint.File.Event.Href
      description: List of reference link of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.MD5
      description: MD5 file hash of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.SHA1
      description: SHA1 file hash of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.SHA256
      description: SHA256 file hash of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.EventDetails
      description: Event details in which the indicator observed
    - contextPath: Flashpoint.File.Event.Category
      description: Category of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.Fpid
      description: Fp-id of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.Timestamp
      description: Time at which indicaor observed
      type: string
    - contextPath: Flashpoint.File.Event.Type
      description: Type of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.Uuid
      description: uuid of the indicator
      type: string
    - contextPath: Flashpoint.File.Event.Comment
      description: Comment which was provided when the indicator was observed
      type: string
    - contextPath: File.Malicious.Description
      description: Description of malicious file.
      type: string
    - contextPath: File.Malicious.Vendor
      description: Vendor of malicious file.
      type: string
    - contextPath: File.MD5
      description: MD5 type file.
      type: string
    - contextPath: File.SHA1
      description: SHA1 type file.
      type: string
    - contextPath: File.SHA256
      description: SHA256 type file.
      type: string
    description: Lookup the "File" type indicator details. The reputation of File-hash is considered Malicious 
      if there's at least one IOC event in Flashpoint database matching the File-hash indicator.
  - name: email
    arguments:
    - name: email
      required: false
      default: true
      description: The email to check.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: Flashpoint.Email.Event.Href
      description: List of reference link of the indicator
      type: string
    - contextPath: Flashpoint.Email.Event.EventDetails
      description: Event details in which the indicator observed
    - contextPath: Flashpoint.Email.Event.Category
      description: Category of the indicator
      type: string
    - contextPath: Flashpoint.Email.Event.Fpid
      description: Fp-id of the indicator
      type: string
    - contextPath: Flashpoint.Email.Event.Timestamp
      description: Time at which indicaor observed
      type: string
    - contextPath: Flashpoint.Email.Event.Type
      description: Type of the indicator
      type: string
    - contextPath: Flashpoint.Email.Event.Uuid
      description: uuid of the indicator
      type: string
    - contextPath: Flashpoint.Email.Event.Comment
      description: Comment which was provided when the indicator was observed
      type: string
    - contextPath: Account.Email.Malicious.Description
      description: Description of Malicious email account.
      type: string
    - contextPath: Account.Email.Malicious.Vendor
      description: Vendor of Malicious email.
      type: string
    - contextPath: Account.Email.Name
      description: Name of indicator.
      type: string
    description: Lookup the "Email" type indicator details. The reputation of Email is considered Malicious 
      if there's at least one IOC event in Flashpoint database matching the Email indicator.
  - name: flashpoint-search-intelligence-reports
    arguments:
    - name: report_search
      required: true
      description: Search report using keyword or text
    outputs:
    - contextPath: Flashpoint.Report
      description: List of reports based on specified search query or keyword
    description: Search for the Intelligence Reports using a keyword
  - name: flashpoint-get-single-intelligence-report
    arguments:
    - name: report_id
      required: true
      description: The report id of the report for which the details are to be fetched.
        The id can be known from report-search command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Report.NotifiedAt
      description: Notify date of report.
      type: string
    - contextPath: Flashpoint.Report.PlatformUrl
      description: Platform url of report. It helps to redirect flashpoint platform.
      type: string
    - contextPath: Flashpoint.Report.PostedAt
      description: posted date of report.
      type: number
    - contextPath: Flashpoint.Report.Summary
      description: Summary of report.
      type: string
    - contextPath: Flashpoint.Report.Title
      description: Title of the report.
      type: string
    - contextPath: Flashpoint.Report.UpdatedAt
      description: Last updated date of report.
      type: string
    - contextPath: Flashpoint.Report.ReportId
      description: Unique id of the report.
      type: string
    description: Get single report details using the report id. 
      The id can be known from report-search command response or some other investigation.
  - name: flashpoint-get-related-reports
    arguments:
    - name: report_id
      required: true
      description: The report-id of the report of which the related reports are to be fetched.
        The id can be known from report-search command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Report
      description: Display list of related report based on report fpid.
    description: Get related reports for a particular report using the report-id. 
      The id can be known from report-search command response or some other investigation.
  - name: flashpoint-get-single-event
    arguments:
    - name: event_id
      required: true
      description: The UUID or FPID that identifies a particular event. The id can be fetched from get-events command or 
        indicator reputation command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Event.ObservedTime
      description: Date of event triggered.
      type: string
    - contextPath: Flashpoint.Event.EventCreatorEmail
      description: Event creator email.
      type: string
    - contextPath: Flashpoint.Event.Href
      description: Display event reference.
    - contextPath: Flashpoint.Event.Tags
      description: Display event tags.
    - contextPath: Flashpoint.Event.EventId
      description: Display event id (event fpid)
      type: string
    - contextPath: Flashpoint.Event.Name
      description: Name of the event
      type: string
    description: Get single event details using its UUID or FPID. The id can be fetched from get-events command or 
      indicator reputation command response or some other investigation.
  - name: flashpoint-get-events
    arguments:
    - name: time_period
      description: Search events based on time period.
    - name: report_fpid
      description: Search events by report fpid. Get report fpid from output of report-search or related-reports
        commands and use it in this command to get events for specific Flashpoint report.
    - name: limit
      description: Specify the limit on the no. of record.
      defaultValue: "10"
    - name: attack_ids
      description: Search events by attack ids. Multiple ids are accepted using
        comma separated values. attack_ids can be found in event information.
    outputs:
    - contextPath: Flashpoint.Event
      description: Display the list of multiple events.
    description: Search events using time-period, Report fpid or Attack-ids.
  - name: flashpoint-common-lookup
    arguments:
    - name: indicator
      required: false
      default: true
      description: Specify indicator value like any domain, ip, email, url etc.
      isArray: true
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The indicator score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    description: Lookup any type of indicator
  - name: flashpoint-get-forum-details
    arguments:
    - name: forum_id
      required: true
      description: Specify forum id of the forum for which the details are to be fetched. The id can be known from 
        flashpoint-search-forum-posts command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Forum.Description
      description: Detail information of supplied forum id.
      type: string
    - contextPath: Flashpoint.Forum.Hostname
      description: Host detail of supplied forum id.
      type: string
    - contextPath: Flashpoint.Forum.Name
      description: Name of forum.
      type: string
    - contextPath: Flashpoint.Forum.Stats
      description: Display stats information like number of posts, rooms, threads and users details.
    - contextPath: Flashpoint.Forum.Tags
      description: Display list of tags which includes id, name, parent_tag and uuid.
    - contextPath: Flashpoint.Forum.ForumId
      description: Forum's unique id.
      type: string
    description: Get forum details using the forum-id. The id can be known from 
      flashpoint-search-forum-posts command response or some other investigation.
  - name: flashpoint-get-forum-room-details
    arguments:
    - name: room_id
      required: true
      description: Specify room id which is used to retrieve room information in forum. The id can be known from 
        flashpoint-search-forum-posts command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Forum.Room.Forum
      description: Displays all forum details like forum name, hostname, platform url,
        stats and tags etc.
    - contextPath: Flashpoint.Forum.Room.Title
      description: Room title. User can use same title in forum search command.
      type: string
    - contextPath: Flashpoint.Forum.Room.Url
      description: Room url.
      type: string
    - contextPath: Flashpoint.Forum.Room.RoomId
      description: Unique id of forum room.
      type: string
    description: Get forum-room details using the room-id. The id can be known from 
      flashpoint-search-forum-posts command response or some other investigation.
  - name: flashpoint-get-forum-user-details
    arguments:
    - name: user_id
      required: true
      description: Specify user id which is used to retrieve user's information. The id can be known from 
        flashpoint-search-forum-posts command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Forum.User.Forum
      description: Display all forum details like id, hostname, description, stats,
        tags etc.
    - contextPath: Flashpoint.Forum.User.Name
      description: Name of user.
      type: string
    - contextPath: Flashpoint.Forum.User.PlatformUrl
      description: platform url of user which is redirect to Flashpoint platform.
      type: string
    - contextPath: Flashpoint.Forum.User.Url
      description: URL of user.
      type: string
    - contextPath: Flashpoint.Forum.User.UserId
      description: Unique id of forum user.
      type: string
    description: Get user details using the user-id. The id can be known from 
      flashpoint-search-forum-posts command response or some other investigation.
  - name: flashpoint-get-forum-post-details
    arguments:
    - name: post_id
      required: true
      description: Specify post id which gives post information embeded with forum, room, user etc.
        The id can be known from flashpoint-search-forum-posts command response or some other investigation.
    outputs:
    - contextPath: Flashpoint.Forum.Post.Forum
      description: Display all forum details of post like id, hostname, stats, description,
        tags etc.
    - contextPath: Flashpoint.Forum.Post.Room
      description: Display room details of post like room title, id, url, platform
        url etc.
    - contextPath: Flashpoint.Forum.Post.User
      description: Display user details of post like user id, name, url, platform
        url etc.
    - contextPath: Flashpoint.Forum.Post.PlatformUrl
      description: Using platform url user can redirect to Flashpoint platform.
      type: string
    - contextPath: Flashpoint.Forum.Post.PublishedAt
      description: published date of post.
    - contextPath: Flashpoint.Forum.Post.Url
      description: Display url of post.
    - contextPath: Flashpoint.Forum.Post.PostId
      description: Unique id of forum post.
      type: string
    description: Get post details using the post-id. The id can be known from 
      flashpoint-search-forum-posts command response or some other investigation.
  - name: flashpoint-search-forum-sites
    arguments:
    - name: site_search
      required: true
      description: Search by site keyword or text. This keyword is used for search information in forum sites.
        This keyword or text is known by fp user.
    outputs:
    - contextPath: Flashpoint.Forum.Site
      description: List of forum site details based on search keyword.
    description: Search forum sites using a keyword. it will search in site content like name, title, descripion etc.
  - name: flashpoint-search-forum-posts
    arguments:
    - name: post_search
      required: true
      description: Search by post keyword or text which is used for search information in forum posts and it is known by
        fp user.
    outputs:
    - contextPath: Flashpoint.Forum.Post
      description: Display list of forum posts based on specified search keyword.
    description: Search forum posts using a keyword
  dockerimage: demisto/python3:3.7.5.4583
  runonce: false
  subtype: python3
tests:
- Flashpoint_event-Test
- Flashpoint_forum-Test
- Flashpoint_report-Test
- Flashpoint_reputation-Test

