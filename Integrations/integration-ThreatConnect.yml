commonfields:
  id: ThreatConnect
  version: -1
name: ThreatConnect
display: ThreatConnect
category: Data Enrichment
image: data:image/png;base64,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
description: Threat Intelligence platform
configuration:
- display: Access ID
  name: accessId
  defaultvalue: ""
  type: 0
  required: true
- display: Secret Key
  name: secretKey
  defaultvalue: ""
  type: 4
  required: true
- display: baseUrl
  name: baseUrl
  defaultvalue: https://api.threatconnect.com
  type: 0
  required: true
- display: defaultOrg
  name: defaultOrg
  defaultvalue: ""
  type: 0
  required: false
- display: ProxyIP  (or http://${ip} )
  name: proxyIp
  defaultvalue: ""
  type: 0
  required: false
- display: ProxyPort
  name: proxyPort
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |-
    from threatconnect import ThreatConnect
    from threatconnect.RequestObject import RequestObject
    from threatconnect.Config.IndicatorType import IndicatorType
    from threatconnect.Config.ResourceType import ResourceType
    from threatconnect.Config.FilterOperator import FilterOperator
    import urllib
    import datetime

    filePath= 'File(val.MD5 && val.MD5 == obj.MD5 || val.SHA1 && val.SHA1 == obj.SHA1 || val.SHA256 && val.SHA256 == obj.SHA256)'
    ipPath= 'IP(val.Address && val.Address == obj.Address)'
    urlPath= 'URL(val.Data && val.Data == obj.Data)'
    domainPath= 'Domain(val.Name && val.Name == obj.Name)'

    defaultMaliciosConfidenceThreshold = 50
    defaultMaliciosRatingThreshold = 3

    def escapeNewLines(indJson):
        indJson = indJson.replace('\r', '<br>')
        indJson = indJson.replace('\\n', '<br>')
        return indJson

    def getClient():
        access = demisto.params()['accessId']
        secert = demisto.params()['secretKey']
        url = demisto.params()['baseUrl']
        default_org = demisto.params()['defaultOrg']
        proxy_ip = demisto.params()['proxyIp']
        proxy_port = demisto.params()['proxyPort']
        tc = ThreatConnect(access, secert, default_org, url)
        if proxy_ip and proxy_port and len(proxy_ip) > 0 and len(proxy_port) > 0:
            tc.set_proxies(proxy_ip, int(proxy_port))
        return tc

    def buildFilters(args):
        filters = '?'
        if demisto.get(args, 'ratingThreshold'):
            filters = filters + 'rating%3E' + demisto.args()['ratingThreshold']
        if demisto.get(args, 'confidenceThreshold'):
            if len(filters) > 1:
                filters = filters + '&'
            filters = filters + 'threatAssessConfidence%3E' + demisto.args()['confidenceThreshold']
        if len(filters) == 1:
            return '' # no filters at all in this case
        return filters

    def createContext(indicators,contextPath,ratingThreshold,confidenceThreshold,indicatorType):
        ec = {};
        ec['DBotScore'] = [];
        ec[contextPath] = [];
        if ratingThreshold < 0:
            ratingThreshold = defaultMaliciosRatingThreshold
        if confidenceThreshold < 0:
            confidenceThreshold = defaultMaliciosConfidenceThreshold
        for ind in indicators:
            dbotScore = 0
            if ind.confidence >= confidenceThreshold and ind.rating>= ratingThreshold:
                dbotScore = 3
                desc = ''
                if hasattr(ind, 'description'):
                    desc = ind.description
                mal = {'Malicious':{'Vendor':'ThreatConnect','Description':desc}}
                if indicatorType == 'ip':
                    if hasattr(ind, 'summary'):
                        mal['Address'] = ind.summary
                elif indicatorType == 'hash':
                    if hasattr(ind, 'md5'):
                        mal['MD5'] = ind.md5
                    if hasattr(ind, 'sha1'):
                        mal['SHA1'] = ind.sha1
                    if hasattr(ind, 'sha256'):
                        mal['SHA256'] = ind.sha256
                elif indicatorType == 'url':
                    if hasattr(ind, 'indicator'):
                        mal['Data'] = ind.indicator
                elif indicatorType == 'domain':
                    if hasattr(ind, 'hostName'):
                        mal['Name'] = ind.hostName
                mal['properties_to_append'] = ['Malicious'];
                ec[contextPath] = mal;
            elif ind.rating >=1:
                dbotScore = 2
            else:
                dbotScore = 1
            ec['DBotScore'].append({'Indicator': ind.indicator, 'Type': indicatorType, 'Vendor': 'ThreatConnect', 'Score': dbotScore});
        return ec

    def getIndicatorsForDbot(args, indicatorValue, indicatorType):
        tc = getClient()
        indicators = tc.indicators()
        filter1 = indicators.add_filter()
        filter1.add_indicator(indicatorValue)
        owners_arr = []
        if demisto.get(demisto.args(), 'owners'):
            owners = demisto.args()['owners'].split(",")
            owners_arr.extend(owners)
        else:
            owners = tc.owners()
            owners.retrieve()
            for owner in owners:
                owners_arr.append(owner.name)
        filter1.add_owner(owners_arr)
        if demisto.get(demisto.args(), 'ratingThreshold'):
            filter1.add_pf_rating(int(demisto.args()['ratingThreshold']), FilterOperator.GE)
        if demisto.get(demisto.args(), 'confidenceThreshold'):
            filter1.add_pf_confidence(int(demisto.args()['confidenceThreshold']), FilterOperator.GE)
        if indicatorType:
            filter1.add_pf_type(indicatorType, FilterOperator.EQ)
        indicators.retrieve()
        return indicators

    def getIndicator(indicatorType, value, owners, limit, filters):
        tc = getClient()
        tc.set_api_result_limit(limit)
        ro = RequestObject()
        ro.set_http_method('GET')
        ro.set_request_uri('/v2/indicators/'+indicatorType+'/'+value+filters)
        if len(owners) > 0:
            ro.set_owner(owners)
            ro.set_owner_allowed(True)
        results = tc.api_request(ro)
        if results.headers['content-type'] == 'application/json':
            data = results.json()
            return json.dumps(data, indent=4)

    # The command demisto.command() holds the command sent from the user.
    if demisto.command() == 'test-module':
        tc = getClient()
        owners = tc.owners()
        owners.retrieve()
        demisto.results('ok')
        sys.exit(0)
    if demisto.command() == 'ip':
        ip = demisto.args()['ip']
        malRatingThreshold = -1
        malConfidenceThreshold = -1
        if demisto.get(demisto.args(), 'ratingThreshold'):
            malRatingThreshold = int(demisto.args()['ratingThreshold'])
        if demisto.get(demisto.args(), 'confidenceThreshold'):
            malConfidenceThreshold = int(demisto.args()['confidenceThreshold'])
        indicators = getIndicatorsForDbot(demisto.args(), ip, 'Address')
        ec = createContext(indicators,ipPath,malRatingThreshold,malConfidenceThreshold,'ip')
        indicatorsArr = []
        for indicator in indicators:
            indJson = escapeNewLines(indicator.json)
            indicatorsArr.append(json.loads(indJson))
        if len(indicators) == 0:
            md = "## ThreatConnect IP Report for: " + ip + "\nNo results found!"
            demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": md,"EntryContext": ec, "HumanReadable": md})
        else:
            demisto.results({"Type": 1, "ContentsFormat": "json", "HumanReadable": tableToMarkdown("ThreatConnect IP Reputation for: "+ip, indicatorsArr, ""),"Contents": json.dumps(indicatorsArr),"EntryContext": ec})
        sys.exit(0)
    if demisto.command() == 'url':
        url = demisto.args()['url']
        malRatingThreshold = -1
        malConfidenceThreshold = -1
        if demisto.get(demisto.args(), 'ratingThreshold'):
            malRatingThreshold = int(demisto.args()['ratingThreshold'])
        if demisto.get(demisto.args(), 'confidenceThreshold'):
            malConfidenceThreshold = int(demisto.args()['confidenceThreshold'])
        indicators = getIndicatorsForDbot(demisto.args(), url, 'URL')
        ec = createContext(indicators,urlPath,malRatingThreshold,malConfidenceThreshold,'url')
        indicatorsArr = []
        for indicator in indicators:
            indJson = escapeNewLines(indicator.json)
            indicatorsArr.append(json.loads(indJson))
        if len(indicators) == 0:
            md = "## ThreatConnect URL Report for: " + url + "\nNo results found!"
            demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": md,"EntryContext": ec, "HumanReadable": md})
        else:
            demisto.results({"Type": 1, "ContentsFormat": "json", "HumanReadable": tableToMarkdown("ThreatConnect URL Reputation for: "+url, indicatorsArr, ""), "Contents": json.dumps(indicatorsArr),"EntryContext": ec})
        sys.exit(0)
    if demisto.command() == 'file':
        file = demisto.args()['file']
        malRatingThreshold = -1
        malConfidenceThreshold = -1
        if demisto.get(demisto.args(), 'ratingThreshold'):
            malRatingThreshold = int(demisto.args()['ratingThreshold'])
        if demisto.get(demisto.args(), 'confidenceThreshold'):
            malConfidenceThreshold = int(demisto.args()['confidenceThreshold'])
        indicators = getIndicatorsForDbot(demisto.args(), file, 'File')
        ec = createContext(indicators,filePath,malRatingThreshold,malConfidenceThreshold,'hash')
        indicatorsArr = []
        for indicator in indicators:
            indJson = escapeNewLines(indicator.json)
            indicatorsArr.append(json.loads(indJson))
        if len(indicators) == 0:
            md = "## ThreatConnect File Report for: " + file + "\nNo results found!"
            demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": md,"EntryContext": ec, "HumanReadable": md})
        else:
            demisto.results({"Type": 1, "ContentsFormat": "json", "HumanReadable": tableToMarkdown("ThreatConnect File Reputation for: "+file, indicatorsArr, ""), "Contents": json.dumps(indicatorsArr),"EntryContext": ec})
        sys.exit(0)
    if demisto.command() == 'domain':
        domain = demisto.args()['domain']
        malRatingThreshold = -1
        malConfidenceThreshold = -1
        if demisto.get(demisto.args(), 'ratingThreshold'):
            malRatingThreshold = int(demisto.args()['ratingThreshold'])
        if demisto.get(demisto.args(), 'confidenceThreshold'):
            malConfidenceThreshold = int(demisto.args()['confidenceThreshold'])
        indicators = getIndicatorsForDbot(demisto.args(), domain, 'Host')
        ec = createContext(indicators,domainPath,malRatingThreshold,malConfidenceThreshold,'domain')
        indicatorsArr = []
        for indicator in indicators:
            indJson = escapeNewLines(indicator.json)
            indicatorsArr.append(json.loads(indJson))
        if len(indicators) == 0:
            md = "## ThreatConnect Domain Report for: " + domain + "\nNo results found!"
            demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": md,"EntryContext": ec, "HumanReadable": md})
        else:
            demisto.results({"Type": 1, "ContentsFormat": "json", "HumanReadable": tableToMarkdown("ThreatConnect Domain Reputation for: "+domain, indicatorsArr, ""), "Contents": json.dumps(indicatorsArr),"EntryContext": ec})
        sys.exit(0)
    if demisto.command() == 'tc-owners':
        tc = getClient()
        ro = RequestObject()
        ro.set_http_method('GET')
        ro.set_request_uri('/v2/owners')
        results = tc.api_request(ro)
        if results.headers['content-type'] == 'application/json':
            data = results.json()
            res = json.dumps(data, indent=4)
            demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": res})
    if demisto.command() == 'tc-indicators':
        tc = getClient()
        limit = 500
        if demisto.get(demisto.args(), 'limit'):
            limit = int(demisto.args()['limit'])
        tc.set_api_result_limit(limit)
        ro = RequestObject()
        ro.set_http_method('GET')
        ro.set_request_uri('/v2/indicators/')
        owners = ''
        if demisto.get(demisto.args(), 'owners'):
            owners = demisto.args()['owners']
        if len(owners) > 0:
            ro.set_owner(owners)
            ro.set_owner_allowed(True)
        results = tc.api_request(ro)
        if results.headers['content-type'] == 'application/json':
            data = results.json()
            res = json.dumps(data, indent=4)
            demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": res})
        sys.exit(0)
    if demisto.command() == 'tc-get-tags':
        tc = getClient()
        ro = RequestObject()
        ro.set_http_method('GET')
        ro.set_request_uri('/v2/tags')
        results = tc.api_request(ro)
        if results.headers['content-type'] == 'application/json':
            data = results.json()
            res = json.dumps(data, indent=4)
            demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": res})
        sys.exit(0)
    if demisto.command() == 'tc-tag-indicator':
        tc = getClient()
        indicators = tc.indicators()
        filter1 = indicators.add_filter()
        filter1.add_indicator(demisto.args()['indicator'])
        indicators.retrieve()

        for indicator in indicators:
            indicator.add_tag(demisto.args()['tag'])
            indicator.commit()
            demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": "Indicator: "+demisto.args()['indicator']+" With id: "+str(indicator.id)+", was tagged with tag: "+demisto.args()['tag']})
        sys.exit(0)
    if demisto.command() == 'tc-get-indicator':
        tc = getClient()
        indicators = tc.indicators()
        filter1 = indicators.add_filter()
        filter1.add_indicator(demisto.args()['indicator'])
        owners_arr = []
        owners = tc.owners()
        owners.retrieve()
        for owner in owners:
            owners_arr.append(owner.name)
        filter1.add_owner(owners_arr)
        if demisto.get(demisto.args(), 'ratingThreshold'):
            filters.add_pf_rating(int(demisto.args()['ratingThreshold']), FilterOperator.GT)
        if demisto.get(demisto.args(), 'confidenceThreshold'):
            filter1.add_pf_confidence(int(demisto.args()['confidenceThreshold']), FilterOperator.GT)
        indicators.retrieve()

        indicatorsArr = []
        for indicator in indicators:
            indicatorsArr.append(json.loads(indicator.json))
        if len(indicators) == 0:
            demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": "Found no results for given indicator: "+demisto.args()['indicator']})
        else:
            demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": json.dumps(indicatorsArr)})
        sys.exit(0)
    if demisto.command() == 'tc-get-indicators-by-tag':
        tc = getClient()
        ro = RequestObject()
        ro.set_http_method('GET')
        ro.set_request_uri('/v2/tags/'+demisto.args()['tag']+'/indicators')
        results = tc.api_request(ro)
        if results.headers['content-type'] == 'application/json':
            data = results.json()
            res = json.dumps(data, indent=4)
            demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": res})
        sys.exit(0)
    if demisto.command() == 'tc-add-indicator':
        tc = getClient()
        indicators = tc.indicators()
        indicator = indicators.add(demisto.args()['indicator'], demisto.params()['defaultOrg'])
        if demisto.get(demisto.args(), 'rating'):
            indicator.set_rating(int(demisto.args()['rating']))
        if demisto.get(demisto.args(), 'confidence'):
            indicator.set_confidence(int(demisto.args()['confidence']))
        indicator.commit()
        demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": "Created new indicator: "+demisto.args()['indicator']})
        sys.exit(0)
    if demisto.command() == 'tc-create-incident':
        tc = getClient()
        incidents = tc.incidents()
        owner = demisto.params()['defaultOrg']
        if demisto.get(demisto.args(), 'owner'):
            owner = demisto.args()['owner']
        incident = incidents.add(demisto.args()['incidentName'], owner)
        eventDate = ""
        if demisto.get(demisto.args(), 'eventDate'):
            eventDate = demisto.args()['eventDate']
        else:
            d = datetime.datetime.utcnow()
            dateStr = d.isoformat("T")
            dateStr = dateStr[:dateStr.rfind(".")]
            eventDate = dateStr + "Z"
        incident.set_event_date(eventDate)
        if demisto.get(demisto.args(), 'tag'):
            incident.add_tag(demisto.args()['tag'])
        if demisto.get(demisto.args(), 'securityLabel'):
            incident.set_security_label(demisto.args()['securityLabel'])
        if demisto.get(demisto.args(), 'description'):
            incident.add_attribute('Description', demisto.args()['description'])
        incident.commit()
        demisto.results({"Type": 1, "ContentsFormat": "text", "Contents": "Created new incident: "+demisto.args()['incidentName']})
        sys.exit(0)
    if demisto.command() == 'tc-fetch-incidents':
        tc = getClient()
        incidents = tc.incidents()
        if demisto.get(demisto.args(), 'incidentId') or demisto.get(demisto.args(), 'owner') or demisto.get(demisto.args(), 'incidentName'):
            filter1 = incidents.add_filter()
            if demisto.get(demisto.args(), 'incidentId'):
                filter1.add_id(int(demisto.args()['incidentId']))
            if demisto.get(demisto.args(), 'owner'):
                filter1.add_owner(demisto.args()['owner'])
            if demisto.get(demisto.args(), 'incidentName'):
                filter1.add_pf_name(demisto.args()['incidentName'])
        incidents.retrieve()
        incidentsJsonArr = []
        for incident in incidents:
            incidentsJsonArr.append(json.loads(incident.json))
        demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": json.dumps(incidentsJsonArr), "EntryContext": {"ThreatConnect.incidents": incidentsJsonArr}})
        sys.exit(0)
    if demisto.command() == 'tc-get-incident-associate-indicators':
        tc = getClient()
        incidents = tc.incidents()
        filter1 = incidents.add_filter()
        filter1.add_id(int(demisto.args()['incidentId']))
        if demisto.get(demisto.args(), 'owner'):
            filter1.add_owner(demisto.args()['owner'])
        incidents.retrieve()
        indicatorsArr = []
        for incident in incidents:
            for indicator in incident.indicator_associations:
                indicatorsArr.append(indicator.indicator)
        demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": json.dumps(indicatorsArr)})
        sys.exit(0)
    if demisto.command() == 'tc-incident-associate-indicator':
        tc = getClient()
        incidents = tc.incidents()
        filter1 = incidents.add_filter()
        filter1.add_id(int(demisto.args()['incidentId']))
        if demisto.get(demisto.args(), 'owner'):
            filter1.add_owner(demisto.args()['owner'])
        indType = ResourceType.URLS
        indTypeStr = demisto.get(demisto.args(), 'indicatorType')
        if indTypeStr == 'ADDRESSES':
            indType = ResourceType.ADDRESSES
        elif indTypeStr == 'EMAIL_ADDRESSES':
            indType = ResourceType.EMAIL_ADDRESSES
        elif indTypeStr == 'FILES':
            indType = ResourceType.FILES
        elif indTypeStr == 'HOSTS':
            indType = ResourceType.HOSTS
        elif indTypeStr == 'CUSTOM_INDICATORS':
            indType = ResourceType.CUSTOM_INDICATORS
        incidents.retrieve()
        for incident in incidents:
            incident.associate_indicator(indType, demisto.args()['indicator'])

            incident.commit()
            demisto.results({"Type": 1, "ContentsFormat": "json", "Contents": incident.json})
        sys.exit(0)
  type: python
  commands:
  - name: ip
    arguments:
    - name: ip
      required: true
      default: true
      description: IPv4/IPv6 address
    - name: owners
      description: 'client’s Organization or any Sources or Communities to which a
        client’s API User has been granted permission, comma separated: owner1,owner2,owner3'
    - name: ratingThreshold
      description: filter on indicators rating grater then given value(value between
        0 to 5)
    - name: confidenceThreshold
      description: filter on indicators confidence grater then given value(value between
        0 to 100)
    outputs:
    - contextPath: IP.Address
      description: Bad IP Address found
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the full Description
    description: search for IP indicator
  - name: url
    arguments:
    - name: url
      required: true
      default: true
      description: url like www.demisto.com
    - name: owners
      description: client’s Organization or any Sources or Communities to which a
        client’s API User has been granted permission.
    - name: ratingThreshold
      description: filter on indicators rating grater then given value(value between
        0 to 5)
    - name: confidenceThreshold
      description: filter on indicators confidence grater then given value(value between
        0 to 100)
    outputs:
    - contextPath: URL.Data
      description: Bad URLs found
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    description: search for URL indicator
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: hash of the file (MD5, SHA-1, or SHA-256)
    - name: owners
      description: client’s Organization or any Sources or Communities to which a
        client’s API User has been granted permission.
    - name: ratingThreshold
      description: filter on indicators rating grater then given value(value between
        0 to 5)
    - name: confidenceThreshold
      description: filter on indicators confidence grater then given value(value between
        0 to 100)
    outputs:
    - contextPath: File.MD5
      description: Bad hash found
    - contextPath: File.SHA1
      description: Bad hash SHA1
    - contextPath: File.SHA256
      description: Bad hash SHA256
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    description: search for File indicator
  - name: tc-owners
    arguments: []
    description: retrieve possible owners from this account
  - name: tc-indicators
    arguments:
    - name: owner
      description: client’s Organization or any Sources or Communities to which a
        client’s API User has been granted permission.
    - name: limit
      description: int limit of results, default is 500
    description: 'retrieve all indicators '
  - name: tc-get-tags
    arguments: []
    description: Get all ThreatConnect Tags in system
  - name: tc-tag-indicator
    arguments:
    - name: tag
      required: true
      description: Tag value
    - name: indicator
      required: true
      default: true
      description: Indicator to tag, this is the value of indicator like ip, file
        hash, url
    description: Tag an exiting indicator
  - name: tc-get-indicator
    arguments:
    - name: indicator
      required: true
      default: true
      description: Indicator value to search by, can be an IP, url, file Hash. will
        retrieve from all owners
    - name: ratingThreshold
      description: filter on indicators rating grater then given value(value between
        0 to 5)
    - name: confidenceThreshold
      description: filter on indicators confidence grater then given value(value between
        0 to 100)
    description: Get indicator
  - name: tc-get-indicators-by-tag
    arguments:
    - name: tag
      required: true
      default: true
      description: Tag value to filter by
    description: Fetch all indicators that have given tag
  - name: tc-add-indicator
    arguments:
    - name: indicator
      required: true
      description: The value of the indicator, can be hash/ip/domain/url
    - name: rating
      description: indicator rating, like 2.5
    - name: confidence
      description: confidence in indicator, in scale of 1-100
    description: Add a new indicator to ThreatConnect
  - name: tc-create-incident
    arguments:
    - name: owner
      description: Owner of new incident, default will be defaultOrg param
    - name: incidentName
      required: true
      default: true
      description: Incident group name
    - name: eventDate
      description: incident time in the format 2017-03-21T00:00:00Z
    - name: tag
      description: incident tag
    - name: securityLabel
      description: security label like 'TLP Green'
    - name: description
      description: incident description attribute
    description: Create a new incident group
  - name: tc-fetch-incidents
    arguments:
    - name: incidentId
      default: true
      description: filter by incident id too
    - name: owner
      description: filter by owner
    - name: incidentName
      description: filter by incident name
    outputs:
    - contextPath: ThreatConnect.incidents
      description: Incidents from ThreatConnect
    description: Fetch TC incidents
  - name: tc-incident-associate-indicator
    arguments:
    - name: indicatorType
      required: true
      auto: PREDEFINED
      predefined:
      - ADDRESSES
      - EMAIL_ADDRESSES
      - URLS
      - HOSTS
      - FILES
      - CUSTOM_INDICATORS
      description: indicator type
    - name: incidentId
      required: true
      description: incident id to associate
    - name: indicator
      required: true
      default: true
      description: value of indicator (hash,ip, url...)
    - name: owner
      description: filter by owner
    description: associate an indicator to an existing incident
  - name: domain
    arguments:
    - name: domain
      required: true
      default: true
      description: Domain name to check reputation
    outputs:
    - contextPath: Domain.Name
      description: Bad domain found
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    description: Check domain reputation
  - name: tc-get-incident-associate-indicators
    description: Get incidents that are related to a specific indicator
    arguments:
    - name: incidentId
      description: incident ID
      required: true
      default: true
    - name: owner
      description: filter by owner too
  dockerimage: demisto/threatconnect-sdk
