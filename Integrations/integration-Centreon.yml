commonfields:
  id: Centreon
  version: -1
name: Centreon
display: Centreon
category: Case Management
image: data:image/png;base64,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
description: IT & Network Monitoring
configuration:
- display: Server URL (e.g. http://147.75.33.100:20016/)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |
    ''' IMPORTS '''
    import requests
    import json
    import os
    # disable insecure warnings
    requests.packages.urllib3.disable_warnings()

    ''' GLOBAL VARS '''
    SERVER_NAME=demisto.params()['server']
    USERNAME=demisto.params()['credentials']['identifier']
    PASSWORD=demisto.params()['credentials']['password']

    BASE_URL= SERVER_NAME + 'centreon/api/index.php?'
    USE_SSL = True if demisto.params().get('insecure') else False
    DEFAULT_HEADERS = {
        'Content-Type': 'application/json'
    }

    ''' HELPER FUNCTIONS '''

    def load_proxy():
        """ Loads the system configured proxy if enabled in configuration """
        proxy = {}
        if "proxy" in demisto.params():
            proxy["http"] = os.environ["http_proxy"]
            proxy["https"] = os.environ["https_proxy"]
        return proxy

    PROXY = load_proxy()

    def httpRequest(method, urlSuffix, data, headers):
        data = {} if data is None else data

        url = BASE_URL + urlSuffix
        LOG('running %s request with url=%s\theaders=%s' % (method, url, headers))

        try:
            res = requests.request(method,
                url,
                verify=USE_SSL,
                params=data,
                headers=headers,
                proxies=PROXY
            )
            res.raise_for_status()
            return res.json()

        except Exception, e:
            LOG(e)
            raise(e)

    def httpPost(urlSuffix, data=None, files=None):
        data = {} if data is None else data
        url = BASE_URL + urlSuffix
        LOG('running request with url=%s\tdata=%s\tfiles=%s' % (url, data, files))
        try:
            res = requests.post(url, data=data, proxies=PROXY)
            res.raise_for_status()
            return res.json()

        except Exception, e:
            LOG(e)
            raise (e)

    def login():
      # retrieves an authentication token from Centreon
        cmd_url = 'action=authenticate'
        data = {
            'username': USERNAME,
            'password': PASSWORD
        }
        result = httpPost(cmd_url, data=data)
        return result['authToken']

    def transform_host_vals(key, value):
        # "down" and "unreachable" states can be added here after their value would be known
        host_service_status = {
          '0': "Up",
          '4': "Pending"
        }
        if (key == 'State' and value in host_service_status):
          return host_service_status[value]
        return value

    def to_upper_camel_case(word):
        return ''.join(x.capitalize() or '_' for x in word.split('_'))

    ''' COMMANDS FUNCTIONS '''

    def get_host_status():
        """ Returns the status of the connected hosts. """

        args = demisto.args()
        token = login()
        DEFAULT_HEADERS['centreon-auth-token'] = token
        cmd_url = 'object=centreon_realtime_hosts&action=list'
        return httpRequest('GET', cmd_url, args, DEFAULT_HEADERS)


    def get_host_status_command():
        """ corresponds to 'centreon-get-host-status' command. Brings the status of the connected hosts."""

        response = get_host_status()
        if (len(response) == 0):
            return "No Hosts found"

        # changing the keys from underscore notation to UpperCamelCase notation
        camel_case_response = [dict((to_upper_camel_case(k),v) for k, v in dic.iteritems()) for dic in response]
        # for the human readable - only including keys which has values. Also, transforming values from ints to readable text
        list_for_md = [dict((k, transform_host_vals(k,v)) for k, v in dic.iteritems() if (v==0 or v)) for dic in camel_case_response]

        entry = {
            'Type': entryTypes['note'],
            'Contents': camel_case_response,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown('Centreon Hosts status', list_for_md),
            'EntryContext': {
                  'Centreon.Host(val.Id==obj.Id)': camel_case_response
            }
        }

        return entry

    def get_service_status():
        """ Returns the status of the connected services. """

        args = demisto.args()
        token = login()
        DEFAULT_HEADERS['centreon-auth-token'] = token
        cmd_url = 'object=centreon_realtime_services&action=list'
        return httpRequest('GET', cmd_url, args, DEFAULT_HEADERS)

    def get_service_status_command():
        """ corresponds to 'centreon-get-service-status' command. Brings the status of the connected services. """

        response = get_service_status()
        if (len(response) == 0):
            return "No Services found"

        # changing the keys from underscore notation to UpperCamelCase notation
        camel_case_response = [dict((to_upper_camel_case(k),v) for k, v in dic.iteritems()) for dic in response]
        # for the human readable - only including keys which has values. Also, transforming values from ints to readable text
        list_for_md = [dict((k, transform_host_vals(k,v)) for k, v in dic.iteritems() if (v==0 or v)) for dic in camel_case_response]

        entry = {
            'Type': entryTypes['note'],
            'Contents': camel_case_response,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown('Centreon Services status', list_for_md),
            'EntryContext': {
                  'Centreon.Service(val.ServiceId==obj.ServiceId)': camel_case_response
            }
        }

        return entry

    ''' EXECUTION CODE '''
    LOG('command is %s' % (demisto.command(), ))
    try:
        if demisto.command() == 'test-module':
            # This is the call made when pressing the integration test button.
            if get_host_status():
                demisto.results('ok')
            else:
                demisto.results('test failed')
        elif demisto.command() == 'centreon-get-host-status':
            demisto.results(get_host_status_command())
        elif demisto.command() == 'centreon-get-service-status':
            demisto.results(get_service_status_command())

    except Exception, e:
        LOG(e.message)
        LOG.print_log()
        raise
  type: python
  commands:
  - name: centreon-get-host-status
    arguments:
    - name: viewType
      auto: PREDEFINED
      predefined:
      - all
      - unhandled
      - problems
      description: 'select the predefined filter like in the monitoring view: all,
        unhandled, problems'
    - name: fields
      description: 'the fields list that you want to get separated by a ”,”. For example:
        fields=id,name,alias,address'
    - name: status
      auto: PREDEFINED
      predefined:
      - up
      - down
      - unreachable
      - pending
      - all
      description: the status of hosts that you want to get (up, down, unreachable,
        pending, all)
    - name: hostgroup
      description: hostgroup id filter. For example, hostgroup=2
    - name: instance
      description: instance id filter. For example, instance=2
    - name: search
      description: search pattern applied on host name. For example, search="localhost"
    - name: criticality
      description: a specific criticality
    - name: sortType
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: asc,desc
    - name: limit
      description: number of lines that you want
    - name: number
      description: page number
    outputs:
    - contextPath: Centreon.Host.Output
      description: Host output
      type: string
    - contextPath: Centreon.Host.Name
      description: Host name
      type: string
    - contextPath: Centreon.Host.State
      description: Host state
    - contextPath: Centreon.Host.Address
      description: Host address
      type: string
    - contextPath: Centreon.Host.Id
      description: Host id
      type: number
    description: 'All the monitoring information regarding hosts '
  - name: centreon-get-service-status
    arguments:
    - name: viewType
      auto: PREDEFINED
      predefined:
      - all
      - unhandled
      - problems
      description: 'select the predefined filter like in the monitoring view: all,
        unhandled, problems'
    - name: fields
      description: the fields list that you want to get separated by ",". For example,
        fields=id,description,host_id
    - name: status
      auto: PREDEFINED
      predefined:
      - ok
      - warning
      - critical
      - unknown
      - pending
      - all
      description: the status of services that you want to get (ok, warning, critical,
        unknown, pending, all)
    - name: hostgroup
      description: hostgroup id filter. For example, hostgroup=2
    - name: servicegroup
      description: servicegroup id filter
    - name: instance
      description: instance id filter. For example, instance=2
    - name: search
      description: search pattern applied on service
    - name: searchHost
      description: search pattern applied on host
    - name: searchOutput
      description: search pattern applied on output
    - name: criticality
      description: a specific criticality
    - name: sortType
      auto: PREDEFINED
      predefined:
      - asc
      - desc
      description: asc or desc
    - name: limit
      description: the amount of lines that you want
    - name: number
      description: page number
    outputs:
    - contextPath: Centreon.Service.Output
      description: Service output
      type: string
    - contextPath: Centreon.Service.Name
      description: Service name
      type: string
    - contextPath: Centreon.Service.ServiceId
      description: Service id
      type: number
    - contextPath: Centreon.Service.Description
      description: Service description
      type: string
    - contextPath: Centreon.Service.State
      description: Service state
    description: All the monitoring information regarding services
  runonce: false
