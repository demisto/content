commonfields:
  id: McAfee ESM-v10.2
  version: -1
name: McAfee ESM-v10.2
display: McAfee ESM-v10.2
category: Analytics & SIEM
image: data:image/png;base64,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
description: Run queries and receive alarms from Intel Security ESM
configuration:
- display: Port
  name: port
  defaultvalue: "443"
  type: 0
  required: true
- display: ESM IP (e.g. 78.125.0.209)
  name: ip
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
- display: 'Fetch Types: cases, alarms, both (relevant only for fetch incident mode)'
  name: fetchTypes
  defaultvalue: alarms
  type: 0
  required: false
- display: 'Start fetch after Case ID: (relevant only for fetch incident mode)'
  name: startingCaseID
  defaultvalue: "0"
  type: 0
  required: false
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |-
    import base64
    import json
    import re
    import sys
    import requests
    import time
    import datetime
    from distutils.util import strtobool

    # global for ignoring errors in fetch incident
    should_stop_on_error = True
    max_cases_per_fetch = 30

    # by default filters only "Closed" cases
    filtered_out_statuses = [2, ]
    verify =  demisto.params()['insecure'] == False
    requests.packages.urllib3.disable_warnings()

    def throw_error(error_str):
        if should_stop_on_error:
            demisto.results({ 'Type' : entryTypes['error'], 'ContentsFormat' : 'text', 'Contents' : error_str })
            sys.exit(0)
        else:
            demisto.error(error_str)

    def search_result_to_md(res):
        columns = res['columns']
        rows = res['rows']

        md = "### results:\n"

        if(len(rows) == 0):
            return md + "No matching search result were found"

        # headers
        columnNames = list(map(lambda column: column['name'], columns))
        md = md + ' | '.join(columnNames) + '\n'
        md = md + ' | '.join(list(map(lambda column: "---", columns))) + '\n'

        # body
        for row in rows:
            md = md + ' | '.join(r.replace('|', '\\|') for r in row['values']) + '\n'

        return md

    def search_results_to_context(res):
        columns = res['columns']
        rows = res['rows']
        if (len(rows) == 0):
            demisto.results('No results were found')
        fixed_searches = []
        for row in rows:
            values = row['values']
            i = 0
            for column in columns:
                column_string = column['name'].replace("Alert.", "")
                fixed_searches.append({
                column_string : values[i]
                })
                i += 1
        context = {'SearchResults(val.ID && val.ID == obj.ID)' : fixed_searches}
        return context

    def severity_to_level(severity):
        if severity > 65:
            return 3
        elif severity > 32:
            return 2
        else:
            return 1

    class NitroESM(object):

        def __init__(self, esmhost, user, passwd):
            """ Init instance attributes """
            self.esmhost = esmhost
            self.user = user
            self.passwd = passwd
            self._build_login_urls()
            self._encode_login()
            self._build_params()
            self.is_logged_in = False

        def _build_login_urls(self):
            """ Concatenate URLs """
            self.url = 'https://{}/rs/esm/'.format(self.esmhost)
            self.int_url = 'https://{}/ess'.format(self.esmhost)
            self.login_url = '{}{}'.format(self.url, 'login')

        def _encode_login(self):
            self.b64_user = base64.b64encode(self.user.encode('utf-8')).decode()
            self.b64_passwd = base64.b64encode(self.passwd.encode('utf-8')).decode()

        def _build_params(self):
                self.params = {"username": self.b64_user,
                               "password": self.b64_passwd,
                               "locale": "en_US",
                               "os" : "Win32"
                               }
                try:
                    self.params_json = json.dumps(self.params)
                except TypeError as e:
                    throw_error("Invalid parameters: {}".format(self.params))

        def login(self):
            try:
                authString = base64.encodestring('%s:%s' % (self.user, self.passwd)).strip()
                self.v10_login_headers = {'Content-Type': 'application/json'}
                self.login_response = requests.post(self.login_url,
                                                     self.params_json,
                                                     headers=self.v10_login_headers,
                                                     verify=verify)
                self.cookie = self.login_response.headers.get('Set-Cookie')
                try:
                    self.jwttoken = re.search('(^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*)', self.cookie).group(1)
                except TypeError as e:
                    throw_error("Failed login\nurl: {}\n response status: {}\nresponse: {}\n".format(self.login_url,
                                    self.login_response.status_code, self.login_response.text))
                self.xsrf_token = self.login_response.headers.get('Xsrf-Token')
                self.session_headers = {'Cookie' : self.jwttoken,
                                        'X-Xsrf-Token' : self.xsrf_token,
                                        'Content-Type': 'application/json'}
                self.is_logged_in = True
            except KeyError as e:
                throw_error("Failed login\n error: {}".format(e))

        def logout(self):
            if self.is_logged_in:
                try:
                    headers = {'Cookie' : self.cookie}
                    requests.post(self.url + 'userLogout',
                        headers=self.session_headers,
                        # headers=headers,
                        data=json.dumps(''),
                        verify=verify
                        )
                    self.is_logged_in = False
                except Exception as e:
                    demisto.error('McAfee ESM logout failed with the following error: %s' % (str(e), ))

        def cmdquery(self, cmd, query=None, no_answer=False, no_validation=False):
            """ Send query to ESM, return JSON result """
            self.cmd = cmd
            self.query = query
            self.url = 'https://{}/rs/esm/'.format(self.esmhost)
            self.result = requests.post(self.url + self.cmd,
                                        headers=self.session_headers,
                                        data=self.query, verify=verify)
            if not no_validation:
                if no_answer:
                    if self.result.status_code != 200:
                        throw_error('Error - ESM replied with:\n - status code: {} \n - body: {}'.format(self.result.status_code, self.result.text))
                else:
                    try:
                        res = self.result.json()
                        if 'qry' not in cmd:
                            return res['return']
                        return res
                    except:
                        throw_error('Error - ESM replied with:\n - status code: {} \n - body: {}'.format(self.result.status_code, self.result.text))

        def execute_query(self, time_range, custom_start, custom_end, filters, fields, query_type):
            if (time_range == 'CUSTOM' and (not custom_start or not custom_end)):
                throw_error('you must specify customStart and customEnd when timeRange is CUSTOM')

            cmd = 'v2/qryExecuteDetail?reverse=false&type=' + query_type
            if (time_range == 'CUSTOM'):
               cmd = cmd + '&customStart=' + custom_start + '&customEnd=' + custom_end

            q = {
                'config': {
                    'timeRange': time_range,
                    'filters': filters
                }
            }
            if fields is not None:
                q['config']['fields'] = json.loads(fields)
            query = json.dumps(q)

            res = self.cmdquery(cmd, query)
            return res['resultID']

        def get_query_result(self, resultID):
            cmd = 'v2/qryGetStatus'
            query = json.dumps({ 'resultID': resultID })

            res = self.cmdquery(cmd, query)
            return res['complete']

        def wait_for_results(self, resultID, max_wait):

            # initial back off, sleep 3 sec between each time
            for i in range(5):
                ready = self.get_query_result(resultID)
                if ready:
                    return
                else:
                    time.sleep(3)

            # wait for response - 1 min between each try
            for i in range(max_wait):
                ready = self.get_query_result(resultID)
                if ready:
                    return
                else:
                    time.sleep(60)

            throw_error('Waited more {} min for query results : {}'.format(max_wait, resultID))

        def fetch_results(self, resultID):
            cmd = 'v2/qryGetResults?startPos=0&reverse=false&numRows=1000'
            query = json.dumps({ 'resultID': resultID })

            res = self.cmdquery(cmd, query)
            return res

        def search(self, time_range, custom_start, custom_end, filters, fields, query_type, max_wait):
            self.login()
            # execute command
            resultID = self.execute_query(time_range, custom_start, custom_end, filters, fields, query_type)

            # wait for result to be ready
            self.wait_for_results(resultID, max_wait)

            #fetch result
            res = self.fetch_results(resultID)
            table = search_result_to_md(res)
            context = search_results_to_context(res)

            return {
                'ContentsFormat': formats['json'],
                'Type': entryTypes['note'],
                'Contents': res,
                'ReadableContentsFormat': formats['markdown'],
                'HumanReadable': table,
                'EntryContext': context
            }

        def fetchAllFields(self):
            self.login()
            res = self.cmdquery('v2/qryGetFilterFields')

            # convert to an appropriate table
            for x in res:
                x['types'] = ','.join(x['types'])

            return {
                'ContentsFormat': formats['json'],
                'Type': entryTypes['note'],
                'Contents': res,
                'ReadableContentsFormat': formats['markdown'],
                'HumanReadable': tblToMd('Result:' ,res),
            }

        # alarms commands
        def fetch_alarms(self, time_range, custom_start, custom_end, assigned_user):
            if (time_range == 'CUSTOM' and (not custom_start or not custom_end)):
                throw_error('you must specify customStart and customEnd when timeRange is CUSTOM')

            self.login()

            cmd = 'alarmGetTriggeredAlarmsPaged?pageSize=500&pageNumber=1&triggeredTimeRange=' + time_range
            if (time_range == 'CUSTOM'):
               cmd = cmd + '&customStart=' + custom_start + '&customEnd=' + custom_end

            query = ''
            if (assigned_user == 'ME'):
                user = self.get_user_obj(self.user)
                query = json.dumps({ 'assignedUser' : user})
            elif assigned_user:
                query = json.dumps({ 'assignedUser' : self.get_user_obj(assigned_user)})

            res = self.cmdquery(cmd, query)

            for alarm in res:
                alarm['ID'] = alarm['id']['value']
                del alarm["id"]

            return res
        def update_alarms_status(self, alarm_ids):
            cmd = 'alarm%(action)sTriggeredAlarm' % (action, )
            query = json.dumps({'triggeredIds' : [{'value' : int(i)} for i in alarm_ids]})

            self.login()

            # the command return an error for a list of alarm ids however is execute the update successfully.
            self.cmdquery(cmd, query, no_validation=True)
            return 'Alarms has been %sd.' % (action, )

        def acknowledge_alarms(self, alarm_ids):
            return self.update_alarms_status('Acknowledge', alarm_ids)

        def unacknowledge_alarms(self, alarm_ids):
            return self.update_alarms_status('Unacknowledge', alarm_ids)

        def delete_alarms(self, alarm_ids):
            return self.update_alarms_status('Delete', alarm_ids)

        # case statuses commands
        def add_case_status(self, name, should_show_in_case_pane):
            '''add a new type of case status with given parameters'''
            self.login()
            status_details = {
                'name' : name,
                'default' : False,
                'showInCasePane' : should_show_in_case_pane
            }

            cmd = 'caseAddCaseStatus'
            query = json.dumps({'status' : status_details})
            self.cmdquery(cmd, query)
            return 'Added case status : %s' % (name, )

        def edit_case_status(self, original_name, new_name, show_in_case_pane):
            '''edit a  case status with given id'''
            self.login()

            status_id = self.case_status_name_to_id(original_name)
            status_details = {
                'id' : status_id,
                'name': new_name
            }

            if show_in_case_pane is not None:
                status_details['showInCasePane'] = show_in_case_pane

            cmd = 'caseEditCaseStatus'
            query = json.dumps({'status' : status_details})
            self.cmdquery(cmd, query, no_answer=True)

            return 'Edit case status with ID: %d' % (status_id, )

        def delete_case_status(self, name):
            '''delete a new type of case status with given name'''
            self.login()
            status_id = self.case_status_name_to_id(name)
            status_id = {'value' : status_id}

            cmd = 'caseDeleteCaseStatus'
            query = json.dumps({'statusId' : status_id})
            self.cmdquery(cmd, query, no_answer=True)

            return 'Deleted case status with ID: %d' % (status_id['value'], )

        def get_case_statuses(self, should_login = False):
            '''get all case statuses'''
            if should_login:
                self.login()

            cmd = 'caseGetCaseStatusList'
            query = json.dumps({"authPW": {"value": self.passwd}})
            return self.cmdquery(cmd, query)

        def case_status_id_to_name(self, status_id):
            '''convert case status id to name'''
            res = self.get_case_statuses()
            matches = [status['name'] for status in res if status['id'] == status_id]
            return matches[0] if matches else 'Unknown - %d' % (status_id, )

        def case_status_name_to_id(self, status_name):
            '''convert case status name to id'''
            res = self.get_case_statuses()
            matches = [status['id'] for status in res if status['name'].lower() == status_name.lower()]
            return matches[0] if matches else 0 # 0 is not a valid value

        # user commands
        def get_users(self, should_login = False):
            '''get all user's names'''
            if should_login:
                self.login()

            cmd = 'userGetUserList'
            query = json.dumps({"authPW": {"value": self.passwd}})
            return self.cmdquery(cmd, query)

        def get_user_obj(self, user_name):
            '''get user object'''
            if user_name.lower() == 'me':
                user_name = self.user
            res = self.get_users()
            matches = [user for user in res if user['username'] == user_name]
            self_matches = [user['id']['value'] for user in res if user['username'] == self.user]

            # the login user must appear in the user list
            return matches[0] if matches else self_matches[0]

        def user_name_to_id(self, user_name):
            '''convert user name to id'''
            if user_name is None or user_name.lower() == 'me':
                user_name = self.user
            res = self.get_users()
            matches = [user['id']['value'] for user in res if user['username'] == user_name]
            self_matches = [user['id']['value'] for user in res if user['username'] == self.user]

            # the login user must appear in the user list
            return matches[0] if matches else self_matches[0]

        def user_id_to_name(self, user_id):
            '''convert user id to name'''
            res = self.get_users()
            matches = [user['username'] for user in res if user['id']['value'] == user_id]

            return matches[0] if matches else self.user

        # organization commands
        def get_organizations(self, should_login = False):
            '''get all organization names'''
            if should_login:
                self.login()

            cmd = 'caseGetOrganizationList'
            return self.cmdquery(cmd, '')

        def organization_name_to_id(self, organization_name):
            '''convert organization name to id'''
            if organization_name is None:
                organization_name = ''
            res = self.get_organizations()
            matches = [org['id'] for org in res if org['name'].lower() == organization_name.lower()]

            return matches[0] if matches else 1

        def organization_id_to_name(self, organization_id):
            '''convert organization name to id'''
            res = self.get_organizations()
            matches = [org['name'] for org in res if org['id'] == organization_id]

            return matches[0] if matches else 'None'

        # cases commands
        def get_cases(self):
            '''get all cases associated with current user'''
            self.login()
            cmd = 'caseGetCaseList'
            res = self.cmdquery(cmd)

            return res

        def get_case_detail(self, case_id, should_login=False):
            if should_login:
                self.login()

            cmd = 'caseGetCaseDetail'
            case_id = {'id' : {'value' : case_id}}
            query = json.dumps(case_id)
            res = self.cmdquery(cmd, query)

            return res

        def add_case(self, summary, severity, status, assignee, organization):
            self.login()

            if severity < 1:
                severity = 1
            elif severity > 100:
                severity = 100

            if status is None:
                status = 'Open'

            assignee = self.user_name_to_id(assignee)
            org_id = self.organization_name_to_id(organization)

            cmd = 'caseAddCase'
            case_details = {
                'summary' : summary,
                'assignedTo' : assignee,
                'severity' : severity,
                'orgId' : org_id,
                'statusId' : {'value' : self.case_status_name_to_id(status)},
            }

            query = json.dumps({ 'caseDetail' : case_details})
            res = self.cmdquery(cmd, query)
            return res['value']

        def edit_case(self, case_id, summary, severity, status, assignee, organization):
            self.login()

            case = self.get_case_detail(case_id)

            if summary is not None:
                case['summary'] = summary

            if severity is not None:
                if severity < 1:
                    severity = 1
                elif severity > 100:
                    severity = 100
                case['severity'] = severity

            if status is not None:
                case['statusId'] = self.case_status_name_to_id(status)

            if assignee is not None:
                case['assignedTo'] = self.user_name_to_id(assignee)

            cmd = 'caseEditCase'
            query = json.dumps({'caseDetail' : case})
            self.cmdquery(cmd, query, True)

            return

        def get_case_event_list(self, event_ids):
            self.login()

            event_ids = {'list' : event_ids}

            cmd = 'caseGetCaseEventsDetail'
            query = json.dumps({'eventIds' : event_ids})
            res = self.cmdquery(cmd, query)

            return res


    def alarms_to_entry(alarms):
        if not alarms:
                return "No alarms were found"

        context = { 'Alarm(val.ID && val.ID == obj.ID)': alarms }
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': alarms,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tblToMd('Result:' ,alarms),
            'EntryContext': context
        }

    def alarms_to_incidents(alarms):
        incidents = []
        for alarm in alarms:
            incidents.append({
                'name': alarm['summary'],
                'details': 'Alarm {} , ID : {} , was triggered by condition type: {}'.format(alarm['alarmName'], alarm['ID'], alarm['conditionType']),
                'severity': severity_to_level(alarm['severity']),
                'rawJSON': json.dumps(alarm)
            })
        return incidents

    def cases_to_entry(esm, title, cases):
        if not cases:
            return 'No cases were found'

        headers = ['ID', 'Summary', 'Status', 'Severity', 'Open Time']
        fixed_cases = []
        context_cases = []
        for case in cases:
            fixed_case = {}
            fixed_case['ID'] = case['id']['value']
            fixed_case['Summary'] = case['summary']
            fixed_case['Status'] = esm.case_status_id_to_name(case['statusId']['value'])
            fixed_case['OpenTime'] = case['openTime']
            fixed_case['Severity'] = case['severity']

            if case.has_key('assignedTo'):
                fixed_case['Assignee'] = esm.user_id_to_name(case['assignedTo'])
                headers.append('Assignee')

            if case.has_key('orgId'):
                fixed_case['Organization'] = esm.organization_id_to_name(case['orgId'])
                headers.append('Organization')

            context_case = fixed_case.copy()
            if case.has_key('eventList'):
                fixed_case['Event List'] = json.dumps(case['eventList']).replace('|', '\|')
                context_case['EventList'] = case['eventList']
                headers.append('Event List')

            if case.has_key('notes'):
                fixed_case['Notes'] = json.dumps(case['notes']).replace('|', '\|')
                context_case['Notes'] = case['notes']
                headers.append('Notes')

            fixed_cases.append(fixed_case)
            context_cases.append(context_case)

        context = { 'Case(val.ID && val.ID == obj.ID)': context_cases }
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': cases,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tblToMd(title, fixed_cases, headers),
            'EntryContext': context
        }

    def cases_to_incidents(esm, cases):
        incidents = []
        for case in cases:
            demisto.log(esm.case_status_id_to_name(case['statusId']['value']))
            incident = {
                'name' : case['summary'],
                'details' : 'Case %s with ID %s was triggerred' % (case['summary'], case['id']['value']),
                'severity' : severity_to_level(case['severity']),
                # 'status' : esm.case_status_id_to_name(case['statusId']['value']),
                'rawJSON' : json.dumps(case),
            }
            # if case.has_key('assignedTo'):
            #     incident['owner'] = esm.user_id_to_name(case['assignedTo'])
            incidents.append(incident)

        return incidents

    def case_statuses_to_entry(case_statuses):
        if not case_statuses:
            return 'No case statuses were found'

        headers = ['ID', 'Name', 'Is Default', 'Show In Case Pane']
        fixed_statuses = []
        for status in case_statuses:
            fixed_statuses.append({
                'ID' : status['id'],
                'Name' : status['name'],
                'Is Default' : status['default'],
                'Show In Case Pane' : status['showInCasePane']
            })

        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': fixed_statuses,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tblToMd('Result:', fixed_statuses, headers),
            'EntryContext': {}
        }

    def organizations_to_entry(organizations):
        if not organizations:
            return 'No organizations were found'

        headers = ['ID', 'Name']
        fixed_organizations = []
        for organization in organizations:
            fixed_organizations.append({
                'ID' : organization['id'],
                'Name' : organization['name'],
            })

        context = {'Organizations(val.ID && val.ID == obj.ID)' : fixed_organizations}
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': fixed_organizations,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tblToMd('Case Events:', fixed_organizations, headers),
            'EntryContext': context
       }

    def events_to_entry(events):
        if not events:
            return 'No events were found'

        headers = ['ID', 'LastTime', 'Message']
        fixed_events = []
        for event in events:
            fixed_events.append({
                'ID' : event['id']['value'].replace('|', '\|'),
                'LastTime' : event['lastTime'],
                'Message' : event['message'],
            })

        context = {'CaseEvents(val.ID && val.ID == obj.ID)' : fixed_events}
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': fixed_events,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tblToMd('Case Events:', fixed_events, headers),
            'EntryContext': context
       }

    def users_to_entry(users):
        # unreachable code - in order to send command, one must be logged in. therefore there is at least one user.
        if not users:
            return 'No users were found'

        headers = ['ID', 'Name', 'Email', 'SMS', 'IsMaster', 'IsAdmin']
        fixed_users = []
        for user in users:
            fixed_users.append({
                'ID' : user['id']['value'],
                'Name' : user['username'],
                'Email' : user['email'],
                'SMS' : user['sms'],
                'IsMaster' : user['master'],
                'IsAdmin' : user['admin'],
            })

        context = {'EsmUser(val.ID && val.ID == obj.ID)' : fixed_users}
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': fixed_users,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tblToMd('Users:', fixed_users, headers),
            'EntryContext': context
       }

    esm = NitroESM(demisto.params()['ip'] + ':' + demisto.params()['port'], demisto.params()['credentials']['identifier'],
        demisto.params()['credentials']['password'])
    final_result = 'No result set'

    if demisto.command() == 'fetch-incidents':
        last_run = demisto.getLastRun()
        # for backward compatibility uses
        if last_run.has_key('value') and not last_run.has_key('alarms'):
            last_run['alarms'] = last_run['value']
        configuration_last_case = int(demisto.params()['startingCaseID'])

        start_alarms = last_run.get('alarms', (datetime.datetime.now() - datetime.timedelta(minutes=1)).isoformat())
        last_case = last_run.get('cases', 0)
        # if last_case < configuration_last_case:
        last_case = max(last_case, configuration_last_case)

        incidents = []
        mode = demisto.params().get('fetchTypes', 'alarms').lower() # alarms is default for backward compatability

        if mode in ('alarms', 'both'):
            end = datetime.datetime.now().isoformat()
            last_run['value'] = end
            last_run['alarms'] = end

            res = esm.fetch_alarms(
                'CUSTOM',
                start_alarms,
                end,
                ''
            )
            esm.logout()
            incidents.extend(alarms_to_incidents(res))

        if mode in ('cases', 'both'):
            esm.login()

            # get new cases
            cases = [case for case in esm.get_cases() if case['id']['value'] > last_case]
            cases.sort(cmp=lambda case1,case2: case1['id']['value'].__cmp__(case2['id']['value']))
            cases = cases[:max_cases_per_fetch]

            if cases:
                last_case = cases[-1]['id']['value']

            esm.logout()
            # update last run info
            last_run['cases'] = last_case

            demisto.info('adding %d more cases, last id is: %d' % (len(cases), last_run['cases'], ))
            if cases:
                incidents.extend(cases_to_incidents(esm, cases))

        demisto.setLastRun(last_run)
        demisto.incidents(incidents)
        sys.exit(0)


    elif demisto.command() == 'test-module':
        esm.fetchAllFields()
        final_result = 'ok'

    elif demisto.command() == 'esm-fetch-fields':
        res = esm.fetchAllFields()
        final_result = res

    elif demisto.command() == 'esm-search':
        args = demisto.args()
        res = esm.search(
            demisto.get(args, 'timeRange'),
            demisto.get(args, 'customStart'),
            demisto.get(args, 'customEnd'),
            json.loads(args.get('filters')),
            args.get('fields'),
            demisto.get(args, 'queryType') or 'EVENT',
            demisto.get(args, 'maxWait') or 30
            )
        final_result = res

    elif demisto.command() == 'esm-get-case-list':
        res = esm.get_cases()
        final_result = cases_to_entry(esm, 'All cases:', res)

    elif demisto.command() == 'esm-get-case-detail':
        args = demisto.args()
        case_id = int(demisto.get(args, 'id'))
        res = esm.get_case_detail(case_id, True)
        final_result = cases_to_entry(esm, 'Case %d:' % (case_id, ), [res])

    elif demisto.command() == 'esm-add-case':
        args = demisto.args()
        res = esm.add_case(
            demisto.get(args, 'summary'),
            int(demisto.get(args, 'severity')),
            demisto.get(args, 'status'),
            demisto.get(args, 'assignee'),
            demisto.get(args, 'organization'),
            )
        case = esm.get_case_detail(res)
        final_result = cases_to_entry(esm, 'New Case:', [case])

    elif demisto.command() == 'esm-edit-case':
        args = demisto.args()
        case_id = int(demisto.get(args, 'id'))
        sevirity = demisto.get(args, 'severity')
        esm.edit_case(
            case_id,
            demisto.get(args, 'summary'),
            int(sevirity) if sevirity else None,
            demisto.get(args, 'status'),
            demisto.get(args, 'assignee'),
            demisto.get(args, 'organization'),
            )
        case = esm.get_case_detail(case_id)
        final_result = cases_to_entry(esm, 'Edited Case:', [case])

    elif demisto.command() == 'esm-get-case-statuses':
        res = esm.get_case_statuses(True)
        final_result = case_statuses_to_entry(res)

    elif demisto.command() == 'esm-add-case-status':
        args = demisto.args()
        res = esm.add_case_status(
            demisto.get(args, 'name'),
            bool(strtobool(demisto.get(args, 'show_in_case_pane'))),
            )
        final_result = res

    elif demisto.command() == 'esm-edit-case-status':
        args = demisto.args()
        should_show = demisto.get(args, 'show_in_case_pane')
        res = esm.edit_case_status(
            demisto.get(args, 'original_name'),
            demisto.get(args, 'new_name'),
            bool(strtobool(should_show)) if should_show else None,
            )
        final_result = res

    elif demisto.command() == 'esm-delete-case-status':
        args = demisto.args()
        res = esm.delete_case_status(
            demisto.get(args, 'name')
        )
        final_result = res

    elif demisto.command() == 'esm-get-case-event-list':
        args = demisto.args()
        event_ids = demisto.get(args, 'ids').split(',')
        res = esm.get_case_event_list(event_ids)
        final_result = events_to_entry(res)

    elif demisto.command() == 'esm-get-organization-list':
        res = esm.get_organizations(True)
        final_result = organizations_to_entry(res)

    elif demisto.command() == 'esm-get-user-list':
        res = esm.get_users(True)
        final_result = users_to_entry(res)

    elif demisto.command() == 'esm-fetch-alarms':
        args = demisto.args()
        res = esm.fetch_alarms(
            demisto.get(args, 'timeRange'),
            demisto.get(args, 'customStart'),
            demisto.get(args, 'customEnd'),
            demisto.get(args, 'assignedUser')
        )
        final_result = alarms_to_entry(res)

    elif demisto.command() == 'esm-acknowledge-alarms':
        args = demisto.args()
        res = esm.acknowledge_alarms(argToList(demisto.get(args, 'alarmIds')))
        final_result = res

    elif demisto.command() == 'esm-unacknowledge-alarms':
        args = demisto.args()
        res = esm.unacknowledge_alarms(argToList(demisto.get(args, 'alarmIds')))
        final_result = res

    elif demisto.command() == 'esm-delete-alarms':
        args = demisto.args()
        res = esm.delete_alarms(argToList(demisto.get(args, 'alarmIds')))
        final_result = res

    esm.logout()
    demisto.results(final_result)
    sys.exit(0)
  type: python
  commands:
  - name: esm-fetch-fields
    arguments: []
    description: Get all fields that can be used in query filters, with type information
      for each field
  - name: esm-search
    arguments:
    - name: timeRange
      required: true
      auto: PREDEFINED
      predefined:
      - LAST_3_DAYS
      - LAST_2_DAYS
      - LAST_24_HOURS
      - PREVIOUS_DAY
      - CURRENT_DAY
      - LAST_HOUR
      - LAST_30_MINUTES
      - LAST_10_MINUTES
      - LAST_MINUTE
      - CUSTOM
      - PREVIOUS_YEAR
      - CURRENT_YEAR
      - PREVIOUS_QUARTER
      - CURRENT_QUARTER
      - PREVIOUS_MONTH
      - CURRENT_MONTH
      - PREVIOUS_WEEK
      - CURRENT_WEEK
      description: The time period for the search
    - name: filters
      required: true
      description: Filter on the query results, should be a json string, of the format
        EsmFilter (read more on that here - https://<esm-ip>:<esm-port>/rs/esm/help/types/EsmFilter)
    - name: queryType
      auto: PREDEFINED
      predefined:
      - EVENT
      - FLOW
      - ASSETS
      description: 'Query type to preform, by default EVENT (other possible values
        are : FLOW/ASSET)'
    - name: maxWait
      description: Maximum time to wait (in minutes), default is 30
    - name: customStart
      description: if timeRange is CUSTOM, start time for the time range (e.g. 2017-06-01T12:48:16.734Z)
    - name: customEnd
      description: if timeRange is CUSTOM, end time for the time range (e.g. 2017-06-01T12:48:16.734Z)
    - name: fields
      description: The fields that will be selected when this query is executed.
    description: Perform a query against Mcafee ESM SIEM
  - name: esm-fetch-alarms
    arguments:
    - name: timeRange
      required: true
      auto: PREDEFINED
      predefined:
      - LAST_3_DAYS
      - LAST_2_DAYS
      - LAST_24_HOURS
      - PREVIOUS_DAY
      - CURRENT_DAY
      - LAST_HOUR
      - LAST_30_MINUTES
      - LAST_10_MINUTES
      - LAST_MINUTE
      - CUSTOM
      - PREVIOUS_YEAR
      - CURRENT_YEAR
      - PREVIOUS_QUARTER
      - CURRENT_QUARTER
      - PREVIOUS_MONTH
      - CURRENT_MONTH
      - PREVIOUS_WEEK
      - CURRENT_WEEK
      description: The time period for the fetch
    - name: customStart
      description: if timeRange is CUSTOM, start time for the time range (e.g. 2017-06-01T12:48:16.734Z)
    - name: customEnd
      description: if timeRange is CUSTOM, end time for the time range (e.g. 2017-06-01T12:48:16.734Z)
    - name: assignedUser
      auto: PREDEFINED
      predefined:
      - ME
      - ""
      description: 'user assigned to handle this triggered alarm (use ''ME'' option
        to use instance user, or use format EsmUser (read more on that here - https://<esm-ip>:<esm-port>/rs/esm/help/types/EsmUser) '
    outputs:
    - contextPath: Alarm.ID
      description: Alarm ID
    - contextPath: Alarm.summary
      description: Alarm summary
    - contextPath: Alarm.assignee
      description: Alarm assignee
    - contextPath: Alarm.severity
      description: Alarm severity
    - contextPath: Alarm.triggeredDate
      description: Alarm triggered date
    - contextPath: Alarm.acknowledgedDate
      description: Alarm acknowledged date
    - contextPath: Alarm.acknowledgedUsername
      description: Alarm acknowledged username
    - contextPath: Alarm.alarmName
      description: Alarm name
    - contextPath: Alarm.conditionType
      description: Alarm condition type
    description: Retrieves a list of alarms that have been triggered
  - name: esm-get-case-list
    arguments: []
    outputs:
    - contextPath: Case.ID
      description: The ID of the case
    - contextPath: Case.Summary
      description: The summary of the case
    - contextPath: Case.Status
      description: The status of the case
    - contextPath: Case.OpenTime
      description: The open time of the case
    - contextPath: Case.Severity
      description: The severity of the case
    - contextPath: Case.Assignee
      description: The Assignee of the case
    - contextPath: Case.Organization
      description: The organization of the case
    - contextPath: Case.EventList
      description: List of case's events
    - contextPath: Case.Notes
      description: List of case's notes
    description: Get a list of cases from the system
  - name: esm-add-case
    arguments:
    - name: summary
      required: true
      default: true
      description: the name of the case
    - name: status
      description: the status of the case (use `esm-get-case-statuses` to view all
        statuses)
      defaultValue: Open
    - name: assignee
      description: who the case is assigned to
      defaultValue: me
    - name: severity
      description: the severity of the case (1 - 100)
      defaultValue: "1"
    - name: organization
      description: the organization assigned to the case  (use `esm-get-organization-list`
        to view all ogranizations)
    outputs:
    - contextPath: Case.ID
      description: The ID of the case
    - contextPath: Case.Summary
      description: The summary of the case
    - contextPath: Case.Status
      description: The status of the case
    - contextPath: Case.OpenTime
      description: The open time of the case
    - contextPath: Case.Severity
      description: The severity of the case
    - contextPath: Case.Assignee
      description: The Assignee of the case
    - contextPath: Case.Organization
      description: The organization of the case
    - contextPath: Case.EventList
      description: List of case's events
    - contextPath: Case.Notes
      description: List of case's notes
    description: Add a case to the system
  - name: esm-edit-case
    arguments:
    - name: id
      required: true
      default: true
      description: the id of the case
    - name: summary
      description: the name of the case
    - name: severity
      description: the new severity of the case (1 - 100)
    - name: assignee
      description: who the case should be assigned to
    - name: status
      description: the new status of the case (use `esm-get-case-statuses` to view
        all statuses)
    - name: organization
      description: the organization assigned to the case  (use `esm-get-organization-list`
        to view all ogranizations)
    outputs:
    - contextPath: Case.ID
      description: The ID of the case
    - contextPath: Case.Summary
      description: The summary of the case
    - contextPath: Case.Status
      description: The status of the case
    - contextPath: Case.OpenTime
      description: The open time of the case
    - contextPath: Case.Severity
      description: The severity of the case
    - contextPath: Case.Assignee
      description: The Assignee of the case
    - contextPath: Case.Organization
      description: The organization of the case
    - contextPath: Case.EventList
      description: List of case's events
    - contextPath: Case.Notes
      description: List of case's notes
    description: Edit an existing case
  - name: esm-get-case-statuses
    arguments: []
    description: Get a list of valid case statuses from the system
  - name: esm-edit-case-status
    arguments:
    - name: original_name
      required: true
      default: true
      description: the name of the case status to edit
    - name: new_name
      required: true
      description: the new name for the case status
    - name: show_in_case_pane
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: whether the status be shown in case pane
    description: Edit a case status
  - name: esm-get-case-detail
    arguments:
    - name: id
      required: true
      default: true
      description: the ID of the case
    outputs:
    - contextPath: Case.ID
      description: The ID of the case
    - contextPath: Case.Summary
      description: The summary of the case
    - contextPath: Case.Status
      description: The status of the case
    - contextPath: Case.OpenTime
      description: The open time of the case
    - contextPath: Case.Severity
      description: The severity of the case
    - contextPath: Case.Assignee
      description: The Assignee of the case
    - contextPath: Case.Organization
      description: The organization of the case
    - contextPath: Case.EventList
      description: List of case's events
    - contextPath: Case.Notes
      description: List of case's notes
    description: Get detail on an existing case
  - name: esm-get-case-event-list
    arguments:
    - name: ids
      required: true
      description: Comma separated  list of event IDs
    outputs:
    - contextPath: CaseEvents.ID
      description: The ID of the event
    - contextPath: CaseEvents.LastTime
      description: The last updated time of the event
    - contextPath: CaseEvents.Message
      description: The massage of the event
    description: Get case events details
  - name: esm-add-case-status
    arguments:
    - name: name
      required: true
      default: true
      description: the name of the case status
    - name: show_in_case_pane
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: whether the status be shown in case pane
      defaultValue: "True"
    description: Add a case status
  - name: esm-delete-case-status
    arguments:
    - name: name
      required: true
      default: true
      description: the name of the case status to delete
    description: Delete a case status
  - name: esm-get-organization-list
    arguments: []
    description: Get case organization
  - name: esm-get-user-list
    arguments: []
    outputs:
    - contextPath: EsmUser.ID
      description: the ID of the user
    - contextPath: EsmUser.Name
      description: the esm user name
    - contextPath: EsmUser.Email
      description: the e-mail of the user
    - contextPath: EsmUser.SMS
      description: the SMS details of the user
    - contextPath: EsmUser.IsMaster
      description: whether the user is a master user
    - contextPath: EsmUser.IsAdmin
      description: whether the user is an admin
    description: Get a list of all users.
  - name: esm-acknowledge-alarms
    arguments:
    - name: alarmIds
      required: true
      default: true
      description: list of triggered alarm ids to be marked acknowledged separated
        with commas
      isArray: true
    description: Mark triggered alarms as acknowledged
  - name: esm-unacknowledge-alarms
    arguments:
    - name: alarmIds
      required: true
      default: true
      description: list of triggered alarm ids to be marked unacknowledged separated
        with commas
      isArray: true
    description: Mark triggered alarms as unacknowledged
  - name: esm-delete-alarms
    arguments:
    - name: alarmIds
      required: true
      default: true
      description: list of triggered alarm ids to be deleted separated with commas
      isArray: true
    description: Delete triggered alarms
  isfetch: true
