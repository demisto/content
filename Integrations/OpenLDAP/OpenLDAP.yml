commonfields:
  id: LDAP
  version: -1
name: LDAP
display: LDAP
category: Database
image: data:image/png;base64,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
description: LDAP integration for use with the Lightweight Directory Access Protocol
configuration:
- display: Host
  name: host
  defaultvalue: 192.168.10.188
  type: 0
  required: true
- display: Port
  name: port
  defaultvalue: "389"
  type: 0
  required: true
- display: Use SSL
  name: secure
  defaultvalue: "false"
  type: 8
  required: false
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: false
- display: Domain
  name: domain
  defaultvalue: ""
  type: 0
  required: false
script:
  script: ''
  type: python
  commands:
  - name: ldap-object-search
    arguments:
    - name: search_base
      required: true
      description: Base DN to begin search from
    - name: search_filter
      required: true
      description: Filter to use for teh search
    - name: attributes
      description: CSV of attributes to return
    outputs:
    - contextPath: LDAP.Object.Search
    description: Search LDAP for objects
  - name: ldap-object-create
    arguments:
    - name: dn
      required: true
      description: Full DN to create
    - name: objectClass
      required: true
      description: Object Class to create the new entry as
    - name: attributes
      description: 'JSON string of attributes to set. Example: {''givenName'': ''Beatrix'',
        ''sn'': ''Potter''}'
    outputs:
    - contextPath: LDAP.Object.Create.result
    - contextPath: LDAP.Object.Create.description
    - contextPath: LDAP.Object.Create.dn
    - contextPath: LDAP.Object.Create.message
    - contextPath: LDAP.Object.Create.referrals
    - contextPath: LDAP.Object.Create.type
    description: Creates an object in the LDAP DIT
    execution: true
  - name: ldap-object-rename
    arguments:
    - name: oldDN
      required: true
      description: The DN to modify
    - name: newDN
      required: true
      description: The new DN
    outputs:
    - contextPath: LDAP.Object.Rename.result
    - contextPath: LDAP.Object.Rename.description
    - contextPath: LDAP.Object.Rename.dn
    - contextPath: LDAP.Object.Rename.message
    - contextPath: LDAP.Object.Rename.referrals
    - contextPath: LDAP.Object.Rename.type
    description: Renames an LDAP object (does not modify the attributes)
    execution: true
  - name: ldap-object-move
    arguments:
    - name: dn
      required: true
      description: The DN to move
    - name: location
      required: true
      description: The new location to move the object to
    outputs:
    - contextPath: LDAP.Object.Move.result
    - contextPath: LDAP.Object.Move.description
    - contextPath: LDAP.Object.Move.dn
    - contextPath: LDAP.Object.Move.message
    - contextPath: LDAP.Object.Move.referrals
    - contextPath: LDAP.Object.Move.type
    description: Moves an LDAP object to another location
    execution: true
  - name: ldap-attribute-add
    arguments:
    - name: dn
      required: true
      description: The DN to add to
    - name: attributes
      required: true
      description: 'A dictionary of attributes and values, example: {"sn": "smyth"}.
        There can be multiples of the same attributes, for example: {"sn": ["smyth",
        "jones"]}'
    outputs:
    - contextPath: LDAP.Attribute.Add.result
    - contextPath: LDAP.Attribute.Add.description
    - contextPath: LDAP.Attribute.Add.dn
    - contextPath: LDAP.Attribute.Add.message
    - contextPath: LDAP.Attribute.Add.referrals
    - contextPath: LDAP.Attribute.Add.type
    - contextPath: LDAP.Attribute.Add.attribute
    - contextPath: LDAP.Attribute.Add.value
    description: Adds an attribute to an object
    execution: true
  - name: ldap-attribute-replace
    arguments:
    - name: dn
      required: true
      description: The DN to modify
    - name: attributes
      required: true
      description: 'A dictionary of attributes and values, example: {"sn": "smyth"}.
        There can be multiples of the same attributes, for example: {"sn": ["smyth",
        "jones"]}'
    outputs:
    - contextPath: LDAP.Attribute.Replace.result
    - contextPath: LDAP.Attribute.Replace.description
    - contextPath: LDAP.Attribute.Replace.dn
    - contextPath: LDAP.Attribute.Replace.message
    - contextPath: LDAP.Attribute.Replace.referrals
    - contextPath: LDAP.Attribute.Replace.attribute
    - contextPath: LDAP.Attribute.Replace.value
    description: Replaces an attribute of an object
    execution: true
  - name: ldap-attribute-delete
    arguments:
    - name: dn
      required: true
      description: The DN to modify
    - name: attributes
      required: true
      description: A CSV of attributes to delete
    outputs:
    - contextPath: LDAP.Attribute.Delete.result
    - contextPath: LDAP.Attribute.Delete.description
    - contextPath: LDAP.Attribute.Delete.dn
    - contextPath: LDAP.Attribute.Delete.message
    - contextPath: LDAP.Attribute.Delete.referrals
    - contextPath: LDAP.Attribute.Delete.attribute
    description: Deletes an attribute of an object
  - name: ldap-attribute-check
    arguments:
    - name: dn
      required: true
      description: The DN to check against
    - name: attribute
      required: true
      description: The attribute to check
    - name: value
      required: true
      description: The value to check against
    outputs:
    - contextPath: LDAP.Attribute.Match.IsMatch
    description: Checks an attribute value against the one specified
  - name: ldap-get-info
    arguments:
    - name: type
      required: true
      auto: PREDEFINED
      predefined:
      - NONE
      - DSA
      - SCHEMA
      - ALL
      - OFFLINE_EDIR_8_8_8
      - OFFLINE_EDIR_9_1_4
      - OFFLINE_AD_2012_R2
      - OFFLINE_SLAPD_2_4
      - OFFLINE_DS389_1_3_3
      defaultValue: ALL
    outputs:
    - contextPath: LDAP.Server.Schema
    - contextPath: LDAP.Server.Info
    description: Retrieves information about the LDAP server
  dockerimage: demisto/ldap:1.0.0.75
  runonce: false
  subtype: python3
