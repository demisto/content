commonfields:
  id: AWS - CloudWatchLogs
  version: -1
name: AWS - CloudWatchLogs
display: AWS - CloudWatchLogs
category: IT Services
image: data:image/png;base64,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
description: Amazon Web Services CloudWatch Logs (logs).
configuration:
- display: Default Region
  name: defaultRegion
  defaultvalue: ""
  type: 0
  required: true
- display: Role Arn
  name: roleArn
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Name
  name: roleSessionName
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Duration
  name: sessionDuration
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |-
    import boto3
    import datetime

    AWS_DEFAULT_REGION = demisto.params()['defaultRegion']
    AWS_roleArn = demisto.params()['roleArn']
    AWS_roleSessionName = demisto.params()['roleSessionName']
    AWS_roleSessionDuration = demisto.params()['sessionDuration']
    AWS_rolePolicy = None

    def aws_session(service='logs',region=None,roleArn=None,roleSessionName=None,roleSessionDuration=None,rolePolicy=None):
        kwargs = {}
        if roleArn and roleSessionName is not None:
            kwargs.update({
                'RoleArn':roleArn,
                'RoleSessionName':roleSessionName,
                })
        elif AWS_roleArn and AWS_roleSessionName is not None:
            kwargs.update({
                'RoleArn':AWS_roleArn,
                'RoleSessionName':AWS_roleSessionName,
                })

        if roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(roleSessionDuration)})
        elif AWS_roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(AWS_roleSessionDuration)})

        if rolePolicy is not None:
            kwargs.update({'Policy':rolePolicy})
        elif AWS_rolePolicy is not None:
            kwargs.update({'Policy':AWS_rolePolicy})

        if kwargs:
            sts_client = boto3.client('sts')
            sts_response = sts_client.assume_role(**kwargs)
            if region is not None:
                client = boto3.client(
                    service_name=service,
                    region_name=region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
            else:
                client = boto3.client(
                    service_name=service,
                    region_name=AWS_DEFAULT_REGION,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
        else:
            if region is not None:
                client = boto3.client(service_name=service,region_name=region)
            else:
                client = boto3.client(service_name=service,region_name=AWS_DEFAULT_REGION)

        return client

    class DatetimeEncoder(json.JSONEncoder):
      def default(self, obj):
        if isinstance (obj, datetime.datetime):
            return obj.strftime ('%Y-%m-%dT%H:%M:%S')
        elif isinstance (obj, datetime.date):
            return obj.strftime ('%Y-%m-%d')
        elif isinstance(obj, datetime):
            return obj.strftime('%Y-%m-%dT%H:%M:%S')
        elif isinstance(obj, date):
            return obj.strftime('%Y-%m-%d')
        # Let the base class default method raise the TypeError
        return json.JSONEncoder.default(self, obj)

    def parse_resource_ids(resource_id):
        id_list = resource_id.replace(" ", "")
        resourceIds = id_list.split(",")
        return resourceIds


    def create_entry(title,data, ec):
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': data,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, data) if data else 'No result were found',
            'EntryContext': ec
        }

    def raise_error(error):
        return {
            'Type' : entryTypes['error'],
            'ContentsFormat' : formats['text'],
            'Contents' : str(error)
        }


    def create_log_group(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'logGroupName':args.get('logGroupName')}

            if args.get('kmsKeyId') is not None:
                kwargs.update({'kmsKeyId':args.get('kmsKeyId')})

            response = client.create_log_group(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Log Group was created successfully"

        except Exception as e:
            return raise_error(e)

    def create_log_stream(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'logGroupName':args.get('logGroupName'),
                'logStreamName':args.get('logStreamName')
            }
            response = client.create_log_stream(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Log Stream was created successfully"

        except Exception as e:
            return raise_error(e)

    def delete_log_stream(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'logGroupName':args.get('logGroupName'),
                'logStreamName':args.get('logStreamName')
            }
            response = client.delete_log_stream(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Log Stream was Deleted successfully"

        except Exception as e:
            return raise_error(e)

    def delete_log_group(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {'logGroupName':args.get('logGroupName')}
            response = client.delete_log_group(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Log Group was Deleted successfully"

        except Exception as e:
            return raise_error(e)

    def filter_log_events(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            data =[]
            kwargs = {'logGroupName':args.get('logGroupName')}

            if args.get('logStreamNames') is not None:
                kwargs.update({'logStreamNames':parse_resource_ids(args.get('logStreamNames'))})
            if args.get('startTime') is not None:
                kwargs.update({'startTime':int(args.get('startTime'))})
            if args.get('endTime') is not None:
                kwargs.update({'endTime':int(args.get('endTime'))})
            if args.get('filterPattern') is not None:
                kwargs.update({'filterPattern':args.get('filterPattern')})
            if args.get('limit') is not None:
                kwargs.update({'limit':int(args.get('limit'))})
            if args.get('interleaved') is not None:
                kwargs.update({'interleaved':True if args.get('interleaved') == 'True'  else False})

            response = client.filter_log_events(**kwargs)
            for event in response['events']:
                data.append({
                    'LogStreamName': event['logStreamName'],
                    'Timestamp': event['timestamp'],
                    'Message': event['message'],
                    'IngestionTime': event['ingestionTime'],
                    'EventId': event['eventId']
                })

            ec = {"AWS.CloudWatchLogs.Events(val.eventId === obj.eventId)": data}
            return  create_entry('AWS CloudWatch Logs Events', data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_log_groups(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data=[]
            kwargs = {}
            if args.get('logGroupNamePrefix') is not None:
                kwargs.update({'logGroupNamePrefix':args.get('logGroupNamePrefix')})
            if args.get('limit') is not None:
                kwargs.update({'limit':int(args.get('limit'))})

            response = client.describe_log_groups(**kwargs)
            for i, logGroup in enumerate(response['logGroups']):
                data.append({
                    'LogGroupName': logGroup['logGroupName'],
                    'CreationTime': logGroup['creationTime'],
                    'Arn': logGroup['arn'],
                })
                if 'retentionInDays' in logGroup: data[i].update({'RetentionInDays': logGroup['retentionInDays']})
                if 'metricFilterCount' in logGroup: data[i].update({'MetricFilterCount': logGroup['metricFilterCount']})
                if 'storedBytes' in logGroup: data[i].update({'StoredBytes': logGroup['storedBytes']})
                if 'kmsKeyId' in logGroup: data[i].update({'KmsKeyId': logGroup['kmsKeyId']})

            ec = {"AWS.CloudWatchLogs.LogGroups(val.LogGroupName === obj.LogGroupName)": data}
            return  create_entry('AWS CloudWatch Log Groups', data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_log_streams(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data=[]
            kwargs = {'logGroupName':args.get('logGroupName')}
            if args.get('logStreamNamePrefix') is not None:
                kwargs.update({'logStreamNamePrefix':args.get('logStreamNamePrefix')})
            if args.get('limit') is not None:
                kwargs.update({'limit':int(args.get('limit'))})
            if args.get('orderBy') is not None:
                kwargs.update({'orderBy':args.get('orderBy')})

            response = client.describe_log_streams(**kwargs)
            for i, logStream in enumerate(response['logStreams']):
                data.append({
                    'LogGroupName': args.get('logGroupName'),
                    'LogStreamName': logStream['creationTime'],
                    'CreationTime': logStream['creationTime'],
                    'Arn': logStream['arn'],
                })
                if 'firstEventTimestamp' in logStream: data[i].update({'FirstEventTimestamp': logStream['firstEventTimestamp']})
                if 'lastEventTimestamp' in logStream: data[i].update({'LastEventTimestamp': logStream['lastEventTimestamp']})
                if 'storedBytes' in logStream: data[i].update({'StoredBytes': logStream['storedBytes']})
                if 'lastIngestionTime' in logStream: data[i].update({'LastIngestionTime': logStream['lastIngestionTime']})
                if 'uploadSequenceToken' in logStream: data[i].update({'UploadSequenceToken': logStream['uploadSequenceToken']})

            ec = {"AWS.CloudWatchLogs.LogGroups(val.LogGroupName === obj.LogGroupName).LogStreams": data}
            return  create_entry('AWS CloudWatch Log Streams', data, ec)

        except Exception as e:
            return raise_error(e)

    def put_retention_policy(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'logGroupName':args.get('logGroupName'),
                'retentionInDays':int(args.get('retentionInDays')),
            }
            response = client.put_retention_policy(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Log Group Retention Policy was added successfully"

        except Exception as e:
            return raise_error(e)


    def delete_retention_policy(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_retention_policy(logGroupName=args.get('logGroupName'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Log Group Retention Policy was Deleted successfully"

        except Exception as e:
            return raise_error(e)

    def put_log_events(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'logGroupName':args.get('logGroupName'),
                'logStreamName':args.get('logStreamName'),
                'logEvents':[{
                    'timestamp':int(args.get('timestamp')),
                    'message':args.get('message'),
                }]
            }
            if args.get('sequenceToken') is not None:
                kwargs.update({'sequenceToken':args.get('sequenceToken')})

            response = client.put_log_events(**kwargs)
            data = ({'NextSequenceToken': response['nextSequenceToken']})

            ec = {"AWS.CloudWatchLogs.PutLogEvents": data}
            return  create_entry('AWS CloudWatch Log Put Log Events', data, ec)

        except Exception as e:
            return raise_error(e)

    def put_metric_filter(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'logGroupName':args.get('logGroupName'),
                'filterName':args.get('filterName'),
                'filterPattern':args.get('filterPattern'),
                'metricTransformations':[{
                    'metricName':args.get('metricName'),
                    'metricNamespace':args.get('metricNamespace'),
                    'metricValue':args.get('metricValue'),
                }]
            }
            response = client.put_metric_filter(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Metric Filter was added successfully"

        except Exception as e:
            return raise_error(e)

    def delete_metric_filter(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                'logGroupName':args.get('logGroupName'),
                'filterName':args.get('filterName'),
            }

            response = client.delete_metric_filter(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Metric Filter was Deleted successfully"

        except Exception as e:
            return raise_error(e)


    def describe_metric_filters(args):
        try:
            client = aws_session(
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {}
            if args.get('logGroupName') is not None:
                kwargs.update({'logGroupName':args.get('logGroupName')})
            if args.get('filterNamePrefix') is not None:
                kwargs.update({'filterNamePrefix':args.get('filterNamePrefix')})
            if args.get('metricName') is not None:
                kwargs.update({'metricName':args.get('metricName')})
            if args.get('metricNamespace') is not None:
                kwargs.update({'metricNamespace':args.get('metricNamespace')})

            response = client.describe_metric_filters(**kwargs)
            for metric in response['metricFilters']:
                data.append({
                    'FilterName': metric['filterName'],
                    'FilterPattern': metric['filterPattern'],
                    'CreationTime': metric['creationTime'],
                    'LogGroupName': metric['logGroupName']
                })

            raw = json.loads(json.dumps(response['metricFilters'], cls=DatetimeEncoder))
            ec = {"AWS.CloudWatchLogs.MetricFilters(val.FilterName === obj.FilterName)": raw}
            return  create_entry('AWS CloudWatch Metric Filters', data, ec)

        except Exception as e:
            return raise_error(e)

    def test_function():
        try:
            client = aws_session()
            response = client.describe_log_groups()
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return 'ok'

        except Exception as error:
            return error

    if demisto.command() == 'test-module':
        # This is the call made when pressing the integration test button.
        result = test_function()

    if demisto.command() == 'aws-logs-create-log-group':
        result = create_log_group(demisto.args())

    if demisto.command() == 'aws-logs-create-log-stream':
        result = create_log_stream(demisto.args())

    if demisto.command() == 'aws-logs-delete-log-group':
        result = delete_log_group(demisto.args())

    if demisto.command() == 'aws-logs-delete-log-stream':
        result = delete_log_stream(demisto.args())

    if demisto.command() == 'aws-logs-filter-log-events':
        result = filter_log_events(demisto.args())

    if demisto.command() == 'aws-logs-describe-log-groups':
        result = describe_log_groups(demisto.args())

    if demisto.command() == 'aws-logs-describe-log-streams':
        result = describe_log_streams(demisto.args())

    if demisto.command() == 'aws-logs-put-retention-policy':
        result = put_retention_policy(demisto.args())

    if demisto.command() == 'aws-logs-delete-retention-policy':
        result = delete_retention_policy(demisto.args())

    if demisto.command() == 'aws-logs-put-log-events':
        result = put_log_events(demisto.args())

    if demisto.command() == 'aws-logs-put-metric-filter':
        result = put_metric_filter(demisto.args())

    if demisto.command() == 'aws-logs-delete-metric-filter':
        result = delete_metric_filter(demisto.args())

    if demisto.command() == 'aws-logs-describe-metric-filters':
        result = describe_metric_filters(demisto.args())

    demisto.results(result)
    sys.exit(0)
  type: python
  commands:
  - name: aws-logs-create-log-group
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: kmsKeyId
      description: The Amazon Resource Name (ARN) of the CMK to use when encrypting
        log data.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Creates a log group with the specified name.
    execution: true
  - name: aws-logs-create-log-stream
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: logStreamName
      required: true
      description: The name of the log stream.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Creates a log stream for the specified log group.
    execution: true
  - name: aws-logs-delete-log-group
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified log group and permanently deletes all the archived
      log events associated with the log group.
    execution: true
  - name: aws-logs-delete-log-stream
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: logStreamName
      required: true
      description: The name of the log stream.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified log stream and permanently deletes all the
      archived log events associated with the log stream.
    execution: true
  - name: aws-logs-filter-log-events
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: logStreamNames
      description: Optional list of log stream names. Separated by comma.
    - name: startTime
      description: The start of the time range, expressed as the number of milliseconds
        after Jan 1, 1970 00:00:00 UTC (Unix Time). Events with a time stamp before
        this time are not returned.
    - name: endTime
      description: The end of the time range, expressed as the number of milliseconds
        after Jan 1, 1970 00:00:00 UTC (Unix Time). Events with a time stamp later
        than this time are not returned.
    - name: filterPattern
      description: The filter pattern to use. If not provided, all the events are
        matched.
    - name: limit
      description: The maximum number of events to return. The default is 10,000 events.
    - name: interleaved
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: If the value is true, the operation makes a best effort to provide
        responses that contain events from multiple log streams within the log group,
        interleaved in a single response. If the value is false, all the matched log
        events in the first log stream are searched first, then those in the next
        log stream, and so on. The default is false.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudWatchLogs.Events.LogStreamName
      description: The name of the log stream this event belongs to.
      type: string
    - contextPath: AWS.CloudWatchLogs.Events.Timestamp
      description: The time the event occurred, expressed as the number of milliseconds
        after Jan 1, 1970 00:00:00 UTC.
      type: date
    - contextPath: AWS.CloudWatchLogs.Events.Message
      description: The data contained in the log event.
      type: string
    - contextPath: AWS.CloudWatchLogs.Events.IngestionTime
      description: The time the event was ingested, expressed as the number of milliseconds
        after Jan 1, 1970 00:00:00 UTC.
      type: date
    - contextPath: AWS.CloudWatchLogs.Events.EventId
      description: The ID of the event.
      type: string
    description: Lists log events from the specified log group. You can list all the
      log events or filter the results using a filter pattern, a time range, and the
      name of the log stream.
  - name: aws-logs-describe-log-groups
    arguments:
    - name: logGroupNamePrefix
      description: The prefix to match.
    - name: limit
      description: The maximum number of items returned. If you don't specify a value,
        the default is up to 50 items.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogGroupName
      description: The name of the log group.
      type: string
    - contextPath: AWS.CloudWatchLogs.LogGroups.CreationTime
      description: The creation time of the log group, expressed as the number of
        milliseconds after Jan 1, 1970 00:00:00 UTC.
      type: number
    - contextPath: AWS.CloudWatchLogs.LogGroups.RetentionInDays
      description: The number of days to retain the log events in the specified log
        group.
      type: number
    - contextPath: AWS.CloudWatchLogs.LogGroups.MetricFilterCount
      description: The number of metric filters.
      type: number
    - contextPath: AWS.CloudWatchLogs.LogGroups.Arn
      description: The Amazon Resource Name (ARN) of the log group.
      type: string
    - contextPath: AWS.CloudWatchLogs.LogGroups.StoredBytes
      description: The number of bytes stored.
      type: number
    - contextPath: AWS.CloudWatchLogs.LogGroups.KmsKeyId
      description: The Amazon Resource Name (ARN) of the CMK to use when encrypting
        log data.
      type: string
    description: Lists the specified log groups. You can list all your log groups
      or filter the results by prefix. The results are ASCII-sorted by log group name.
  - name: aws-logs-describe-log-streams
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: logStreamNamePrefix
      description: The prefix to match. If orderBy is LastEventTime ,you cannot specify
        this parameter.
    - name: orderBy
      auto: PREDEFINED
      predefined:
      - LogStreamName
      - LastEventTime
      description: If the value is LogStreamName , the results are ordered by log
        stream name. If the value is LastEventTime , the results are ordered by the
        event time. The default value is LogStreamName .If you order the results by
        event time, you cannot specify the logStreamNamePrefix parameter.
    - name: limit
      description: The maximum number of items returned. If you don't specify a value,
        the default is up to 50 items.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.LogGroupName
      description: The Name of the log group.
      type: string
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.LogStreamName
      description: The name of the log stream.
      type: string
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.CreationTime
      description: The creation time of the stream, expressed as the number of milliseconds
        after Jan 1, 1970 00:00:00 UTC.
      type: number
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.Arn
      description: The Amazon Resource Name (ARN) of the log stream.
      type: string
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.FirstEventTimestamp
      description: The time of the first event, expressed as the number of milliseconds
        after Jan 1, 1970 00:00:00 UTC.
      type: date
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.LastEventTimestamp
      description: the time of the most recent log event in the log stream in CloudWatch
        Logs. This number is expressed as the number of milliseconds after Jan 1,
        1970 00:00:00 UTC. lastEventTime updates on an eventual consistency basis.
        It typically updates in less than an hour from ingestion, but may take longer
        in some rare situations.
      type: date
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.LastIngestionTime
      description: The ingestion time, expressed as the number of milliseconds after
        Jan 1, 1970 00:00:00 UTC.
      type: date
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.UploadSequenceToken
      description: The sequence token.
      type: string
    - contextPath: AWS.CloudWatchLogs.LogGroups.LogStreams.StoredBytes
      description: The number of bytes stored.
      type: number
    description: Lists the log streams for the specified log group. You can list all
      the log streams or filter the results by prefix. You can also control how the
      results are ordered.
  - name: aws-logs-put-retention-policy
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: retentionInDays
      required: true
      auto: PREDEFINED
      predefined:
      - "1"
      - "3"
      - "5"
      - "7"
      - "14"
      - "30"
      - "60"
      - "90"
      - "120"
      - "150"
      - "180"
      - "365"
      - "400"
      - "545"
      - "731"
      - "1827"
      - "3653"
      description: The number of days to retain the log events in the specified log
        group.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Sets the retention of the specified log group. A retention policy
      allows you to configure the number of days for which to retain log events in
      the specified log group.
    execution: true
  - name: aws-logs-delete-retention-policy
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified retention policy.  Log events do not expire
      if they belong to log groups without a retention policy.
    execution: true
  - name: aws-logs-put-log-events
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: logStreamName
      required: true
      description: The name of the log stream.
    - name: timestamp
      required: true
      description: The time the event occurred, expressed as the number of milliseconds
        fter Jan 1, 1970 00:00:00 UTC. (Unix Time)
    - name: message
      required: true
      description: The raw event message.
    - name: sequenceToken
      description: The sequence token obtained from the response of the previous PutLogEvents
        call. An upload in a newly created log stream does not require a sequence
        token. You can also get the sequence token using DescribeLogStreams . If you
        call PutLogEvents twice within a narrow time period using the same value for
        sequenceToken , both calls may be successful, or one may be rejected.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudWatchLogs.PutLogEvents.NextSequenceToken
      description: The next sequence token.
      type: string
    description: Uploads a batch of log events to the specified log stream. You must
      include the sequence token obtained from the response of the previous call.
      An upload in a newly created log stream does not require a sequence token. You
      can also get the sequence token using DescribeLogStreams . If you call PutLogEvents
      twice within a narrow time period using the same value for sequenceToken , both
      calls may be successful, or one may be rejected.
    execution: true
  - name: aws-logs-put-metric-filter
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: filterName
      required: true
      description: A name for the metric filter.
    - name: filterPattern
      required: true
      description: A filter pattern for extracting metric data out of ingested log
        events.
    - name: metricName
      required: true
      description: The name of the CloudWatch metric.
    - name: metricNamespace
      required: true
      description: The namespace of the CloudWatch metric.
    - name: metricValue
      required: true
      description: The value to publish to the CloudWatch metric when a filter pattern
        matches a log event.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Creates or updates a metric filter and associates it with the specified
      log group. Metric filters allow you to configure rules to extract metric data
      from log events ingested through PutLogEvents .
    execution: true
  - name: aws-logs-delete-metric-filter
    arguments:
    - name: logGroupName
      required: true
      description: The name of the log group.
    - name: filterName
      required: true
      description: The name of the metric filter.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified metric filter.
    execution: true
  - name: aws-logs-describe-metric-filters
    arguments:
    - name: logGroupName
      description: The name of the log group.
    - name: filterNamePrefix
      description: The prefix to match.
    - name: metricName
      description: Filters results to include only those with the specified metric
        name. If you include this parameter in your request, you must also include
        the metricNamespace parameter.
    - name: metricNamespace
      description: Filters results to include only those in the specified namespace.
        If you include this parameter in your request, you must also include the metricName parameter.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.CloudWatchLogs.MetricFilters.filterName
      description: The name of the metric filter.
      type: string
    - contextPath: AWS.CloudWatchLogs.MetricFilters.filterPattern
      description: A symbolic description of how CloudWatch Logs should interpret
        the data in each log event. For example, a log event may contain time stamps,
        IP addresses, strings, and so on. You use the filter pattern to specify what
        to look for in the log event message.
      type: string
    - contextPath: AWS.CloudWatchLogs.MetricFilters.metricTransformations.metricName
      description: The name of the CloudWatch metric.
      type: string
    - contextPath: AWS.CloudWatchLogs.MetricFilters.metricTransformations.metricNamespace
      description: The namespace of the CloudWatch metric.
      type: string
    - contextPath: AWS.CloudWatchLogs.MetricFilters.metricTransformations.metricValue
      description: The value to publish to the CloudWatch metric when a filter pattern
        matches a log event.
      type: string
    - contextPath: AWS.CloudWatchLogs.MetricFilters.metricTransformations.defaultValue
      description: The value to emit when a filter pattern does not match a log event.
        This value can be null.
      type: string
    - contextPath: AWS.CloudWatchLogs.MetricFilters.creationTime
      description: The creation time of the metric filter, expressed as the number
        of milliseconds after Jan 1, 1970 00:00:00 UTC.
      type: date
    - contextPath: AWS.CloudWatchLogs.MetricFilters.logGroupName
      description: The name of the log group.
      type: string
    description: Lists the specified metric filters. You can list all the metric filters
      or filter the results by log name, prefix, metric name, or metric namespace.
  dockerimage: demisto/boto3
  runonce: false
releaseNotes: "-"
tests:
  - Forgive me for my sins but I did not create any test
