commonfields:
  id: VMware
  version: -1
name: VMware
display: VMware
category: IT Services
image: data:image/png;base64,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
description: VMware vCenter server is a centralized management application that lets you manage virtual machines and ESXi hosts centrally.
configuration:
- display: Server URL (i.e. https://192.168.0.1:30022)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: "true"
  type: 8
  required: false
- display: Use proxy system settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |-
    from pyVim.connect import SmartConnect, Disconnect
    from pyVim.task import WaitForTask
    from pyVmomi import vim
    from pyVmomi import vmodl
    import ssl
    import os
    import sys
    from datetime import datetime

    FULL_URL=demisto.params()['url'].split(':')
    URL=FULL_URL[0]
    USERNAME=demisto.params()['credentials']['identifier']
    PASSWORD=demisto.params()['credentials']['password']
    PORT=str(FULL_URL[1])

    def login():
        s = ssl.SSLContext(ssl.PROTOCOL_TLSv1)
        s.verify_mode = ssl.CERT_NONE
        try:
            si = SmartConnect(host=URL,
                              user=USERNAME,
                              pwd=PASSWORD,
                              port=V)
        except:
            si = SmartConnect(host=URL,
                              user=USERNAME,
                              pwd=PASSWORD,
                              port=PORT,
                              sslContext=s)
        return si

    def logout(si):
        Disconnect(si)

    def get_vm(uuid):
        vm = si.content.searchIndex.FindByUuid(None, uuid, True, True)
        if vm is None:
            raise SystemExit('Unable to locate Virtual Machine.')
        return vm

    def get_vms():
        data = []
        content = si.RetrieveContent()
        container = content.rootFolder
        viewType = [vim.VirtualMachine]
        recursive = True
        containerView = content.viewManager.CreateContainerView(container, viewType, recursive)
        children = containerView.view
        for child in children:
            summary = child.summary
            for dev in child.config.hardware.device:
                if isinstance(dev, vim.vm.device.VirtualEthernetCard):
                    macAddress = dev.macAddress
                    break
            data.append ({
                'Name': summary.config.name,
                'Template': summary.config.template,
                'Path': summary.config.vmPathName,
                'Guest': summary.config.guestFullName,
                'UUID': summary.config.instanceUuid,
                'IP': summary.guest.ipAddress if summary.guest.ipAddress else ' ',
                'State': summary.runtime.powerState,
                'HostName': summary.guest.hostName if summary.guest.hostName else ' ',
                'MACAddress': macAddress if macAddress else ' '
            })
        ec = {
            'VMWare(val.UUID && val.UUID === obj.UUID)': data
        }
        return create_entry(data, ec)

    def create_entry(data, ec):
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': data,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown('Virtual Machines', data) if data else 'No result were found',
            'EntryContext': ec
        }

    def power_on(uuid):
        vm = get_vm(uuid)

        if vm.runtime.powerState == 'poweredOn':
            raise SystemExit('Virtual Machine is already powered on.')
        task = vm.PowerOn()
        while task.info.state not in [vim.TaskInfo.State.success, vim.TaskInfo.State.error]:
            time.sleep(1)
        if task.info.state == 'success':
            ec = {
                'VMWare(val.UUID && val.UUID === obj.UUID)': {
                    'UUID': uuid,
                    'State': 'poweredOn'
                }
            }
            return {
                'ContentsFormat': formats['json'],
                'Type': entryTypes['note'],
                'Contents': ec,
                'ReadableContentsFormat': formats['text'],
                'HumanReadable': 'Virtual Machine was powered on successfully.',
                'EntryContext': ec
            }
        elif task.info.state == 'error':
            raise SystemExit('Error occured while trying to power on Virtual Machine.')

    def power_off(uuid):
        vm = get_vm(uuid)
        if vm.runtime.powerState == 'poweredOff':
            raise SystemExit('Virtual Machine is already powered off.')
        task = vm.PowerOff()
        while task.info.state not in [vim.TaskInfo.State.success, vim.TaskInfo.State.error]:
            time.sleep(1)
        if task.info.state == 'success':
            ec = {
                'VMWare(val.UUID && val.UUID === obj.UUID)': {
                    'UUID': uuid,
                    'State': 'poweredOff'
                }
            }
            return {
                'ContentsFormat': formats['json'],
                'Type': entryTypes['note'],
                'Contents': ec,
                'ReadableContentsFormat': formats['text'],
                'HumanReadable': 'Virtual Machine was powered off successfully.',
                'EntryContext': ec
            }
        elif task.info.state == 'error':
            raise SystemExit('Error occured while trying to power off Virtual Machine.')

    def suspend(uuid):
        vm = get_vm(uuid)
        if vm.runtime.powerState == 'suspended':
             raise SystemExit('Virtual Machine is already suspended.')
        task = vm.Suspend()
        while task.info.state not in [vim.TaskInfo.State.success, vim.TaskInfo.State.error]:
            time.sleep(1)
        if task.info.state == 'success':
            return 'Virtual Machine was suspended successfully.'
        elif task.info.state == 'error':
            raise SystemExit('Error occured while trying to power on Virtual Machine.')

    def hard_reboot(uuid):
        vm = get_vm(uuid)
        task = vm.ResetVM_Task()
        wait_for_tasks(si, [task])
        if task.info.state == 'success':
            return 'Virtual Machine was rebooted successfully.'
        elif task.info.state == 'error':
            raise SystemExit('Error occured while trying to reboot Virtual Machine.')

    def wait_for_tasks(si, tasks):
        propertyCollector = si.content.propertyCollector
        taskList = [str(task) for task in tasks]
        objSpecs = [vmodl.query.PropertyCollector.ObjectSpec(obj=task) for task in tasks]
        propertySpec = vmodl.query.PropertyCollector.PropertySpec(type=vim.Task, pathSet=[], all=True)
        filterSpec = vmodl.query.PropertyCollector.FilterSpec()
        filterSpec.objectSet = objSpecs
        filterSpec.propSet = [propertySpec]
        pcfilter = propertyCollector.CreateFilter(filterSpec, True)
        try:
            version, state = None, None
            while len(taskList):
                update = propertyCollector.WaitForUpdates(version)
                for filter_set in update.filterSet:
                    for obj_set in filter_set.objectSet:
                        task = obj_set.obj
                        for change in obj_set.changeSet:
                            if change.name == 'info':
                                state = change.val.state
                            elif change.name == 'info.state':
                                state = change.val
                            else:
                                continue
                            if not str(task) in taskList:
                                continue
                            if state == vim.TaskInfo.State.success:
                                taskList.remove(str(task))
                            elif state == vim.TaskInfo.State.error:
                                raise task.info.error
                version = update.version
        finally:
            if pcfilter:
                pcfilter.Destroy()

    def soft_reboot(uuid):
        vm = get_vm(uuid)
        vm.RebootGuest()
        return 'A request to reboot the guest has been sent.'

    def create_snapshot(args):
        uuid = args['vm-uuid']
        vm = get_vm(uuid)
        d = str(datetime.now())
        if args['memory'] == 'True':
            mem = True
        else:
            mem = False
        if args['quiesce'] == 'True':
            qui = True
        else:
            qui = False
        name = args.get('name', uuid + ' snapshot ' + d)
        desc = args.get('description', 'Snapshot of VM UUID ' + uuid + ' taken on ' + d)
        WaitForTask(vm.CreateSnapshot(name=name, description=desc, memory=mem, quiesce=qui))
        return 'Snapshot ' + name + ' completed.'

    def revert_snapshot(name, uuid):
        vm = get_vm(uuid)
        snapObj = get_snapshots(vm.snapshot.rootSnapshotList, name)
        if len(snapObj) == 1:
            snapObj = snapObj[0].snapshot
            WaitForTask(snapObj.RevertToSnapshot_Task())
            return 'Reverted to snapshot ' + name + ' successfully.'
        else:
            return 'No snapshots found with name: ' + name + ' on VM: ' + uuid

    def get_snapshots(snapshots, snapname):
        snapObj = []
        for snapshot in snapshots:
            if snapshot.name == snapname:
                snapObj.append(snapshot)
            else:
                snapObj = snapObj + get_snapshots(snapshot.childSnapshotList, snapname)
        return snapObj

    def get_events(uuid):
        vm = get_vm(uuid)
        hr = []
        content = si.RetrieveServiceContent()
        eventManager = content.eventManager
        filter = vim.event.EventFilterSpec.ByEntity(entity=vm, recursion="self")
        filterSpec = vim.event.EventFilterSpec()
        ids = ['VmGuestRebootEvent', 'VmGuestShutdownEvent', 'VmPoweredOnEvent', 'VmPoweredOffEvent', 'VmSuspendedEvent']
        filterSpec.eventTypeId = ids
        filterSpec.entity = filter
        eventRes = eventManager.QueryEvents(filterSpec)
        for e in eventRes:
            hr.append({
                'Event': e.fullFormattedMessage,
                'Created Time': e.createdTime.strftime("%Y-%m-%d %H:%M:%S")
            })
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': hr,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown('VM ' + vm.summary.config.name + ' Events', hr) if hr else 'No result were found'
        }

    from cStringIO import StringIO
    sout = sys.stdout
    sys.stdout = StringIO()

    si = login()

    if demisto.command() == 'test-module':
        login()
        result = 'ok'
    if demisto.command() == 'vmware-get-vms':
        result = get_vms()
    if demisto.command() == 'vmware-poweron':
        result = power_on(demisto.args()['vm-uuid'])
    if demisto.command() == 'vmware-poweroff':
        result = power_off(demisto.args()['vm-uuid'])
    if demisto.command() == 'vmware-hard-reboot':
        result = hard_reboot(demisto.args()['vm-uuid'])
    if demisto.command() == 'vmware-suspend':
        result = suspend(demisto.args()['vm-uuid'])
    if demisto.command() == 'vmware-soft-reboot':
        result = soft_reboot(demisto.args()['vm-uuid'])
    if demisto.command() == 'vmware-create-snapshot':
        result = create_snapshot(demisto.args())
    if demisto.command() == 'vmware-revert-snapshot':
        result = revert_snapshot(demisto.args()['snapshot-name'], demisto.args()['vm-uuid'])
    if demisto.command() == 'vmware-get-events':
        result = get_events(demisto.args()['vm-uuid'])

    logout(si)
    sys.stdout = sout
    demisto.results(result)
    sys.exit(0)
  type: python
  commands:
  - name: vmware-get-vms
    arguments: []
    outputs:
    - contextPath: VMWare.Name
      description: VM name
    - contextPath: VMWare.Template
      description: true if template, else false
    - contextPath: VMWare.Path
      description: Path to VM
    - contextPath: VMWare.Guest
      description: Guest full name
    - contextPath: VMWare.UUID
      description: VM instance UUID
    - contextPath: VMWare.IP
      description: VM IP address
    - contextPath: VMWare.State
      description: VM State (i.e. poweredOn, poweredOff, suspended)
    - contextPath: VMWare.HostName
      description: Host name of VM
    - contextPath: VMWare.MACAddress
      description: MAC Address of VM
    description: Returns all virtual machines on a system.
  - name: vmware-poweron
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to be powered on.
    outputs:
    - contextPath: VMWare.UUID
      description: VM instance UUID
    - contextPath: VMWare.State
      description: VM State (i.e. poweredOn, poweredOff, suspended)
    description: Powers on a powered-off or suspended virtual machine.
  - name: vmware-poweroff
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to be powered on.
    outputs:
    - contextPath: VMWare.UUID
      description: VM instance UUID
    - contextPath: VMWare.State
      description: VM State (i.e. poweredOn, poweredOff, suspended)
    description: Powers off a powered-on or suspended virtual machine.
  - name: vmware-hard-reboot
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to reboot.
    description: Reboots a powered-on virtual machine.
  - name: vmware-suspend
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to be suspended.
    description: Suspends a powered-on virtual machine.
  - name: vmware-soft-reboot
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to reboot.
    description: Issues a command to the guest operating system asking it to perform
      a reboot.
  - name: vmware-create-snapshot
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to take snapshot of.
    - name: name
      description: Snapshot name
    - name: description
      description: Snapshot description
    - name: memory
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Snapshot the virtual machine's memory
      defaultValue: "True"
    - name: quiesce
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Quiesce guest file system (needs VMWare Tools installed).
      defaultValue: "False"
    description: 'Creates VM snapshot'
  - name: vmware-revert-snapshot
    arguments:
    - name: snapshot-name
      required: true
      description: Snapshot name to revert to
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to revert snapshot.
    description: Reverts VM to snapshot
  - name: vmware-get-events
    arguments:
    - name: vm-uuid
      required: true
      description: VM UUID of virtual machine to get events of.
    description: Gets events of VM
  dockerimage: demisto/vmware:1.0-alpine
