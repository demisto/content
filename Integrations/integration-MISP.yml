commonfields:
  id: MISP
  version: -1
name: MISP
display: MISP
category: Threat Intelligence
image: data:image/png;base64,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
description: Malware Information Sharing Platform and Threat Sharing
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: API Key
  name: api_key
  defaultvalue: ""
  type: 4
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |+
    var entitiesDict = {
        event: [
                {to: 'ID', from: 'id'},
                {to: 'Date', from: 'date'},
                {to: 'ThreatLevelID', from: 'threat_level_id'},
                {to: 'info', from: 'info'},
                {to: 'Published', from: 'published'},
                {to: 'UUID', from: 'uuid'},
                {to: 'Analysis', from: 'analysis'},
                {to: 'Timestamp', from: 'timestamp'},
                {to: 'Distribution', from: 'distribution'},
                {to: 'ProposalEmailLock', from: 'proposal_email_lock'},
                {to: 'Locked', from: 'locked'},
                {to: 'PublishTimestamp', from: 'publish_timestamp'},
                {to: 'SharingGroupID', from: 'sharing_group_id'},
                {to: 'DisableCorrelation', from: 'disable_correlation'},
                {to: 'EventCreatorEmail', from: 'event_creator_email'},
                {to: 'Organisation.ID', from: 'Org.id'},
                {to: 'Organisation.Name', from: 'Org.name'},
                {to: 'Organisation.UUID', from: 'Org.uuid'},
                {to: 'OwnerOrganisation.ID', from: 'Orgc.id'},
                {to: 'OwnerOrganisation.Name', from: 'Orgc.name'},
                {to: 'OwnerOrganisation.UUID', from: 'Orgc.uuid'},
                {to: 'Attribute', from: 'Attribute'},
                {to: 'ShadowAttribute', from: 'ShadowAttribute'},
                {to: 'RelatedEvent', from: 'RelatedEvent'},
            ],
            attribute:
            [
                {to: 'ID', from: 'id'},
                {to: 'Type', from: 'type'},
                {to: 'Category', from: 'category'},
                {to: 'ToIDs', from: 'to_ids'},
                {to: 'UUID', from: 'uuid'},
                {to: 'EventID', from: 'event_id'},
                {to: 'Distribution', from: 'distribution'},
                {to: 'Timestamp', from: 'timestamp'},
                {to: 'Comment', from: 'comment'},
                {to: 'SharingGroupID', from: 'sharing_group_id'},
                {to: 'Deleted', from: 'deleted'},
                {to: 'DisableCorrelation', from: 'disable_correlation'},
                {to: 'Value', from: 'value'},
                {to: 'ShadowAttribute', from: 'ShadowAttribute'},
                ],
            shadowAttribute: [
                {to: 'ID', from: 'id'},
                {to: 'Type', from: 'type'},
                {to: 'Category', from: 'category'},
                {to: 'ToIDs', from: 'to_ids'},
                {to: 'UUID', from: 'uuid'},
                {to: 'EventUUID', from: 'event_uuid'},
                {to: 'EventID', from: 'event_id'},
                {to: 'OldID', from: 'old_id'},
                {to: 'Distribution', from: 'distribution'},
                {to: 'Timestamp', from: 'timestamp'},
                {to: 'Comment', from: 'comment'},
                {to: 'OrganisationID', from: 'org_id'},
                {to: 'SharingGroupID', from: 'sharing_group_id'},
                {to: 'ProposalToDelete', from: 'proposal_to_delete'},
                {to: 'DisableCorrelation', from: 'disable_correlation'},
                {to: 'Value', from: 'value'},
                {to: 'OwnerOrganisation.ID', from: 'Orgc.id'},
                {to: 'OwnerOrganisation.Name', from: 'Orgc.name'},
                {to: 'OwnerOrganisation.UUID', from: 'Orgc.uuid'},
                ],
            relatedEvent: [
                {to: 'ID', from: 'id'},
                ]
    };

    var commands = {
            'misp-download-sample': {
                url: '/attributes/downloadSample/',
                title: '',
                args: ['hash','allSamples','eventID', 'filename'],
                contextKey: '',
            },
            'internal-misp-upload-sample': {
                url: '/events/upload_sample/',
                title: 'MISP upload sample',
                args: ['distribution','to_ids','category','info','analysis','comment'],
                contextKey: '',
            },
            'internal-misp-download-sample': {
                url: '/attributes/downloadSample',
                title: '',
                args: ['hash','eventID','allSamples'],
                contextKey: '',
            },
            'misp-search': {
                url: '/events/restSearch/download/',
                title: 'Misp events search result:',
                args: ['value','type','category','org','tags','from','to','last','eventid','uuid'],
                ContentPath: 'response.Event',
                contextKey: 'MISP.Event(val.UUID==obj.UUID)',
            },
            'file': '',
            'url': '',
            'ip':''
    };

    function mapObjFunction(mapFields) {
                var transformSingleObj= function(obj) {
                    var res = {};
                    var fieldValue = '';
                    mapFields.forEach(function(f) {
                        fieldValue = dq(obj, f.from);
                        if (fieldValue){
                            var keys = f.to.split('.');
                            switch (keys.length){
                                case 1:
                                    res[keys[0]] = fieldValue;
                                    break;
                                case 2:
                                     if (!res[keys[0]]){
                                        res[keys[0]] = {};
                                    }
                                    res[keys[0]][keys[1]] = fieldValue;
                                    break;
                                default:
                                throw "context target field [" + f.to + "] must have 1-3 levels but have " + keys.length;
                            }
                        }
                    });
                    return res;
                };
                return function(obj) {
                    if (obj instanceof Array) {
                        var res = [];
                        for (var j=0; j < obj.length; j++) {
                            res.push(transformSingleObj(obj[j]));
                        }
                        return res;
                    }
                    return transformSingleObj(obj);
                };
            }


    function translateEvents(rawResponse, contextPath, title){
        var ec = {};
        if (rawResponse.response.length === 0) {
            return {
                Type: entryTypes.note,
                ContentsFormat: formats.json,
                Contents: rawResponse,
                ReadableContentsFormat: formats.markdown,
                HumanReadable: '## ' + title + '\n* No events found',
                EntryContext: ec
            };
        }

        var returnObject = mapObjFunction(entitiesDict.event)(dq(rawResponse,'response.Event'));
        if (Array.isArray(returnObject)) {
                events = returnObject;
            } else {
                events = [returnObject];
            }
            for (var i=0; i<events.length; i++) {
                if(events[i].Attribute.length > 0) {
                    events[i].Attribute = mapObjFunction(entitiesDict.attribute)(dq(events[i],'Attribute'));
                }
                if(events[i].ShadowAttribute.length > 0) {
                    events[i].ShadowAttribute = mapObjFunction(entitiesDict.shadowAttribute)(dq(events[i],'ShadowAttribute'));
                }
                if(events[i].RelatedEvent.length > 0) {
                    events[i].RelatedEvent = mapObjFunction(entitiesDict.relatedEvent)(dq(events[i],'RelatedEvent.Event'));
                }
            }
            if (contextPath) {
                ec[contextPath] = events;
            }
            return {
                Type: entryTypes.note,
                ContentsFormat: formats.json,
                Contents: rawResponse,
                ReadableContentsFormat: formats.markdown,
                HumanReadable: tableToMarkdown(title, returnObject),
                EntryContext: ec
            };
    }

    function getProvidedArgsForCommand(command, passedArgs) {
        var currentArgs = {};
        var allArgs = commands[command].args;
            for (var j = 0; j < allArgs.length; j++){
                if (passedArgs[allArgs[j]]){
                  currentArgs[allArgs[j]] = passedArgs[allArgs[j]];
                }
            }
        return currentArgs;
    }

    function getHashFormat(hash) {
        switch(hash.length){
            case 32:
                return 'md5';
            case 40:
                return 'sha1';
            case 64:
                return 'sha256';
            default:
                throw "invalid hash length, please enter file hash of format md5, sha1 or sha256";
        }
    }

    function getMISPThreatLevelStr(threat_level_id) {
        switch(threat_level_id){
            case '1':
                return 'HIGH';
            case '2':
                return 'MEDIUM';
            case '3':
                return 'LOW';
            case '4':
                return 'UNDEFINED';
            default:
                return 'Invalid MISP Threat Level with threat_level_id: ' + threat_level_id;
        }
    }


    function doJSONPost(requestUrl, body) {
        var res = http(
            requestUrl,
            {
                Method: 'POST',
                Headers: {
                    'Authorization': [params.api_key],
                    'Accept': ['application/json'],
                    'Content-Type': ['application/json']
                },
                Body: JSON.stringify(body)
            },
            params.insecure,
            params.useproxy
        );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Request Failed.\nStatus code: ' + res.StatusCode + '.\nBody: ' + JSON.stringify(res) + '.';
        }
        if (res.Headers && res.Headers['Content-Type'] == 'application/json; charset=UTF-8') {
            return JSON.parse(res.Body);
        }
        throw 'Response content type is not \"application/json; charset=UTF-8\" as expected.\n response: +' + JSON.stringify(res);
    }

    function doGeneralPost(command, passedArgs){
        var currentArgs = getProvidedArgsForCommand(command, passedArgs);
        var requestUrl = params.url + commands[command].url;
        var body = {'request': currentArgs };
        return doJSONPost(requestUrl, body);
    }

    function doFile(hash) {
            var hashFormat = getHashFormat(hash);
            var res = doGeneralPost('misp-search', {'value': hash});
            if (res.response.length === 0) {
                return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json,
                    HumanReadable: 'No events found in MISP for hash: ' + hash + '\n'};
            }
            var events = dq(res,'response.Event');
            var r = [];
            if (Array.isArray(events)) { // Got multiple hashes so need to nicely iterate
                r = events;
            } else {
                r = [events];
            }
            var md = '## MISP Reputation for File' + ': ' + hash + '\n';
            var ec = {};
            ec.DBotScore = [];
            ec[outputPaths.file] = [];
            for (var i=0; i<r.length; i++) {
                var mispOrganisation = 'MISP.' + r[i].Orgc.name;
                var dbotScore = 0;
                if (r[i].threat_level_id <= 3) {
                    dbotScore = 3;
                    var malFile = {};
                    var MaliciousFileObj = {};
                    MaliciousFileObj[hashFormat.toUpperCase()] = hash;
                    MaliciousFileObj.Malicious = {Vendor: mispOrganisation, Description: 'file hash found in MISP event with ID ' + r[i].id};
                    addMalicious(malFile, outputPaths.file, MaliciousFileObj);
                    ec[outputPaths.file].push(malFile[outputPaths.file]);
                    ec.DBotScore.push({Indicator: hash, Type: 'hash', Vendor: mispOrganisation , Score: dbotScore });
                }
                md += '* Found file hash in MISP event: ' +  r[i].id + ' with MISP Threat Level: '+ getMISPThreatLevelStr(r[i].threat_level_id), + 'from: '+  mispOrganisation + '\n';
                md += '\n';
            }
            return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec};
        }



    function doURL(url) {
            var res = doGeneralPost('misp-search', {'type': 'url', 'value': url});
            if (res.response.length === 0) {
                return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json,
                    HumanReadable: 'No events found in MISP for url: ' + url + '\n'};
            }
            var events = dq(res,'response.Event');
            var r = [];
            if (Array.isArray(events)) { // Got multiple hashes so need to nicely iterate
                r = events;
            } else {
                r = [events];
            }

            var md = '## MISP Reputation for URL' + ': ' + url + '\n';
            var ec = {};
            ec.DBotScore = [];
            for (var i=0; i<r.length; i++) {
                var dbotScore = 0;
                if (r[i].threat_level_id <= 3) {
                    dbotScore = 3;
                   var mispOrganisation = 'MISP.' + r[i].Orgc.name;
                    addMalicious(ec, outputPaths.url, {
                        Data: url,
                        Malicious: {Vendor: mispOrganisation, Description: 'URL Found in MISP event: ' + r[i].id}
                    });
                    ec.DBotScore.push({Indicator: url, Type: 'url', Vendor: mispOrganisation , Score: 3});
                }
                md += '* Found URL in MISP event: ' +  r[i].id + ' with MISP Threat Level: '+ getMISPThreatLevelStr(r[i].threat_level_id), + 'from: '+  mispOrganisation + '\n';
                md += '\n';
            }
            return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec}
        };

    function doIP(ip) {
            var res = doGeneralPost('misp-search', {'type': 'ip', 'value': ip});
            if (res.response.length === 0) {
                return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json,
                    HumanReadable: 'No events found in MISP for IP: ' + ip + '\n'};
            }
            var events = dq(res,'response.Event');
            var r = [];
            if (Array.isArray(events)) { // Got multiple hashes so need to nicely iterate
                r = events;
            } else {
                r = [events];
            }

            var md = '## MISP Reputation for IP' + ': ' + ip + '\n';
            var ec = {};
            ec.DBotScore = [];
            for (var i=0; i<r.length; i++) {
                var dbotScore = 0;
                if (r[i].threat_level_id <= 3) {
                    dbotScore = 3;
                   var mispOrganisation = 'MISP.' + r[i].Orgc.name;
                    addMalicious(ec, outputPaths.ip, {
                        Address: ip,
                        Malicious: {Vendor: mispOrganisation, Description: 'IP Found in MISP event: ' + r[i].id}
                    });
                    ec.DBotScore.push({Indicator: ip, Type: 'ip', Vendor: mispOrganisation , Score: 3});
                }
                md += '* Found IP in MISP event: ' +  r[i].id + ' with MISP Threat Level: '+ getMISPThreatLevelStr(r[i].threat_level_id), + 'from: '+  mispOrganisation + '\n';
                md += '\n';
            }
            return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec}
        };

    function doUploadSample(command) {
        var fileContent = args['fileContent'];
        var filename = args['filename'];
        if (!fileContent) {
            throw 'file \"'+ filename + '\" is empty or missing';
        }

        var currentArgs = getProvidedArgsForCommand(command, args)
        currentArgs['data'] =  fileContent;
        currentArgs['filename'] = filename;


        var requestUrl = params.url + commands[command].url;
        requestUrl = (args['event_id'])  ? requestUrl + args['event_id'] : requestUrl;

        var body = { 'request': { 'files': [currentArgs] } };
        var res = doJSONPost(requestUrl, body)
        return {
                Type: entryTypes.note,
                ContentsFormat: formats.json,
                Contents: res,
                ReadableContentsFormat: formats.markdown,
                HumanReadable: '## ' + commands[command].title + '\n* message: ' + res.message + '\n* event id: ' + res.id + '\n* file name: ' + filename,
                EntryContext: {}
            };
    }




    // The command input arg holds the command sent from the user.
    switch (command) {
        // This is the call made when pressing the integration test button.
        case 'test-module':
            doIP('1.3.4.5');
            return 'ok';
        case 'internal-misp-upload-sample':
            return doUploadSample(command);
        case 'internal-misp-download-sample':
            return doGeneralPost(command, args);
        case 'misp-search':
            return translateEvents(doGeneralPost(command, args), commands[command].contextKey, commands[command].title);
        case 'file':
            return doFile(args.file)
        case 'url':
            return doURL(args.url)
        case 'ip':
            return doIP(args.ip)
        default:
    }

  type: javascript
  commands:
  - name: internal-misp-upload-sample
    description: Internal function, do not use it directly
    arguments:
    - name: filename
      required: true
      description: File name
    - name: fileContent
      required: true
      description: File Content in Base64
    - name: event_id
      description: The Event's ID is optional. It can be either supplied via the URL
        or the POSTed object, but the URL has priority if both are provided. Not supplying
        an event ID will cause MISP to create a single new event for all of the POSTed
        malware samples. You can define the default settings for the event, otherwise
        a set of default settings will be used.
    - name: distribution
      description: The distribution setting used for the attributes and for the newly
        created event, if relevant. [0-3]
    - name: to_ids
      description: You can flag all attributes created during the transaction to be
        marked as "to_ids" or not.
    - name: category
      description: 'The category that will be assigned to the uploaded samples. Valid
        options are: Payload delivery, Artifacts dropped, Payload Installation, External
        Analysis.'
    - name: info
      description: Used to populate the event info field if no event ID supplied.
        Alternatively, if not set, MISP will simply generate a message showing that
        it's a malware sample collection generated on the given day.
    - name: analysis
      description: 'The analysis level of the newly created event, if applicable.
        [0-2] threat_level_id: The threat level ID of the newly created event, if
        applicatble. [0-3]'
    - name: comment
      description: This will populate the comment field of any attribute created using
        this API.
    execution: true
  - name: misp-search
    arguments:
    - name: type
      description: The attribute type, any valid MISP attribute type is accepted
    - name: value
      description: Search for the given value in the attributes' value field.
    - name: category
      description: The attribute category, any valid MISP attribute category is accepted.
    - name: org
      description: Search by the creator organisation by supplying the organisation
        identifier.
    - name: tags
      description: To include a tag in the results just write its names into this
        parameter. To exclude a tag prepend it with a '!'. You can also chain several
        tag commands together with the '&&' operator. Please be aware the colons (:)
        cannot be used in the tag search. Use semicolons instead (the search will
        automatically search for colons instead).
    - name: from
      description: 'Events with the date set to a date after the one specified in
        the from field (format: 2015-02-15). This filter will use the date of the
        event.'
    - name: to
      description: 'Events with the date set to a date before the one specified in
        the to field (format: 2015-02-15). This filter will use the date of the event.'
    - name: last
      description: Events published within the last x amount of time, where x can
        be defined in days, hours, minutes (for example 5d or 12h or 30m). This filter
        will use the published timestamp of the event.
    - name: eventid
      description: The events that should be included / excluded from the search.
    - name: uuid
      description: The returned events must include an attribute with the given UUID,
        or alternatively the event's UUID must match the value(s) passed.
    outputs:
    - contextPath: MISP.Event.ID
      description: Event ID
    - contextPath: MISP.Event.Date
      description: Date
    - contextPath: MISP.Event.ThreatLevelID
      description: Threat Level ID
    - contextPath: MISP.Event.info
      description: info
    - contextPath: MISP.Event.Published
      description: Published
    - contextPath: MISP.Event.UUID
      description: UUID
    - contextPath: MISP.Event.Analysis
      description: Analysis
    - contextPath: MISP.Event.Timestamp
      description: Timestamp
    - contextPath: MISP.Event.Distribution
      description: Distribution
    - contextPath: MISP.Event.ProposalEmailLock
      description: Proposal Email Lock
    - contextPath: MISP.Event.Locked
      description: Locked
    - contextPath: MISP.Event.PublishTimestamp
      description: Publish Timestamp
    - contextPath: MISP.Event.SharingGroupID
      description: Sharing Group ID
    - contextPath: MISP.Event.DisableCorrelation
      description: Disable Correlation
    - contextPath: MISP.Event.EventCreatorEmail
      description: Event Creator Email
    - contextPath: MISP.Event.Organisation.ID
      description: Organisation ID
    - contextPath: MISP.Event.Organisation.Name
      description: Organisation Name
    - contextPath: MISP.Event.Organisation.UUID
      description: Organisation UUID
    - contextPath: MISP.Event.OwnerOrganisation.ID
      description: Owner Organisation ID
    - contextPath: MISP.Event.OwnerOrganisation.Name
      description: Owner Organisation Name
    - contextPath: MISP.Event.OwnerOrganisation.UUID
      description: Owner Organisation UUID
    - contextPath: MISP.Event.Attribute
      description: Attribute
    - contextPath: MISP.Event.ShadowAttribute
      description: ShadowAttribute
    - contextPath: MISP.Event.RelatedEvent
      description: RelatedEvent
    description: Search for events in misp
  - name: file
    description: Check file in misp
    arguments:
    - name: file
      description: file
      required: true
    outputs:
    - contextPath: File.MD5
      description: Bad hash found
    - contextPath: File.SHA1
      description: Bad hash SHA1
    - contextPath: File.SHA256
      description: Bad hash SHA256
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
  - name: url
    arguments:
    - name: url
      description: Check URL in misp
      required: true
    outputs:
    - contextPath: URL.Data
      description: Bad URLs found
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    description: Check if IP is in MISP events
  - name: ip
    description: Check ip in misp
    arguments:
    - name: ip
      required: true
      description: Check if IP is in MISP events
    outputs:
    - contextPath: IP.Address
      description: Bad IP Address found
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
  - name: internal-misp-download-sample
    arguments:
    - name: hash
      required: true
      description: 'A hash in MD5 format. If allSamples is set, this can be any one
        of the following: md5, sha1, sha256.'
    - name: eventID
      description: If set, it will only fetch data from the given event ID.
    - name: allSamples
      auto: PREDEFINED
      predefined:
      - "1"
      - "0"
      description: If set, it will return all samples from events that have a match
        for the hash provided above.
    description: Download malware sample by hash
hidden: false
