commonfields:
  id: FalconHost
  version: -1
name: FalconHost
display: CrowdStrike Falcon Host
category: Endpoint
image: data:image/png;base64,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
description: Crowdstrike IOCs and detections API
detaileddescription: |-
  Please provide the API id and key for the CrowsStrike Falcon Host API.
  API Key Pairs can be requested by emailing support@crowdstrike.com.
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: url
  defaultvalue: https://falconapi.crowdstrike.com/
  type: 0
  required: true
- display: API ID
  name: id
  defaultvalue: ""
  type: 0
  required: true
- display: API Key
  name: key
  defaultvalue: ""
  type: 4
  required: true
- display: Use system proxy settings
  name: useproxy
  defaultvalue: "true"
  type: 8
  required: false
- display: Allow self-signed SSL certificates
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |
    var serverUrl = params.url;
    if (serverUrl[serverUrl.length - 1] !== '/') {
        serverUrl += '/';
    }

    var doReq = function(method, path, query, body) {
        var result = http(
            serverUrl + path + encodeToURLQuery(query),
            {
                Headers: {
                    'Content-Type': ['application/json'],
                    'Accept': ['application/json']
                },
                Username: params.id,
                Password: params.key,
                Method: method,
                Body: body ? JSON.stringify(body) : ''
            },
            params.insecure,
            params.useproxy
        );
        if (result.StatusCode < 200 || result.StatusCode > 299) {
            if (result.StatusCode === 404 && result.Body.indexOf('Resource Not Found') > -1) {
                    // Skip this error - it just means query returned no results. Handle as no results.
            } else {
                throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode + ', body: ' + result.Body;
            }
        }


        if (result.Body === '') {
            throw 'No content received.';
        } else
        {
            var obj;
            try {
                obj = JSON.parse(result.Body);
            } catch (ex) {
                throw 'Error parsing reply - ' + result.Body + ' - ' + ex;
            }

            if (obj.errors && obj.errors.length > 0) {
                if (dq(obj, 'errors.[0].code') === 404 && dq(obj, 'errors.[0].message').indexOf('Resource Not Found') > -1) {
                    // Skip this error - it just means query returned no results. Handle as no results.
                } else {
                    throw JSON.stringify(obj.errors);
                }
            }
            return {body: result.Body, obj: obj, statusCode: result.StatusCode};
        }
    };

    var dateToEpoch = function(d) {
        return d ? new Date(d).getTime() : null;
    };

    var uploadIOC = function() {
        args.expiration_days = parseInt(args.expiration_days)
        var res = doReq('POST', 'indicators/entities/iocs/v1', {}, [args]);
        return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: 'IOC [' + args.value + '] uploaded'};
    };

    var getIOC = function() {
        var res = doReq('GET', 'indicators/entities/iocs/v1', {ids: args.type + ':' + args.value});
        var md = '### Falcon Host custom IOC retrieval\n';
        if (res.obj.resources) {
            for (var i=0; i<res.obj.resources.length; i++) {
                md += objToList(res.obj.resources[i], res.obj.resources[i].value) + '\n';
            }
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md};
    };

    // add args to a if exists
    var add = function(a, k, f) {
        if (args[k]) {
            var parts = argToList(args[k]);
            for (var i=0; i<parts.length; i++) {
                parts[i] = parts[i].trim();
            }
            a[k] = f ? f(args[k]) : parts.length > 1 ? parts : parts[0];
        }
    };

    var updateIOC = function() {
        var a = {};
        add(a, 'policy');
        add(a, 'share_level');
        add(a, 'expiration_days');
        add(a, 'source');
        add(a, 'description');
        var res = doReq('PATCH', 'indicators/entities/iocs/v1', {ids: args.type + ':' + args.value}, a);
        return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: 'IOC [' + args.value + '] updated'};
    };

    var deleteIOC = function() {
        var a = {};
        var res = doReq('DELETE', 'indicators/entities/iocs/v1', {ids: args.type + ':' + args.value});
        return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: 'IOC [' + args.value + '] deleted'};
    };

    var searchIOCs = function() {
        var a = {};
        add(a, 'types');
        add(a, 'values');
        add(a, 'policies');
        add(a, 'share_levels');
        add(a, 'sources');
        add(a, 'sort');
        add(a, 'limit');
        add(a, 'offset');
        if (args.from_expiration_date) {
            a['from.expiration_timestamp'] = args.from_expiration_date + 'T00:00:00';
        }
        if (args.to_expiration_date) {
            a['to.expiration_timestamp'] = args.to_expiration_date + 'T23:59:59';
        }
        var res = doReq('GET', 'indicators/queries/iocs/v1', a);
        var md = '## Falcon Host IOC Search\n';
        if (res.obj.resources) {
            var fullRes = doReq('GET', 'indicators/entities/iocs/v1', {ids: res.obj.resources});
            if (fullRes.obj.resources) {
                for (var i=0; i<fullRes.obj.resources.length; i++) {
                    md += objToList(fullRes.obj.resources[i], fullRes.obj.resources[i].value) + '\n';
                }
                res.obj.resources = fullRes.obj.resources;
            } else {
                md += 'No result found';
            }
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md};
    };

    var deviceSearch = function() {
        var a = {};
        add(a, 'filter');
        add(a, 'limit');
        add(a, 'offset');
        if (args.query) {
            a.q = args.query;
        }
        var res = doReq('GET', 'devices/queries/devices/v1', a);
        var md = '## Falcon Host Device Search\n';
        var ec = {};
        if (res.obj.resources && res.obj.resources.length > 0) {
            ec.FalconHostDevices = res.obj.resources;
            md += '### Devices\n';
            for (var i=0; i<res.obj.resources.length; i++) {
                md += res.obj.resources[i] + '\n';
            }
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec};
    };

    var deviceDetails = function() {
        var ids = argToList(args.ids);
        var res = doReq('GET', 'devices/entities/devices/v1', {ids: ids});
        var md = '## Falcon Host Device Details\n';
        var found = false;
        if (res.obj.resources) {
            for (var i=0; i<res.obj.resources.length; i++) {
                var o = res.obj.resources[i];
                var cleanObj = {};
                var keys = Object.keys(o);
                for (var j=0; j<keys.length; j++) {
                    if (keys[j] !== 'policies' && keys[j] !== 'meta') {
                        cleanObj[keys[j]] = o[keys[j]];
                    }
                }
                md += objToList(cleanObj, o.hostname) + '\n';
                if (o.policies) {
                    md += '#### Policies\n';
                    md += arrToMd(o.policies) + '\n';
                }
                if (o.meta) {
                    md += objToList(o.meta, 'Meta') + '\n';
                }
                found = true;
            }
        }
        if (!found) {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md};
    };

    var deviceCountIOC = function() {
        var res = doReq('GET', 'indicators/aggregates/devices-count/v1', args);
        var md = '## Falcon Host IOC Device Count\n';
        if (res.obj.resources && res.obj.resources.length > 0) {
            md += arrToMd(res.obj.resources);
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md};
    };

    var deviceRanOn = function() {
        var res = doReq('GET', 'indicators/queries/devices/v1', args);
        var md = '## Falcon Host IOC Device Ran On\n';
        var ec = {};
        if (res.obj.resources && res.obj.resources.length > 0) {
            ec.FalconHostDevices = res.obj.resources;
            md += '### Devices\n';
            for (var i=0; i<res.obj.resources.length; i++) {
                md += res.obj.resources[i] + '\n';
            }
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec};
    };

    var processesRanOn = function() {
        var res = doReq('GET', 'indicators/queries/processes/v1', args);
        var md = '## Falcon Host IOC Processes Ran On Device\n';
        var ec = {};
        if (res.obj.resources && res.obj.resources.length > 0) {
            ec.FalconHostProcesses = res.obj.resources;
            md += '### Processes\n';
            for (var i=0; i<res.obj.resources.length; i++) {
                md += res.obj.resources[i] + '\n';
            }
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md, EntryContext: ec};
    };

    var processDetails = function() {
        var ids = argToList(args.ids);
        var res = doReq('GET', 'processes/entities/processes/v1', {ids: ids});
        var md = '## Falcon Host Process Details\n';
        if (res.obj.resources && res.obj.resources.length > 0) {
            md += arrToMd(res.obj.resources);
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md};
    };

    var resolveDetection = function() {
        var ids = argToList(args.ids);
        var res = doReq('PATCH', 'detects/entities/detects/v2', {}, {ids: ids, status: args.status});
        var md = '## Falcon Host Process Details\n';
        if (res.obj.resources && res.obj.resources.length > 0) {
            md += arrToMd(res.obj.resources);
        } else {
            md += 'No result found';
        }
        return {Type: entryTypes.note, Contents: res.obj, ContentsFormat: formats.json, HumanReadable: md};
    };

    switch (command) {
        case 'test-module':
            args = {filter: "platform_name:'Windows'"};
            deviceSearch();
            return true;
        case 'cs-upload-ioc':
            return uploadIOC();
        case 'cs-get-ioc':
            return getIOC();
        case 'cs-update-ioc':
            return updateIOC();
        case 'cs-delete-ioc':
            return deleteIOC();
        case 'cs-search-iocs':
            return searchIOCs();
        case 'cs-device-search':
            return deviceSearch();
        case 'cs-device-details':
            return deviceDetails();
        case 'cs-device-count-ioc':
            return deviceCountIOC();
        case 'cs-device-ran-on':
            return deviceRanOn();
        case 'cs-processes-ran-on':
            return processesRanOn();
        case 'cs-process-details':
            return processDetails();
        case 'cs-resolve-detection':
            return resolveDetection();
        default:
            throw 'Unknown command - ' + command;
    }
  type: javascript
  commands:
  - name: cs-upload-ioc
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      description: The type of the indicator
    - name: value
      required: true
      deprecated: false
      description: The string representation of the indicator
    - name: policy
      deprecated: false
      auto: PREDEFINED
      predefined:
      - detect
      - none
      description: The policy that should be enacted when the value is detected on
        a host. none is equivalent to turning the indicator off.
      defaultValue: detect
    - name: share_level
      deprecated: false
      auto: PREDEFINED
      predefined:
      - red
      description: This represents the level the indicator will be shared. Currently
        only red share level (not shared) is supported, indicating that the IOC isn't
        shared with other FH customers.
    - name: expiration_days
      deprecated: false
      description: This represents the days the indicator should be valid for. This
        only applies to domain, ipv4, and ipv6 types. Default os 30 if not provided.
    - name: source
      deprecated: false
      description: The source where this indicator originated. This can be used for
        tracking where this indicator was defined. Limit 200 characters.
    - name: description
      deprecated: false
      description: The friendly description of the indicator. Limit 200 characters.
    description: Allows you to upload one or more indicators that you want CrowdStrike
      to watch
    execution: true
  - name: cs-get-ioc
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      description: The IOC type to retrieve
    - name: value
      required: true
      deprecated: false
      description: The IOC value to retrieve
    description: Get the full definition of one or more indicators that you are watching
  - name: cs-update-ioc
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      description: The IOC type to update
    - name: value
      required: true
      deprecated: false
      description: The IOC value to update
    - name: policy
      deprecated: false
      auto: PREDEFINED
      predefined:
      - detect
      - none
      description: The policy that should be enacted when the value is detected on
        a host
      defaultValue: detect
    - name: share_level
      deprecated: false
      auto: PREDEFINED
      predefined:
      - red
      description: This represents the level the indicator will be shared. Currently,
        the only share level supported is "red" (not shared), indicating that the
        IOC isn't shared with other FH customers.
    - name: expiration_days
      deprecated: false
      description: This represents the days the indicator should be valid for. This
        only applies to domain, ipv4, and ipv6 types. Default is 30.
    - name: source
      deprecated: false
      description: The source where this indicator originated. This can be used for
        tracking where this indicator was defined. Limit 200 characters.
    - name: description
      deprecated: false
      description: The friendly description of the indicator. Limit 200 characters.
    description: Updates one or more indicators that you have uploaded
    execution: true
  - name: cs-delete-ioc
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      description: The IOC type to delete
    - name: value
      deprecated: false
      description: The IOC value to delete
    description: Allows you to delete an indicator that you are watching
    execution: true
  - name: cs-search-iocs
    deprecated: false
    arguments:
    - name: types
      deprecated: false
      description: A list of indicator types. Separate multiple types by comma. Valid
        types are sha256, sha1, md5, domain, ipv4, ipv6.
      isArray: true
    - name: values
      deprecated: false
      description: A list of indicator values separated by comma
      isArray: true
    - name: policies
      deprecated: false
      description: A list of indicator policies separated by comma
      isArray: true
    - name: share_levels
      deprecated: false
      description: A list of share levels. At this time, only red is supported.
      isArray: true
    - name: sources
      deprecated: false
      description: A list of IOC sources separated by comma
      isArray: true
    - name: from_expiration_date
      deprecated: false
      description: starting date range to search in YYYY-MM-DD format
    - name: to_expiration_date
      deprecated: false
      description: ending date range to search in YYYY-MM-DD format
    - name: sort
      deprecated: false
      auto: PREDEFINED
      predefined:
      - type.asc
      - type.desc
      - value.asc
      - value.desc
      - policy.asc
      - policy.desc
      - share_level.asc
      - share_level.desc
      - expiration_timestamp.asc
      - expiration_timestamp.desc
      description: The order of the results. Format is field.asc or field.desc.
    - name: limit
      deprecated: false
      description: The maximum number of records to return. The minimum is 1 and the
        maximum is 500. Default is 100.
    - name: offset
      deprecated: false
      description: The offset to begin the list from. i.e. start from the 10th records
        and return the list. Default is 0.
    description: Returns a list of your uploaded IOCs that match the search criteria
  - name: cs-device-search
    deprecated: false
    arguments:
    - name: query
      deprecated: false
      default: true
      description: search for a value across all fields
    - name: filter
      deprecated: false
      description: Filter devices using query syntax of "field:value+field:value"
        where string values are enclosed in single quotes or as arrays in single quotes
        (['x', 'y']). Numerical fields and dates also support operators like field:>value.
        Please see list of relevant fields in the CrowdStrike documentation.
    - name: limit
      deprecated: false
      description: Number of results to return
    - name: offset
      deprecated: false
      description: Starting from which result
    outputs:
    - contextPath: FalconHostDevices
      description: Device IDs found by device search
    description: Search for devices in your environment by platform, host name, IP,
      or a number of other parameters
  - name: cs-device-details
    deprecated: false
    arguments:
    - name: ids
      required: true
      deprecated: false
      default: true
      description: The ID to retrieve details. Supports multiple IDs separated by
        comma.
    description: Get details on one or more devices, given a device ID
  - name: cs-device-count-ioc
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      description: The type of indicator
    - name: value
      required: true
      deprecated: false
      default: true
      description: The actual string representation of your indicator
    description: Returns the number of devices on which an IOC ran, given a type and
      value of an IOC
  - name: cs-device-ran-on
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      description: The type of indicator from the list of supported indicator types.
    - name: value
      required: true
      deprecated: false
      description: The actual string representation of your indicator
    outputs:
    - contextPath: FalconHostDevices
      description: Device IDs found by device IOC search
    description: Returns a list of device IDs on which an indicator ran
  - name: cs-processes-ran-on
    deprecated: false
    arguments:
    - name: type
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      description: The type of indicator from the list of supported indicator types.
    - name: value
      required: true
      deprecated: false
      description: The actual string representation of your indicator
    - name: device_id
      required: true
      deprecated: false
      description: The device ID you want to specifically check against
    outputs:
    - contextPath: FalconHostProcesses
      description: List of processes of the searched indicators
    description: Returns the process ID of the indicator if it ran on given device
      recently
  - name: cs-process-details
    deprecated: false
    arguments:
    - name: ids
      required: true
      deprecated: false
      default: true
      description: The ID of the process. Allows multiple values separated by comma.
    description: Retrieves the details of a process that is running or that previously
      ran, given a process ID.
  - name: cs-resolve-detection
    deprecated: false
    arguments:
    - name: ids
      required: true
      deprecated: false
      default: true
      description: 'The IDs of the detections you wish to resolve. Note that with
        the launch of v2 of this api, CrowdStrike detection ids are in the following
        format:  ldt:[first field]:[second field] e.g. ldt:cf54bb61f92e4d3e75bf4f7c11fc8f74:4295536142.'
    - name: status
      required: true
      deprecated: false
      auto: PREDEFINED
      predefined:
      - new
      - in_progress
      - true_positive
      - false_positive
      - ignored
      description: The status to which you want to transition a detection
    description: Dets the state of a detection in Falcon Host. You can obtain detection
      IDs from the Falcon Host UI or from the Falcon Streaming API.
    execution: true
hidden: false
fromversion: 2.5.0
