commonfields:
  id: Tenable IO
  version: -1
name: Tenable IO
display: Tenable IO
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAMAAACgee/qAAABBVBMVEUAAABFVWVIV2ZEVWZIV2hJW2lFVWVFVWVKXGpOXnMAqLYAp7ZEVGQAp7UAqLYAqLZsdIAAp7ZEVWUAp7UAp7UAqLUAp7VFVWUAp7UAqLUAqLZEVGQAqLZFVWUAqLYAqLdEVGUAp7UAp7UAp7VEVWQAp7YAussAp7UAp7UAp7UAqLZFVmZHV2YAr7xQZHNEVWRFVWRFVWVFV2YAqbYAt8FEVGVEVWVFVWZGVmUAqrhIWGlMWmxFVGVEVWVFVWVFVWRGVWYAqLZHV2YAqrYArbtFVGUAqbVFWGlHV2lFVWREVWUAp7QAp7VGV2ZEVWVGVmVFVmYArLdEVWREVmUAq7dEVWVEVGQidPTWAAAAVnRSTlMAjCF7JhjRmRUMdmD0h2pSBIv8k4+voZ+Yb0/qZGRKRLy1qZyWgwXFgH5ZRjMQCPm1h008CfB1XEIoHxDj24+CbkE5LhewNyob5sK8pC+rVFEgpqEz5PhyY/gAAAQ1SURBVFjD7ZTZctowFEAva8DGNsZL7GDM4pp9h7AECBAC2ZukTfX/n1ItcQwkM51Op+lDOQ/oXkvWsdCV4MCBAwcO/D4be9yHf4BQbUiKXukV4XMRpJ7r3JXypVJBHMPnIQj31lJdFkWh52qybpzAH/AFIRTz0yBOA/Axap6/dK2GxHFiybpU+L5ZBcZjIBCI/zWxWlqZjpzXtILCibrSs8pFAxhHZJK/JZbvqiVBtmyxAStx495XZc7S/0B89EvxpHZFvIWCmS1nTVZTtsVrDa4krD6apNnccyST4NPcEzffi5Ns20adIfZWS32zzGXhlSKv3vdPShydoj3Fb+Xa30hydXyDUPpbncSZdrsdiQVmqVZ0QN1nnWgLJWbnZ564vk6gxNfwtvj6fIZQYl3D0WMNXIlTQTGK4HOpCS/3GolmiJHGcSiFGHOcBHCbOWX5Gi+k43Wmukw8YA8SQ188TCDGd/qpOiiVfn73+HC8IZaKu+I5eiNDxT4juPCTRJiIfeqeeMg+DJGMihvlii3vinmzXL1b4mAxj+Jx5/MB1HE7fZrER/hBesLEt4vRgKw6BNBGucxDcDgjo5k4t6iFSOftqziC13uaiTXrOYRaZAfKWb4i23tiUZUc4e1oRHC7xsOvABNLI9Sh4nO62Tg4xvufAcIVMVLxnKRhLEMXTNzBv11aX/jTv+K2J9sVY/NerOjb4iae4jZOOUYoSsVBOjcTw+RxMHxIQpp0HtF3MNQ2YGKsu4lTBng/kriINUmoZPfEriipcsMX0/l9Wr44wsQDWjg3j1MiZu8QuuSPYeIU2oYUf0EsjK09cWEjqXZvS/yAdojviTNe4aR2VkyL7oiKm2gHciZN3TjhdsViYVWV+9aW+Bo3s9AbzT1xGv8u4qRwtsWskjtsxaS2/Amucef4riyVK9ve4j23cu2s5InJqCnemIk/ZFd8hki9EG488RlNyYcMqZiGV7BDXgNJE5/BI1t2N6t8VgFP3H01teO0nBYfir8D4YcnjgbJtULq4ZqJM+RhhL4SAoaR54q8Y/N9mo3NpWg+awrzQohcH19z+BSR4HzRyaXQaF+cTGPBE0DsGHlilIq2bxBVUjE9RShxtJivWygDlGrVkE9454XHG90Qs5J1knfzCjBGiBKBi1PkEQX4qLhO01vFNUWMH5NXMQTZIzoyzq5mYWlmVZOzTNWVhYLrOOO8AR7fEWL/djiHKKl18J0Y5i16XWamnvjhFhHaMf+ujn1LIcrtBTB0WAp9scCPObnS2yi9Z80Bn/CoO2KlEruodWsPExqGw+EkvYdwEKF9T916E4Lh8BlEaGew9lQLe0NiQJjU8QT1mF9NellSpYahNPDq+UbFMeCzeLac/J3BFRzdFCoS2V+bW8En8cJpmmpfwtKgFcfZ8Hn0s4Kuq0Vacb0iHDhw4MCB/5yfYHowcdS9KS4AAAAASUVORK5CYII=
description: A comprehensive asset centric solution to accurately track resources
  while accommodating dynamic assets such as cloud, mobile devices, containers and
  web applications.
configuration:
- display: Access Key
  name: access_key
  defaultvalue: ""
  type: 4
  required: true
- display: Secret Key
  name: secret_key
  defaultvalue: ""
  type: 4
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |-
    import os
    from tenable_io.client imrpot TenableIOClient
    from tenable_io.helpers.scan imrpot ScanRef, ScanInfo
    from tenable_io.api.models import ScanDetails, ScanHistory

    client = TenablieIOClient(access_key=demisto.getArg('access_key'), secret_key=demisto.getArg('secret_key'))

    if not demisto.params()['proxy']:
        del os.environ['HTTP_PROXY']
        del os.environ['HTTPS_PROXY']
        del os.environ['http_proxy']
        del os.environ['https_proxy']

    def tenable_object_to_dict(obj):
        res_dict = None

        if isinstance(obj, ScanRef):
            res_dict = tenable_object_to_dict(obj.details())
            res_dict['Id'] = obj.id
            return res_dict

        if isinstance(obj, ScanDetails):
            res_dict = tennable_object_to_dict(obj.info())
            return res_dict

        if isinstance(obj, ScanInfo):
            res_dict = {
                'Status': obj.status,
                'Uuid': obj.uuid,
                'Name': obj.name,
                'Type': obj.scan_type,
                'UserPermissions': obj.user_permissions,
                'ScanStart': obj.scan_start,

            }
            return res_dict


    def get_entry_for_object(title, context_key, obj, headers=None):
        if len(obj) == 0:
            return "There is no output results"
        obj = filter_dict_null(obj)
        if isinstance(obj, list):
            obj = map(filter_dict_null, obj)
        if headers and isinstance(obj, dict):
            headers = list(set(headers).intersection(set(obj.keys())))

        return {
            'Type': entryTypes['note'],
            'Contents': obj,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, obj, headers),
            ENTRY_CONTEXT: {
                context_key: obj
            }
        }

    if demisto.command() == 'test-module':
        get_scans()
        demisto.results('ok')
        sys.exit(0)
    # You can use demisto.args()[argName] to get a specific arg. args are strings.
    # You can use demisto.params()[paramName] to get a specific params.
    # Params are of the type given in the integration page creation.
  type: python
  commands:
  - name: tenable-get-scans
    arguments:
    - name: folder-id
      description: 'The ID of the folder whose scans should be listed. Scans are stored
        in specific folders on Tenable. e.g : folderId = 8'
    - name: last-modified-date
      description: 'Limit the results to those that have only changed since this time.
        Time in the following format -  MM/DD/YYYY. e.g : lastModifiedDate = 08/12/2018'
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique id of the scan.
      type: number
    - contextPath: Tenable.Scan.Uuid
      description: The uuid for the scan.
      type: string
    - contextPath: Tenable.Scan.Name
      description: The name of the scan.
      type: string
    - contextPath: Tenable.Scan.Type
      description: The type of scan (local, remote, or agent).
      type: string
    - contextPath: Tenable.Scan.Owner
      description: The owner of the scan.
      type: string
    - contextPath: Tenable.Scan.Enabled
      description: If true, the schedule for the scan is enabled.
      type: boolean
    - contextPath: Tenable.Scan.Status
      description: The status of the scan (completed, aborted, imported, pending,
        running, resuming, canceling, cancelled, pausing, paused, stopping, stopped).
      type: string
    - contextPath: Tenable.Scan.UserPermissions
      description: The sharing permissions for the scan.
      type: number
    - contextPath: Tenable.Scan.CreationDate
      description: The creation date for the scan in Unix time.
      type: date
    - contextPath: Tenable.Scan.LastModificationDate
      description: The last modification date for the scan in Unix time.
      type: date
    - contextPath: Tenable.Scan.StartTime
      description: The scheduled start time for the scan.
      type: string
    - contextPath: Tenable.Scan.Scanner
      description: The scanner assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Policy
      description: The policy assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Target
      description: The targets to be scanned.
      type: string
    - contextPath: Tenable.Scan.FolderId
      description: The unique id of the folder where the scan has been stored.
      type: number
    description: Retrive scans from the Tenable platform.
  - name: tenable-launch-scan
    arguments:
    - name: scanId
      required: true
      default: true
      description: The id of the scan to launch.
    - name: scanTargets
      description: If specified, these targets will be scanned instead of the default.
        Value can be an array where each index is a target, or an array with a single
        index of comma separated targets.
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique id of the scan.
      type: number
    - contextPath: Tenable.Scan.Targets
      description: The targets to be scanned.
      type: string
    description: Lauch a scan with existing or custom targets. (You can specify custom
      targets in the arguements of this command.)
  - name: tenable-get-scan-report
    arguments:
    - name: scan-id
      required: true
      default: true
      description: The uuid of the scan to retrieve. While scan uuid is preferred,
        scan id is supported.
    - name: detailed
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: If detailed is true, the report will contain remediations and hosts
        information as well for the given scan. Otherwise the report will only have
        vulnerabilities.
      defaultValue: "no"
    - name: info
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: To return the basic details of the given scan.
      defaultValue: "no"
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique id of the scan.
      type: number
    - contextPath: Tenable.Scan.Uuid
      description: The uuid for the scan.
      type: number
    - contextPath: Tenable.Scan.Name
      description: The name of the scan.
      type: string
    - contextPath: Tenable.Scan.Status
      description: The status of the scan (completed, aborted, imported, pending,
        running, resuming, canceling, cancelled, pausing, paused, stopping, stopped).
      type: string
    - contextPath: Tenable.Scan.StartTime
      description: The scheduled start time for the scan.
      type: string
    - contextPath: Tenable.Scan.EndTime
      description: The scan end time for the scan.
      type: string
    - contextPath: Tenable.Scan.Scanner
      description: The scanner assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Policy
      description: The policy assigned for the scan.
      type: string
    - contextPath: Tenable.Scan.Targets
      description: The targets to be scanned.
      type: string
    - contextPath: Tenable.Scan.FolderId
      description: The unique id of the folder where the scan has been stored.
      type: string
    - contextPath: Vulnerabilities.Id
      description: The unique ID of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Description
      description: The description of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.FirstSeen
      description: When the vulnerability was first seen.
      type: date
    - contextPath: Vulnerabilities.LastSeen
      description: When the vulnerability was last seen.
      type: date
    - contextPath: Vulnerabilities.Solution
      description: Information on how to fix the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Synopsis
      description: A brief summary of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Count
      description: A count of the vulnerability occurrences.
      type: number
    - contextPath: Vulnerabilities.Severity
      description: The severity level of the vulnerability.
      type: number
    - contextPath: Vulnerabilities.RiskInfo.RiskFactor
      description: String containing CVSS and risk factor information.
      type: string
    - contextPath: Assets.AssetId
      description: The unique id of the host.
      type: number
    - contextPath: Assets.Hostname
      description: The name of the host.
      type: string
    - contextPath: Assets.Score
      description: The overall score for the host.
      type: number
    - contextPath: Assets.Severitycount
      description: The number of different findings organized by severity level.
      type: number
    - contextPath: Assets.CriticalLevelFindings
      description: The percentage of critical findings on the host.
      type: number
    - contextPath: Assets.HighLevelFindings
      description: Retrieving data. Wait a few seconds and try to cut or copy again.
      type: number
    - contextPath: Assets.MediumLevelFindings
      description: The percentage of medium findings on the host.
      type: number
    - contextPath: Assets.LowLevelFindings
      description: The percentage of low findings on the host.
      type: number
    - contextPath: Remediations.Id
      description: The unique id of the remediation.
      type: string
    - contextPath: Remediations.RemediationDescription
      description: Specific information related to the vulnerability and steps to
        remedy.
      type: string
    - contextPath: Remediations.NumOfHostsAffected
      description: The number of hosts affected.
      type: number
    - contextPath: Remediations.NumOfVulnerabilitiesAssociated
      description: The number of vulnerabilities associated with the remedy.
      type: number
    description: Retrive scan-report for the given scan.
  - name: tenable-get-vulnerability-details
    arguments:
    - name: vulnerability-id
      required: true
      default: true
      description: The unique ID of the vulnerability.
    - name: date-range
      description: The number of days of data prior to and including today that should
        be returned.
    outputs:
    - contextPath: Vulnerabilities.Description
      description: The description of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.FirstSeen
      description: When the vulnerability was first seen.
      type: date
    - contextPath: Vulnerabilities.LastSeen
      description: When the vulnerability was last seen.
      type: date
    - contextPath: Vulnerabilities.Solution
      description: Information on how to fix the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Synopsis
      description: A brief summary of the vulnerability.
      type: string
    - contextPath: Vulnerabilities.Count
      description: A count of the vulnerability occurrences.
      type: number
    - contextPath: Vulnerabilities.Severity
      description: The severity level of the vulnerability.
      type: number
    - contextPath: Vulnerabilities.Family
      type: string
    - contextPath: Vulnerabilities.ModificationDate
      type: date
    - contextPath: Vulnerabilities.Name
      type: string
    - contextPath: Vulnerabilities.Type
      type: string
    - contextPath: Vulnerabilities.Severity
      type: string
    - contextPath: Vulnerabilities.PublicationDate
      type: date
    - contextPath: Vulnerabilities.RiskInfo.RiskFactor
      type: string
    - contextPath: Vulnerabilities.RiskInfo.CvssVector
      type: string
    - contextPath: Vulnerabilities.RiskInfo.CvssBaseScore
      type: string
    - contextPath: Vulnerabilities.RiskInfo.Cvss3Vector
      type: string
    - contextPath: Vulnerabilities.RiskInfo.Cvss3BaseScore
      type: string
  - name: tenable-get-vulnerabilities-by-asset
    arguments:
    - name: asset-id
      required: true
      default: true
      description: The unique ID of the Asset.
    - name: date-range
      description: The number of days of data prior to and including today that should
        be returned.
    outputs:
    - contextPath: Vulnerabilities.Count
      description: The number of times the vulnerability was found.
      type: number
    - contextPath: Vulnerabilities.Family
      description: The vulnerability's family.
      type: string
    - contextPath: Vulnerabilities.Id
      description: The unique vulnerability's ID.
      type: number
    - contextPath: Vulnerabilities.Name
      description: The name of the vulnerability's.
      type: string
    - contextPath: Vulnerabilities.VulnerabilityState
      description: The current state of the reported vulnerability (Active, Fixed,
        New, etc.)
      type: string
    - contextPath: Vulnerabilities.Severity
      description: Integer [0-4] indicating how severe the vulnerability is, where
        0 is info only.
      type: number
    description: Get a list of up to 5000 of the vulnerabilities recorded for a given
      asset. By default, this list is sorted by vulnerability count, descending.
  - name: tenable-request-scan-status
    arguments:
    - name: scan-id
      description: The unique ID of the Scan.
    outputs:
    - contextPath: Tenable.Scan.Id
      description: The unique ID of the scan specified.
      type: string
    - contextPath: Tenable.Scan.Status
      description: The status of the scan specified.
      type: string
    description: 'Check the status of a specific scan using its ID. The status can
      hold following possible values : Running, Completed and Empty (Ready to run).'
  - name: tenable-get-scan-editor-templates
    arguments: []
    outputs:
    - contextPath: Tenable.ScanEditorTemplate.Unsupported
      description: If true, template is not supported.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.CloudOnly
      description: If true, template is only available on the cloud.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Description
      description: The description of the template.
      type: string
    - contextPath: Tenable.ScanEditorTemplate.SubscriptionOnly
      description: If true, the template is only available for subscribers.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.WebScanningBoolean
      description: If true, the template is for Web Application Scanning.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Title
      description: The long name of the template.
      type: string
    - contextPath: Tenable.ScanEditorTemplate.IsForAgents
      description: If true, the template is for agent scans.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Uuid
      description: The uuid for the template.
      type: string
    - contextPath: Tenable.ScanEditorTemplate.ManagerOnly
      description: If true, can only be used by manager.
      type: boolean
    - contextPath: Tenable.ScanEditorTemplate.Name
      description: The short name of the template.
      type: string
    description: Get the list of available scanning editor templates to create new
      scans.
  - name: tenable-create-scan
    arguments:
    - name: uuid
      required: true
      default: true
      description: The uuid for the editor template to use.
    - name: name
      required: true
      description: The name of the scan.
    - name: enabled
      required: true
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: If true, the schedule for the scan is enabled.
      defaultValue: "yes"
    - name: text-targets
      required: true
      description: The list of targets to scan.
    - name: start-time
      description: The starting time and date for the scan (i.e. YYYYMMDDTHHMMSS).
    - name: timezone
      description: The timezone for the scan schedule.
    - name: scan-rule-frequency
      description: The frequency (scanRuleFrequency=onetime or daily or weekly or
        monthly or yearly) Expects a string comprised of three values. If you specify
        scanRuleFrequency you need to specify scanRuleTimeInterval and scanRuleDaysToRun
        as well. To create a scan that runs every three weeks on Monday Wednesday
        and Friday the string would be scanRuleFrequency=weekly;scanRuleTimeInterval=3;scanRuleDaysToRun=mo,we,fr
    - name: scan-rule-time-interval
      description: The time interval for which you want to run the scan (timeInterval=1
        or 2 or 3 ... x), Expects a string comprised of three values. If you specify
        timeInterval you need to specify scanFrequency and daysToRun as well. To create
        a scan that runs every three weeks on Monday Wednesday and Friday the string
        would be scanFrequency=weekly;timeInterval=3;daysToRun=mo,we,fr. 
    - name: scan-rule-days-to-run
      description: The days of the week on which you want to run the scan. (scanRuleDaysToRun=su,mo,tu,we,th,fr,sa)
        Please write down first two letter of the word. Expects a string comprised
        of three values. If you specify scanRuleDaysToRun you need to specify scanRuleFrequency
        and scanRuleTimeInterval as well. To create a scan that runs every three weeks
        on Monday Wednesday and Friday the string would be scanRuleFrequency=weekly;scanRuleTimeInterval=3;scanRuleDaysToRun=mo,we,fr. 
    - name: email-accounts
      description: A comma separated list of accounts who will recieve the email summary
        report.
    - name: description
      description: The description of the scan.
    - name: scanner-id
      description: The unique id of the scanner to use.
    outputs:
    - contextPath: Tenable.Scan.CreationDate
      description: The creation date of the scan.
      type: date
    - contextPath: Tenable.Scan.Targets
      description: The targets specified for the scan.
      type: string
    - contextPath: Tenable.Scan.DefaultPermissions
      description: The default permissions assigned to the scan.
      type: number
    - contextPath: Tenable.Scan.Id
      description: The unique ID of the scan.
      type: number
    - contextPath: Tenable.Scan.Name
      description: The name of the scan.
      type: string
    - contextPath: Tenable.Scan.Owner
      description: The owner of the scan.
      type: string
    description: Create a scan on the Tenable platform.
  dockerimage: demisto/tenable_io
