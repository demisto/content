commonfields:
  id: AWS - EC2
  version: -1
name: AWS - EC2
display: AWS - EC2
category: IT Services
image: data:image/png;base64,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
description: Amazon Web Services Elastic Compute Cloud (EC2)
configuration:
- display: AWS Default Region
  name: defaultRegion
  defaultvalue: ""
  type: 0
  required: false
- display: Role Arn
  name: roleArn
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Name
  name: roleSessionName
  defaultvalue: ""
  type: 0
  required: false
- display: Role Session Duration
  name: sessionDuration
  defaultvalue: ""
  type: 0
  required: false
script:
  script: |+
    import boto3
    import json
    import re
    import datetime

    AWS_DEFAULT_REGION = demisto.params()['defaultRegion']
    AWS_roleArn = demisto.params()['roleArn']
    AWS_roleSessionName = demisto.params()['roleSessionName']
    AWS_roleSessionDuration = demisto.params()['sessionDuration']
    AWS_rolePolicy = None

    def aws_session(service='ec2',region=None,roleArn=None,roleSessionName=None,roleSessionDuration=None,rolePolicy=None):
        kwargs = {}
        if roleArn and roleSessionName is not None:
            kwargs.update({
                'RoleArn':roleArn,
                'RoleSessionName':roleSessionName,
                })
        elif AWS_roleArn and AWS_roleSessionName is not None:
            kwargs.update({
                'RoleArn':AWS_roleArn,
                'RoleSessionName':AWS_roleSessionName,
                })

        if roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(roleSessionDuration)})
        elif AWS_roleSessionDuration is not None:
            kwargs.update({'DurationSeconds':int(AWS_roleSessionDuration)})

        if rolePolicy is not None:
            kwargs.update({'Policy':rolePolicy})
        elif AWS_rolePolicy is not None:
            kwargs.update({'Policy':AWS_rolePolicy})

        if kwargs:
            sts_client = boto3.client('sts')
            sts_response = sts_client.assume_role(**kwargs)
            if region is not None:
                client = boto3.client(
                    service_name=service,
                    region_name=region,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
            else:
                client = boto3.client(
                    service_name=service,
                    region_name=AWS_DEFAULT_REGION,
                    aws_access_key_id=sts_response['Credentials']['AccessKeyId'],
                    aws_secret_access_key=sts_response['Credentials']['SecretAccessKey'],
                    aws_session_token=sts_response['Credentials']['SessionToken']
                    )
        else:
            if region is not None:
                client = boto3.client(service_name=service,region_name=region)
            else:
                client = boto3.client(service_name=service,region_name=AWS_DEFAULT_REGION)

        return client

    def parse_filter_field(filter_str):
        filters = []
        regex = re.compile(r'name=([\w\d_:.-]+),values=([ /\w\d_,.\*-]+)', flags=re.I)
        for f in filter_str.split(';'):
            match = regex.match(f)
            if match is None:
                demisto.log('could not parse filter: %s' % (f, ))
                continue

            filters.append({
                'Name' : match.group(1),
                'Values' : match.group(2).split(',')
                })

        return filters

    def parse_tag_field(tags_str):
        tags = []
        regex = re.compile(r'key=([\w\d_:.-]+),value=([/\w\d_,.\*-]+)', flags=re.I)
        for f in tags_str.split(';'):
            match = regex.match(f)
            if match is None:
                demisto.log('could not parse field: %s' % (f, ))
                continue

            tags.append({
                'Key' : match.group(1),
                'Value' : match.group(2)
                })

        return tags

    class DatetimeEncoder(json.JSONEncoder):
      def default(self, obj):
        if isinstance (obj, datetime.datetime):
            return obj.strftime ('%Y-%m-%dT%H:%M:%S')
        elif isinstance (obj, datetime.date):
            return obj.strftime ('%Y-%m-%d')
        elif isinstance(obj, datetime):
            return obj.strftime('%Y-%m-%dT%H:%M:%S')
        elif isinstance(obj, date):
            return obj.strftime('%Y-%m-%d')
        # Let the base class default method raise the TypeError
        return json.JSONEncoder.default(self, obj)

    def parse_resource_ids(resource_id):
        id_list = resource_id.replace(" ", "")
        resourceIds = id_list.split(",")
        return resourceIds

    def create_entry(title,data, ec):
        return {
            'ContentsFormat': formats['json'],
            'Type': entryTypes['note'],
            'Contents': data,
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(title, data) if data else 'No result were found',
            'EntryContext': ec
        }

    def raise_error(error):
        return {
            'Type' : entryTypes['error'],
            'ContentsFormat' : formats['text'],
            'Contents' : str(error)
        }

    def describe_regions(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            data = []
            kwargs = {}
            if args.get('regionNames') is not None:
                kwargs.update({'RegionNames':parse_resource_ids(args.get('regionNames'))})

            response = client.describe_regions(**kwargs)
            for region in response['Regions']:
                data.append ({
                    'Endpoint': region['Endpoint'],
                    'RegionName': region['RegionName']
                    })

            ec = {'AWS.Regions(val.RegionName === obj.RegionName)': data}
            return  create_entry('AWS Regions',data, ec)

        except Exception as e:
            return raise_error(e)


    def describe_instances(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            data=[]
            kwargs = {}
            output = []
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('instanceIds') is not None:
                kwargs.update({'InstanceIds':parse_resource_ids(args.get('instanceIds'))})

            response = client.describe_instances(**kwargs)
            for i, reservation in enumerate(response['Reservations']):
                for instance in reservation['Instances']:
                    data.append ({
                        'InstanceId': instance['InstanceId'],
                        'ImageId': instance['ImageId'],
                        'State': instance['State']['Name'],
                        'PublicIPAddress': instance.get('PublicIpAddress'),
                        'Region': obj['_user_provided_options']['region_name'],
                        'Type': instance['InstanceType'],
                        'LaunchDate': datetime.datetime.strftime(instance['LaunchTime'], '%Y-%m-%dT%H:%M:%SZ'),
                        'PublicDNSName': instance['PublicDnsName'],
                        'KeyName': instance['KeyName'],
                        'Monitoring': instance['Monitoring']['State'],
                    })
                    if 'Tags' in instance:
                        for tag in instance['Tags']:
                            data[i].update ({
                              tag['Key']: tag['Value']
                            })
                instance.update({'Region': obj['_user_provided_options']['region_name']})
                output.append(instance)

            raw = json.loads(json.dumps(output, cls=DatetimeEncoder))
            ec = {'AWS.EC2.Instances(val.InstanceId === obj.InstanceId)': raw}
            return  create_entry('AWS Instances',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_images(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('imageIds') is not None:
                kwargs.update({'ImageIds':parse_resource_ids(args.get('imageIds'))})
            if args.get('owners') is not None:
                kwargs.update({'Owners':parse_resource_ids(args.get('owners'))})
            if args.get('executableUsers') is not None:
                kwargs.update({'ExecutableUsers':parse_resource_ids(args.get('executableUsers'))})

            response = client.describe_images(**kwargs)
            for i, image in enumerate(response['Images']):
                data.append({
                    'CreationDate': image['CreationDate'],
                    'ImageId': image['ImageId'],
                    'Public': image['Public'],
                    'Name': image['Name'],
                    'State': image['State'],
                    'Region': obj['_user_provided_options']['region_name'],
                })
                if 'Description' in image: data[i].update({'Description': image['Description']})
                if 'EnaSupport' in image: data[i].update({'EnaSupport': image['EnaSupport']})
                if 'Tags' in image:
                    for tag in image['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['Images'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Images(val.ImageId === obj.ImageId)': raw}
            return  create_entry('AWS EC2 Images',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_addresses(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('publicIps') is not None:
                kwargs.update({'PublicIps':parse_resource_ids(args.get('publicIps'))})
            if args.get('allocationIds') is not None:
                kwargs.update({'AllocationIds':parse_resource_ids(args.get('allocationIds'))})

            response = client.describe_addresses(**kwargs)

            for i, address in enumerate(response['Addresses']):
                data.append({
                    'PublicIp': address['PublicIp'],
                    'AllocationId': address['AllocationId'],
                    'Domain': address['Domain'],
                    'Region': obj['_user_provided_options']['region_name'],
                })
                if 'InstanceId' in address: data[i].update({'InstanceId': address['InstanceId']})
                if 'AssociationId' in address: data[i].update({'AssociationId': address['AssociationId']})
                if 'NetworkInterfaceId' in address: data[i].update({'NetworkInterfaceId': address['NetworkInterfaceId']})
                if 'PrivateIpAddress' in address: data[i].update({'PrivateIpAddress': address['PrivateIpAddress']})
                if 'Tags' in address:
                    for tag in address['Tags']:
                       data[i].update ({
                           tag['Key']: tag['Value']
                       })

            raw = response['Addresses']
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.ElasticIPs(val.AllocationId === obj.AllocationId)': raw}
            return  create_entry('AWS EC2 ElasticIPs',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_snapshots(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('ownerIds') is not None:
                kwargs.update({'OwnerIds':parse_resource_ids(args.get('ownerIds'))})
            if args.get('snapshotIds') is not None:
                kwargs.update({'SnapshotIds':parse_resource_ids(args.get('snapshotIds'))})
            if args.get('restorableByUserIds') is not None:
                kwargs.update({'RestorableByUserIds':parse_resource_ids(args.get('restorableByUserIds'))})

            response = client.describe_snapshots(**kwargs)

            for i, snapshot in enumerate(response['Snapshots']):
                data.append({
                    'Description': snapshot['Description'],
                    'Encrypted': snapshot['Encrypted'],
                    'OwnerId': snapshot['OwnerId'],
                    'Progress': snapshot['Progress'],
                    'SnapshotId': snapshot['SnapshotId'],
                    'StartTime': datetime.datetime.strftime(snapshot['StartTime'], '%Y-%m-%dT%H:%M:%SZ'),
                    'State': snapshot['State'],
                    'VolumeId': snapshot['VolumeId'],
                    'VolumeSize': snapshot['VolumeSize'],
                    'Region': obj['_user_provided_options']['region_name'],
                })
                if 'Tags' in snapshot:
                    for tag in snapshot['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['Snapshots'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Snapshots(val.SnapshotId === obj.SnapshotId)': raw}
            return  create_entry('AWS EC2 Snapshots',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_volumes(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('volumeIds') is not None:
                kwargs.update({'VolumeIds':parse_resource_ids(args.get('volumeIds'))})

            response = client.describe_volumes(**kwargs)

            for i, volume in enumerate(response['Volumes']):
                data.append({
                    'AvailabilityZone': volume['AvailabilityZone'],
                    'Encrypted': volume['Encrypted'],
                    'State': volume['State'],
                    'VolumeId': volume['VolumeId'],
                    'VolumeType': volume['VolumeType'],
                    'CreateTime': datetime.datetime.strftime(volume['CreateTime'], '%Y-%m-%dT%H:%M:%SZ'),
                })
                if 'Tags' in volume:
                    for tag in volume['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['Volumes'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Volumes(val.VolumeId === obj.VolumeId)': raw}
            return  create_entry('AWS EC2 Volumes',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_launch_templates(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('launchTemplateIds') is not None:
                kwargs.update({'LaunchTemplateIds':parse_resource_ids(args.get('launchTemplateIds'))})
            if args.get('launchTemplateNames') is not None:
                kwargs.update({'LaunchTemplateNames':parse_resource_ids(args.get('launchTemplateNamess'))})

            response = client.describe_launch_templates(**kwargs)

            for i, template in enumerate(response['LaunchTemplates']):
                data.append({
                    'LaunchTemplateId': template['LaunchTemplateId'],
                    'LaunchTemplateName': template['LaunchTemplateName'],
                    'CreatedBy': template['CreatedBy'],
                    'DefaultVersionNumber': template['DefaultVersionNumber'],
                    'LatestVersionNumber': template['LatestVersionNumber'],
                    'CreateTime': datetime.datetime.strftime(template['CreateTime'], '%Y-%m-%dT%H:%M:%SZ'),
                    'Region': obj['_user_provided_options']['region_name'],
                })

                if 'Tags' in template:
                    for tag in template['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['LaunchTemplates'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.LaunchTemplates(val.LaunchTemplateId === obj.LaunchTemplateId)': raw}
            return  create_entry('AWS EC2 LaunchTemplates',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_key_pairs(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('keyNames') is not None:
                kwargs.update({'KeyNames':parse_resource_ids(args.get('keyNames'))})

            response = client.describe_key_pairs(**kwargs)

            for key in response['KeyPairs']:
                data.append({
                    'KeyFingerprint': key['KeyFingerprint'],
                    'KeyName': key['KeyName'],
                    'Region': obj['_user_provided_options']['region_name'],
                })

            ec = {'AWS.EC2.KeyPairs(val.KeyName === obj.KeyName)': data}
            return  create_entry('AWS EC2 Key Pairs',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_vpcs(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('vpcIds') is not None:
                kwargs.update({'VpcIds':parse_resource_ids(args.get('vpcIds'))})

            response = client.describe_vpcs(**kwargs)

            for i, vpc in enumerate(response['Vpcs']):
                data.append({
                    'CidrBlock': vpc['CidrBlock'],
                    'DhcpOptionsId': vpc['DhcpOptionsId'],
                    'State': vpc['State'],
                    'VpcId': vpc['VpcId'],
                    'InstanceTenancy': vpc['InstanceTenancy'],
                    'IsDefault': vpc['IsDefault'],
                    'Region': obj['_user_provided_options']['region_name'],
                })

                if 'Tags' in vpc:
                    for tag in vpc['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['Vpcs'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Vpcs(val.VpcId === obj.VpcId)': raw}
            return  create_entry('AWS EC2 Vpcs',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_subnets(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('subnetIds') is not None:
                kwargs.update({'SubnetIds':parse_resource_ids(args.get('subnetIds'))})

            response = client.describe_subnets(**kwargs)

            for i, subnet in enumerate(response['Subnets']):
                data.append({
                    'AvailabilityZone': subnet['AvailabilityZone'],
                    'AvailableIpAddressCount': subnet['AvailableIpAddressCount'],
                    'CidrBlock': subnet['CidrBlock'],
                    'DefaultForAz': subnet['DefaultForAz'],
                    'State': subnet['State'],
                    'SubnetId': subnet['SubnetId'],
                    'VpcId': subnet['VpcId'],
                    'Region': obj['_user_provided_options']['region_name'],
                })

                if 'Tags' in subnet:
                    for tag in subnet['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['Subnets'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Subnets(val.SubnetId === obj.SubnetId)': raw}
            return  create_entry('AWS EC2 Subnets',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_security_groups(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('groupIds') is not None:
                kwargs.update({'GroupIds':parse_resource_ids(args.get('groupIds'))})
            if args.get('groupNames') is not None:
                kwargs.update({'GroupNames':parse_resource_ids(args.get('groupNames'))})

            response = client.describe_security_groups(**kwargs)

            for i, sg in enumerate(response['SecurityGroups']):
                data.append({
                    'Description': sg['Description'],
                    'GroupName': sg['GroupName'],
                    'OwnerId': sg['OwnerId'],
                    'GroupId': sg['GroupId'],
                    'VpcId': sg['VpcId'],
                    'Region': obj['_user_provided_options']['region_name'],
                })

                if 'Tags' in sg:
                    for tag in sg['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })

            output = json.dumps(response['SecurityGroups'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.SecurityGroups(val.GroupId === obj.GroupId)': raw}
            return  create_entry('AWS EC2 SecurityGroups',data, ec)

        except Exception as e:
            return raise_error(e)

    def allocate_address(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)

            response = client.allocate_address(Domain='vpc')
            data = ({
                'PublicIp': response['PublicIp'],
                'AllocationId': response['AllocationId'],
                'Domain': response['Domain'],
                'Region': obj['_user_provided_options']['region_name']
            })
            ec = {'AWS.EC2.ElasticIPs': data}
            return  create_entry('AWS EC2 ElasticIP', data, ec)

        except Exception as e:
            return raise_error(e)

    def associate_address(args):
        try:
            client = aws_session(
                    service = 'ec2',
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {'AllocationId':args.get('allocationId')}

            if args.get('instanceId') is not None:
                kwargs.update({'InstanceId':args.get('instanceId')})
            if args.get('allowReassociation') is not None:
                kwargs.update({'AllowReassociation':True if args.get('allowReassociation') == 'True'  else False})
            if args.get('networkInterfaceId') is not None:
                kwargs.update({'NetworkInterfaceId':args.get('networkInterfaceId')})
            if args.get('privateIpAddress') is not None:
                kwargs.update({'PrivateIpAddress':args.get('privateIpAddress')})

            response = client.associate_address(**kwargs)
            data = ({
                'AllocationId': args.get('allocationId'),
                'AssociationId': response['AssociationId'],
                'Region':obj['_user_provided_options']['region_name']
            })

            ec = {"AWS.EC2.ElasticIPs(val.AllocationId === obj.AllocationId)": data}
            return  create_entry('AWS EC2 ElasticIP', data, ec)

        except Exception as e:
            return raise_error(e)

    def create_snapshot(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            obj = vars(client._client_config)
            kwargs = {'VolumeId':args.get('volumeId')}

            if args.get('description') is not None:
                kwargs.update({'Description':args.get('description')})
            if args.get('tags') is not None:
                kwargs.update({
                    'TagSpecifications':[{
                        'ResourceType': 'snapshot',
                        'Tags':parse_tag_field(args.get('tags'))}]
                })

            response = client.create_snapshot(**kwargs)

            data = ({
                'Description': response['Description'],
                'Encrypted': response['Encrypted'],
                'Progress': response['Progress'],
                'SnapshotId': response['SnapshotId'],
                'State': response['State'],
                'VolumeId': response['VolumeId'],
                'VolumeSize': response['VolumeSize'],
                'StartTime': datetime.datetime.strftime(response['StartTime'], '%Y-%m-%dT%H:%M:%SZ'),
                'Region': obj['_user_provided_options']['region_name'],
                })

            if 'Tags' in response:
                for tag in response['Tags']:
                    data.update ({
                        tag['Key']: tag['Value']
                    })

            output = json.dumps(response, cls=DatetimeEncoder)
            raw = json.loads(output)
            del raw['ResponseMetadata']
            raw.update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Snapshots': raw}
            return  create_entry('AWS EC2 Snapshots',data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_snapshot(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_snapshot(SnapshotId=args.get('snapshotId'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Snapshot with ID: {0} was deleted".format(args.get('snapshotId'))

        except Exception as e:
            return raise_error

    def create_image(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            obj = vars(client._client_config)
            kwargs = {
                'Name':args.get('name'),
                'InstanceId':args.get('instanceId')
            }

            if args.get('description') is not None:
                kwargs.update({'Description':args.get('description')})
            if args.get('noReboot') is not None:
                kwargs.update({'NoReboot':True if args.get('noReboot') == 'True'  else False})

            response = client.create_image(**kwargs)

            data = ({
                'ImageId': response['ImageId'],
                'Name': args.get('name'),
                'InstanceId': args.get('instanceId'),
                'Region': obj['_user_provided_options']['region_name'],
                })

            ec = {'AWS.EC2.Images': data}
            return  create_entry('AWS EC2 Images',data, ec)

        except Exception as e:
            return raise_error(e)

    def deregister_image(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.deregister_image(ImageId=args.get('imageId'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The AMI with ID: {0} was deregistered".format(args.get('imageId'))

        except Exception as e:
            return raise_error(e)

    def modify_volume(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            obj = vars(client._client_config)
            kwargs = {'VolumeId':args.get('volumeId')}

            if args.get('size') is not None:
                kwargs.update({'Size':int(args.get('size'))})
            if args.get('volumeType') is not None:
                kwargs.update({'VolumeType':args.get('volumeType')})
            if args.get('iops') is not None:
                kwargs.update({'Iops':int(args.get('iops'))})

            response = client.modify_volume(**kwargs)
            volumeModification = response['VolumeModification']

            data = ({
                'VolumeId': volumeModification['VolumeId'],
                'ModificationState': volumeModification['ModificationState'],
                'TargetSize': volumeModification['TargetSize'],
                'TargetIops': volumeModification['TargetIops'],
                'TargetVolumeType': volumeModification['TargetVolumeType'],
                'OriginalSize': volumeModification['OriginalSize'],
                'OriginalIops': volumeModification['OriginalIops'],
                'OriginalVolumeType': volumeModification['OriginalVolumeType'],
                'StartTime': datetime.datetime.strftime(volumeModification['StartTime'], '%Y-%m-%dT%H:%M:%SZ'),
                'Progress': volumeModification['Progress'],
                'Region': obj['_user_provided_options']['region_name'],
                })

            output = json.dumps(response['VolumeModification'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw.update({'Region': obj['_user_provided_options']['region_name']})

            ec = {'AWS.EC2.Volumes(val.VolumeId === obj.VolumeId).Modification': raw}
            return  create_entry('AWS EC2 Volume Modification ',data, ec)

        except Exception as e:
            return raise_error(e)

    def create_tags(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {
                    'Resources':parse_resource_ids(args.get('resources')),
                    'Tags':parse_tag_field(args.get('tags'))
                }
            response = client.create_tags(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The recources where taged successfully"

        except Exception as e:
            return raise_error(e)

    def disassociate_address(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.disassociate_address(AssociationId=args.get('associationId'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Elastic IP was disassociated"

        except Exception as e:
            return raise_error(e)

    def release_address(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.release_address(AllocationId=args.get('allocationId'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Elastic IP was released"

        except Exception as e:
            return raise_error(e)

    def start_instances(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.start_instances(InstanceIds=parse_resource_ids(args.get('instanceIds')))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Instances were started"

        except Exception as e:
            return raise_error(e)

    def stop_instances(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.stop_instances(InstanceIds=parse_resource_ids(args.get('instanceIds')))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Instances were stopped"

        except Exception as e:
            return raise_error(e)

    def terminate_instances(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.terminate_instances(InstanceIds=parse_resource_ids(args.get('instanceIds')))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Instances were terminated"

        except Exception as e:
            return raise_error(e)

    def create_volume(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            obj = vars(client._client_config)
            kwargs = {'AvailabilityZone':args.get('availabilityZone')}

            if args.get('encrypted') is not None:
                kwargs.update({'Encrypted':True if args.get('encrypted') == 'True'  else False})
            if args.get('iops') is not None:
                kwargs.update({'Iops':int(args.get('iops'))})
            if args.get('kmsKeyId') is not None:
                kwargs.update({'KmsKeyId':args.get('kmsKeyId')})
            if args.get('size') is not None:
                kwargs.update({'Size':int(args.get('size'))})
            if args.get('snapshotId') is not None:
                kwargs.update({'SnapshotId':args.get('snapshotId')})
            if args.get('volumeType') is not None:
                kwargs.update({'VolumeType':args.get('volumeType')})
            if args.get('kmsKeyId') is not None:
                kwargs.update({'KmsKeyId':args.get('kmsKeyId')})
            if args.get('tags') is not None:
                kwargs.update({
                    'TagSpecifications':[{
                        'ResourceType': 'volume',
                        'Tags':parse_tag_field(args.get('tags'))}]
                })

            response = client.create_volume(**kwargs)

            data = ({
                'AvailabilityZone': response['AvailabilityZone'],
                'CreateTime': datetime.datetime.strftime(response['CreateTime'], '%Y-%m-%dT%H:%M:%SZ'),
                'Encrypted': response['Encrypted'],
                'Size': response['Size'],
                'State': response['State'],
                'VolumeId': response['VolumeId'],
                'Iops': response['Iops'],
                'VolumeType': response['VolumeType'],
                'Region': obj['_user_provided_options']['region_name'],
                })
            if 'SnapshotId' in response:
                data.update({'SnapshotId':response['SnapshotId']})
            if 'KmsKeyId' in response:
                data.update({'KmsKeyId':response['KmsKeyId']})
            if 'Tags' in response:
                for tag in response['Tags']:
                    data.update ({
                        tag['Key']: tag['Value']
                    })


            ec = {'AWS.EC2.Volumes': data}
            return  create_entry('AWS EC2 Volumes',data, ec)

        except Exception as e:
            return raise_error(e)

    def attach_volume(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {
                'Device':args.get('device'),
                'InstanceId':args.get('instanceId'),
                'VolumeId':args.get('volumeId'),
            }
            response = client.attach_volume(**kwargs)
            data = ({
                'AttachTime': datetime.datetime.strftime(response['AttachTime'], '%Y-%m-%dT%H:%M:%SZ'),
                'Device': response['Device'],
                'InstanceId': response['InstanceId'],
                'State': response['State'],
                'VolumeId': response['VolumeId'],
                })
            if 'DeleteOnTermination' in response: data.update({'DeleteOnTermination': response['DeleteOnTermination']})

            ec = {'AWS.EC2.Volumes(val.VolumeId === obj.VolumeId).Attachments': data}
            return  create_entry('AWS EC2 Volume Attachments',data, ec)

        except Exception as e:
            return raise_error(e)

    def detach_volume(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            kwargs = {'VolumeId':args.get('volumeId')}

            if args.get('force') is not None:
                kwargs.update({'Force':True if args.get('force') == 'True'  else False})
            if args.get('device') is not None:
                kwargs.update({'Device':int(args.get('device'))})
            if args.get('instanceId') is not None:
                kwargs.update({'InstanceId':args.get('instanceId')})

            response = client.detach_volume(**kwargs)
            data = ({
                'AttachTime': datetime.datetime.strftime(response['AttachTime'], '%Y-%m-%dT%H:%M:%SZ'),
                'Device': response['Device'],
                'InstanceId': response['InstanceId'],
                'State': response['State'],
                'VolumeId': response['VolumeId'],
                })
            if 'DeleteOnTermination' in response: data.update({'DeleteOnTermination': response['DeleteOnTermination']})

            ec = {'AWS.EC2.Volumes(val.VolumeId === obj.VolumeId).Attachments': data}
            return  create_entry('AWS EC2 Volume Attachments',data, ec)

        except Exception as e:
            return raise_error

    def delete_volume(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            response = client.delete_volume(VolumeId=args.get('volumeId'))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Volume was deleted"

        except Exception as e:
            return raise_error(e)

    def run_instances(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            obj = vars(client._client_config)
            kwargs = {
                'MinCount':int(args.get('count')),
                'MaxCount': int(args.get('count'))
            }
            BlockDeviceMappings = None
            if args.get('imageId') is not None:
                kwargs.update({'ImageId':(args.get('imageId'))})
            if args.get('instanceType') is not None:
                kwargs.update({'InstanceType':args.get('instanceType')})
            if args.get('securityGroupIds') is not None:
                kwargs.update({'SecurityGroupIds':parse_resource_ids(args.get('securityGroupIds'))})
            if args.get('securityGroups') is not None:
                kwargs.update({'SecurityGroups':parse_resource_ids(args.get('securityGroups'))})
            if args.get('subnetId') is not None:
                kwargs.update({'SubnetId':args.get('subnetId')})
            if args.get('userData') is not None:
                kwargs.update({'UserData':args.get('userData')})
            if args.get('keyName') is not None:
                kwargs.update({'KeyName':args.get('keyName')})
            if args.get('ebsOptimized') is not None:
                kwargs.update({'EbsOptimized':args.get('ebsOptimized')})
            if args.get('disableApiTermination') is not None:
                kwargs.update({'DisableApiTermination':True if args.get('disableApiTermination') == 'True'  else False})
            if args.get('deviceName')  is not None:
                BlockDeviceMappings = {'DeviceName': args.get('deviceName') }
                BlockDeviceMappings.update({'Ebs':{}})
            if args.get('ebsVolumeSize') is not None:
                BlockDeviceMappings['Ebs'].update({'VolumeSize':int(args.get('ebsVolumeSize'))})
            if args.get('ebsVolumeType') is not None:
                BlockDeviceMappings['Ebs'].update({'VolumeType':args.get('ebsVolumeType')})
            if args.get('ebsIops') is not None:
                BlockDeviceMappings['Ebs'].update({'Iops':int(args.get('ebsIops'))})
            if args.get('ebsDeleteOnTermination') is not None:
                BlockDeviceMappings['Ebs'].update({'DeleteOnTermination':True if args.get('ebsDeleteOnTermination') == 'True'  else False})
            if args.get('ebsKmsKeyId') is not None:
                BlockDeviceMappings['Ebs'].update({'KmsKeyId':args.get('ebsKmsKeyId')})
            if args.get('ebsSnapshotId') is not None:
                BlockDeviceMappings['Ebs'].update({'SnapshotId':args.get('ebsSnapshotId')})
            if args.get('ebsEncrypted') is not None:
                BlockDeviceMappings['Ebs'].update({'Encrypted':True if args.get('ebsEncrypted') == 'True'  else False})
            if BlockDeviceMappings:
                kwargs.update({'BlockDeviceMappings':[BlockDeviceMappings]})

            if args.get('iamInstanceProfileArn') and args.get('iamInstanceProfileName') is not None:
                kwargs.update({
                    'IamInstanceProfile':{
                        'Arn': args.get('iamInstanceProfileArn'),
                        'Name':args.get('iamInstanceProfileName')}
                })
            if args.get('launchTemplateId') is not None:
                kwargs.update({
                    'LaunchTemplate':{
                        'LaunchTemplateId': args.get('launchTemplateId')}
                })
            if args.get('launchTemplateName') is not None:
                kwargs.update({
                    'LaunchTemplate':{
                        'LaunchTemplateName': args.get('launchTemplateName')}
                })
            if args.get('launchTemplateVersion') is not None:
                kwargs['LaunchTemplate'].update({
                        'Version': args.get('launchTemplateVersion')
                })
            if args.get('tags') is not None:
                kwargs.update({
                    'TagSpecifications':[{
                        'ResourceType': 'instance',
                        'Tags':parse_tag_field(args.get('tags'))}]
                })

            response = client.run_instances(**kwargs)
            data = []
            for i, instance in enumerate(response['Instances']):
                data.append ({
                    'InstanceId': instance['InstanceId'],
                    'ImageId': instance['ImageId'],
                    'State': instance['State']['Name'],
                    'PublicIPAddress': instance.get('PublicIpAddress'),
                    'Region': obj['_user_provided_options']['region_name'],
                    'Type': instance['InstanceType'],
                    'LaunchDate': datetime.datetime.strftime(instance['LaunchTime'], '%Y-%m-%dT%H:%M:%SZ'),
                    'PublicDNSName': instance['PublicDnsName'],
                    'KeyName': instance['KeyName'],
                    'Monitoring': instance['Monitoring']['State'],
                })
                if 'Tags' in instance:
                    for tag in instance['Tags']:
                        data[i].update ({
                            tag['Key']: tag['Value']
                        })
            output = json.dumps(response['Instances'], cls=DatetimeEncoder)
            raw = json.loads(output)
            raw[0].update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Instances': raw}
            return  create_entry('AWS Instances',data, ec)

        except Exception as e:
            return raise_error(e)

    def waiter_instance_running(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {}
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('instanceIds') is not None:
                kwargs.update({'InstanceIds':parse_resource_ids(args.get('instanceIds'))})
            if args.get('waiterDelay') is not None:
                kwargs.update({'WaiterConfig':{'Delay':int(args.get('waiterDelay'))}})
            if args.get('waiterMaxAttempts') is not None:
                kwargs.update({'WaiterConfig':{'MaxAttempts':int(args.get('waiterMaxAttempts'))}})

            waiter = client.get_waiter('instance_running')
            waiter.wait(**kwargs)

            return "success"

        except Exception as e:
            return raise_error

    def waiter_instance_status_ok(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {}
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('instanceIds') is not None:
                kwargs.update({'InstanceIds':parse_resource_ids(args.get('instanceIds'))})
            if args.get('waiterDelay') is not None:
                kwargs.update({'WaiterConfig':{'Delay':int(args.get('waiterDelay'))}})
            if args.get('waiterMaxAttempts') is not None:
                kwargs.update({'WaiterConfig':{'MaxAttempts':int(args.get('waiterMaxAttempts'))}})

            waiter = client.get_waiter('instance_status_ok')
            waiter.wait(**kwargs)

            return "success"

        except Exception as e:
            return raise_error

    def waiter_instance_stopped(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {}
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('instanceIds') is not None:
                kwargs.update({'InstanceIds':parse_resource_ids(args.get('instanceIds'))})
            if args.get('waiterDelay') is not None:
                kwargs.update({'WaiterConfig':{'Delay':int(args.get('waiterDelay'))}})
            if args.get('waiterMaxAttempts') is not None:
                kwargs.update({'WaiterConfig':{'MaxAttempts':int(args.get('waiterMaxAttempts'))}})

            waiter = client.get_waiter('instance_stopped')
            waiter.wait(**kwargs)

            return "success"

        except Exception as e:
            return raise_error

    def waiter_instance_terminated(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {}
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('instanceIds') is not None:
                kwargs.update({'InstanceIds':parse_resource_ids(args.get('instanceIds'))})
            if args.get('waiterDelay') is not None:
                kwargs.update({'WaiterConfig':{'Delay':int(args.get('waiterDelay'))}})
            if args.get('waiterMaxAttempts') is not None:
                kwargs.update({'WaiterConfig':{'MaxAttempts':int(args.get('waiterMaxAttempts'))}})

            waiter = client.get_waiter('instance_terminated')
            waiter.wait(**kwargs)

            return "success"

        except Exception as e:
            return raise_error

    def waiter_image_available(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {}
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('imageIds') is not None:
                kwargs.update({'ImageIds':parse_resource_ids(args.get('imageIds'))})
            if args.get('executableUsers') is not None:
                kwargs.update({'ExecutableUsers':parse_resource_ids(args.get('executableUsers'))})
            if args.get('owners') is not None:
                kwargs.update({'Owners':parse_resource_ids(args.get('owners'))})
            if args.get('waiterDelay') is not None:
                kwargs.update({'WaiterConfig':{'Delay':int(args.get('waiterDelay'))}})
            if args.get('waiterMaxAttempts') is not None:
                kwargs.update({'WaiterConfig':{'MaxAttempts':int(args.get('waiterMaxAttempts'))}})

            waiter = client.get_waiter('image_available')
            waiter.wait(**kwargs)

            return "success"

        except Exception as e:
            return raise_error

    def waiter_snapshot_completed(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )
            kwargs = {}
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('ownerIds') is not None:
                kwargs.update({'OwnerIds':parse_resource_ids(args.get('ownerIds'))})
            if args.get('restorableByUserIds') is not None:
                kwargs.update({'RestorableByUserIds':parse_resource_ids(args.get('restorableByUserIds'))})
            if args.get('snapshotIds') is not None:
                kwargs.update({'SnapshotIds':parse_resource_ids(args.get('snapshotIds'))})
            if args.get('waiterDelay') is not None:
                kwargs.update({'WaiterConfig':{'Delay':int(args.get('waiterDelay'))}})
            if args.get('waiterMaxAttempts') is not None:
                kwargs.update({'WaiterConfig':{'MaxAttempts':int(args.get('waiterMaxAttempts'))}})

            waiter = client.get_waiter('snapshot_completed')
            waiter.wait(**kwargs)

            return "success"

        except Exception as e:
            return raise_error

    def get_latest_ami(args):
        try:
            client = aws_session(
                service = 'ec2',
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            kwargs = {}
            data = []

            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('imageIds') is not None:
                kwargs.update({'ImageIds':parse_resource_ids(args.get('imageIds'))})
            if args.get('owners') is not None:
                kwargs.update({'Owners':parse_resource_ids(args.get('owners'))})
            if args.get('executableUsers') is not None:
                kwargs.update({'ExecutableUsers':parse_resource_ids(args.get('executableUsers'))})
            response = client.describe_images(**kwargs)
            amis = sorted(response['Images'],
                      key=lambda x: x['CreationDate'],
                      reverse=True)
            image = amis[0]
            data =({
                'CreationDate': image['CreationDate'],
                'ImageId': image['ImageId'],
                'Public': image['Public'],
                'Name': image['Name'],
                'State': image['State'],
                'Region': obj['_user_provided_options']['region_name'],
                })
            if 'Description' in image:
                data.update({'Description': image['Description']})
            if 'Tags' in image:
                for tag in image['Tags']:
                    data.update ({
                        tag['Key']: tag['Value']
                    })

            raw = json.loads(json.dumps(image, cls=DatetimeEncoder))
            raw.update({'Region': obj['_user_provided_options']['region_name']})
            ec = {'AWS.EC2.Images': image}
            return  create_entry('AWS EC2 Images',data, ec)

        except Exception as e:
            return raise_error(e)

    def create_security_group(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            kwargs = {
                'GroupName':args.get('groupName'),
                'Description':args.get('description'),
                'VpcId':args.get('vpcId'),
                }
            response = client.create_security_group(**kwargs)
            data = ({
                'GroupName':args.get('groupName'),
                'Description':args.get('description'),
                'VpcId':args.get('vpcId'),
                'GroupId':response['GroupId']
            })
            ec = {'AWS.EC2.SecurityGroups': data}
            return  create_entry('AWS EC2 Security Groups',data, ec)

        except Exception as e:
            return raise_error(e)

    def delete_security_group(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            kwargs = {}
            if args.get('groupId') is not None:
                kwargs.update({'GroupId':args.get('groupId')})
            if args.get('groupName') is not None:
                kwargs.update({'GroupName':args.get('groupName')})

            response = client.delete_security_group(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Security Group was Deleted"

        except Exception as e:
            return raise_error(e)

    def authorize_security_group_ingress(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            kwargs = {'GroupId':args.get('groupId')}

            if args.get('fromPort') is not None:
                kwargs.update({'FromPort':int(args.get('fromPort'))})
            if args.get('cidrIp') is not None:
                kwargs.update({'CidrIp':args.get('cidrIp')})
            if args.get('toPort') is not None:
                kwargs.update({'ToPort':int(args.get('toPort'))})
            if args.get('ipProtocol') is not None:
                kwargs.update({'IpProtocol':args.get('ipProtocol')})
            if args.get('sourceSecurityGroupName') is not None:
                kwargs.update({'SourceSecurityGroupName':args.get('sourceSecurityGroupName')})

            response = client.authorize_security_group_ingress(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Security Group ingress rule was created"

        except Exception as e:
            return raise_error(e)

    def revoke_security_group_ingress(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            kwargs = {'GroupId':args.get('groupId')}

            if args.get('fromPort') is not None:
                kwargs.update({'FromPort':int(args.get('fromPort'))})
            if args.get('cidrIp') is not None:
                kwargs.update({'CidrIp':args.get('cidrIp')})
            if args.get('toPort') is not None:
                kwargs.update({'ToPort':int(args.get('toPort'))})
            if args.get('ipProtocol') is not None:
                kwargs.update({'IpProtocol':args.get('ipProtocol')})
            if args.get('sourceSecurityGroupName') is not None:
                kwargs.update({'SourceSecurityGroupName':args.get('sourceSecurityGroupName')})

            response = client.revoke_security_group_ingress(**kwargs)
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Security Group ingress rule was revoked"

        except Exception as e:
            return raise_error(e)

    def copy_image(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            kwargs = {
                'Name':args.get('name'),
                'SourceImageId':args.get('sourceImageId'),
                'SourceRegion':args.get('sourceRegion'),
            }
            if args.get('clientToken') is not None:
                kwargs.update({'ClientToken':args.get('clientToken')})
            if args.get('description') is not None:
                kwargs.update({'Description':args.get('description')})
            if args.get('encrypted') is not None:
                kwargs.update({'Encrypted':True if args.get('ebsEncrypted') == 'True'  else False})
            if args.get('kmsKeyId') is not None:
                kwargs.update({'KmsKeyId':args.get('kmsKeyId')})

            response = client.copy_image(**kwargs)
            data = ({
                'ImageId': response['ImageId'],
                'Region': obj['_user_provided_options']['region_name']
            })

            ec = {'AWS.EC2.Images(val.ImageId === obj.ImageId)': data}
            return  create_entry('AWS EC2 Images',data, ec)

        except Exception as e:
            return raise_error(e)

    def copy_snapshot(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            kwargs = {
                'SourceSnapshotId':args.get('sourceSnapshotId'),
                'SourceRegion':args.get('sourceRegion'),
            }
            if args.get('description') is not None:
                kwargs.update({'Description':args.get('description')})
            if args.get('encrypted') is not None:
                kwargs.update({'Encrypted':True if args.get('ebsEncrypted') == 'True'  else False})
            if args.get('kmsKeyId') is not None:
                kwargs.update({'KmsKeyId':args.get('kmsKeyId')})

            response = client.copy_snapshot(**kwargs)
            data = ({
                'SnapshotId': response['SnapshotId'],
                'Region': obj['_user_provided_options']['region_name']
            })

            ec = {'AWS.EC2.Snapshots(val.SnapshotId === obj.SnapshotId)': data}
            return  create_entry('AWS EC2 Snapshots',data, ec)

        except Exception as e:
            return raise_error(e)

    def describe_reserved_instances(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            kwargs = {}
            data = []
            output = []
            if args.get('filters') is not None:
                kwargs.update({'Filters':parse_filter_field(args.get('filters'))})
            if args.get('offeringClass') is not None:
                kwargs.update({'OfferingClass':args.get('offeringClass')})
            if args.get('reservedInstancesIds') is not None:
                kwargs.update({'ReservedInstancesIds':parse_resource_ids(args.get('reservedInstancesIds'))})

            response = client.describe_reserved_instances(**kwargs)
            for i, reservation in enumerate(response['ReservedInstances']):
                data.append({
                    'ReservedInstancesId': reservation['ReservedInstancesId'],
                    'Start': atetime.datetime.strftime(reservation['Start'], '%Y-%m-%dT%H:%M:%SZ'),
                    'End': atetime.datetime.strftime(reservation['End'], '%Y-%m-%dT%H:%M:%SZ'),
                    'Duration': reservation['Duration'],
                    'InstanceType':reservation['InstanceType'],
                    'InstanceCount': reservation['InstanceCount'],
                    'OfferingClass': reservation['OfferingClass'],
                    'Scope': reservation['Scope'],
                    'State': reservation['State']
                })
                if 'Tags' in reservation:
                        for tag in reservation['Tags']:
                            data[i].update ({
                              tag['Key']: tag['Value']
                            })
                reservation.update({'Region': obj['_user_provided_options']['region_name']})
                output.append(reservation)

            raw = json.loads(json.dumps(output, cls=DatetimeEncoder))
            ec = {'AWS.EC2.ReservedInstances(val.ReservedInstancesId === obj.ReservedInstancesId)': raw}
            return  create_entry('AWS EC2 Reserved Instances',data, ec)

        except Exception as e:
            return raise_error(e)

    def monitor_instances(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            data=[]
            output=[]
            response = client.monitor_instances(InstanceIds=parse_resource_ids(args.get('instancesIds')))

            for instance in response['InstanceMonitorings']:
                data.append({
                    'InstanceId': instance['InstanceId'],
                    'MonitoringState': instance['Monitoring']['State']
                })

            ec = {'AWS.EC2.Instances(val.InstancesId === obj.InstancesId)': response['InstanceMonitorings']}
            return  create_entry('AWS EC2 Instances',data, ec)

        except Exception as e:
            return raise_error(e)

    def unmonitor_instances(args):
        try:
            client = aws_session(
                region = args.get('region'),
                roleArn = args.get('roleArn'),
                roleSessionName = args.get('roleSessionName'),
                roleSessionDuration = args.get('roleSessionDuration'),
            )
            obj = vars(client._client_config)
            data=[]
            output=[]
            response = client.unmonitor_instances(InstanceIds=parse_resource_ids(args.get('instancesIds')))

            for instance in response['InstanceMonitorings']:
                data.append({
                    'InstanceId': instance['InstanceId'],
                    'MonitoringState': instance['Monitoring']['State']
                })

            ec = {'AWS.EC2.Instances(val.InstancesId === obj.InstancesId)': response['InstanceMonitorings']}
            return  create_entry('AWS EC2 Instances',data, ec)

        except Exception as e:
            return raise_error(e)

    def reboot_instances(args):
        try:
            client = aws_session(
                    region = args.get('region'),
                    roleArn = args.get('roleArn'),
                    roleSessionName = args.get('roleSessionName'),
                    roleSessionDuration = args.get('roleSessionDuration'),
                )

            response = client.reboot_instances(InstanceIds=parse_resource_ids(args.get('instanceIds')))
            if response['ResponseMetadata']['HTTPStatusCode'] == 200:
                return "The Instances were rebooted"

        except Exception as e:
            return raise_error(e)


    # The command demisto.command() holds the command sent from the user.
    if demisto.command() == 'test-module':
        # This is the call made when pressing the integration test button.
        client = aws_session()
        response = client.describe_regions()
        if response['ResponseMetadata']['HTTPStatusCode'] == 200:
          result = ('ok')

    if demisto.command() == 'aws-ec2-describe-regions':
        result = describe_regions(demisto.args())

    if demisto.command() == 'aws-ec2-describe-instances':
        result = describe_instances(demisto.args())

    if demisto.command() == 'aws-ec2-describe-images':
        result = describe_images(demisto.args())

    if demisto.command() == 'aws-ec2-describe-addresses':
        result = describe_addresses(demisto.args())

    if demisto.command() == 'aws-ec2-describe-snapshots':
        result = describe_snapshots(demisto.args())

    if demisto.command() == 'aws-ec2-describe-volumes':
        result = describe_volumes(demisto.args())

    if demisto.command() == 'aws-ec2-describe-launch-templates':
        result = describe_launch_templates(demisto.args())

    if demisto.command() == 'aws-ec2-describe-key-pairs':
        result = describe_key_pairs(demisto.args())

    if demisto.command() == 'aws-ec2-describe-vpcs':
        result = describe_vpcs(demisto.args())

    if demisto.command() == 'aws-ec2-describe-subnets':
        result = describe_subnets(demisto.args())

    if demisto.command() == 'aws-ec2-describe-security-groups':
        result = describe_security_groups(demisto.args())

    if demisto.command() == 'aws-ec2-allocate-address':
        result = allocate_address(demisto.args())

    if demisto.command() == 'aws-ec2-associate-address':
        result = associate_address(demisto.args())

    if demisto.command() == 'aws-ec2-create-snapshot':
        result = create_snapshot(demisto.args())

    if demisto.command() == 'aws-ec2-delete-snapshot':
        result = delete_snapshot(demisto.args())

    if demisto.command() == 'aws-ec2-create-image':
        result = create_image(demisto.args())

    if demisto.command() == 'aws-ec2-deregister-image':
        result = deregister_image(demisto.args())

    if demisto.command() == 'aws-ec2-modify-volume':
        result = modify_volume(demisto.args())

    if demisto.command() == 'aws-ec2-create-tags':
        result = create_tags(demisto.args())

    if demisto.command() == 'aws-ec2-disassociate-address':
        result = disassociate_address(demisto.args())

    if demisto.command() == 'aws-ec2-release-address':
        result = release_address(demisto.args())

    if demisto.command() == 'aws-ec2-start-instances':
        result = start_instances(demisto.args())

    if demisto.command() == 'aws-ec2-stop-instances':
        result = stop_instances(demisto.args())

    if demisto.command() == 'aws-ec2-terminate-instances':
        result = terminate_instances(demisto.args())

    if demisto.command() == 'aws-ec2-create-volume':
        result = create_volume(demisto.args())

    if demisto.command() == 'aws-ec2-attach-volume':
        result = attach_volume(demisto.args())

    if demisto.command() == 'aws-ec2-detach-volume':
        result = detach_volume(demisto.args())

    if demisto.command() == 'aws-ec2-delete-volume':
        result = delete_volume(demisto.args())

    if demisto.command() == 'aws-ec2-run-instances':
        result = run_instances(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-instance-running':
        result = waiter_instance_running(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-instance-status-ok':
        result = waiter_instance_status_ok(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-instance-stopped':
        result = waiter_instance_stopped(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-instance-terminated':
        result = waiter_instance_terminated(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-instance-terminated':
        result = waiter_instance_terminated(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-image-available':
        result = waiter_image_available(demisto.args())

    if demisto.command() == 'aws-ec2-waiter-snapshot_completed':
        result = waiter_snapshot_completed(demisto.args())

    if demisto.command() == 'aws-ec2-get-latest-ami':
        result = get_latest_ami(demisto.args())

    if demisto.command() == 'aws-ec2-create-security-group':
        result = create_security_group(demisto.args())

    if demisto.command() == 'aws-ec2-delete-security-group':
        result = delete_security_group(demisto.args())

    if demisto.command() == 'aws-ec2-authorize-security-group-ingress-rule':
        result = authorize_security_group_ingress(demisto.args())

    if demisto.command() == 'aws-ec2-revoke-security-group-ingress-rule':
        result = revoke_security_group_ingress(demisto.args())

    if demisto.command() == 'aws-ec2-copy-image':
        result = copy_image(demisto.args())

    if demisto.command() == 'aws-ec2-copy-snapshot':
        result = copy_snapshot(demisto.args())

    if demisto.command() == 'aws-ec2-describe-reserved-instances':
        result = describe_reserved_instances(demisto.args())

    if demisto.command() == 'aws-ec2-monitor-instances':
        result = monitor_instances(demisto.args())

    if demisto.command() == 'aws-ec2-unmonitor-instances':
        result = unmonitor_instances(demisto.args())

    if demisto.command() == 'aws-ec2-reboot-instances':
        result = reboot_instances(demisto.args())


    demisto.results(result)
    sys.exit(0)


  type: python
  commands:
  - name: aws-ec2-describe-instances
    arguments:
    - name: filters
      description: One or more filters.See documentation for details & filter options.
    - name: instanceIds
      description: One or more instance IDs. Seprated by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Instances.AmiLaunchIndex
      description: The AMI launch index, which can be used to find this instance in
        the launch group.
      type: number
    - contextPath: AWS.EC2.Instances.ImageId
      description: The ID of the AMI used to launch the instance.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceType
      description: The instance type.
      type: string
    - contextPath: AWS.EC2.Instances.KernelId
      description: The kernel associated with this instance, if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.KeyName
      description: The name of the key pair, if this instance was launched with an
        associated key pair.
      type: string
    - contextPath: AWS.EC2.Instances.LaunchTime
      description: The time the instance was launched.
      type: date
    - contextPath: AWS.EC2.Instances.Monitoring.State
      description: Indicates whether detailed monitoring is enabled. Otherwise, basic
        monitoring is enabled.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.AvailabilityZone
      description: The Availability Zone of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.Affinity
      description: The affinity setting for the instance on the Dedicated Host.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.GroupName
      description: The name of the placement group the instance is in (for cluster
        compute instances).
      type: string
    - contextPath: AWS.EC2.Instances.Placement.HostId
      description: he ID of the Dedicated Host on which the instance resides.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.Tenancy
      description: The tenancy of the instance (if the instance is running in a VPC).
      type: string
    - contextPath: AWS.EC2.Instances.Platform
      description: The value is Windows for Windows instances; otherwise blank.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateDnsName
      description: (IPv4 only) The private DNS hostname name assigned to the instance.
        This DNS hostname can only be used inside the Amazon EC2 network. This name
        is not available until the instance enters the running state.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateIpAddress
      description: The private IPv4 address assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.ProductCodes.ProductCodeId
      description: The product code.
      type: string
    - contextPath: AWS.EC2.Instances.ProductCodes.ProductCodeType
      description: The type of product code.
      type: string
    - contextPath: AWS.EC2.Instances.PublicDnsName
      description: (IPv4 only) The public DNS name assigned to the instance. This
        name is not available until the instance enters the running state.
      type: string
    - contextPath: AWS.EC2.Instances.PublicIpAddress
      description: The public IPv4 address assigned to the instance, if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.RamdiskId
      description: The RAM disk associated with this instance, if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.State.Code
      description: The low byte represents the state.
      type: string
    - contextPath: AWS.EC2.Instances.State.Name
      description: The current state of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.StateTransitionReason
      description: The reason for the most recent state transition. This might be
        an empty string.
      type: string
    - contextPath: AWS.EC2.Instances.SubnetId
      description: The ID of the subnet in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.VpcId
      description: The ID of the VPC in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.Architecture
      description: The architecture of the image.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.DeviceName
      description: The device name (for example, /dev/sdh or xvdh).
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.AttachTime
      description: The time stamp when the attachment initiated.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.DeleteOnTermination
      description: Indicates whether the volume is deleted on instance termination.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.Status
      description: The attachment state.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.VolumeId
      description: The ID of the EBS volume.
      type: string
    - contextPath: AWS.EC2.Instances.ClientToken
      description: The idempotency token you provided when you launched the instance,
        if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.EbsOptimized
      description: Indicates whether the instance is optimized for Amazon EBS I/O.
      type: boolean
    - contextPath: AWS.EC2.Instances.EnaSupport
      description: Specifies whether enhanced networking with ENA is enabled.
      type: boolean
    - contextPath: AWS.EC2.Instances.Hypervisor
      description: The hypervisor type of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.IamInstanceProfile.Arn
      description: The Amazon Resource Name (ARN) of the instance profile.
      type: string
    - contextPath: AWS.EC2.Instances.IamInstanceProfile.Id
      description: The ID of the instance profile.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceLifecycle
      description: Indicates whether this is a Spot Instance or a Scheduled Instance.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuId
      description: The ID of the Elastic GPU.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuAssociationId
      description: The ID of the association.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuAssociationState
      description: The state of the association between the instance and the Elastic
        GPU.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuAssociationTime
      description: The time the Elastic GPU was associated with the instance.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Association.IpOwnerId
      description: The ID of the owner of the Elastic IP address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Association.PublicDnsName
      description: The public DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Association.PublicIp
      description: The public IP address or Elastic IP address bound to the network
        interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.AttachTime
      description: The time stamp when the attachment initiated.
      type: date
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.AttachmentId
      description: The ID of the network interface attachment.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.DeleteOnTermination
      description: Indicates whether the network interface is deleted when the instance
        is terminated.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.DeviceIndex
      description: The index of the device on the instance for the network interface
        attachment.
      type: number
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.Status
      description: The attachment state.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Description
      description: The description.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Groups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Groups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Ipv6Addresses.Ipv6Address
      description: The IPv6 addresses associated with the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.MacAddress
      description: The MAC address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.NetworkInterfaceId
      description: The ID of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.OwnerId
      description: The ID of the AWS account that created the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateDnsName
      description: The private DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress
      description: The IPv4 address of the network interface within the subnet.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Association.IpOwnerId
      description: The ID of the owner of the Elastic IP address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Association.PublicDnsName
      description: The public DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Association.PublicIp
      description: The public IP address or Elastic IP address bound to the network
        interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Primary
      description: Indicates whether this IPv4 address is the primary private IP address
        of the network interface.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.PrivateDnsName
      description: The private IPv4 DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.PrivateIpAddress
      description: The private IPv4 address of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.SourceDestCheck
      description: Indicates whether to validate network traffic to or from this network
        interface.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Status
      description: The status of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.SubnetId
      description: The ID of the subnet.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.VpcId
      description: The ID of the VPC.
      type: string
    - contextPath: AWS.EC2.Instances.RootDeviceName
      description: The device name of the root device volume (for example, /dev/sda1).
      type: string
    - contextPath: AWS.EC2.Instances.RootDeviceType
      description: The root device type used by the AMI. The AMI can use an EBS volume
        or an instance store volume.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.SourceDestCheck
      description: Specifies whether to enable an instance launched in a VPC to perform
        NAT.
      type: boolean
    - contextPath: AWS.EC2.Instances.SpotInstanceRequestId
      description: If the request is a Spot Instance request, the ID of the request.
      type: string
    - contextPath: AWS.EC2.Instances.SriovNetSupport
      description: Specifies whether enhanced networking with the Intel 82599 Virtual
        Function interface is enabled.
      type: string
    - contextPath: AWS.EC2.Instances.StateReason.Code
      description: The reason code for the state change.
      type: string
    - contextPath: AWS.EC2.Instances.StateReason.Message
      description: The message for the state change.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.VirtualizationType
      description: The virtualization type of the instance.
      type: string
    description: Describes one or more of your instances.
  - name: aws-ec2-describe-images
    arguments:
    - name: filters
      description: One or more filters.
    - name: imageIds
      description: One or more image IDs, Seperated by comma
    - name: owners
      description: Filters the images by the owner. Specify an AWS account ID, self
        (owner is the sender of the request), or an AWS owner alias (valid values
        are amazon | aws-marketplace | microsoft ). Omitting this option returns all
        images for which you have launch permissions, regardless of ownership.
    - name: executableUsers
      description: Scopes the images by users with explicit launch permissions. Specify
        an AWS account ID, self (the sender of the request), or all (public AMIs).
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Images.Architecture
      description: The architecture of the image.
      type: string
    - contextPath: AWS.EC2.Images.CreationDate
      description: The date and time the image was created.
      type: date
    - contextPath: AWS.EC2.Images.ImageId
      description: The ID of the AMI.
      type: string
    - contextPath: AWS.EC2.Images.ImageLocation
      description: The location of the AMI.
      type: string
    - contextPath: AWS.EC2.Images.ImageType
      description: The type of image.
      type: string
    - contextPath: AWS.EC2.Images.Public
      description: Indicates whether the image has public launch permissions. The
        value is true if this image has public launch permissions or false if it has
        only implicit and explicit launch permissions.
      type: boolean
    - contextPath: AWS.EC2.Images.KernelId
      description: The kernel associated with the image, if any. Only applicable for
        machine images.
      type: string
    - contextPath: AWS.EC2.Images.OwnerId
      description: The AWS account ID of the image owner.
      type: string
    - contextPath: AWS.EC2.Images.Platform
      description: The value is Windows for Windows AMIs; otherwise blank.
      type: string
    - contextPath: AWS.EC2.Images.ProductCodes.ProductCodeId
      description: The product code.
      type: string
    - contextPath: AWS.EC2.Images.ProductCodes.ProductCodeType
      description: The type of product code.
      type: string
    - contextPath: AWS.EC2.Images.RamdiskId
      description: The RAM disk associated with the image, if any. Only applicable
        for machine images.
      type: string
    - contextPath: AWS.EC2.Images.State
      description: The current state of the AMI. If the state is available , the image
        is successfully registered and can be used to launch an instance.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.DeviceName
      description: The device name (for example, /dev/sdh or xvdh).
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.VirtualName
      description: The virtual device name (ephemeral N).
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.Encrypted
      description: Indicates whether the EBS volume is encrypted.
      type: boolean
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.DeleteOnTermination
      description: Indicates whether the EBS volume is deleted on instance termination.
      type: boolean
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.Iops
      description: The number of I/O operations per second (IOPS) that the volume
        supports.
      type: number
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.KmsKeyId
      description: Identifier (key ID, key alias, ID ARN, or alias ARN) for a user-managed
        CMK under which the EBS volume is encrypted.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.SnapshotId
      description: The ID of the snapshot.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.VolumeSize
      description: The size of the volume, in GiB.
      type: number
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.VolumeType
      description: The volume type.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.NoDevice
      description: Suppresses the specified device included in the block device mapping
        of the AMI.
      type: string
    - contextPath: AWS.EC2.Images.Description
      description: The description of the AMI that was provided during image creation.
      type: string
    - contextPath: AWS.EC2.Images.EnaSupport
      description: Specifies whether enhanced networking with ENA is enabled.
      type: boolean
    - contextPath: AWS.EC2.Images.Hypervisor
      description: The hypervisor type of the image.
      type: string
    - contextPath: AWS.EC2.Images.ImageOwnerAlias
      description: The AWS account alias (for example, amazon , self ) or the AWS
        account ID of the AMI owner.
      type: string
    - contextPath: AWS.EC2.Images.Name
      description: The name of the AMI that was provided during image creation.
      type: string
    - contextPath: AWS.EC2.Images.RootDeviceName
      description: The device name of the root device volume (for example, /dev/sda1).
      type: string
    - contextPath: AWS.EC2.Images.RootDeviceType
      description: The type of root device used by the AMI. The AMI can use an EBS
        volume or an instance store volume.
      type: string
    - contextPath: AWS.EC2.Images.SriovNetSupport
      description: Specifies whether enhanced networking with the Intel 82599 Virtual
        Function interface is enabled.
      type: string
    - contextPath: AWS.EC2.Images.StateReason.Code
      description: The reason code for the state change.
      type: string
    - contextPath: AWS.EC2.Images.StateReason.Message
      description: The message for the state change.
      type: string
    - contextPath: AWS.EC2.Images.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Images.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Images.VirtualizationType
      description: The type of virtualization of the AMI.
      type: string
    description: Describes one or more of the images (AMIs, AKIs, and ARIs) available
      to you. Images available to you include public images, private images that you
      own, and private images owned by other AWS accounts but for which you have explicit
      launch permissions.
  - name: aws-ec2-describe-regions
    arguments:
    - name: regionNames
      description: The name of the region (for example, us-east-1 ).
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.Regions.Endpoint
      description: The region service endpoint.
      type: string
    - contextPath: AWS.Regions.RegionName
      description: The name of the region.
      type: string
    description: Describes one or more regions that are currently available to you.
  - name: aws-ec2-describe-addresses
    arguments:
    - name: filters
      description: One or more filters. See documentation for filters list.
    - name: publicIps
      description: One or more Elastic IP addresses.
    - name: allocationIds
      description: One or more allocation IDs.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.ElasticIPs.InstanceId
      description: The ID of the instance that the address is associated with (if
        any).
      type: string
    - contextPath: AWS.EC2.ElasticIPs.PublicIp
      description: The Elastic IP address.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.AllocationId
      description: The ID representing the allocation of the address for use with
        EC2-VPC.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.AssociationId
      description: The ID representing the association of the address with an instance
        in a VPC.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.Domain
      description: dicates whether this Elastic IP address is for use with instances
        in EC2-Classic (standard) or instances in a VPC.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.NetworkInterfaceId
      description: The ID of the network interface.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.NetworkInterfaceOwnerId
      description: The ID of the AWS account that owns the network interface.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.PrivateIpAddress
      description: The private IP address associated with the Elastic IP address.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.Region
      description: The aws region were the elastic ip is located.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.Tags.Value
      description: The value of the tag.
      type: string
    description: Describes one or more of your Elastic IP addresses.
  - name: aws-ec2-describe-snapshots
    arguments:
    - name: filters
      description: One or more filters. See documentation for filters list.
    - name: ownerIds
      description: Returns the snapshots owned by the specified owner. Multiple owners
        can be specified.
    - name: snapshotIds
      description: One or more snapshot IDs. Seperated by commas
    - name: restorableByUserIds
      description: One or more AWS accounts IDs that can create volumes from the snapshot.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Snapshots.DataEncryptionKeyId
      description: The data encryption key identifier for the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.Description
      description: The description for the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.Encrypted
      description: Indicates whether the snapshot is encrypted.
      type: boolean
    - contextPath: AWS.EC2.Snapshots.KmsKeyId
      description: The full ARN of the AWS Key Management Service (AWS KMS) customer
        master key (CMK) that was used to protect the volume encryption key for the
        parent volume.
      type: string
    - contextPath: AWS.EC2.Snapshots.OwnerId
      description: The AWS account ID of the EBS snapshot owner.
      type: string
    - contextPath: AWS.EC2.Snapshots.Progress
      description: The progress of the snapshot, as a percentage.
      type: string
    - contextPath: AWS.EC2.Snapshots.SnapshotId
      description: The ID of the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.StartTime
      description: The time stamp when the snapshot was initiated.
      type: string
    - contextPath: AWS.EC2.Snapshots.State
      description: The snapshot state.
      type: string
    - contextPath: AWS.EC2.Snapshots.StateMessage
      description: this field displays error state details to help you diagnose why
        the error occurred.
      type: string
    - contextPath: AWS.EC2.Snapshots.VolumeId
      description: The ID of the volume that was used to create the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.VolumeSize
      description: The size of the volume, in GiB.
      type: number
    - contextPath: AWS.EC2.Snapshots.OwnerAlias
      description: Value from an Amazon-maintained list of snapshot owners.
      type: string
    - contextPath: AWS.EC2.Snapshots.Region
      description: The aws region were the snapshot is located
      type: string
    - contextPath: AWS.EC2.Snapshots.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Snapshots.Tags.Value
      description: The value of the tag.
      type: string
    description: Describes one or more of the EBS snapshots available to you.
  - name: aws-ec2-describe-launch-templates
    arguments:
    - name: Filters
      description: One or more filters.See documentation for filters list.
    - name: LaunchTemplateNames
      description: One or more launch template names. Sepereted by comma.
    - name: LaunchTemplateIds
      description: One or more launch template IDs. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.LaunchTemplates.LaunchTemplateId
      description: The ID of the launch template.
      type: string
    - contextPath: AWS.EC2.LaunchTemplates.LaunchTemplateName
      description: The name of the launch template.
      type: string
    - contextPath: AWS.EC2.LaunchTemplates.CreateTime
      description: The time launch template was created.
      type: date
    - contextPath: AWS.EC2.LaunchTemplates.CreatedBy
      description: The principal that created the launch template.
      type: string
    - contextPath: AWS.EC2.LaunchTemplates.DefaultVersionNumber
      description: The version number of the default version of the launch template.
      type: number
    - contextPath: AWS.EC2.LaunchTemplates.LatestVersionNumber
      description: The version number of the latest version of the launch template.
      type: number
    - contextPath: AWS.EC2.LaunchTemplates.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.LaunchTemplates.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.LaunchTemplates.Region
      description: The aws region where the template is located
      type: string
    description: Describes one or more launch templates.
  - name: aws-ec2-describe-key-pairs
    arguments:
    - name: filters
      description: One or more filters. See documentation for filters list.
    - name: keyNames
      description: One or more key pair names. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.KeyPairs.KeyFingerprint
      description: If you used CreateKeyPair to create the key pair, this is the SHA-1
        digest of the DER encoded private key. If you used ImportKeyPair to provide
        AWS the public key, this is the MD5 public key fingerprint as specified in
        section 4 of RFC4716.
    - contextPath: AWS.EC2.KeyPairs.KeyName
      description: The name of the key pair.
    - contextPath: AWS.EC2.KeyPairs.Region
      description: The aws region where the key pair is located
    description: Describes one or more of your key pairs.
  - name: aws-ec2-describe-volumes
    arguments:
    - name: filters
      description: One or more filters. See documentation for filters list.
    - name: volumeIds
      description: One or more volume IDs. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Volumes.AvailabilityZone
      description: The Availability Zone for the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.CreateTime
      description: The time stamp when volume creation was initiated.
      type: date
    - contextPath: AWS.EC2.Volumes.Encrypted
      description: Indicates whether the volume will be encrypted.
      type: boolean
    - contextPath: AWS.EC2.Volumes.KmsKeyId
      description: The full ARN of the AWS Key Management Service customer master
        key that was used to protect the volume encryption key for the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Size
      description: The snapshot from which the volume was created, if applicable.
      type: number
    - contextPath: AWS.EC2.Volumes.State
      description: The volume state.
      type: string
    - contextPath: AWS.EC2.Volumes.VolumeId
      description: The ID of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Iops
      description: The number of I/O operations per second (IOPS) that the volume
        supports.
      type: number
    - contextPath: AWS.EC2.Volumes.VolumeType
      description: The volume type. This can be gp2 for General Purpose SSD, io1 for
        Provisioned IOPS SSD, st1 for Throughput Optimized HDD, sc1 for Cold HDD,
        or standard for Magnetic volumes.
      type: string
    - contextPath: AWS.EC2.Volumes.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Volumes.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.AttachTime
      description: The time stamp when the attachment initiated.
      type: date
    - contextPath: AWS.EC2.Volumes.Attachments.Device
      description: The device name.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.State
      description: The attachment state of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.VolumeId
      description: The ID of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.DeleteOnTermination
      description: Indicates whether the EBS volume is deleted on instance termination.
      type: boolean
    description: Describes the specified EBS volumes.
  - name: aws-ec2-describe-vpcs
    arguments:
    - name: filters
      description: One or more filters. See documentation for filters list.
    - name: vpcIds
      description: One or more VPC IDs. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Vpcs.CidrBlock
      description: The primary IPv4 CIDR block for the VPC.
      type: string
    - contextPath: AWS.EC2.Vpcs.DhcpOptionsId
      description: The ID of the set of DHCP options you have associated with the
        VPC.
      type: string
    - contextPath: AWS.EC2.Vpcs.State
      description: The current state of the VPC.
      type: string
    - contextPath: AWS.EC2.Vpcs.VpcId
      description: The ID of the VPC.
      type: string
    - contextPath: AWS.EC2.Vpcs.InstanceTenancy
      description: The allowed tenancy of instances launched into the VPC.
      type: string
    - contextPath: AWS.EC2.Vpcs.IsDefault
      description: Indicates whether the VPC is the default VPC.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.Ipv6CidrBlockAssociationSet.AssociationId
      description: The association ID for the IPv6 CIDR block.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.Ipv6CidrBlockAssociationSet.Ipv6CidrBlock
      description: The IPv6 CIDR block.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.Ipv6CidrBlockAssociationSet.Ipv6CidrBlockState.State
      description: The state of the CIDR block.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.Ipv6CidrBlockAssociationSet.Ipv6CidrBlockState.StatusMessage
      description: A message about the status of the CIDR block, if applicable.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.CidrBlockAssociationSet.AssociationId
      description: The association ID for the IPv4 CIDR block.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.CidrBlockAssociationSet.CidrBlock
      description: The IPv4 CIDR block.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.CidrBlockAssociationSet.CidrBlockState.State
      description: The state of the CIDR block.
      type: string
    - contextPath: AWS.EC2.Vpcs.Tags.CidrBlockAssociationSet.CidrBlockState.StatusMessage
      description: A message about the status of the CIDR block, if applicable.
      type: string
    description: Describes one or more of your VPCs.
  - name: aws-ec2-describe-subnets
    arguments:
    - name: filters
      description: One or more filters. See documetation for filters list.
    - name: subnetIds
      description: One or more subnet IDs. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Subnets.AvailabilityZone
      description: The Availability Zone of the subnet.
      type: string
    - contextPath: AWS.EC2.Subnets.AvailableIpAddressCount
      description: The number of unused private IPv4 addresses in the subnet. Note
        that the IPv4 addresses for any stopped instances are considered unavailable.
      type: number
    - contextPath: AWS.EC2.Subnets.CidrBlock
      description: The IPv4 CIDR block assigned to the subnet.
      type: string
    - contextPath: AWS.EC2.Subnets.DefaultForAz
      description: Indicates whether this is the default subnet for the Availability
        Zone.
      type: boolean
    - contextPath: AWS.EC2.Subnets.MapPublicIpOnLaunch
      description: Indicates whether instances launched in this subnet receive a public
        IPv4 address.
      type: boolean
    - contextPath: AWS.EC2.Subnets.State
      description: The current state of the subnet.
      type: string
    - contextPath: AWS.EC2.Subnets.SubnetId
      description: The ID of the subnet.
      type: string
    - contextPath: AWS.EC2.Subnets.VpcId
      description: The ID of the VPC the subnet is in.
      type: string
    - contextPath: AWS.EC2.Subnets.AssignIpv6AddressOnCreation
      description: Indicates whether a network interface created in this subnet (including
        a network interface created by RunInstances) receives an IPv6 address.
      type: boolean
    - contextPath: AWS.EC2.Subnets.Ipv6CidrBlockAssociationSet.AssociationId
      description: The association ID for the CIDR block.
      type: string
    - contextPath: AWS.EC2.Subnets.Ipv6CidrBlockAssociationSet.Ipv6CidrBlock
      description: The IPv6 CIDR block.
      type: string
    - contextPath: AWS.EC2.Subnets.Ipv6CidrBlockAssociationSet.Ipv6CidrBlockState.State
      description: The state of a CIDR block.
      type: string
    - contextPath: AWS.EC2.Subnets.Ipv6CidrBlockAssociationSet.Ipv6CidrBlockState.StatusMessage
      description: A message about the status of the CIDR block, if applicable.
      type: string
    - contextPath: AWS.EC2.Subnets.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Subnets.Tags.Value
      description: The value of the tag.
      type: string
    description: Describes one or more of your subnets.
  - name: aws-ec2-describe-security-groups
    arguments:
    - name: filters
      description: One or more filters. See documetation for filters list.
    - name: groupIds
      description: One or more security group IDs. Required for security groups in
        a nondefault VPC. Sepereted by comma.
    - name: groupNames
      description: One or more security group names. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.SecurityGroups.Description
      description: A description of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.FromPort
      description: The start of port range for the TCP and UDP protocols, or an ICMP/ICMPv6
        type number. A value of -1 indicates all ICMP/ICMPv6 types.
      type: number
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.IpProtocol
      description: The IP protocol name (tcp , udp , icmp ) or number.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.IpRanges.CidrIp
      description: The IPv4 CIDR range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.IpRanges.Description
      description: A description for the security group rule that references this
        IPv4 address range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.Ipv6Ranges.CidrIpv6
      description: The IPv6 CIDR range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.Ipv6Ranges.Description
      description: A description for the security group rule that references this
        IPv6 address range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.PrefixListIds.Description
      description: A description for the security group rule that references this
        prefix list ID.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.PrefixListIds.PrefixListId
      description: The ID of the prefix.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.ToPort
      description: The end of port range for the TCP and UDP protocols, or an ICMP/ICMPv6
        code.
      type: number
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.Description
      description: A description for the security group rule that references this
        user ID group pair.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.PeeringStatus
      description: The status of a VPC peering connection, if applicable.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.UserId
      description: The ID of an AWS account.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.VpcId
      description: The ID of the VPC for the referenced security group, if applicable.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissions.UserIdGroupPairs.VpcPeeringConnectionId
      description: The ID of the VPC peering connection, if applicable.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.OwnerId
      description: The AWS account ID of the owner of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.FromPort
      description: The start of port range for the TCP and UDP protocols, or an ICMP/ICMPv6
        type number.
      type: number
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.IpProtocol
      description: The IP protocol name (tcp , udp , icmp) or number.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.IpRanges.CidrIp
      description: The IPv4 CIDR range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.IpRanges.Description
      description: A description for the security group rule that references this
        IPv4 address range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.Ipv6Ranges.CidrIpv6
      description: The IPv6 CIDR range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.Ipv6Ranges.Description
      description: A description for the security group rule that references this
        IPv6 address range.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.PrefixListIds.Description
      description: A description for the security group rule that references this
        prefix list ID.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.PrefixListIds.PrefixListId
      description: The ID of the prefix.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.ToPort
      description: The end of port range for the TCP and UDP protocols, or an ICMP/ICMPv6
        code.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.Description
      description: A description for the security group rule that references this
        user ID group pair.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.PeeringStatus
      description: The status of a VPC peering connection, if applicable.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.UserId
      description: The ID of an AWS account.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.VpcId
      description: The ID of the VPC for the referenced security group, if applicable.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.IpPermissionsEgress.UserIdGroupPairs.VpcPeeringConnectionId
      description: The ID of the VPC peering connection, if applicable.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.VpcId
      description: The ID of the VPC for the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.Tags.Value
      description: The value of the tag.
      type: string
    description: Describes one or more of your security groups.
  - name: aws-ec2-allocate-address
    arguments:
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.ElasticIPs.PublicIp
      description: The Elastic IP address.
    - contextPath: AWS.EC2.ElasticIPs.AllocationId
      description: The ID that AWS assigns to represent the allocation of the Elastic
        IP address for use with instances in a VPC.
      type: string
    - contextPath: AWS.EC2.ElasticIPs.Domain
      description: Indicates whether this Elastic IP address is for use with instances
        in EC2-Classic (standard ) or instances in a VPC (vpc).
      type: string
    - contextPath: AWS.EC2.ElasticIPs.Region
      description: The aws region where the elastic IP is located.
    description: Allocates an Elastic IP address.
  - name: aws-ec2-associate-address
    arguments:
    - name: allocationId
      required: true
      description: The allocation ID.
    - name: instanceId
      description: The ID of the instance. For EC2-VPC, you can specify either the
        instance ID or the network interface ID, but not both. The operation fails
        if you specify an instance ID unless exactly one network interface is attached.
    - name: allowReassociation
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: For a VPC in an EC2-Classic account, specify true to allow an Elastic
        IP address that is already associated with an instance or network interface
        to be reassociated with the specified instance or network interface. Otherwise,
        the operation fails. In a VPC in an EC2-VPC-only account, reassociation is
        automatic, therefore you can specify false to ensure the operation fails if
        the Elastic IP address is already associated with another resource.
      defaultValue: "False"
    - name: networkInterfaceId
      description: The ID of the network interface. If the instance has more than
        one network interface, you must specify a network interface ID.
    - name: privateIpAddress
      description: The primary or secondary private IP address to associate with the
        Elastic IP address. If no private IP address is specified, the Elastic IP
        address is associated with the primary private IP address.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.ElasticIPs.AssociationId
      description: The ID that represents the association of the Elastic IP address
        with an instance.
      type: string
    description: Associates an Elastic IP address with an instance or a network interface.
  - name: aws-ec2-create-snapshot
    arguments:
    - name: volumeId
      required: true
      description: The ID of the EBS volume.
    - name: description
      description: A description for the snapshot.
    - name: tags
      description: The tags to apply to the snapshot during creation.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Snapshots.DataEncryptionKeyId
      description: The data encryption key identifier for the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.Description
      description: The description for the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.Encrypted
      description: Indicates whether the snapshot is encrypted.
      type: number
    - contextPath: AWS.EC2.Snapshots.KmsKeyId
      description: The full ARN of the AWS Key Management Service (AWS KMS) customer
        master key (CMK) that was used to protect the volume encryption key for the
        parent volume.
      type: string
    - contextPath: AWS.EC2.Snapshots.OwnerId
      description: The AWS account ID of the EBS snapshot owner.
      type: string
    - contextPath: AWS.EC2.Snapshots.Progress
      description: The progress of the snapshot, as a percentage.
      type: string
    - contextPath: AWS.EC2.Snapshots.SnapshotId
      description: The ID of the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.StartTime
      description: The time stamp when the snapshot was initiated.
      type: date
    - contextPath: AWS.EC2.Snapshots.State
      description: The snapshot state.
      type: string
    - contextPath: AWS.EC2.Snapshots.StateMessage
      description: this field displays error state details to help you diagnose why
        the error occurred.
      type: string
    - contextPath: AWS.EC2.Snapshots.VolumeId
      description: The ID of the volume that was used to create the snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.VolumeSize
      description: The size of the volume, in GiB.
      type: number
    - contextPath: AWS.EC2.Snapshots.OwnerAlias
      description: Value from an Amazon-maintained list of snapshot owners.
      type: string
    - contextPath: AWS.EC2.Snapshots.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Snapshots.Tags.Value
      description: The value of the tag.
      type: string
    description: Creates a snapshot of an EBS volume and stores it in Amazon S3. You
      can use snapshots for backups, to make copies of EBS volumes, and to save data
      before shutting down an instance.
  - name: aws-ec2-delete-snapshot
    arguments:
    - name: snapshotId
      required: true
      description: The ID of the EBS snapshot.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified snapshot.
  - name: aws-ec2-create-image
    arguments:
    - name: name
      required: true
      description: A name for the new image.
    - name: instanceId
      required: true
      description: The ID of the instance.
    - name: description
      description: A description for the new image.
    - name: noReboot
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: By default, Amazon EC2 attempts to shut down and reboot the instance
        before creating the image. If the noReboot option is set, Amazon EC2 wont
        shut down the instance before creating the image. When this option is used,
        file system integrity on the created image cant be guaranteed.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Images.ImageId
      description: The ID of the new AMI.
      type: string
    - contextPath: AWS.EC2.Images.Name
      description: The name of the new AMI.
      type: string
    - contextPath: AWS.EC2.Images.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Images.Region
      description: The aws region where the image is located
      type: string
    description: Creates an Amazon EBS-backed AMI from an Amazon EBS-backed instance
      that is either running or stopped.
  - name: aws-ec2-deregister-image
    arguments:
    - name: imageId
      description: The ID of the AMI.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deregisters the specified AMI.
  - name: aws-ec2-modify-volume
    arguments:
    - name: volumeId
      required: true
      description: The ID of the volume.
    - name: size
      description: Target size in GiB of the volume to be modified.
    - name: volumeType
      description: Target EBS volume type of the volume to be modified  The API does
        not support modifications for volume type standard . You also cannot change
        the type of a volume to standard .
    - name: iops
      description: Target IOPS rate of the volume to be modified.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Volumes.Modification.VolumeId
      description: ID of the volume being modified.
      type: string
    - contextPath: AWS.EC2.Volumes.Modification.ModificationState
      description: Current state of modification. Modification state is null for unmodified.
        volumes.
      type: string
    - contextPath: AWS.EC2.Volumes.Modification.StatusMessage
      description: Generic status message on modification progress or failure.
      type: string
    - contextPath: AWS.EC2.Volumes.Modification.TargetSize
      description: Target size of the volume being modified.
      type: number
    - contextPath: AWS.EC2.Volumes.Modification.TargetIops
      description: Target IOPS rate of the volume being modified.
      type: number
    - contextPath: AWS.EC2.Volumes.Modification.TargetVolumeType
      description: Target EBS volume type of the volume being modified.
      type: string
    - contextPath: AWS.EC2.Volumes.Modification.OriginalSize
      description: Original size of the volume being modified.
      type: number
    - contextPath: AWS.EC2.Volumes.Modification.OriginalIops
      description: Original IOPS rate of the volume being modified.
      type: number
    - contextPath: AWS.EC2.Volumes.Modification.OriginalVolumeType
      description: Original EBS volume type of the volume being modified.
      type: string
    - contextPath: AWS.EC2.Volumes.Modification.Progress
      description: Modification progress from 0 to 100%.
      type: string
    - contextPath: AWS.EC2.Volumes.Modification.StartTime
      description: Modification start time.
      type: date
    - contextPath: AWS.EC2.Volumes.Modification.EndTime
      description: Modification completion or failure time.
      type: date
    description: You can modify several parameters of an existing EBS volume, including
      volume size, volume type, and IOPS capacity.
  - name: aws-ec2-create-tags
    arguments:
    - name: resources
      description: The IDs of one or more resources to tag. For example, ami-1a2b3c4d.
    - name: tags
      description: One or more tags.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Adds or overwrites one or more tags for the specified Amazon EC2
      resource or resources.
  - name: aws-ec2-disassociate-address
    arguments:
    - name: associationId
      required: true
      description: The association ID.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Disassociates an Elastic IP address from the instance or network
      interface its associated with.
  - name: aws-ec2-release-address
    arguments:
    - name: allocationId
      required: true
      description: The allocation ID.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Releases the specified Elastic IP address.
  - name: aws-ec2-start-instances
    arguments:
    - name: instanceIds
      required: true
      description: One or more instance IDs. Sepereted by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Starts an Amazon EBS-backed instance that you have previously stopped.
  - name: aws-ec2-stop-instances
    arguments:
    - name: instanceIds
      required: true
      description: One or more instance IDs.
    - name: region
      description: The AWS Region, if not specified the default region will be used
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Stops an Amazon EBS-backed instance.
  - name: aws-ec2-terminate-instances
    arguments:
    - name: instanceIds
      required: true
      description: One or more instance IDs.
    - name: region
      description: The AWS Region, if not specified the default region will be used
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Shuts down one or more instances. This operation is idempotent; if
      you terminate an instance more than once, each call succeeds.
  - name: aws-ec2-create-volume
    arguments:
    - name: availabilityZone
      required: true
      description: The Availability Zone in which to create the volume. Use DescribeAvailabilityZones
        to list the Availability Zones that are currently available to you.
    - name: encrypted
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether the volume should be encrypted.
    - name: iops
      description: The number of I/O operations per second (IOPS) to provision for
        the volume, with a maximum ratio of 50 IOPS/GiB. Range is 100 to 32000 IOPS
        for volumes in most regions.
    - name: kmsKeyId
      description: An identifier for the AWS Key Management Service (AWS KMS) customer
        master key (CMK) to use when creating the encrypted volume. This parameter
        is only required if you want to use a non-default CMK; if this parameter is
        not specified, the default CMK for EBS is used. If a KmsKeyId is specified,
        the Encrypted flag must also be set.
    - name: size
      description: The size of the volume, in GiBs.
    - name: snapshotId
      description: The snapshot from which to create the volume.
    - name: volumeType
      auto: PREDEFINED
      predefined:
      - standard
      - io1
      - gp2
      - sc1
      - st1
      description: The volume type.
    - name: tags
      description: One or more tags.Example key=Name,value=test;key=Owner,value=Bob
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Volumes.AvailabilityZone
      description: The Availability Zone for the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.CreateTime
      description: The time stamp when volume creation was initiated.
      type: date
    - contextPath: AWS.EC2.Volumes.Encrypted
      description: Indicates whether the volume will be encrypted.
      type: boolean
    - contextPath: AWS.EC2.Volumes.KmsKeyId
      description: The full ARN of the AWS Key Management Service (AWS KMS) customer
        master key (CMK) that was used to protect the volume encryption key for the
        volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Size
      description: The size of the volume, in GiBs.
      type: number
    - contextPath: AWS.EC2.Volumes.SnapshotId
      description: The snapshot from which the volume was created, if applicable.
      type: string
    - contextPath: AWS.EC2.Volumes.State
      description: The volume state.
      type: string
    - contextPath: AWS.EC2.Volumes.VolumeId
      description: The ID of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Iops
      description: The number of I/O operations per second (IOPS) that the volume
        supports.
      type: number
    - contextPath: AWS.EC2.Volumes.VolumeType
      description: The volume type. This can be gp2 for General Purpose SSD, io1 for
        Provisioned IOPS SSD, st1 for Throughput Optimized HDD, sc1 for Cold HDD,
        or standard for Magnetic volumes.
      type: string
    - contextPath: AWS.EC2.Volumes.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Volumes.Tags.Value
      description: The value of the tag.
      type: string
    description: Creates an EBS volume that can be attached to an instance in the
      same Availability Zone.
  - name: aws-ec2-attach-volume
    arguments:
    - name: device
      required: true
      description: The device name (for example, /dev/sdh or xvdh).
    - name: instanceId
      required: true
      description: The ID of the instance.
    - name: volumeId
      required: true
      description: The ID of the EBS volume. The volume and instance must be within
        the same Availability Zone.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Volumes.Attachments.AttachTime
      description: The time stamp when the attachment initiated.
      type: date
    - contextPath: AWS.EC2.Volumes.Attachments.Device
      description: The device name.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.State
      description: The attachment state of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.VolumeId
      description: The ID of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.DeleteOnTermination
      description: Indicates whether the EBS volume is deleted on instance termination.
      type: boolean
    description: Attaches an EBS volume to a running or stopped instance and exposes
      it to the instance with the specified device name.
  - name: aws-ec2-detach-volume
    arguments:
    - name: volumeId
      required: true
      description: The ID of the volume.
    - name: force
      description: Forces detachment if the previous detachment attempt did not occur
        cleanly. This option can lead to data loss or a corrupted file system. Use
        this option only as a last resort to detach a volume from a failed instance.
    - name: device
      description: The device name (for example, /dev/sdh or xvdh).
    - name: instanceId
      description: The ID of the instance.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Volumes.Attachments.AttachTime
      description: The time stamp when the attachment initiated.
      type: date
    - contextPath: AWS.EC2.Volumes.Attachments.Device
      description: The device name.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.State
      description: The attachment state of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.VolumeId
      description: The ID of the volume.
      type: string
    - contextPath: AWS.EC2.Volumes.Attachments.DeleteOnTermination
      description: Indicates whether the EBS volume is deleted on instance termination.
      type: boolean
    description: Detaches an EBS volume from an instance.
  - name: aws-ec2-delete-volume
    arguments:
    - name: volumeId
      required: true
      description: The ID of the volume.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes the specified EBS volume. The volume must be in the available
      state (not attached to an instance).
  - name: aws-ec2-run-instances
    arguments:
    - name: count
      required: true
      description: The number of instances to launch. must be grater then 0.
      defaultValue: "1"
    - name: imageId
      description: The ID of the AMI, which you can get by calling DescribeImages
        . An AMI is required to launch an instance and must be specified here or in
        a launch template.
    - name: instanceType
      description: 'The instance type. for example: t2.large'
    - name: securityGroupIds
      description: One or more security group IDs. Sepereted by comma.
    - name: securityGroups
      description: One or more security group names. For a nondefault VPC, you must
        use security group IDs instead.
    - name: subnetId
      description: The ID of the subnet to launch the instance into.
    - name: userData
      description: The user data to make available to the instance.This value will
        be base64 encoded automatically. Do not base64 encode this value prior to
        performing the operation.
    - name: disableApiTermination
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: If you set this parameter to true , you cant terminate the instance
        using the Amazon EC2 console, CLI, or API.
    - name: iamInstanceProfileArn
      description: The Amazon Resource Name (ARN) of the instance profile. Both iamInstanceProfileArn
        and iamInstanceProfile are required if you would like to associate an instance
        profile.
    - name: iamInstanceProfileName
      description: The name of the instance profile. Both iamInstanceProfileArn and
        iamInstanceProfile are required if you would like to associate an instance
        profile.
    - name: keyName
      description: The name of the key pair. Warning - If you do not specify a key
        pair, you cant connect to the instance unless you choose an AMI that is configured
        to allow users another way to log in.
    - name: ebsOptimized
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Indicates whether the instance is optimized for Amazon EBS I/O.
    - name: deviceName
      description: The device name (for example, /dev/sdh or xvdh).
    - name: ebsVolumeSize
      description: The size of the volume, in GiB.
    - name: ebsVolumeType
      auto: PREDEFINED
      predefined:
      - gp2
      - io1
      - st1
      - sc1
      - standard
      description: The volume type.
    - name: ebsIops
      description: The number of I/O operations per second (IOPS) that the volume
        supports.
    - name: ebsDeleteOnTermination
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Indicates whether the EBS volume is deleted on instance termination.
    - name: ebsKmsKeyId
      description: Identifier (key ID, key alias, ID ARN, or alias ARN) for a user-managed
        CMK under which the EBS volume is encrypted.
    - name: ebsSnapshotId
      description: The ID of the snapshot.
    - name: ebsEncrypted
      description: Indicates whether the EBS volume is encrypted.
    - name: launchTemplateId
      description: The ID of the launch template. The launch template to use to launch
        the instances. Any parameters that you specify in RunInstances override the
        same parameters in the launch template. You can specify either the name or
        ID of a launch template, but not both.
    - name: launchTemplateName
      description: The name of the launch template. The launch template to use to
        launch the instances. Any parameters that you specify in RunInstances override
        the same parameters in the launch template. You can specify either the name
        or ID of a launch template, but not both.
    - name: launchTemplateVersion
      description: The version number of the launch template.
    - name: tags
      description: The tags to apply to the instance.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Instances.AmiLaunchIndex
      description: The AMI launch index, which can be used to find this instance in
        the launch group.
      type: number
    - contextPath: AWS.EC2.Instances.ImageId
      description: The ID of the AMI used to launch the instance.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceType
      description: The instance type.
      type: string
    - contextPath: AWS.EC2.Instances.KernelId
      description: The kernel associated with this instance, if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.KeyName
      description: The name of the key pair, if this instance was launched with an
        associated key pair.
      type: string
    - contextPath: AWS.EC2.Instances.LaunchTime
      description: The time the instance was launched.
      type: date
    - contextPath: AWS.EC2.Instances.Monitoring.State
      description: Indicates whether detailed monitoring is enabled. Otherwise, basic
        monitoring is enabled.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.AvailabilityZone
      description: The Availability Zone of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.Affinity
      description: The affinity setting for the instance on the Dedicated Host.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.GroupName
      description: The name of the placement group the instance is in (for cluster
        compute instances).
      type: string
    - contextPath: AWS.EC2.Instances.Placement.HostId
      description: he ID of the Dedicated Host on which the instance resides.
      type: string
    - contextPath: AWS.EC2.Instances.Placement.Tenancy
      description: The tenancy of the instance (if the instance is running in a VPC).
      type: string
    - contextPath: AWS.EC2.Instances.Platform
      description: The value is Windows for Windows instances; otherwise blank.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateDnsName
      description: (IPv4 only) The private DNS hostname name assigned to the instance.
        This DNS hostname can only be used inside the Amazon EC2 network. This name
        is not available until the instance enters the running state.
      type: string
    - contextPath: AWS.EC2.Instances.PrivateIpAddress
      description: The private IPv4 address assigned to the instance.
      type: string
    - contextPath: AWS.EC2.Instances.ProductCodes.ProductCodeId
      description: The product code.
      type: string
    - contextPath: AWS.EC2.Instances.ProductCodes.ProductCodeType
      description: The type of product code.
      type: string
    - contextPath: AWS.EC2.Instances.PublicDnsName
      description: (IPv4 only) The public DNS name assigned to the instance. This
        name is not available until the instance enters the running state.
      type: string
    - contextPath: AWS.EC2.Instances.PublicIpAddress
      description: The public IPv4 address assigned to the instance, if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.RamdiskId
      description: The RAM disk associated with this instance, if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.State.Code
      description: The low byte represents the state.
      type: string
    - contextPath: AWS.EC2.Instances.State.Name
      description: The current state of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.StateTransitionReason
      description: The reason for the most recent state transition. This might be
        an empty string.
      type: string
    - contextPath: AWS.EC2.Instances.SubnetId
      description: The ID of the subnet in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.VpcId
      description: The ID of the VPC in which the instance is running.
      type: string
    - contextPath: AWS.EC2.Instances.Architecture
      description: The architecture of the image.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.DeviceName
      description: The device name (for example, /dev/sdh or xvdh).
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.AttachTime
      description: The time stamp when the attachment initiated.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.DeleteOnTermination
      description: Indicates whether the volume is deleted on instance termination.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.Status
      description: The attachment state.
      type: string
    - contextPath: AWS.EC2.Instances.BlockDeviceMappings.Ebs.VolumeId
      description: The ID of the EBS volume.
      type: string
    - contextPath: AWS.EC2.Instances.ClientToken
      description: The idempotency token you provided when you launched the instance,
        if applicable.
      type: string
    - contextPath: AWS.EC2.Instances.EbsOptimized
      description: Indicates whether the instance is optimized for Amazon EBS I/O.
      type: boolean
    - contextPath: AWS.EC2.Instances.EnaSupport
      description: Specifies whether enhanced networking with ENA is enabled.
      type: boolean
    - contextPath: AWS.EC2.Instances.Hypervisor
      description: The hypervisor type of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.IamInstanceProfile.Arn
      description: The Amazon Resource Name (ARN) of the instance profile.
      type: string
    - contextPath: AWS.EC2.Instances.IamInstanceProfile.Id
      description: The ID of the instance profile.
      type: string
    - contextPath: AWS.EC2.Instances.InstanceLifecycle
      description: Indicates whether this is a Spot Instance or a Scheduled Instance.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuId
      description: The ID of the Elastic GPU.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuAssociationId
      description: The ID of the association.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuAssociationState
      description: The state of the association between the instance and the Elastic
        GPU.
      type: string
    - contextPath: AWS.EC2.Instances.ElasticGpuAssociations.ElasticGpuAssociationTime
      description: The time the Elastic GPU was associated with the instance.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Association.IpOwnerId
      description: The ID of the owner of the Elastic IP address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Association.PublicDnsName
      description: The public DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Association.PublicIp
      description: The public IP address or Elastic IP address bound to the network
        interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.AttachTime
      description: The time stamp when the attachment initiated.
      type: date
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.AttachmentId
      description: The ID of the network interface attachment.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.DeleteOnTermination
      description: Indicates whether the network interface is deleted when the instance
        is terminated.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.DeviceIndex
      description: The index of the device on the instance for the network interface
        attachment.
      type: number
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Attachment.Status
      description: The attachment state.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Description
      description: The description.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Groups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Groups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Ipv6Addresses.Ipv6Address
      description: The IPv6 addresses associated with the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.MacAddress
      description: The MAC address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.NetworkInterfaceId
      description: The ID of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.OwnerId
      description: The ID of the AWS account that created the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateDnsName
      description: The private DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress
      description: The IPv4 address of the network interface within the subnet.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Association.IpOwnerId
      description: The ID of the owner of the Elastic IP address.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Association.PublicDnsName
      description: The public DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Association.PublicIp
      description: The public IP address or Elastic IP address bound to the network
        interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.Primary
      description: Indicates whether this IPv4 address is the primary private IP address
        of the network interface.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.PrivateDnsName
      description: The private IPv4 DNS name.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddresses.PrivateIpAddress
      description: The private IPv4 address of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.SourceDestCheck
      description: Indicates whether to validate network traffic to or from this network
        interface.
      type: boolean
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.Status
      description: The status of the network interface.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.SubnetId
      description: The ID of the subnet.
      type: string
    - contextPath: AWS.EC2.Instances.NetworkInterfaces.VpcId
      description: The ID of the VPC.
      type: string
    - contextPath: AWS.EC2.Instances.RootDeviceName
      description: The device name of the root device volume (for example, /dev/sda1).
      type: string
    - contextPath: AWS.EC2.Instances.RootDeviceType
      description: The root device type used by the AMI. The AMI can use an EBS volume
        or an instance store volume.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.SecurityGroups.GroupId
      description: The ID of the security group.
      type: string
    - contextPath: AWS.EC2.Instances.SourceDestCheck
      description: Specifies whether to enable an instance launched in a VPC to perform
        NAT.
      type: boolean
    - contextPath: AWS.EC2.Instances.SpotInstanceRequestId
      description: If the request is a Spot Instance request, the ID of the request.
      type: string
    - contextPath: AWS.EC2.Instances.SriovNetSupport
      description: Specifies whether enhanced networking with the Intel 82599 Virtual
        Function interface is enabled.
      type: string
    - contextPath: AWS.EC2.Instances.StateReason.Code
      description: The reason code for the state change.
      type: string
    - contextPath: AWS.EC2.Instances.StateReason.Message
      description: The message for the state change.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Instances.VirtualizationType
      description: The virtualization type of the instance.
      type: string
    description: Launches the specified number of instances using an AMI for which
      you have permissions. You can create a launch template , which is a resource
      that contains the parameters to launch an instance. When you launch an instance
      using RunInstances , you can specify the launch template instead of specifying
      the launch parameters. An instance is ready for you to use when its in the running
      state. You can check the state of your instance using DescribeInstances.
  - name: aws-ec2-waiter-instance-running
    arguments:
    - name: filter
      description: One or more filters. See documentation for details & filter options.
    - name: instanceIds
      description: One or more instance IDs. Sepreted by comma.
    - name: waiterDelay
      description: The amount of time in seconds to wait between attempts. Default
        15
    - name: waiterMaxAttempts
      description: The maximum number of attempts to be made. Default 40
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: A waiter function that runs every 15  seconds until a successful
      state is reached.
  - name: aws-ec2-waiter-instance-status-ok
    arguments:
    - name: filter
      description: One or more filters. See documentation for details & filter options.
    - name: instanceIds
      description: One or more instance IDs. Seprated by comma.
    - name: waiterDelay
      description: The amount of time in seconds to wait between attempts. Default
        15
    - name: waiterMaxAttempts
      description: The maximum number of attempts to be made. Default 40.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: A waiter function that runs every 15  seconds until a successful
      state is reached
  - name: aws-ec2-waiter-instance-stopped
    arguments:
    - name: filter
      description: One or more filters. See documentation for details & filter options.
    - name: instanceIds
      description: One or more instance IDs. Seprated by comma.
    - name: waiterDelay
      description: The amount of time in seconds to wait between attempts. Default
        15
    - name: waiterMaxAttempts
      description: The maximum number of attempts to be made. Default 40
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: A waiter function that runs every 15  seconds until a successful
      state is reached
  - name: aws-ec2-waiter-instance-terminated
    arguments:
    - name: filter
      description: One or more filters. See documentation for details & filter options.
    - name: instanceIds
      description: One or more instance IDs. Seprated by comma.
    - name: waiterDelay
      description: The amount of time in seconds to wait between attempts. Default
        15
    - name: waiterMaxAttempts
      description: The maximum number of attempts to be made. Default 40
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: A waiter function that runs every 15  seconds until a successful
      state is reached
  - name: aws-ec2-waiter-image-available
    arguments:
    - name: filters
      description: One or more filters. See documentation for available filters.
    - name: imageIds
      description: One or more image IDs. Sperated by comma.
    - name: owners
      description: Filters the images by the owner. Specify an AWS account ID, self
        (owner is the sender of the request), or an AWS owner alias (valid values
        are amazon | aws-marketplace | microsoft ). Omitting this option returns all
        images for which you have launch permissions, regardless of ownership.
    - name: executableUsers
      description: Scopes the images by users with explicit launch permissions. Specify
        an AWS account ID, self (the sender of the request), or all (public AMIs).
    - name: waiterDelay
      description: The amount of time in seconds to wait between attempts. Default
        15
    - name: waiterMaxAttempts
      description: The maximum number of attempts to be made. Default 40
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: A waiter function that waits until image is avilable
  - name: aws-ec2-waiter-snapshot_completed
    arguments:
    - name: filters
      description: One or more filters. See documentation for available filters.
    - name: ownerIds
      description: Returns the snapshots owned by the specified owner. Multiple owners
        can be specified. Sperated by comma.
    - name: snapshotIds
      description: One or more snapshot IDs. Sperated by comma.
    - name: restorableByUserIds
      description: One or more AWS accounts IDs that can create volumes from the snapshot.
    - name: waiterDelay
      description: The amount of time in seconds to wait between attempts. Default
        15
    - name: waiterMaxAttempts
      description: The maximum number of attempts to be made. Default 40
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: A waiter function that waits until the snapshot is complate
  - name: aws-ec2-get-latest-ami
    arguments:
    - name: filters
      description: One or more filters. See documentation for available filters.
    - name: owners
      description: Filters the images by the owner. Specify an AWS account ID, self
        (owner is the sender of the request), or an AWS owner alias (valid values
        are amazon | aws-marketplace | microsoft ). Omitting this option returns all
        images for which you have launch permissions, regardless of ownership.
    - name: executableUsers
      description: Scopes the images by users with explicit launch permissions. Specify
        an AWS account ID, self (the sender of the request), or all (public AMIs).
    - name: region
      description: The AWS Region, if not specified the default region will be used
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Images.Architecture
      description: The architecture of the image.
      type: string
    - contextPath: AWS.EC2.Images.CreationDate
      description: The date and time the image was created.
      type: date
    - contextPath: AWS.EC2.Images.ImageId
      description: The ID of the AMI.
      type: string
    - contextPath: AWS.EC2.Images.ImageLocation
      description: The location of the AMI.
      type: string
    - contextPath: AWS.EC2.Images.ImageType
      description: The type of image.
      type: string
    - contextPath: AWS.EC2.Images.Public
      description: Indicates whether the image has public launch permissions. The
        value is true if this image has public launch permissions or false if it has
        only implicit and explicit launch permissions.
      type: boolean
    - contextPath: AWS.EC2.Images.KernelId
      description: The kernel associated with the image, if any. Only applicable for
        machine images.
      type: string
    - contextPath: AWS.EC2.Images.OwnerId
      description: The AWS account ID of the image owner.
      type: string
    - contextPath: AWS.EC2.Images.Platform
      description: The value is Windows for Windows AMIs; otherwise blank.
      type: string
    - contextPath: AWS.EC2.Images.ProductCodes.ProductCodeId
      description: The product code.
      type: string
    - contextPath: AWS.EC2.Images.ProductCodes.ProductCodeType
      description: The type of product code.
      type: string
    - contextPath: AWS.EC2.Images.RamdiskId
      description: The RAM disk associated with the image, if any. Only applicable
        for machine images.
      type: string
    - contextPath: AWS.EC2.Images.State
      description: The current state of the AMI. If the state is available , the image
        is successfully registered and can be used to launch an instance.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.DeviceName
      description: The device name (for example, /dev/sdh or xvdh ).
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.VirtualName
      description: The virtual device name (ephemeral N).
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.Encrypted
      description: Indicates whether the EBS volume is encrypted.
      type: boolean
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.DeleteOnTermination
      description: Indicates whether the EBS volume is deleted on instance termination.
      type: boolean
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.Iops
      description: The number of I/O operations per second (IOPS) that the volume
        supports.
      type: number
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.KmsKeyId
      description: Identifier (key ID, key alias, ID ARN, or alias ARN) for a user-managed
        CMK under which the EBS volume is encrypted.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.SnapshotId
      description: The ID of the snapshot.
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.VolumeSize
      description: The size of the volume, in GiB.
      type: number
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.Ebs.VolumeType
      description: The volume type
      type: string
    - contextPath: AWS.EC2.Images.BlockDeviceMappings.NoDevice
      description: Suppresses the specified device included in the block device mapping
        of the AMI.
      type: string
    - contextPath: AWS.EC2.Images.Description
      description: The description of the AMI that was provided during image creation.
      type: string
    - contextPath: AWS.EC2.Images.EnaSupport
      description: Specifies whether enhanced networking with ENA is enabled.
      type: boolean
    - contextPath: AWS.EC2.Images.Hypervisor
      description: The hypervisor type of the image.
      type: string
    - contextPath: AWS.EC2.Images.ImageOwnerAlias
      description: The AWS account alias (for example, amazon , self ) or the AWS
        account ID of the AMI owner.
      type: string
    - contextPath: AWS.EC2.Images.Name
      description: The name of the AMI that was provided during image creation.
      type: string
    - contextPath: AWS.EC2.Images.RootDeviceName
      description: The device name of the root device volume (for example, /dev/sda1).
      type: string
    - contextPath: AWS.EC2.Images.RootDeviceType
      description: The type of root device used by the AMI. The AMI can use an EBS
        volume or an instance store volume.
      type: string
    - contextPath: AWS.EC2.Images.SriovNetSupport
      description: Specifies whether enhanced networking with the Intel 82599 Virtual
        Function interface is enabled.
      type: string
    - contextPath: AWS.EC2.Images.StateReason.Code
      description: The reason code for the state change.
      type: string
    - contextPath: AWS.EC2.Images.StateReason.Message
      description: The message for the state change.
      type: string
    - contextPath: AWS.EC2.Images.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.Images.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.Images.VirtualizationType
      description: The type of virtualization of the AMI.
      type: string
    description: Get The latest AMI
  - name: aws-ec2-create-security-group
    arguments:
    - name: groupName
      required: true
      description: The name of the security group.
    - name: description
      required: true
      description: A description for the security group.
    - name: vpcId
      required: true
      description: The ID of the VPC.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.SecurityGroups.GroupName
      description: The name of the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.Description
      description: A description for the security group.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.VpcId
      description: The ID of the VPC.
      type: string
    - contextPath: AWS.EC2.SecurityGroups.GroupId
      description: The ID of the security group.
      type: string
    description: Creates a security group.
  - name: aws-ec2-delete-security-group
    arguments:
    - name: groupId
      description: The ID of the security group. Required for a nondefault VPC.
    - name: groupName
      description: default VPC only.  The name of the security group. You can specify
        either the security group name or the security group ID.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Deletes a security group.
  - name: aws-ec2-authorize-security-group-ingress-rule
    arguments:
    - name: groupId
      required: true
      description: The ID of the security group. You must specify either the security
        group ID or the security group name in the request. For security groups in
        a nondefault VPC, you must specify the security group ID.
    - name: fromPort
      description: The start of port range for the TCP and UDP protocols.
    - name: toPort
      description: The end of port range for the TCP and UDP protocols.
    - name: cidrIp
      description: The CIDR IPv4 address range.
    - name: ipProtocol
      description: The IP protocol name (tcp , udp , icmp) or number.  Use -1 to specify
        all protocols.
    - name: sourceSecurityGroupName
      description: The name of the source security group. The source security group
        must be in the same VPC.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Adds ingress rule to a security group.
  - name: aws-ec2-revoke-security-group-ingress-rule
    arguments:
    - name: groupId
      required: true
      description: The ID of the security group.
    - name: fromPort
      description: The start of port range for the TCP and UDP protocols.
    - name: toPort
      description: The end of port range for the TCP and UDP protocols.
    - name: cidrIp
      description: The CIDR IPv4 address range.
    - name: ipProtocol
      description: The IP protocol name (tcp , udp , icmp) or number.  Use -1 to specify
        all protocols.
    - name: sourceSecurityGroupName
      description: The name of the source security group. The source security group
        must be in the same VPC.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Removes egress rule from a security group. To remove a rule, the
      values that you specify (for example, ports) must match the existing rule's
      values exactly.
  - name: aws-ec2-copy-image
    arguments:
    - name: name
      required: true
      description: The name of the new AMI in the destination region.
    - name: sourceImageId
      required: true
      description: The ID of the AMI to copy.
    - name: sourceRegion
      required: true
      description: The name of the region that contains the AMI to copy.
    - name: description
      description: A description for the new AMI in the destination region.
    - name: encrypted
      auto: PREDEFINED
      predefined:
      - "True"
      - "False"
      description: Specifies whether the destination snapshots of the copied image
        should be encrypted. The default CMK for EBS is used unless a non-default
        AWS Key Management Service (AWS KMS) CMK is specified with KmsKeyId .
    - name: kmsKeyId
      description: An identifier for the AWS Key Management Service (AWS KMS) customer
        master key (CMK) to use when creating the encrypted volume. This parameter
        is only required if you want to use a non-default CMK; if this parameter is
        not specified, the default CMK for EBS is used. If a KmsKeyId is specified,
        the Encrypted flag must also be set.
    - name: clientToken
      description: nique, case-sensitive identifier you provide to ensure idempotency
        of the request.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Images.ImageId
      description: The ID of the new AMI.
      type: string
    - contextPath: AWS.EC2.Images.Region
      description: The Region where the image is located.
      type: string
    description: Initiates the copy of an AMI from the specified source region to
      the current region.
  - name: aws-ec2-copy-snapshot
    arguments:
    - name: sourceSnapshotId
      required: true
      description: The ID of the EBS snapshot to copy.
    - name: sourceRegion
      required: true
      description: The ID of the region that contains the snapshot to be copied.
    - name: description
      description: A description for the EBS snapshot.
    - name: encrypted
      description: ' Specifies whether the destination snapshot should be encrypted.
        You can encrypt a copy of an unencrypted snapshot using this flag, but you
        cannot use it to create an unencrypted copy from an encrypted snapshot. Your
        default CMK for EBS is used unless a non-default AWS Key Management Service
        (AWS KMS) CMK is specified with KmsKeyId .'
    - name: kmsKeyId
      description: An identifier for the AWS Key Management Service (AWS KMS) customer
        master key (CMK) to use when creating the encrypted volume. This parameter
        is only required if you want to use a non-default CMK; if this parameter is
        not specified, the default CMK for EBS is used. If a KmsKeyId is specified,
        the Encrypted flag must also be set.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Snapshots.SnapshotId
      description: The ID of the new snapshot.
      type: string
    - contextPath: AWS.EC2.Snapshots.Region
      description: The Region where the snapshot is located.
      type: string
    description: Copies a point-in-time snapshot of an EBS volume and stores it in
      Amazon S3. You can copy the snapshot within the same region or from one region
      to another.
  - name: aws-ec2-describe-reserved-instances
    arguments:
    - name: filters
      description: ne or more filters.
    - name: reservedInstancesIds
      description: One or more Reserved Instance IDs. Separated by comma.
    - name: offeringClass
      auto: PREDEFINED
      predefined:
      - standard
      - convertible
      description: Describes whether the Reserved Instance is Standard or Convertible.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.ReservedInstances.AvailabilityZone
      description: The Availability Zone in which the Reserved Instance can be used.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.Duration
      description: The duration of the Reserved Instance, in seconds.
      type: number
    - contextPath: AWS.EC2.ReservedInstances.End
      description: The time when the Reserved Instance expires.
      type: date
    - contextPath: AWS.EC2.ReservedInstances.FixedPrice
      description: The purchase price of the Reserved Instance.
      type: number
    - contextPath: AWS.EC2.ReservedInstances.InstanceCount
      description: The number of reservations purchased.
      type: number
    - contextPath: AWS.EC2.ReservedInstances.InstanceType
      description: The instance type on which the Reserved Instance can be used.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.ProductDescription
      description: The Reserved Instance product platform description.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.ReservedInstancesId
      description: The ID of the Reserved Instance.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.Start
      description: The date and time the Reserved Instance started.
      type: date
    - contextPath: AWS.EC2.ReservedInstances.State
      description: The state of the Reserved Instance purchase.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.UsagePrice
      description: The usage price of the Reserved Instance, per hour.
      type: number
    - contextPath: AWS.EC2.ReservedInstances.CurrencyCode
      description: The currency of the Reserved Instance. It's specified using ISO
        4217 standard currency codes. At this time, the only supported currency is
        USD .
      type: string
    - contextPath: AWS.EC2.ReservedInstances.InstanceTenancy
      description: The tenancy of the instance.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.OfferingClass
      description: The offering class of the Reserved Instance.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.OfferingType
      description: The Reserved Instance offering type.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.RecurringCharges.Amount
      description: The amount of the recurring charge.
      type: number
    - contextPath: AWS.EC2.ReservedInstances.RecurringCharges.Frequency
      description: he frequency of the recurring charge.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.Scope
      description: The scope of the Reserved Instance.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.Tags.Key
      description: The key of the tag.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.Tags.Value
      description: The value of the tag.
      type: string
    - contextPath: AWS.EC2.ReservedInstances.Region
      description: The AWS region where the reserved instance is located.
      type: string
    description: Describes one or more of the Reserved Instances that you purchased.
  - name: aws-ec2-monitor-instances
    arguments:
    - name: instancesIds
      required: true
      description: One or more instance IDs. Separated by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Instances.InstanceId
      description: The ID of the instance.
      type: string
    - contextPath: AWS.EC2.Instances.Monitoring.State
      description: Indicates whether detailed monitoring is enabled. Otherwise, basic
        monitoring is enabled.
      type: string
    description: Enables detailed monitoring for a running instance.
  - name: aws-ec2-unmonitor-instances
    arguments:
    - name: instancesIds
      required: true
      description: One or more instance IDs. Separated by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    outputs:
    - contextPath: AWS.EC2.Instances.InstanceId
      description: The ID of the instance.
    - contextPath: AWS.EC2.Instances.Monitoring.State
      description: Indicates whether detailed monitoring is enabled. Otherwise, basic monitoring is enabled.
    description: Disables detailed monitoring for a running instance.
  - name: aws-ec2-reboot-instances
    arguments:
    - name: instanceIds
      required: true
      description: One or more instance IDs. Separated by comma.
    - name: region
      description: The AWS Region, if not specified the default region will be used.
    - name: roleArn
      description: The Amazon Resource Name (ARN) of the role to assume.
    - name: roleSessionName
      description: An identifier for the assumed role session.
    - name: roleSessionDuration
      description: The duration, in seconds, of the role session. The value can range
        from 900 seconds (15 minutes) up to the maximum session duration setting for
        the role.
    description: Requests a reboot of one or more instances. This operation is asynchronous;
      it only queues a request to reboot the specified instances. The operation succeeds
      if the instances are valid and belong to you. Requests to reboot terminated
      instances are ignored. If an instance does not cleanly shut down within four
      minutes, Amazon EC2 performs a hard reboot.
  dockerimage: demisto/boto3
  runonce: false
