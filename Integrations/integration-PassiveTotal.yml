commonfields:
  id: PassiveTotal
  version: -1
name: PassiveTotal
display: PassiveTotal
category: Data Enrichment
system: true
image: data:image/png;base64,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
description: Analyze and understand threat infrastructure from a variety of sources–passive
  DNS, active DNS, WHOIS, SSL certificates and more–without devoting resources to
  time-intensive manual threat research and analysis
configuration:
- display: Server URL
  name: ServerURL
  defaultvalue: https://api.passivetotal.org/
  type: 0
  required: false
- display: Username/API Key
  name: Username
  defaultvalue: ""
  type: 0
  required: true
- display: API Secret 
  name: APIKey
  defaultvalue: ""
  type: 4
  required: true
script:
  script: |-
    var serverUrl = params.ServerURL;
    if (serverUrl[serverUrl.length - 1] !== '/') {
        serverUrl += '/';
    }

    var doReq = function(method, path, parameters, body) {
        var result = http(
            serverUrl + path + encodeToURLQuery(parameters),
            {
                Headers: {'Content-Type': ['application/json']},
                Method: method,
                Username: params.Username,
                Password: params.APIKey,
                Body: body ? body : ''
            }
        );
        if (result.StatusCode !== 200 && result.StatusCode !== 201) {
            throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode + ', request body: ' + result.Body;
        }
        return result.Body;
    };

    var commandToPath = {
        'pt-get-subdomains': 'v2/enrichment/subdomains',
        'pt-account': 'v2/account',
        'pt-monitors': 'v2/account/monitors',
        'pt-passive-dns': 'v2/dns/passive',
        'pt-passive-unique': 'v2/dns/passive/unique',
        'pt-dns-keyword': 'v2/dns/search/keyword',
        'pt-enrichment': 'v2/enrichment',
        'pt-malware': 'v2/enrichment/malware',
        'pt-osint': 'v2/enrichment/osint',
        'pt-whois': 'v2/whois',
        'pt-whois-keyword': 'v2/whois/search/keyword',
        'pt-whois-search': 'v2/whois/search/keyword',
        'pt-get-components': 'v2/host-attributes/components',
        'pt-get-pairs': 'v2/host-attributes/pairs',
        'pt-ssl-cert': 'v2/ssl-certificate',
        'pt-ssl-cert-history': 'v2/ssl-certificate/history',
        'pt-ssl-cert-keyword': 'v2/ssl-certificate/search/keyword',
        'pt-ssl-cert-search': 'v2/ssl-certificate/search'
    };

    // This is the call made when pressing the integration test button.
    if (command === 'test-module') {
        var res = doReq('GET', 'v2/account');
        if (JSON.parse(res).username)
            return true;
        throw 'Unable to retrieve username';
    }
    var res = doReq('GET', commandToPath[command], args);
    var jsonRes = JSON.parse(res);
    // The command input arg holds the command sent from the user.
    switch (command) {
        case 'pt-get-subdomains':
            var md = '## Subdomains for ' + args.query + '\n';
            md += objToMd(jsonRes);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: {subdomains: jsonRes.subdomains}};
        case 'pt-account':
            var md = '## PassiveTotal Account\n';
            md += objToMd(jsonRes);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: {'passivetotal.username': jsonRes.username}};
        case 'pt-monitors':
            var md = '## PassiveTotal Monitors\n';
            md += arrToMd(jsonRes);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-passive-dns':
            var md = '## PassiveTotal Passive DNS for ' + args.query + ' [' + jsonRes.queryType + '] - total: ' + jsonRes.totalRecords + '\n';
            if (jsonRes.pager) {
                md += 'Pager:\n';
                md += objToMd(jsonRes.pager) + '\n';
            }
            var contextDomain = {Name: args.query, DNS: []};
            if (jsonRes.results && jsonRes.results.length > 0) {
                md += 'Query Type | First Seen | Last Seen\n';
                md += '---------- | ---------- | ---------\n';
                md += jsonRes.queryType + ' | ' + jsonRes.firstSeen + ' | ' + jsonRes.lastSeen + '\n\n';
                md += 'Source | Resolve | First Seen | Last Seen\n';
                md += '------ | ------- | ---------- | ---------\n';
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += jsonRes.results[i].source.join(',') + ' | ' + jsonRes.results[i].resolve + ' | ' + jsonRes.results[i].firstSeen + ' | ' + jsonRes.results[i].lastSeen + '\n';
                    if (jsonRes.queryType === 'domain') {
                        contextDomain.DNS.push({Address: jsonRes.results[i].resolve, FirstSeen: jsonRes.results[i].firstSeen, LastSeen: jsonRes.results[i].lastSeen});
                    }
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: {Domain: contextDomain}};
        case 'pt-passive-unique':
            var md = '## PassiveTotal Passive Unique DNS for ' + args.query + ' [' + jsonRes.queryType + '] - total: ' + jsonRes.total + '\n';
            if (jsonRes.pager) {
                md += 'Pager:\n';
                md += objToMd(jsonRes.pager) + '\n';
            }
            var contextDomain = {Name: args.query, DNS: []};
            if (jsonRes.results && jsonRes.results.length > 0) {
                var frequency = jsonRes.frequency.reduce(function(f, v) {f[v[0]] = v[1]; return f;}, {});
                md += 'Result | Frequency\n';
                md += '------ | ---------\n';
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += jsonRes.results[i] + ' | ' + frequency[jsonRes.results[i]] + '\n';
                    contextDomain.DNS.push({Address: jsonRes.results[i]});
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: {Domain: contextDomain}};
        case 'pt-dns-keyword':
            var md = '## PassiveTotal Passive DNS Keyword Query: ' + args.query + '\n';
            if (jsonRes.results && jsonRes.results.length > 0) {
                md += arrToMd(jsonRes.results);
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-enrichment':
            var md = '## PassiveTotal Metadata Enrichment for: ' + args.query + '\n';
            md += objToMd(jsonRes);
            var context = {};
            if (jsonRes.tags.indexOf('malware') >= 0) {
                if (jsonRes.queryType === 'domain') {
                    addMalicious(context, outputPaths.domain, {
                        Name: jsonRes.queryValue, Malicious: {Vendor: 'PassiveTotal', Description: 'Tagged as malware'}
                    });
                    context.dbotScore = {indicator: args.query, type: 'domain', vendor: 'PassiveTotal', score: 3}
                } else {
                    addMalicious(context, outputPaths.ip, {
                        Address: jsonRes.queryValue, Malicious: {Vendor: 'PassiveTotal', Description: 'Tagged as malware'}
                    });
                    context.dbotScore = {indicator: args.query, type: 'ip', vendor: 'PassiveTotal', score: 3}
                }
            } else {
                if (jsonRes.queryType === 'domain') {
                    context.dbotScore = {indicator: args.query, type: 'domain', vendor: 'PassiveTotal', score: 1}
                } else {
                    context.dbotScore = {indicator: args.query, type: 'ip', vendor: 'PassiveTotal', score: 1}
                }
            }
            var fullResult = [{Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: context}];
            if (jsonRes.queryType === 'ip' && jsonRes.latitude && jsonRes.longitude) {
                fullResult.push({Type: entryTypes.map, Contents: {lat: jsonRes.latitude, lng: jsonRes.longitude}, ContentsFormat: formats.json});
            }
            return fullResult;
        case 'pt-malware':
            var md = '## PassiveTotal Malware Report for: ' + args.query + '\n';
            var context = {};
            if (!args.threshold) {
                args.threshold = 10;
            }
            if (!args.samples) {
                args.samples = 10;
            }
            var samples = [];
            if (jsonRes.results && jsonRes.results.length > 0) {
                // Sort based on date to display the latest
                jsonRes.results.sort(function(a, b) {
                    if (a.collectionDate < b.collectionDate) {
                        return 1;
                    } else if (a.collectionDate > b.collectionDate) {
                        return -1;
                    }
                    return 0;
                });
                md += 'Source | Sample | Date\n';
                md += '------ | ------ | ----\n';
                for (var i=0; i<jsonRes.results.length && i<args.samples; i++) {
                    md += '[' + jsonRes.results[i].source + '](' + jsonRes.results[i].sourceUrl + ') | ' + jsonRes.results[i].sample + ' | ' + jsonRes.results[i].collectionDate + '\n';
                    samples.push(jsonRes.results[i].sample);
                }
                context[outputPaths.file] = [];
                for (var hash = 0; hash < samples.length; hash++) {
                    var hashType = samples[hash].length === 32 ? 'MD5' : samples[hash].length === 40 ? 'SHA1' : 'SHA256';
                    var hashObj = {Malicious: {Vendor: 'PassiveTotal', Description: 'Malware sample'}};
                    hashObj[hashType] = samples[hash];
                    var malFile = {};
                    addMalicious(malFile, outputPaths.file, hashObj);
                    context[outputPaths.file].push(malFile[outputPaths.file]);
                }

                var recentSampleCount = 0;
                var now = Date.now();
                for (var i=0; i<jsonRes.results.length; i++) {
                    var d = new Date(jsonRes.results[i].collectionDate.replace(' ', 'T'));
                    if ((now - d.getTime()) / 1000 / 60 / 60 / 24 < 30) {
                          recentSampleCount++;
                    } else {
                        break; // it is sorted
                    }
                }
                var dbotScore = 0;
                if (recentSampleCount >= args.threshold) {
                    dbotScore = 3;
                    if (isIp(args.query)) {
                        addMalicious(context, outputPaths.ip, {
                            Address: args.query, Malicious: {Vendor: 'PassiveTotal', Description: 'Recent sample count: ' + recentSampleCount}
                        });
                    } else {
                        addMalicious(context, outputPaths.domain, {
                            Name: args.query, Malicious: {Vendor: 'PassiveTotal', Description: 'Recent sample count: ' + recentSampleCount}
                        });
                    }
                } else if (recentSampleCount >= args.threshold / 2) {
                    dbotScore = 2;
                } else {
                    dbotScore = 1;
                }
                context.dbotScore = {indicator: args.query, type: 'domain', vendor: 'PassiveTotal', score: dbotScore};
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: context};
        case 'pt-osint':
            var md = '## PassiveTotal OSINT Report for: ' + args.query + '\n';
            if (jsonRes.results && jsonRes.results.length > 0) {
                md += 'Source | Report | Tags\n';
                md += '------ | ------ | ----\n';
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += '[' + jsonRes.results[i].source + '](' + jsonRes.results[i].sourceUrl + ') | ' + jsonRes.results[i].inReport.join(',') + ' | ' + jsonRes.results[i].tags.join(',') + '\n';
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-whois':
            var md = '## PassiveTotal WHOIS Query for: ' + args.query + '\n';
            md += objToMd(jsonRes);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md, EntryContext: {'passivetotal.whois.email': jsonRes.contactEmail}};
        case 'pt-whois-keyword':
            var md = '## PassiveTotal WHOIS Query by Keyword for: ' + args.query + '\n';
            if (jsonRes.results && jsonRes.results.length > 0) {
                md += 'Focus Point | Match Type | Field\n';
                md += '----------- | ---------- | -----\n';
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += jsonRes.results[i].focusPoint + ' | ' + jsonRes.results[i].matchType + ' | ' + jsonRes.results[i].fieldMatch + '\n';
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-whois-search':
            var md = '## PassiveTotal WHOIS Query by Field Matching for: ' + args.field + '=' + args.query + '\n';
            if (jsonRes.results && jsonRes.results.length > 0) {
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += "### Result from " + jsonRes.results[i].registrar + '\n';
                    md += objToMd(jsonRes.results[i]) + '\n';
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-get-components':
            var md = '## PassiveTotal Components for: ' + args.query + '\n';
            if (jsonRes.results && jsonRes.results.length > 0) {
                md += 'Category | Label | First Seen | Last Seen | Hostname\n';
                md += '-------- | ----- | ---------- | --------- | --------\n';
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += jsonRes.results[i].category + ' | ' + jsonRes.results[i].label + ' | ' + jsonRes.results[i].firstSeen + ' | ' +
                        jsonRes.results[i].lastSeen + ' | ' + jsonRes.results[i].hostname + '\n';
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-get-pairs':
            var md = '## PassiveTotal Pairs for: ' + args.query + '\n';
            if (jsonRes.results && jsonRes.results.length > 0) {
                md += 'Parent | Child | Cause | First Seen | Last Seen\n';
                md += '------ | ----- | ----- | ---------- | ---------\n';
                for (var i=0; i<jsonRes.results.length; i++) {
                    md += jsonRes.results[i].parent + ' | ' + jsonRes.results[i].child + ' | ' + jsonRes.results[i].cause + ' | ' +
                        jsonRes.results[i].firstSeen + ' | ' + jsonRes.results[i].lastSeen + '\n';
                }
            } else {
                md += 'No results found!';
            }
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-ssl-cert':
            var md = '## PassiveTotal SSL Certificate for: ' + args.query + '\n';
            md += objToMd(jsonRes);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-ssl-cert-history':
            var md = '## PassiveTotal SSL Certificate History for: ' + args.query + '\n';
            md += arrToMd(jsonRes);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-ssl-cert-keyword':
            var md = '## PassiveTotal SSL Certificate by Keyword for: ' + args.query + '\n';
            md += arrToMd(jsonRes.results);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        case 'pt-ssl-cert-search':
            var md = '## PassiveTotal SSL Certificate Search for: ' + args.field + '=' + args.query + '\n';
            md += arrToMd(jsonRes.results);
            return {Type: entryTypes.note, Contents: res, ContentsFormat: formats.json, HumanReadable: md};
        default:
            throw 'Unknown command'; // should never happen
    }
  type: javascript
  commands:
  - name: pt-get-subdomains
    arguments:
    - name: query
      required: true
      description: The name of the domain to retrieve sub domains for
    outputs:
    - contextPath: subdomains
      description: List of subdomains as strings
    description: Get subdomains using a wildcard query.
  - name: pt-account
    arguments: []
    outputs:
    - contextPath: passivetotal.username
      description: Username / Key used for PassiveTotal
    description: Retrieve account details from PassiveTotal
  - name: pt-monitors
    arguments: []
    description: Get monitors associated with your account
  - name: pt-passive-dns
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    - name: direction
      description: 'Pagination direction: next or previous'
    - name: page
      description: Page ID to request
    - name: sources
      description: Comma seperated list of sources to process with
    - name: start
      description: 'Only show data starting from date: YYYY-mm-dd'
    - name: end
      description: 'Only show data up to date: YYYY-mm-dd'
    - name: timeout
      description: Timeout to use on all source requests
    outputs:
    - contextPath: Domain.Name
      description: The name of the queries domain
    - contextPath: Domain.DNS.Address
      description: The resolved address of the domain
    description: Get passive DNS data
  - name: pt-passive-unique
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    - name: direction
      description: 'Pagination direction: next or previous'
    - name: page
      description: Page ID to request
    - name: sources
      description: Comma seperated list of sources to process with
    - name: start
      description: 'Only show data starting from date: YYYY-mm-dd'
    - name: from
      description: 'Only show data up to date: YYYY-mm-dd'
    outputs:
    - contextPath: Domain.Name
      description: The name of the queries domain
    - contextPath: Domain.DNS.Address
      description: The resolved address of the domain
    description: Get unique resolutions from passive DNS data
  - name: pt-dns-keyword
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    description: Search DNS data for keywords
  - name: pt-enrichment
    arguments:
    - name: query
      required: true
      default: true
      description: The data to enrich
    outputs:
    - contextPath: IP.Address
      description: Bad IPs found during enrichment
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason for the vendor to make the decision
    - contextPath: Domain.Name
      description: Bad domains found during enrichment
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    important:
    - contextPath: IP(val.Malicious)
      description: Malicious IPs
    - contextPath: Domain(val.Malicious)
      description: Malicious Domains
    description: Enrich the given query with metadata
  - name: pt-malware
    arguments:
    - name: query
      required: true
      default: true
      description: The data to get malware for
    - name: samples
      required: false
      default: false
      description: The number of malware samples to return
      defaultValue: "10"
    - name: threshold
      required: false
      default: false
      description: Above this number of samples we will consider this to be malicious
      defaultValue: "10"
    outputs:
    - contextPath: IP.Address
      description: Bad IPs found during enrichment
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason for the vendor to make the decision
    - contextPath: Domain.Name
      description: Bad domains found during enrichment
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason for the vendor to make the decision
    - contextPath: File.MD5
      description: Bad hash MD5
    - contextPath: File.SHA1
      description: Bad hash SHA1
    - contextPath: File.SHA256
      description: Bad hash SHA256
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    important:
    - contextPath: File(val.Malicious)
      description: Malicious Files
    - contextPath: IP(val.Malicious)
      description: Malicious IPs
    - contextPath: Domain(val.Malicious)
      description: Malicious Domains
    description: Get malware data
  - name: pt-osint
    arguments:
    - name: query
      required: true
      default: true
      description: The data to get OSINT for
    description: Get opensource intelligence data
  - name: pt-whois
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    - name: compact_record
      description: Compress the WHOIS record into a deduplicated format - true or
        false
      defaultvalue: true
    outputs:
    - contextPath: passivetotal.whois.email
      description: Contact email for the queried domain
    description: Get WHOIS data for a domain or IP address
  - name: pt-whois-keyword
    arguments:
    - name: query
      required: true
      default: true
      description: Keyword to search WHOIS database
    description: Search WHOIS details based on keywords
  - name: pt-whois-search
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    - name: field
      required: true
      description: 'WHOIS field to execute the search on: domain, email, name, organization,
        address, phone, nameserver'
    description: Get WHOIS records based on field matching queries
  - name: pt-get-components
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    description: Get detailed information about a host
  - name: pt-get-pairs
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    - name: direction
      required: true
      default: false
      description: Relationship direction - parents, children.
      defaultvalue: children
    description: Get host pairs based on dependent requests observed in web crawls
  - name: pt-ssl-cert
    arguments:
    - name: query
      required: true
      default: true
      description: The SHA1 to retrieve SSL certificate data for
    description: Get the SSL certificate associated with the SHA-1
  - name: pt-ssl-cert-history
    arguments:
    - name: query
      required: true
      default: true
      description: The SHA1 or IP to retrieve SSL certificate data for
    description: Get the SSL certificate history associated with an IP address or
      SHA-1
  - name: pt-ssl-cert-keyword
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    description: Search for SSL certificates based on a keyword
  - name: pt-ssl-cert-search
    arguments:
    - name: query
      required: true
      default: true
      description: Query value to use in your request
    - name: field
      required: true
      description: 'Field to search against: issuerSurname, subjectOrganizationName,
        issuerCountry, issuerOrganizationUnitName, fingerprint, subjectOrganizationUnitName,
        serialNumber, subjectEmailAddress, subjectCountry, issuerGivenName, subjectCommonName,
        issuerCommonName, issuerStateOrProvinceName, issuerProvince, subjectStateOrProvinceName,
        sha1, sslVersion, subjectStreetAddress, subjectSerialNumber, issuerOrganizationName,
        subjectSurname, subjectLocalityName, issuerStreetAddress, issuerLocalityName,
        subjectGivenName, subjectProvince, issuerSerialNumber, issuerEmailAddress'
    description: Search for SSL certificates based on field values
