commonfields:
  id: GRR
  version: -1
name: GRR
display: GRR
category: Endpoint
image: data:image/png;base64,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
description: Use GRR Rapid Response framework
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Port
  name: port
  defaultvalue: "8000"
  type: 0
  required: false
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: |-
    var username = params.credentials.identifier;
    var password = params.credentials.password;
    var server = params.server + ':' + params.port;
    var insecure = params.insecure;
    var proxy = params.proxy;

    var getCSRFToken = function(url) {
        var res = http(
                url,
                {
                    Method: 'GET',
                    Username: username,
                    Password: password
                },
                insecure,
                proxy
            );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Failed to get CSRF token, request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
        }

        for (var ix in res.Cookies) {
            if (res.Cookies[ix].Name.toLowerCase() === 'csrftoken') {
                return res.Cookies[ix].Value;
            }
        }
        return 'Failed to get CSRF token, Please verify credentials and check GRR logs.';
    }

    var sendRequest = function(method, url, queryName, body) {
        var csrfToken = getCSRFToken(url);
        var res = http(
                url,
                {
                    Method: method,
                    Username: username,
                    Password: password,
                    Body: body,
                    Headers: {'X-CSRFToken': [csrfToken]},
                    Cookies: [{Name: 'csrftoken', Value: csrfToken, Path: '/', MaxAge: 300}]
                },
                insecure,
                proxy
            );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Failed to ' + (queryName || 'get main page') + ', request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';
        }
        return res.Body;
    }

    var parseJSON = function(raw){
        var output = null;
        var innerParse = function(i){
            var att = null;
            if(typeof i === 'object' && 'value' in i){
                if (typeof i.value === 'object'){
                    i = JSON.parse(JSON.stringify(i.value));
                }else {
                    i = i.value;
                }
            }

            if(typeof i === 'object'){
                att = {};
                for (var k in i){
                    if (k == "urn"){
                        if(typeof i[k] === 'object' && 'value' in i[k]){
                            if (typeof i[k].value === 'object'){
                                i[k] = JSON.parse(JSON.stringify(i[k].value));
                            }else {
                                i[k] = i[k].value;
                            }
                        }
                        if(typeof i[k] === 'string'){
                            var urn = i[k].split('/');
                            if (urn.length > 0){
                                att.id = urn[urn.length - 1];
                            }
                        }
                    }
                    if (typeof i[k] === 'object'){
                        att[k] = parseJSON(i[k]);
                    } else {
                        att[k] = i[k];
                    }
                }
            }
            else{
                att = i;
            }
            return att;
        }

        if(raw instanceof Array){
            output = [];
            raw.forEach(function(row){
                output.push(innerParse(row))
            })
        } else {
            output = innerParse(raw);
        }

        return output;
    }
    var getHunts = function(method, url, queryName, body, jsonPath, title) {
        var raw = JSON.parse(sendRequest(method, url, queryName, body).slice(5));
        var output = parseJSON(jsonPath ? dq(raw,jsonPath) : raw);

        if(!(output instanceof Array )){
            output = [output];
        }

        var context = { Hunt : [] };
        output.forEach(function(i){
            var huntEntity = {
                ID : i.id,
                Created : i.created,
                Creator : i.creator,
                Description : i.description,
                Expires : i.expires,
                IsRobot : i.is_robot,
                Name: i.name,
                State: i.state
            };

            context.Hunt.push(huntEntity);
        });

        return {
              Type: entryTypes.note,
              Contents: raw,
              ContentsFormat: formats.json,
              HumanReadable: tblToMd(title,output,argToList(args.headers)),
              EntryContext: context
          };
    };

    var getHunt = function(method, url, queryName, body, jsonPath, title) {
        var raw = JSON.parse(sendRequest(method, url, queryName, body).slice(5));
        var output = parseJSON(jsonPath ? dq(raw,jsonPath) : raw);

        if(!(output instanceof Array )){
            output = [output];
        }

        var context = { Hunt : [] };
        output.forEach(function(i){
            var huntEntity = {
                ID : i.id,
                Created : i.created,
                Creator : i.creator,
                Description : i.description,
                Expires : i.expires,
                IsRobot : i.is_robot,
                Name: i.name,
                State: i.state
            };

            context.Hunt.push(huntEntity);
        });

        return {
              Type: entryTypes.note,
              Contents: raw,
              ContentsFormat: formats.json,
              HumanReadable: tblToMd(title,output,argToList(args.headers)),
              EntryContext: context
          };
    };

    var getFlows = function(method, url, queryName, body, jsonPath, title) {
        var raw = JSON.parse(sendRequest(method, url, queryName, body).slice(5));
        var output = parseJSON(jsonPath ? dq(raw,jsonPath) : raw);
        if(!(output instanceof Array )){
            output = [output];
        }

        var context = { Flow : [] };

        output.forEach(function(i){
            var flowEntity = {
                ID : i.id,
                Created : i.created,
                Creator : i.creator,
                Description : i.description,
                Expires : i.expires,
                IsRobot : i.is_robot,
                Name: i.name,
                State: i.state,
                Args : i.args,
                LastActiveAt : i.last_active_at,
                NestedFlow : (i.nested_flows && typeof i === 'object' ? i.nested_flows.map(function(a) {return a.id}) : i.nested_flows), //i.nested_flows.map(function(a) {return a.id}),
                StartedAt : i.started_at
            };

            context.Flow.push(flowEntity);
        });

        return {
              Type: entryTypes.note,
              Contents: raw,
              ContentsFormat: formats.json,
              HumanReadable: tblToMd(title,output,argToList(args.headers)),
              EntryContext: context
          };
    };

    var getClients = function(method, url, queryName, body, jsonPath, title) {
        var raw = JSON.parse(sendRequest(method, url, queryName, body).slice(5));
        var output = parseJSON(jsonPath ? dq(raw,jsonPath) : raw);
        if(!(output instanceof Array )){
            output = [output];
        }

        var context = { Client : [] };

        output.forEach(function(i){
            var clientEntity = {
                FirstSeenAt : i.first_seen_at,
                ID : i.id,
                LastBootedAt : i.last_booted_at,
                LastClock : i.last_clock,
                LastCrashAt : i.last_crash_at,
                LastSeenAt : i.last_seen_at,
                AgentInfo : i.agent_info,
                HardwareInfo : i.hardware_info,
                Interfaces : i.interfaces,
                Labels : i.labels,
                OS : i.os_info,
                User : i.users,
                Volumes : i.volumes
            };

            context.Client.push(clientEntity);
        });

        return {
              Type: entryTypes.note,
              Contents: raw,
              ContentsFormat: formats.json,
              HumanReadable: tblToMd(title,output,argToList(args.headers)),
              EntryContext: context
          };
    };

    var sendRequestAndParse = function(method, url, queryName, body) {
        return JSON.parse(sendRequest(method, url, queryName, body).slice(5));
    };

    switch (command) {
        case 'test-module':
            return sendRequest('GET', server) ? 'ok' : 'No body in response';
        case 'grr-set-flows':
        case 'grr_set_flows'://deprecated
            return getFlows('POST', server + '/api/clients/' + args.client_id + '/flows', 'post flow', '{"flow": ' + args.flow + '}',null,"Set Flow");
        case 'grr-get-files': 
        case 'grr_get_files'://deprecated
            var pathsArr;
            try {
                pathsArr = JSON.parse(args.paths);
            } catch (e) {
                logDebug('input is not a valid JSON trying to split');
                pathsArr = args.paths ? args.paths.split(",") : [];
            }
            args.paths = pathsArr;
            return sendRequestAndParse('POST', server + '/api/robot-actions/get-files', 'post get-files', JSON.stringify(args));
        case 'grr-get-hunts':
        case 'grr_get_hunts'://deprecated
            return getHunts('GET', server + '/api/hunts' + encodeToURLQuery(args), 'get hunts',null,"items",'Hunts');
        case 'grr-get-hunt':
        case 'grr_get_hunt'://deprecated
            return getHunt('GET', server + '/api/hunts/' + args.hunt_id, 'get hunt',null,"","Hunt {0}".format(args.hunt_id));
        case 'grr-set-hunts':
        case 'grr_set_hunts'://deprecated
            return getHunts('POST', server + '/api/hunts', 'set hunts', JSON.stringify(args),null,null,"Set Hunt");
        case 'grr-get-clients':
            return getClients('GET',server + '/api/clients' + encodeToURLQuery(args), 'get client',null,"items","Clients");
        case 'grr-get-flows':
        case 'grr_get_flows'://deprecated
            var urlArgs = {};
            if (args.count) {
                urlArgs.count = args.count;
            }
            if (args.offset) {
                urlArgs.offset = args.offset;
            }
            return getFlows('GET', server + '/api/clients/' + args.client_id + '/flows' + encodeToURLQuery(urlArgs), 'get flow',null,"items","Flows");
    }
  type: javascript
  commands:
  - name: grr-set-flows
    arguments:
    - name: client_id
      required: true
      default: true
      description: The ID of the client
    - name: flow
      required: true
      description: JSON string of the flow to set
    - name: headers
      description: The headers to show
    description: Starts a flow on a given client with given parameters
    outputs:
    - contextPath: Flow
      description: A GRR Flow
    - contextPath: Flow.ID
      description: The GRR Flow ID
    - contextPath: Flow.Args
      description: The GRR Flow Args
    - contextPath: Flow.Creator
      description: The GRR Flow Creator
    - contextPath: Flow.LastActiveAt
      description: When Was the flow last active
    - contextPath: Flow.NestedFlow
      description: The GRR Flow Nested Flows
    - contextPath: Flow.StartedAt
      description: When was the flow started at
    - contextPath: Flow.State
      description: The GRR Flow State
    important:
    - contextPath: Flow.ID
      description: The Flow ID
  - name: grr-get-flows
    arguments:
    - name: client_id
      required: true
      default: true
      description: The ID of the client
    - name: offset
      description: Starting offset
    - name: count
      description: Max number of flows to fetch
    - name: headers
      description: headers to show in output
    description: Lists flows launched on a given client
    outputs:
    - contextPath: Flow
      description: A GRR Flow
    - contextPath: Flow.ID
      description: The GRR Flow ID
    - contextPath: Flow.Args
      description: The GRR Flow Args
    - contextPath: Flow.Creator
      description: The GRR Flow Creator
    - contextPath: Flow.LastActiveAt
      description: When Was the flow last active
    - contextPath: Flow.NestedFlow
      description: The GRR Flow Nested Flows
    - contextPath: Flow.StartedAt
      description: When was the flow started at
    - contextPath: Flow.State
      description: The GRR Flow State
    important:
    - contextPath: Flow.ID
      description: The Flow ID
  - name: grr-get-files
    deprecated: true
    arguments:
    - name: hostname
      description: Target host, Can be FQDN or client ID
    - name: paths
      description: Fetch this number of elements, an array of path strings
    - name: max_file_size
      description: Maximum size of file we will download
    - name: action
      description: Action to apply to found files - STAT, HASH or DOWNLOAD
    - name: pathtype
      description: Path type to glob in - UNSET, OS, TSK, REGISTRY, MEMORY, TMPFILE
    description: Downloads files from specified machine without requiring approval
  - name: grr-get-hunts
    arguments:
    - name: offset
      description: Starting offset
    - name: count
      description: Max number of items to fetch
    - name: created_by
      description: 'Only return hunts created by a given user. If approved_by or/and
        description_contains are also supplied, then logical AND is applied to all
        the criterias. NOTE: this filter can only be used in conjunction with ''active_within''
        filter (to prevent queries of death)'
    - name: description_contains
      description: 'Only return hunts where description contains given substring (matching
        is case-insensitive).If created_by or/and approved_by are also supplied, then
        logical AND is applied to all the criterias. NOTE: this filter can only be
        used in conjunction with ''active_within'' filter (to prevent queries of death)'
    - name: active_within
      description: Only return hunts that were active within given time duration
    - name: headers
      description: headers to show in output
    description: Renders list of available hunts
    outputs:
    - contextPath: Hunt
      description: A GRR Hunt
    - contextPath: Hunt.ID
      description: The GRR Hunt ID
    - contextPath: Hunt.Creator
      description: The GRR Hunt Creator
    - contextPath: Hunt.Description
      description: The GRR Hunt Description
    - contextPath: Hunt.Created
      description: The time the GRR Hunt was created
    - contextPath: Hunt.Expires
      description: The time the GRR Hunt expires
    - contextPath: Hunt.IsRobot
      description: Is the Hunt originated from a robot
    - contextPath: Hunt.Name
      description: The GRR Hunt Name
    - contextPath: Hunt.State
      description: The GRR Hunt State
    important:
    - contextPath: Hunt.ID
      description: The Hunt ID
  - name: grr-get-hunt
    arguments:
    - name: hunt_id
      required: true
      default: true
      description: Hunt id
    - name: headers
      description: headers to show in output
    description: Renders hunt's summary
    outputs:
    - contextPath: Hunt
      description: A GRR Hunt
    - contextPath: Hunt.ID
      description: The GRR Hunt ID
    - contextPath: Hunt.Creator
      description: The GRR Hunt Creator
    - contextPath: Hunt.Description
      description: The GRR Hunt Description
    - contextPath: Hunt.Created
      description: The time the GRR Hunt was created
    - contextPath: Hunt.Expires
      description: The time the GRR Hunt expires
    - contextPath: Hunt.IsRobot
      description: Is the Hunt originated from a robot
    - contextPath: Hunt.Name
      description: The GRR Hunt Name
    - contextPath: Hunt.State
      description: The GRR Hunt State
    important:
    - contextPath: Hunt.ID
      description: The Hunt ID
  - name: grr-set-hunts
    arguments:
    - name: hunt_runner_args
      description: Hunt runner arguments
    - name: hunt_args
      description: Hunt arguments
    - name: headers
      description: The headers to show
    description: Handles hunt creation request
  - name: grr-get-clients
    arguments:
    - name: query
      description: 'Search query string. See here for syntax: https://github.com/google/grr-doc/blob/master/user_manual.adoc#searching-for-a-client '
    - name: offset
      description: 'Found clients starting offset. '
    - name: count
      description: 'Number of found client to fetch. '
    - name: headers
      description: headers to show in output
    description: 'Renders results of a client search. '
    outputs:
    - contextPath: Client
      description: A GRR Client
    - contextPath: Client.ID
      description: The GRR Client ID
    - contextPath: Client.LastBootedAt
      description: The GRR Client LastBootedAt time
    - contextPath: Client.FirstSeenAt
      description: The GRR Client FirstSeenAt time
    - contextPath: Client.LatClock
      description: The GRR Client LastClock
    - contextPath: Client.LastCrashAt
      description: The GRR Client LastCrashAt time
    - contextPath: Client.AgentInfo
      description: The GRR Client AgentInfo
    - contextPath: Client.HardwareInfo
      description: The GRR Client HardwareInfo
    - contextPath: Client.Interfaces
      description: The GRR Client Interfaces
    - contextPath: Client.Labels
      description: The GRR Client Labels
    - contextPath: Client.OS
      description: The GRR Client OS details
    - contextPath: Client.User
      description: The GRR Client User
    - contextPath: Client.Volumes
      description: The GRR Client Volumes
    important:
    - contextPath: Client.ID
      description: The Client ID
  - name: grr_set_flows
    deprecated: true
    arguments:
    - name: client_id
      required: true
      default: true
      description: The ID of the client
    - name: flow
      required: true
      description: JSON string of the flow to set
    description: Starts a flow on a given client with given parameters
  - name: grr_get_flows
    deprecated: true
    arguments:
    - name: client_id
      required: true
      default: true
      description: The ID of the client
    - name: offset
      description: Starting offset
    - name: count
      description: Max number of flows to fetch
    description: Lists flows launched on a given client
  - name: grr_get_files
    arguments:
    - name: hostname
      description: Target host, Can be FQDN or client ID
    - name: paths
      description: Fetch this number of elements, an array of path strings
    - name: max_file_size
      description: Maximum size of file we will download
    - name: action
      description: Action to apply to found files - STAT, HASH or DOWNLOAD
    - name: pathtype
      description: Path type to glob in - UNSET, OS, TSK, REGISTRY, MEMORY, TMPFILE
    description: Downloads files from specified machine without requiring approval
  - name: grr_get_hunts
    arguments:
    - name: offset
      description: Starting offset
    - name: count
      description: Max number of items to fetch
    - name: created_by
      description: 'Only return hunts created by a given user. If approved_by or/and
        description_contains are also supplied, then logical AND is applied to all
        the criterias. NOTE: this filter can only be used in conjunction with ''active_within''
        filter (to prevent queries of death)'
    - name: description_contains
      description: 'Only return hunts where description contains given substring (matching
        is case-insensitive).If created_by or/and approved_by are also supplied, then
        logical AND is applied to all the criterias. NOTE: this filter can only be
        used in conjunction with ''active_within'' filter (to prevent queries of death)'
    - name: active_within
      description: Only return hunts that were active within given time duration
    description: Renders list of available hunts
  - name: grr_get_hunt
    arguments:
    - name: hunt_id
      required: true
      default: true
      description: Hunt id
    description: Renders hunt's summary
  - name: grr_set_hunts
    arguments:
    - name: hunt_runner_args
      description: Hunt runner arguments
    - name: hunt_args
      description: Hunt arguments
    description: Handles hunt creation request
system: true
