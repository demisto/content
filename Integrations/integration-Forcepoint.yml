commonfields:
  id: Forcepoint
  version: -1
name: Forcepoint
display: Forcepoint
category: Network Security
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAeCAYAAADnydqVAAAMY0lEQVR42u1ZCVSO6R7/KpEWWSJFKqSSCmUZ65hSDTIlUvExjIuIFiq0L197Ktr7WrWH9pAWSqNSKktMpnvOYDjcM4N7zbiW8d7f03nf7tun5Tbm3DPL9z/nf773fd7f+2y///a8H0coQhGKUITyu5esO/F7Ym7w8kPbjlaHt7sNS4Ouu1Tnd6UEcoTy+xXP5gM5VtUrqFXlqpRhhdqwdFmZEuXcuL2JI5Tfr/hec0zdXmv08vPzWtS6C7rD0tXn1Cm35t0NHKH8cQheXzn/temFuY9xPaSC4Mcg+DRHKH8Mgtde0KHMKvXPmlbOkwKBUriXMjmvhWsdcv+BgmApj+a9IzlC+eN4MEjN5QjlT52D8zhC+esQnNoZpXTgipU4Ryh/ToKRZ+25tYZnhuqnurpaSV9f309TU5M3e/bsPkra5s2b52ZlZSXF4AODAqdu3Ljx8MqVK9MXLlyYuW7dOh83dzdddp9FRUWqhw4d8ofyiLq6uvI2b97ssXXrVvMTJ05ICM7BxdlF0tTUdLeenl7KrFmzMletWhVtZ2dnzMagD0s1NbUP5qihocGLiorSI5hNmzbpf/HFFzwzM7NetbCw4G3YsOGopaUlMB8K5qSH90Kxnsz58+cnGBoa2mIs2T577eu7cf369aQvL8xLpri4WPTYsWPrDhw4IMrG7dy5Uxp740Wwzs7OC/bv3z8a7/gycxJU0g6Mxa8iGPc7yTO7K5ZZgxF89uxZk1GjRlG4HEzlCTYyMtJi3LhxPwg+l5CQeLNnz56jTJ/x8fFr+utHRESEUldXv3657vJEBnvq1CltFRWVu4LYESNGUNo62scZHAgqGmh+X375pR0N2zcQRlxcnDI3N3dkr11XVzcMa38viFVSUvre1tZ2EYODgZSx96K0tFQCTvEGBlbq6ekpzepSgcHBOfZjzAnkejBVVVXN+9UEk3by3L7BOuNkh79If/0UFhYaSklJ9QwmKir6EL+1Alo8depUqePHj88ZO3bsv5mJjRkz5uWkSZOeMfdiYmKUl5eXJQfC5/ONCJmkfcKECfcUFBRqR48e/ZjBbtu2LY7gLl68OGbOnDm95GIe72AAPxIymLbDhw9vJVgbG5tsck+M0djY+Bqsvwae0qM+Pj5G9HJ2Me9NnDixFfOuxdhNTH8yMjLv09PTtQjQ6ZDTYfZGk7Xg+c/M/eTJk58UFBSoECwiWD7d/hPWMamsrGzUokWLnpI2RJD6sLAwZXr8ydCXpH3u3Ll/wxzksA/vcP8W+o413numTUtLK+OjCMZRiTI5P5t4cl7czZARgxE8c+bMIM4AggWV00ZAwaL527dvlwdRYxBat0hKSr4iz+Tl5f8O7xVLTk42YAiG5+3nQPbu3asrKyvbs0gdHZ0bpG3Hjh0OzKIXL17cEhAQoJGSkiLt4OCwcNq0aQ/IWPDu7vLychGE0kyCA2FUbm6umuD8BAmGYfWmDXijB8u4DmEMWTz/J7nHnF5yudzN6F9m9+7dCjCcDAa7Zs0aPgdibW39AcGY71MGJycn142wrgGRIhjSBu/eFxsbK44+ZuN+BvCrQThjTNUwphm4nok1T/soghk1OqdBHWywOpd5J370QAQjZDWEhIS4BgcHu5JfeKQzcqIs8sk4bMQLgoFX3EeOFe+T71evzmFCsJubm35qaupShuCvvvrKlmDQnxL6eEsvvo20wcprGKOJjo42YPcJz1VATtRFTtTBeITgLIIdOXIkCaFd2Kx2otis9tDQ0MWCBJPumb78/f3NmfYZM2a4oK+1rPCeyODo6CMN8p/SxvSI5FsSPQYhmAnrz5YtW7YF6/4Hvcb97H6x/hkMwTDaYvazjyZ4zXntHj309baQyHYf8QEI7ldhabMQ1pSRexkjaBWcC7zYl8HDODYhry5mCF66dGmVu7t7BnJSE4OBxwRzIAi3dXS+fQNDUBlsvcwm96fw+LWCBGMT7VesWGEMIzGbPn1679gI59Zos2FFDjvBsRQVFW/TBvvUw8NDDNEqayCCgWHn+Xe4f0PvUx+CeTyeBgyHMYbS34pgEDuHPHubfDvCeagcjA1/Cy/7Cfm1V1Wnq5IwMnb8+PEv6dz0IDExsc9XMIS1QsYT/fz8PiEejOt+yUDObcwvyBelPbiKeS8pKWkVu0/0MR9hfYOLi8v6S5cuiYDgLNrgKIT2U1u2bAljFGtQYxM8kMKrrjd83SCBgtCaaTMwMIhhj4vwPQ5r/YH24IcoqAb1YBhSA6r/LMGxBAnGvvz2BJvgGT5hvnZs4JqStqEIRjhOQs6QMzIykkPYlTMxMZFDyBXrvNMpYr7BvJqxWFSjfOTZafBMKWzwQWlp6fc976vP+r61tVWcnYOXL1/ejLAYBsN5ThvI86qqKg0O5ODBg0zVS/LyLWyCflBQkCQqU2Okghd0EfP4Wss1QnAm/T6VmZmpJ3AsExUg+Bfg7qPSfaatrf0M418FIQHwRFkCiouLk0fefEEXdi+Re23Cw8OlvL29VVDAlTBzwtEuiSmyBiIYVfB5glm7dq0vCs3/G8E4B8+ytape/jbldqQl3TQkwThnRg2EQy5aAJJeExxdUP0MEp6wrTYiImIXwcLDjZg2eH9PDsa50Ylpw2YU0kckGVTNt5h2GArZsMfsKhobv5dgsdk5TLU+ZcqUn1CE/YtRFIdcAYLfw7A+aW9vl7l8+bJMf+tx93D3ZB/f0M8TeO4rVhX+FKlJhR57QIIR/qsJhi4kd2ANr2iC930UwT7XHHK4NQYontQpQjK8tc9L+65YrI9o8zIk10Ocg42ZDVVWVuYPhnVycloNYr8TDEcI5c9QadozOBDcew6GNx4hbVcbr4rPmz/vJtPOC+BtpYsPFRDUItgnwvZ7VLzhBEN70elBwu+efs7BS4ZaO/K+DwjryZkCR6Y7iCTzGRw+XpSzjoPyhGCE5Vd00dnE7tPR0XEBjKUbkcdVgGBNpBfGOWqGJDi9M1YvpiNgY+h1Ny7RpJvHV3B+hbS1t8nhS9BWVKLcjIyMhUPhd+3aJYtjkg2OTYnIocmoSO2QE6eyMWfOnFHEBnARHrkpqSmaLOLV8GWMi7PfNg9Pj8+YdhQyI5EaTLEpsdjAZKSIQJstNvrsPkG2Fn4+G0AVCAbFlhrmwsUXJS6+EMn9L+sHbjYIdEERmPzpp58moKreCEOWZmNw3FmB8bnI3TYoliSuXr0qmpaWZkb2DGta3U+fExKTEtUECJYE3hpnZi4/mb+KIxShCEUofy3Zt9dWMjwsfMrDBw9EL5w7r1tWWjb+9u3bSrdv3VLqaG+fer3t+rybN24uSOYnK/r5+sl3dnaOaWlp0b9165ZyfX393GQ+X5IDOex0SDE/L1++IC9fOiMtXe5UxikxLw9PeycHx+yoyCiftNRU+dKSEq2Ojg717m+7J1VXVX+emJBQGhMdHZmbk+PfcKVhYkVFhWJ8XJxOy7WWkV6enjqpKanTgFctKS7WLDxbKMURyvDF/sDBbd6eXg+zs7JP+fv5VUefOJkdczK6HmR+F3E8otPX2+eRh7tHaWxMbLPbMbd7ocEhPi6Hnbs93T1tPd09mkJDQovjYmJ1QXB3bHRMEd6tTEpILCsvKx8FfIn7MTcqNCSkKz0t7aafjy8F0n9JiIuvPHbk6FuQ/9bDzf05/hmjgoOCHwXwAp4QfHxcfB3GpID/MSgg8PkRF1cK80riCGX44mjv4IgNz4MneocEB5cmxMcnRkVENhIyQF47tBEkf8tPSuoKCQ55FODPO3nU9chrdzd3Hn6LQUDNiciolSD7Bbw0PD0tPTkhPuEYB4K2ipCgYAqG8wr9vIMhUXGxcV/DQN6gvR7P7wbyAqoCAwIpf18/Cs9/Dg8Lo+DFnT5e3hTB8/z8KRgaBXwdRyjDl4L8/JnffNM1gVwXnjm7/nRBwdhLtbUazc3NS/ABRretrW0xfs2bm5oW19bU6OGMvALPLJoaG3UaGhrMS4pLpjQ1NkkUFxVZQCfhv3LNyguVyhxIWWkpeccIv0b8JL5hTHSMGTx7HYzkQd3luiU3OjoM8nLzlqYkp2xAWDfIyc7RiIuNNa0or5A+XXB6bU52tnZWZtZn0A0I+Us4Qhm+nKuoEGGuqy5W4bqvdHd3i0DFmHuQLX7v3j2xrq4u0Tt3747477sXe67r6ut7+wC5ffpDThXB353KCLcnW1tax9y/f1+0qLBIBOSJDjZH5HbR3JxcEY5Q/pryH47nc49idExKAAAAAElFTkSuQmCC
description: Advanced threat protection with added local management controls.
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: "true"
  type: 8
  required: false
script:
  script: |
    var SERVER_URL = params.url;
    if (SERVER_URL.slice(-1) === '/') {
        SERVER_URL = SERVER_URL.slice(0,-1);
    }
    SERVER_URL += ':15873/api/web/v1/';

    var USER_NAME = params.credentials.identifier;

    var PASSWORD = params.credentials.password;

    function sendRequest(url, method, body, transactionID) {
        var req = {
                Method: method,
                Headers: {
                    'Content-Type': ['application/json'],
                    'Accept': ['application/json']
                },
                Username: USER_NAME,
                Password: PASSWORD
            };
        var reqBody = {};
        if (body) {
            reqBody = body;
        }
        if (transactionID) {
              reqBody['Transaction ID'] = transactionID;
        }
        req.Body = JSON.stringify(reqBody);
        var res = http(url, req, params.insecure, params.proxy);
        return res;
    }

    function transactionFlowRequest(url, method, body) {
        var transactionid = startTransaction();
        var res = {};
        try {
            res = sendRequest(url, method, body, transactionid);
        } catch (e) {
            throw e;
        } finally {
            //if request failes - commit the transaction anyway, to allow the creation a of new transaction for the next command.
            commitTransaction(transactionid);
        }
        var tries = 0;
        var status = {};
        //check the systen status, wait until transaction build status id 'Done'.
        //The database is only updated after the build is done.
        //Will prevent the need to add 'wait' between playbook tasks
        do {
            wait(1);
            status = getTransactionStatus();
            tries++;
        } while (status['Build Status'] !== 'Done' && tries < 10);
        if (tries > 10) {
            throw 'Possible transaction failure - transaction status: ' + status.Status.toString();
        }
        return res;
    }
    function startTransaction() {
        var url = SERVER_URL + 'categories/start';
        var tries = 0;
        var res = {};
        // Start a new transacrion - 3 tries for recurring 409 error.
        //Error 409 - another transaction is in progress (Only one Policy API Server in a global TRITON AP-WEB deployment can start a transaction at a time).
        do {
            wait(1);
            res = sendRequest(url, 'POST');
            tries++;
        } while(res.StatusCode === 409 && tries < 10);
        if (res.StatusCode !== 200) {
            if (res.StatusCode === 409) {
                throw 'Another transaction is in process. Please wait for a few seconds before sending another request.';
            }
            throw 'error - request failed. error number ' + res.StatusCode;
        }
        var resBody = JSON.parse(res.Body);
        var tid = resBody['Transaction ID'];
        return tid;
    }

    function commitTransaction(transactionID) {
        var url = SERVER_URL + 'categories/commit?transactionid=' + transactionID;
        var res = sendRequest(url, 'POST');
        if (res.StatusCode !== 200) {
            throw 'error - transaction commit failed. error  ' + res.Status;
        }
    }

    function getTransactionStatus() {
        var url = SERVER_URL + 'categories/status';
        var res = sendRequest(url, 'GET');
        if (res.StatusCode !== 200) {
            throw 'Error- failed to get transaction status. possible transaction failure';
        }
        try {
            var resBody = JSON.parse(res.Body);
            return resBody;
        } catch (err) {
            throw "error - unexpected response. Couldn't parse response body";
        }
    }

    function parseResponse(response) {
        var body = JSON.parse(response.Body);
        if (response.StatusCode === 200) {
            return body;
        } else {
            throwErrDetails(body, response.StatusCode);
        }
    }

    function throwErrDetails(errResponse, StatusCode) {
        var erMessage = '';
        var errArray = errResponse.Error ? errResponse.Error : [];
        for (var i = 0; i < errArray.length; i++) {
            erMessage = erMessage + errArray[i] + '\n';
        }
        throw 'Request failed with status ' + StatusCode + '. ' + erMessage;
    }

    function addCategory(){
        var res = addCategoryRequest(
            args.categoryName,
            args.categoryDescription,
            parseInt(args.parent));
        var title = 'Forcepoint Add Category';
        var content = res.Categories;
        var data = [
            {
                to: 'CategoryName',
                from: 'Category Name'
            }];
        var context = mapObjFunction(data) (content);
        var entry = {
              Type: entryTypes.note,
              Contents: content,
              ContentsFormat: formats.json,
              ReadableContentsFormat: formats.markdown,
              HumanReadable: tableToMarkdown(title, context),
              EntryContext: {}
          };
          entry.EntryContext['Forcepoint.AddCategory(val.CategoryName==obj.CategoryName)'] = context;
          return entry;
    }

    function addCategoryRequest(categoryName, categoryDescription, parent) {
        var url = SERVER_URL + 'categories';
        var body = {
            Categories: [
                {
                    'Category Name': categoryName,
                    'Category Description': categoryDescription,
                    'Parent': parent
                }
            ]
        };
        var res = transactionFlowRequest(url, 'POST', body);
        return parseResponse(res);
    }

    function listCategories(){
        var listAll = (args.allCategories === 'true');
        var res = listCategoriesRequest(listAll);
        var title = 'Forcepoint List Categories';
        var categories = parseCategoryList(res.Categories);
        var data = [
                    {to: 'CategoryName', from: 'Category Name'},
                    {to: 'CategoryID', from: 'Category ID'},
                    {to: 'CategoryDescription', from: 'Category Description'},
                    {to: 'CategoryOwner', from: 'Category Owner'},
                    {to: 'CategoryParent', from: 'CategoryParent'}
                ];
        var context = mapObjFunction(data)(categories);
        var entry = {
              Type: entryTypes.note,
              Contents: res,
              ContentsFormat: formats.json,
              ReadableContentsFormat: formats.markdown,
              HumanReadable: tableToMarkdown(title, context),
              EntryContext: {}
          };
          entry.EntryContext['Forcepoint.ListCategories(val.CategoryID==obj.CategoryID)'] = createContext(context);
          return entry;
    }

    function parseCategoryList(categories){
        var categoryArr = [];
        categories.forEach(function(cat) {
            var children = cat.Children;
            cat.CategoryParent = '';
            categoryArr.push(cat);
            if (children) {
                for (var i = 0; i < children.length; i++) {
                    var child = children[i];
                    child.CategoryParent = cat['Category Name'];
                    categoryArr.push(child);
                }
            }
        });
        return categoryArr;
    }

    function listCategoriesRequest(listAll) {
        var url = listAll ? SERVER_URL + 'categories/all' : SERVER_URL + 'categories';
        var res =  sendRequest(url, 'GET');
        return parseResponse(res);
    }

    function categoryDetails(){
        if (!args.categoryName && !args.categoryId) {
            throw "Please provide either the category name or it\' ID."
        }
        var res = args.categoryId ? categoryDetailsByIDRequest(args.categoryId) : categoryDetailsByNameRequest(args.categoryName);
        var title = 'Forcepoint Category Details';
        var data = [
                {to: 'CategoryName', from: 'Category Name'},
                {to: 'CategoryID', from: 'Category ID'},
                {to: 'URLs', from: 'URLs'},
                {to: 'IPs', from: 'IPs'}
            ];
        var context = mapObjFunction(data) (res);
        var entry = {
              Type: entryTypes.note,
              Contents: res,
              ContentsFormat: formats.json,
              ReadableContentsFormat: formats.markdown,
              HumanReadable: tableToMarkdown(title, context),
              EntryContext: {}
          };
          entry.EntryContext['Forcepoint.CategoryDetails(val.CategoryID==obj.CategoryID)'] = createContext(context);
          return entry;

    }

    function categoryDetailsByNameRequest(name) {
        url = SERVER_URL + 'categories/urls?catname=' + name;
        var res =  sendRequest(url, 'GET');
        return parseResponse(res);
    }

    function categoryDetailsByIDRequest(id) {
        url = SERVER_URL + 'categories/urls?catid=' + id;
        var res =  sendRequest(url, 'GET');
        return parseResponse(res);
    }

    function addAddress() {
        if (!args.ips && !args.urls) {
            throw 'Please pass an ip list, url list, or both.'
        }
        if (!args.categoryID && !args.categoryName) {
            throw "Please provide either the category name or it's ID.";
        }
        var urls = args.urls ? args.urls.split(',') : undefined;
        var ips = args.ips ? args.ips.split(',') : undefined;
        var res = args.categoryID ? editAddressRequest(urls, ips, parseInt(args.categoryID)) : editAddressRequest(urls, ips, undefined, args.categoryName);
        var title = 'Forcepoint Category Details';
        var data = [
                    {to: 'CategoryID', from: 'Category ID'},
                    {to: 'Totals.AddedURLs', from: 'Totals.Added URLs'},
                    {to: 'Totals.AddedIPs', from: 'Totals.Added IPs'}
                ];
        var context = mapObjFunction(data) (res);
        var entry = {
                Type: entryTypes.note,
                Contents: res,
                ContentsFormat: formats.json,
                ReadableContentsFormat: formats.markdown,
                HumanReadable: tableToMarkdown(title, context),
                EntryContext: {}
            };
        entry.EntryContext['Forcepoint.AddAddressToCategory(val.CategoryID==obj.CategoryID)'] = createContext(context);
        return entry;
    }

    function editAddressRequest(urls, ips, id, name, del){
        var url = SERVER_URL + 'categories/urls';
        var body = {};
        if (id) {
            body['Category ID'] = id;
        }
        else if(name){
            body['Category Name'] = name;
        }
        if (urls) {
            body.URLs = urls;
        }
        if (ips) {
            body.IPs = ips;
        }
        var method = del ? 'DELETE' : 'POST';
        var res =  transactionFlowRequest(url, method, body);
        return parseResponse(res);
    }

    function deleteAddress() {
        if (!args.ips && !args.urls) {
            throw 'Please pass an ip list, url list, or both.'
        }
        if (!args.categoryID && !args.categoryName) {
            throw "Please provide either the category name or it's ID.";
        }
        var urls = args.urls ? args.urls.split(',') : undefined;
        var ips = args.ips ? args.ips.split(',') : undefined;
        var res = args.categoryID ? editAddressRequest(urls, ips, parseInt(args.categoryID), undefined, true) : editAddressRequest(urls, ips, undefined, args.categoryName, true);
        var title = 'Forcepoint Delete Address From Category';
        var data = [
                        {to: 'CategoryID', from: 'Category ID'},
                        {to: 'Totals.DeletedURLs', from: 'Totals.Deleted URLs'},
                        {to: 'Totals.DeletedIPs', from: 'Totals.Deleted IPs'}
                    ];
        var context = mapObjFunction(data)(res);
        var entry = {
              Type: entryTypes.note,
              Contents: res,
              ContentsFormat: formats.json,
              ReadableContentsFormat: formats.markdown,
              HumanReadable: tableToMarkdown(title, context),
              EntryContext: {}
          };
          entry.EntryContext['Forcepoint.DeleteAddressesFromCategory'] = createContext(context);
          return entry;
    }

    function deleteCategory() {
        if (!args.categoryIDs && !args.categoryNames) {
            throw 'Please provied IDs or/and Names of the categories you wish to delete.';
        }
        //save the categories details before deleting them
        var deleted = [];
        if (args.categoryIDs) {
            var ids = [];
            if (Array.isArray(args.categoryIDs)) {
                ids = args.categoryIDs;
            } else if (typeof args.categoryIDs === 'string') {
                ids = args.categoryIDs.split(',');
                ids.forEach(function(element, index, arr) {
                    arr[index] = parseInt(element);
                });
            } else if (!isNaN(args.categoryIDs)) {
                ids.push(args.categoryIDs);
            }
            ids.forEach(function(element) {
                //Get details for each category. If the request fails, it means wrong category id/name was provided.
                //category DELETE request with wrong id/name will not cause an error. No need to end the procedure. Valid ids/names will still be deleted.
                  try {
                    var catDetails = categoryDetailsByIDRequest(element);
                    deleted.push(catDetails);
                } catch(e) {}
            });
            deleteCategoryRequest(ids);
        }
        if(args.categoryNames) {
            var names = [];
            if (Array.isArray(args.categoryNames)){
                names = args.categoryNames;
            } else  {
                names = args.categoryNames.split(',');
            }
            //Get details for each category. If the request fails, it means wrong category id/name was provided.
            //category DELETE request with wrong id/name will not cause an error. No need to end the procedure. Valid ids/names will still be deleted.
            try {
                names.forEach(function(element) {
                    var catDetails = categoryDetailsByNameRequest(element);
                    deleted.push(catDetails);
                });
            } catch(e) {};
            deleteCategoryRequest(undefined, names);
        }
        var data = [
            {to: 'CategoryName', from: 'Category Name'},
            {to: 'CategoryID', from: 'Category ID'},
            {to: 'URLs', from: 'URLs'},
            {to: 'IPs', from: 'IPs'}
            ];
        var context = mapObjFunction(data) (deleted);
        var entry = {
          Type: entryTypes.note,
          ReadableContentsFormat: formats.text,
          HumanReadable: "Categories were deleted successfully",
          Contents: deleted,
          ContentsFormat: formats.json,
          EntryContext: {}
          };
          entry.EntryContext['Forcepoint.DeletedCategories'] = createContext(context);
          return entry;
    }

    function deleteCategoryRequest(ids, names) {
        var url = SERVER_URL + 'categories';
        var body = {};
        if (ids) {
            body['Category IDs'] = ids;
        }
        else if (names) {
            body['Category Names'] = names;
        }
        var res = transactionFlowRequest(url, 'DELETE', body);
        if (res.StatusCode !== 200) {
            var errResponse = JSON.stringify(res.Body);
            throwErrDetails(errResponse, res.StatusCode);
        }
    }

    function test() {
        var tid = startTransaction();
        commitTransaction(tid);
        return 'ok';
    }


    switch(command) {
        case 'test-module':
            return test();
        case 'fp-add-category':
            return addCategory();
        case 'fp-list-categories':
            return listCategories();
        case 'fp-get-category-detailes':
            return categoryDetails();
        case 'fp-add-address-to-category':
            return addAddress();
        case 'fp-delete-address-from-category':
            return deleteAddress();
        case 'fp-delete-categories':
            return deleteCategory();
    }
  type: javascript
  commands:
  - name: fp-add-category
    arguments:
    - name: categoryName
      required: true
      description: The category name. Must be unique, alphanumeric name.
    - name: categoryDescription
      description: The category description.  It may contain alphanumeric characters,
        periods, and commas.
    - name: parent
      description: "The category parent. 0 is the top-level category, and can be specified
        as the parent. \t Subcategories can be added to categories that have a parent
        of 0, but not to categories with a different parent."
      defaultValue: "0"
    outputs:
    - contextPath: Forcepoint.AddCategory.CategoryName
      description: The category name.
    description: Create custom category.
  - name: fp-list-categories
    arguments:
    - name: allCategories
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Select 'true' to retrieve a list of all the categories. Else, only
        API-managed categories will be listed.
      defaultValue: "false"
    outputs:
    - contextPath: ListCategories.CategoryName
      description: Category name
    - contextPath: ListCategories.CategoryID
      description: Category ID
    - contextPath: ListCategories.CategoryDescription
      description: Category description
    - contextPath: ListCategories.CategoryOwner
      description: Category owner
    description: Retrieve a list of all the categories, or only API-managed categories.
  - name: fp-get-category-detailes
    arguments:
    - name: categoryName
      description: The category name.  Leave blank if category ID is provided.
    - name: categoryId
      description: The category ID.  Leave blank if category name is provided.
    outputs:
    - contextPath: Forcepoint.CategoryDetails.CategoryName
      description: Category name
    - contextPath: Forcepoint.CategoryDetails.CategoryID
      description: Category ID
    - contextPath: Forcepoint.CategoryDetails.URLs
      description: Category URLs
    - contextPath: Forcepoint.CategoryDetails.IPs
      description: Category IPs
    description: Get a list of URLs and IP addresses in an API-managed category.
  - name: fp-add-address-to-category
    arguments:
    - name: urls
      description: 'Comma separated list of URL addresses to add. '
    - name: ips
      description: 'Comma separated list of IP address to add. '
    - name: categoryID
      description: The category ID. Leave blank if category name is provided.
    - name: categoryName
      description: The category name. Leave Blank if category ID is provided.
    outputs:
    - contextPath: Forcepoint.AddAddressToCategory.CategoryName
      description: The category name.
    - contextPath: Forcepoint.AddAddressToCategory.CategoryID
      description: The category ID.
    - contextPath: Forcepoint.AddAddressToCategory.Totals.AddedURLs
      description: Total URLs added to category.
    - contextPath: Forcepoint.AddAddressToCategory.Totals.AddedIPs
      description: Total IP addresses added to category.
    description: Add URLs and IP addresses to an API-managed category. Refer to category
      either by it's ID or by it's name.
  - name: fp-delete-categories
    arguments:
    - name: categoryIDs
      description: Comma separated list of category IDs.
    - name: categoryNames
      description: Comma separated list of category names.
    outputs:
    - contextPath: Forcepoint.DeletedCategories.CategoryName
      description: Category name
    - contextPath: Forcepoint.DeletedCategories.CategoryID
      description: Category ID
    - contextPath: Forcepoint.DeletedCategories.URLs
      description: Category URLs
    - contextPath: Forcepoint.DeletedCategories.IPs
      description: Category IPs
    description: Delete API-managed categories. Refer to categories you wish to delete
      either by ID list or by name list. It is possible to pass both lists, when each
      list refers to different categories.
  - name: fp-delete-address-from-category
    arguments:
    - name: categoryID
      description: The category ID.  Leave blank if category name is provided.
    - name: urls
      description: Comma separated list of URL address to remove.
    - name: ips
      description: Comma separated list of IP address to remove.
    - name: categoryName
      description: The category name.  Leave blank if category ID is provided.
    outputs:
    - contextPath: Forcepoint.DeleteAddressesFromCategory.CategoryName
      description: The category Name.
    - contextPath: Forcepoint.DeleteAddressesFromCategory.CategoryID
      description: The category ID.
    - contextPath: Forcepoint.DeleteAddressesFromCategory.Totals.DeletedURLs
      description: Total URLs deleted from category.
    - contextPath: Forcepoint.DeleteAddressesFromCategory.Totals.DeletedIPs
      description: Total IP addresses deleted from category.
    description: ' Remove URLs, IP addresses, and ranges from a specific API-managed
      category.  Refer to category either by it''s ID or by it''s name.'
