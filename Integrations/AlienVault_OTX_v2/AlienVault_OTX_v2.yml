category: Data Enrichment & Threat Intelligence
commonfields:
  id: AlienVault_OTX_v2
  version: -1
configuration:
- display: Trust any certificate
  name: insecure
  required: true
  type: 8
  defaultvalue: false
- display: Use system proxy
  name: proxy
  required: true
  type: 8
  defaultvalue: false
description: query IOCs in AlienVault
display: AlienVault_OTX_v2
name: AlienVault_OTX_v2
script:
  commands:
  - arguments:
    - default: false
      description: ip to query
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Query IP in AlienVault OTX
    execution: false
    name: ip
    outputs:
    - contextPath: IP.Address
      description: IP address
      type: String
    - contextPath: IP.ASN
      description: IP ASN
      type: String
    - contextPath: IP.Geo.Country
      description: IP geographic country
      type: String
    - contextPath: IP.Geo.Location
      description: IP latitude, longtitude
      type: String
    - contextPath: AlienVaultOTX.Reputation
      description: IP reputation
      type: String
    - contextPath: DBotScore.Score
      description: The score from AlienVault
      type: Number
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault vendor
      type: Unknown
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: String
  - arguments:
    - default: false
      description: domain to query
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Query domain in AlienVault OTX
    execution: false
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: Domain name
      type: String
    - contextPath: Domain.AlienVaultOTX.Alexa
      description: Alexa URL for domain data
      type: String
    - contextPath: Domain.AlienVaultOTX.Whois
      description: Whois URL for domain data
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator checked
      type: String
    - contextPath: DBotScore.Score
      description: The score from AlienVault
      type: Number
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault vendor
      type: String
  - arguments:
    - default: false
      description: ip to query
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Query IP in AlienVault OTX
    execution: false
    name: alienvault-search-ipv6
    outputs:
    - contextPath: IP.Address
      description: IP Address
      type: String
    - contextPath: IP.ASN
      description: IP ASN
      type: String
    - contextPath: IP.AlienVaultOTX.Reputation
      description: AlienVault IP reputation
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: String
    - contextPath: DBotScore.Score
      description: The score from AlienVault
      type: Number
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault vendor
      type: String
  - arguments:
    - default: false
      description: hostname to query
      isArray: false
      name: hostname
      required: true
      secret: false
    deprecated: false
    description: Query hostname in AlienVault OTX
    execution: false
    name: alienvault-search-hostname
    outputs:
    - contextPath: Endpoint.Hostname
      description: Endpoint hostname
      type: String
    - contextPath: Endpoint.AlienVaultOTX.Alexa
      description: Endpoint Alexa URL
      type: String
    - contextPath: Endpoint.AlienVaultOTX.Whois
      description: Endpoint Whois URL
      type: String
  - arguments:
    - default: false
      description: md5 to query
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Query file in AlienVault OTX
    execution: false
    name: file
    outputs:
    - contextPath: File.MD5
      description: File md5
      type: String
    - contextPath: File.SHA1
      description: File sha1
      type: String
    - contextPath: File.SHA256
      description: File sha256
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: String
    - contextPath: DBotScore.Score
      description: The score from AlienVault
      type: Number
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault vendor
      type: String
    - contextPath: File.Malicious.PulseIDs
      description: IDs of pulses marked this as malicious
      type: String
  - arguments:
    - default: false
      description: The cve to query
      isArray: false
      name: cve-id
      required: true
      secret: false
    deprecated: false
    description: Query CVE in AlienVault OTX
    execution: false
    name: alienvault-search-cve
    outputs:
    - contextPath: CVE.ID
      description: Id of the CVE
      type: String
    - contextPath: CVE.CVSS
      description: The CVSS score of the CVE
      type: String
    - contextPath: CVE.Published
      description: date published
      type: String
    - contextPath: CVE.Modified
      description: date Modified
      type: String
    - contextPath: CVE.Description
      description: CVE description
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: the type of the indicator
      isArray: false
      name: indicator-type
      predefined:
      - ipv4
      - ipv6
      - domain
      - hostname
      - url
      required: true
      secret: false
    - default: false
      description: the indicator to search related hashes for
      isArray: false
      name: indicator
      required: true
      secret: false
    deprecated: false
    description: URLs analyzed by AlienVault Labs on this indicator
    execution: false
    name: alienvault-get-related-urls-by-indicator
    outputs:
    - contextPath: AlienValut.URL.Data
      description: the path of the url
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: the type of the indicator
      isArray: false
      name: indicator-type
      predefined:
      - ipv4
      - ipv6
      - domain
      - hostname
      required: true
      secret: false
    - default: false
      description: the indicator to search related hashes for
      isArray: false
      name: indicator
      required: true
      secret: false
    deprecated: false
    description: Malware samples analyzed by AlienVault Labs which have been observed
      on this indicator
    execution: false
    name: alienvault-get-related-hashes-by-indicator
    outputs:
    - contextPath: AlienValut.File.Hash
      description: the path of the url
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: the type of the indicator
      isArray: false
      name: indicator-type
      predefined:
      - ipv4
      - ipv6
      - domain
      - hostname
      required: true
      secret: false
    - default: false
      description: the indicator to search urls for
      isArray: false
      name: indicator
      required: true
      secret: false
    deprecated: false
    description: Passive dns records observed by AlienVault Labs pointing to this
      indicator
    execution: false
    name: alienvault-get-passive-dns-data-by-indicator
    outputs:
    - contextPath: AlienValut.PassiveDNS.Domain
      description: the domain value
      type: String
    - contextPath: AlienValut.PassiveDNS.IP
      description: the ip value
      type: String
    - contextPath: AlienValut.PassiveDNS.Type
      description: the asset type
      type: String
    - contextPath: AlienValut.PassiveDNS.FirstSeen
      description: the first seen date
      type: Date
    - contextPath: AlienValut.PassiveDNS.LastSeen
      description: the last seen date
      type: Date
  - arguments:
    - default: false
      description: The page of pulses to get
      isArray: false
      name: page
      required: true
      secret: false
    deprecated: false
    description: Search for pulses in AlienVault OTX
    execution: false
    name: alienvault-search-pulses
    outputs:
    - contextPath: AlienVault.Pulses.ID
      description: Pulse ID
      type: String
    - contextPath: AlienVault.Pulses.Author.ID
      description: Author ID
      type: String
    - contextPath: AlienVault.Pulses.Author.Username
      description: Author username
      type: String
    - contextPath: AlienVault.Pulses.Count
      description: Pulse count
      type: String
    - contextPath: AlienVault.Pulses.Modified
      description: Pulse modification date
      type: Date
    - contextPath: AlienVault.Pulses.Name
      description: Pulse name
      type: String
    - contextPath: AlienVault.Pulses.Source
      description: Pulse source
      type: String
    - contextPath: AlienVault.Pulses.SubscriberCount
      description: Pulse subscriber count
      type: String
    - contextPath: AlienVault.Pulses.Tags
      description: Pulse tags
      type: String
    - contextPath: AlienVault.Pulses.Description
      description: Pulse description
      type: String
  - arguments:
    - default: false
      description: ID of desired pules
      isArray: false
      name: pulse-id
      required: true
      secret: false
    deprecated: false
    description: Get pulse details (pulse are alian vault's entities)
    execution: false
    name: alienvault-get-pulse-details
    outputs:
    - contextPath: AlienVault.Pulses.Created
      description: Pulse created
      type: Date
    - contextPath: AlienVault.Pulses.Author.Username
      description: Pulse author username
      type: String
    - contextPath: AlienVault.Pulses.ID
      description: Pulse ID
      type: String
    - contextPath: AlienVault.Pulses.Name
      description: Pulse name
      type: String
    - contextPath: AlienVault.Pulses.Tags
      description: Pulse tags
      type: String
    - contextPath: AlienVault.Pulses.TargetedCountries
      description: Pulse targeted countries
      type: String
    - contextPath: AlienVault.Pulses.Description
      description: Pulse description
      type: String
  - arguments:
    - default: false
      description: url to query
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Query url in AlienVault OTX
    execution: false
    name: url
    outputs:
    - contextPath: URL.Data
      description: 'URL '
      type: Unknown
  dockerimage: docker pull demisto/python3:3.7.4.1150
  isfetch: false
  runonce: false
  script: '-'
  type: python
