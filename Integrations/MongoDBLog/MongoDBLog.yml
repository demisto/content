category: Database
commonfields:
  id: MongoDBLog
  version: -1
configuration:
- display: MongoDB Username
  name: credentials
  required: true
  type: 9
- defaultvalue: mongodb://172.16.202.134:27017
  display: mongodb://<IP/FQDN>:<Port Number>
  name: URI
  required: true
  type: 0
- defaultvalue: demisto
  display: Database Name
  name: DB
  required: true
  type: 0
- defaultvalue: log
  display: Collection Name
  name: COLLECTION
  required: true
  type: 0
description: |-
  Writes Log data out to MongoDB collection named "log".

  This Integration needs to be run in a Docker container which has the pymongo dependency added.

  Integration uses SCRAM-SHA-1 authentication to the backend Mongo database, but functions with noauth as well (MongoDB configuration).  This was limited by the supported pymongo, further limited by the Python version supported by Demisto (read: Wanted to use SCRAM-SHA-256).
display: MongoDBLog
name: MongoDBLog
script:
  commands:
  - deprecated: false
    description: Returns all log entries.
    execution: false
    name: ReadMongoLog
  - arguments:
    - default: false
      isArray: false
      name: playbook
      required: true
      secret: false
    - default: false
      isArray: false
      name: analyst
      required: true
      secret: false
    - default: false
      isArray: false
      name: entity
      required: true
      secret: false
    - default: false
      isArray: false
      name: action
      required: true
      secret: false
    deprecated: false
    description: Adds log entry.
    execution: false
    name: WriteMongoLog
  - deprecated: false
    description: Returns the number of log entries.
    execution: false
    name: NumMongoLog
  dockerimage: demisto/mongoclient1:latest
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: true
  script: '-'
  subtype: python3
  type: python
sourcemoduleid: Log
