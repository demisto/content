category: Utilities
commonfields:
  id: Server Message Block (SMB)
  version: -1
configuration:
- display: Server IP / Hostname (e.g. 1.2.3.4)
  name: hostname
  required: false
  type: 0
- defaultvalue: '445'
  display: Port
  name: port
  required: true
  type: 0
- display: Server NetBIOS (AD) Name
  name: nbname
  required: false
  type: 0
- display: Domain
  name: domain
  required: false
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: File exchange with an SMB server
display: Server Message Block (SMB)
name: Server Message Block (SMB)
script:
  commands:
  - arguments:
    - name: hostname
      default: false
      description: Server IP / Hostname (e.g. 1.2.3.4)
    - name: nbname
      default: false
      description: Server NetBIOS (AD) Name
    - name: domain
      default: false
      description: The host domain
    - name: file_path
      required: true
      default: true
      description: The path to the file, starting from the share. (e.g. Share/Folder/File)
    - name: download_and_attach
      default: false
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: Specify if the file should be downloaded and attached or only output
      defaultValue: "yes"
    outputs:
    - contextPath: File.Size
      description: File size
      type: number
    - contextPath: File.SHA1
      description: File SHA1
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.SSDeep
      description: File SSDeep
      type: string
    - contextPath: File.EntryID
      description: File entry ID
      type: string
    - contextPath: File.Info
      description: File info
      type: string
    - contextPath: File.Type
      description: File type
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    deprecated: false
    description: Download a file from the SMB server
    execution: false
    name: smb-download
  - arguments:
    - name: hostname
      default: false
      description: Server IP / Hostname (e.g. 1.2.3.4)
    - name: nbname
      default: false
      description: Server NetBIOS (AD) Name
    - name: domain
      default: false
      description: The host domain
    - name: file_path
      default: false
      required: true
      description: The path to the file, starting from the share. (e.g. Share/Folder/File)
    - name: entryID
      default: false
      description: EntryID to the file to send to the share
    - name: content
      default: false
      description: File content to send to the share. Ignored if EntryID argument
        is specified.
    deprecated: false
    description: Upload a file to the SMB server
    execution: false
    name: smb-upload
  dockerimage: demisto/pysmb
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
- SMB test
releaseNotes: Changed server configuration parameters to non-mandatory, and added them as command arguments.

