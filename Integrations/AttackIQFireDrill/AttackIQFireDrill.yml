category: Vulnerability Management
commonfields:
  id: AttackIQFireDrill
  version: -1
configuration:
- display: Server URL (e.g. https://example.net)
  name: url
  required: true
  type: 0
- display: API Token
  name: token
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: AttackIQ offers continuous validation for security controls, processes
  and people.
display: AttackIQ FireDrill
name: AttackIQFireDrill
script:
  commands:
  - arguments:
    - default: true
      description: ID of the assessment to get.
      isArray: false
      name: assessment_id
      required: true
      secret: false
    deprecated: false
    description: Get all assessments in a page or by assessment id.
    execution: false
    name: attackiq-get-assessment-by-id
    outputs:
    - contextPath: AttackIQ.Assessment.Id
      description: Assessment ID.
      type: String
    - contextPath: AttackIQ.Assessment.Name
      description: Assessment Name.
      type: String
    - contextPath: AttackIQ.Assessment.Description
      description: Assessment description.
      type: String
    - contextPath: AttackIQ.Assessment.StartDate
      description: When the assessment started.
      type: Date
    - contextPath: AttackIQ.Assessment.EndDate
      description: When the assessment ended
      type: Date
    - contextPath: AttackIQ.Assessment.AssessmentState
      description: Assessment's state. Can be Active or Inactive.
      type: String
    - contextPath: AttackIQ.Assessment.DefaultSchedule
      description: Assessment's default schedule timing (cron).
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateId
      description: Assessment template ID.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateName
      description: Assessment template Name.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateDescription
      description: Assessment template description.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateDefaultSchedule
      description: Assessment's template default schedule timing (cron).
      type: Unknown
    - contextPath: AttackIQ.Assessment.AssessmentTemplateCompany
      description: The owner of the template.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateCreated
      description: The date the template was created at.
      type: Date
    - contextPath: AttackIQ.Assessment.AssessmentTemplateModified
      description: The date the template was last modified.
      type: Date
    - contextPath: AttackIQ.Assessment.Creator
      description: User who created the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.Owner
      description: User who owns the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.User
      description: The user that ran the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.Created
      description: The time the assessment was created at.
      type: String
    - contextPath: AttackIQ.Assessment.Modified
      description: The time the assessment was last modified at.
      type: String
    - contextPath: AttackIQ.Assessment.Users
      description: User ids that can access the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.Groups
      description: User groups who can access the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.DefaultAssetCount
      description: Number of machines (assets) that are connected to the assessment.
      type: Number
    - contextPath: AttackIQ.Assessment.DefaultAssetGroupCount
      description: Number of asset groups that are connected to the assessment.
      type: Number
    - contextPath: AttackIQ.Assessment.MasterJobCount
      description: Number of tests that ran in the assessment.
      type: Number
    - contextPath: AttackIQ.Assessment.Count
      description: Total number of assessments.
      type: Number
    - contextPath: AttackIQ.Assessment.RemainingPages
      description: Number of remaining pages left to fetch (e.g. if total pages is 6, and the last fetch was page 5, then this value will be 1)
      type: Number
  - arguments:
    - default: false
      defaultValue: '1'
      description: Assessment page. Each page contains by default up to 10 assessments.
      isArray: false
      name: page_number
      required: false
      secret: false
    - default: false
      defaultValue: '10'
      description: The page size as set up in your attackIQ instance.
      isArray: false
      name: page_size
      required: false
      secret: false
    deprecated: false
    description: Get all assessments in a page (up to 10 assessments per page).
    execution: false
    name: attackiq-list-assessments
    outputs:
    - contextPath: AttackIQ.Assessment.Id
      description: Assessment ID.
      type: String
    - contextPath: AttackIQ.Assessment.Name
      description: Assessment Name.
      type: String
    - contextPath: AttackIQ.Assessment.Description
      description: Assessment description.
      type: String
    - contextPath: AttackIQ.Assessment.StartDate
      description: When the assessment started.
      type: Date
    - contextPath: AttackIQ.Assessment.EndDate
      description: When the assessment ended.
      type: Date
    - contextPath: AttackIQ.Assessment.AssessmentState
      description: Assessment's state. Can be Active or Inactive.
      type: String
    - contextPath: AttackIQ.Assessment.DefaultSchedule
      description: Assessment's default schedule timing (cron).
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateId
      description: Assessment template ID.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateName
      description: Assessment template Name.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateDescription
      description: Assessment template description.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateDefaultSchedule
      description: Assessment's template default schedule timing (cron).
      type: Unknown
    - contextPath: AttackIQ.Assessment.AssessmentTemplateCompany
      description: The owner of the template.
      type: String
    - contextPath: AttackIQ.Assessment.AssessmentTemplateCreated
      description: The date the template was created at.
      type: Date
    - contextPath: AttackIQ.Assessment.AssessmentTemplateModified
      description: The date the template was last modified.
      type: Date
    - contextPath: AttackIQ.Assessment.Creator
      description: User who created the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.Owner
      description: User who owns the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.User
      description: The user that ran the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.Created
      description: The time the assessment was created at.
      type: String
    - contextPath: AttackIQ.Assessment.Modified
      description: The time the assessment was last modified at.
      type: String
    - contextPath: AttackIQ.Assessment.Users
      description: User ids that can access the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.Groups
      description: User groups who can access the assessment.
      type: String
    - contextPath: AttackIQ.Assessment.DefaultAssetCount
      description: Number of machines (assets) that are connected to the assessment.
      type: Number
    - contextPath: AttackIQ.Assessment.DefaultAssetGroupCount
      description: Number of asset groups that are connected to the assessment.
      type: Number
    - contextPath: AttackIQ.Assessment.MasterJobCount
      description: Number of tests that ran in the assessment.
      type: Number
  - arguments:
    - default: true
      description: ID of the assessment to activate.
      isArray: false
      name: assessment_id
      required: true
      secret: false
    deprecated: false
    description: Activates the assessment. This is required for execution.
    execution: false
    name: attackiq-activate-assessment
  - arguments:
    - default: false
      description: ID of the assessment to run its tests.
      isArray: false
      name: assessment_id
      required: true
      secret: false
    - default: false
      description: Run only on-demand tests in the assessment, or all tests\ntrue
        - Execute only the on-demand tests in the assessment\nfalse - Execute all
        tests in the assessment (including scheduled tests)
      isArray: false
      name: on_demand_only
      required: false
      secret: false
    deprecated: false
    description: Runs all of the tests in the assessment.
    execution: false
    name: attackiq-run-all-tests-in-assessment
  - arguments:
    - default: true
      description: The assessment to check status
      isArray: false
      name: assessment_id
      required: true
      secret: false
    deprecated: false
    description: Get assessment execution status - supports only on demand runs.
    execution: false
    name: attackiq-get-assessment-execution-status
    outputs:
    - contextPath: AttackIQ.Assessment.Running
      description: Is the assessment running.
      type: Boolean
    - contextPath: AttackIQ.Assessment.Id
      description: Assessment Id.
      type: String
  - arguments:
    - default: true
      description: Test ID to check its status.
      isArray: false
      name: test_id
      required: true
      secret: false
    deprecated: false
    description: Get test run status.
    execution: false
    name: attackiq-get-test-execution-status
    outputs:
    - contextPath: AttackIQTest.Detected
      description: Number of detections in the test.
      type: Number
    - contextPath: AttackIQTest.Failed
      description: Number of failures in the test.
      type: Number
    - contextPath: AttackIQTest.Finished
      description: Is the test finished.
      type: Boolean
    - contextPath: AttackIQTest.Passed
      description: Number of passed tests.
      type: Number
    - contextPath: AttackIQTest.Errored
      description: Number of errored tests.
      type: Number
    - contextPath: AttackIQTest.Total
      description: Total number of tests ran.
      type: Number
    - contextPath: AttackIQTest.Id
      description: ID of the assessment test.
      type: String
  - arguments:
    - default: true
      description: ID of the assessment that contains the tests.
      isArray: false
      name: assessment_id
      required: true
      secret: false
    deprecated: false
    description: Get assessment's test. Will get by default up to 10 test per call.
    execution: false
    name: attackiq-list-tests-by-assessment
    outputs:
    - contextPath: AttackIQTest.Id
      description: Test ID.
      type: String
    - contextPath: AttackIQTest.Name
      description: Test name.
      type: String
    - contextPath: AttackIQTest.Description
      description: Test description.
      type: String
    - contextPath: AttackIQTest.Scenarios.Id
      description: Test scenario ID.
      type: String
    - contextPath: AttackIQTest.Scenarios.Name
      description: Test scenario name.
      type: String
    - contextPath: AttackIQTest.Assets.Id
      description: Test asset ID.
      type: String
    - contextPath: AttackIQTest.Assets.Ipv4Address
      description: Test asset IP version 4 address.
      type: String
    - contextPath: AttackIQTest.Assets.Hostname
      description: Test asset host name.
      type: String
    - contextPath: AttackIQTest.Assets.ProductName
      description: Test asset product name.
      type: String
    - contextPath: AttackIQTest.Assets.Modified
      description: Test asset last modified date.
      type: String
    - contextPath: AttackIQTest.Assets.Status
      description: Test asset status can be Active or Inactive.
      type: Date
    - contextPath: AttackIQTest.TotalAssetCount
      description: Number of assets the test ran on.
      type: Number
    - contextPath: AttackIQTest.CronExpression
      description: Cron expression of the test.
      type: String
    - contextPath: AttackIQTest.Runnable
      description: Is the test runnable.
      type: Boolean
    - contextPath: AttackIQTest.LastResult
      description: Test's last result.
      type: String
    - contextPath: AttackIQTest.User
      description: The user that ran the test in the assessment, should be the same
        as assessment user.
      type: String
    - contextPath: AttackIQTest.Created
      description: Date the test was created.
      type: Date
    - contextPath: AttackIQTest.Modified
      description: Date of the last time the test was modified.
      type: Date
    - contextPath: AttackIQTest.LatestInstanceId
      description: The ID of the most recent run of the test.
      type: Number
    - contextPath: AttackIQTest.UsingDefaultAssets
      description: Does the test use default assets.
      type: Boolean
    - contextPath: AttackIQTest.UsingDefaultSchedule
      description: Does the test use the default schedule.
      type: Boolean
  - arguments:
    - default: false
      description: ID of the test to show results for.
      isArray: false
      name: test_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: Set to True to show the last result.
      isArray: false
      name: show_last_result
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - default: false
      defaultValue: '1'
      description: Page number of test results (by default there are 10 results per
        page).
      isArray: false
      name: page
      required: false
      secret: false
    deprecated: false
    description: Get assessment's test result by page (by default, a page consists
      of 10 tests).
    execution: false
    name: attackiq-get-test-results
    outputs:
    - contextPath: AttackIQTestResult.Id
      description: ID of the test result.
      type: String
    - contextPath: AttackIQTestResult.Modified
      description: Date the test result was last modified.
      type: Date
    - contextPath: AttackIQTestResult.Assessment.Id
      description: ID of the test's assessment.
      type: String
    - contextPath: AttackIQTestResult.Assessment.Name
      description: Name of the test's assessment.
      type: String
    - contextPath: AttackIQTestResult.LastResult
      description: Result of the test's last run.
      type: String
    - contextPath: AttackIQTestResult.Scenario.Id
      description: ID of the test results' scenario.
      type: String
    - contextPath: AttackIQTestResult.Scenario.Name
      description: Name of the test results' scenario.
      type: String
    - contextPath: AttackIQTestResult.Scenario.Description
      description: Description of the test results' scenario.
      type: String
    - contextPath: AttackIQTestResult.Asset.Id
      description: ID of the test results' asset.
      type: String
    - contextPath: AttackIQTestResult.Asset.Ipv4Address
      description: IP address of the test results' scenario asset.
      type: String
    - contextPath: AttackIQTestResult.Asset.Hostname
      description: Host name of the test results' asset.
      type: String
    - contextPath: AttackIQTestResult.Asset.ProductName
      description: Product name of the test results' asset.
      type: String
    - contextPath: AttackIQTestResult.Asset.Modified
      description: Date the asset was last modified.
      type: Date
    - contextPath: AttackIQTestResult.AssetGroup
      description: Asset group of the test.
      type: String
    - contextPath: AttackIQTestResult.JobState.Name
      description: Job state.
      type: String
    - contextPath: AttackIQTestResult.Outcome.Name
      description: Test outcome result.
      type: String
  dockerimage: demisto/python3:3.7.4.1502
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
tests:
- AttackIQ - Test
