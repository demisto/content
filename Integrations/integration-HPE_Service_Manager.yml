commonfields:
  id: Service Manager
  version: -1
name: Service Manager
display: Service Manager
category: IT Services
description: Service Manager By Micro Focus (Formerly HPE Software).
image: data:image/png;base64,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
configuration:
- display: Server URL (e.g. https://192.168.0.1:13080)
  name: url
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: username
  defaultvalue: ""
  type: 9
  required: true
- display: Do not validate server certificate (insecure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |
    var url = params.url + '/SM/9/rest';

    // handle '/' at the end of the url
    if (url[url.length - 1] === '/') {
        url = url.substring(0, url.length - 1);
    }

    var token = Base64.encode(params.username.identifier + ':' + params.username.password);

    var result;
    // The command input arg holds the command sent from the user.
    switch (command) {
        case 'test-module':
            result = 'ok';
            break;
        case 'hpsm-create-incident':
            result = createIncident();
            break;
        case 'hpsm-list-incidents':
            result = listIncidents();
            break;
        case 'hpsm-get-incident-by-id':
            result = getIncidentById();
            break;
        case 'hpsm-list-devices':
            result = listDevices();
            break;
        case 'hpsm-get-device':
            result = getDeviceById();
            break;
        default:
    }
    return result;

    function createIncident() {
        var newIncident = {
            Incident: {
                Category: args.category,
                Description: [
                    args.description
                ],
                Service: args.service,
                Title: args.title,
            }
        };

        if (args.impact) {
            newIncident.Incident.Impact = args.impact;
        }
        if (args.urgency) {
            newIncident.Incident.Urgency = args.urgency;
        }
        if (args.alertStatus) {
            newIncident.Incident.AlertStatus = args.alertStatus;
        }
        if (args.area) {
            newIncident.Incident.Area = args.area;
        }
        if (args.assignmentGroup) {
            newIncident.Incident.AssignmentGroup = args.assignmentGroup;
        }
        if (args.affectedCI) {
            newIncident.Incident.AffectedCI = args.affectedCI;
        }
        if (args.company) {
            newIncident.Incident.Company = args.company;
        }
        if (args.category) {
            newIncident.Incident.Category = args.category;
        }

        if (args.phase) {
            newIncident.Incident.Phase = args.phase;
        }
        if (args.status) {
            newIncident.Incident.Status = args.status;
        }
        if (args.subarea) {
            newIncident.Incident.Subarea = args.subarea;
        }

        var res = doPost('/incidents', newIncident);
        var parsedRes = JSON.parse(res);
        if (parsedRes.ReturnCode !== 0) {
            throw 'Failed to create incident. Error Response: ' + res.Messages;
        }

        hrIncident = parsedRes.Incident;

        var entryContext = {
            'HPSM.Incidents': [parsedRes.Incident],
            Ticket: [
                {
                    ID: parsedRes.Incident.IncidentID,
                    Creator: parsedRes.Incident.OpenedBy,
                    Assignee: parsedRes.Incident.Assignee,
                    State: parsedRes.Incident.Status
                }
            ]
        };
        return {
            Type: entryTypes.note,
            ContentsFormat: formats.json,
            Contents: parsedRes,

            ReadableContentsFormat: formats.markdown,
            HumanReadable: tableToMarkdown('Created Incident ' + parsedRes.Incident.IncidentID, hrIncident),

            EntryContext: entryContext
        };
    }

    // queryToObject takes query of format field1=value1&field2=value2 and return query object like: { "field1": "value1", "field2": "value2" }
    function queryToObject(query) {
        if (!query) {
            return null;
        }

        var queryObj = {};
        var queryArr = query.split('&');
        queryArr.forEach(function(keyValuePair) {
            var a = keyValuePair.split('=');
            var key = a[0];
            var value = a[1];
            queryObj[key] = value;
        });

        return queryObj;
    }

    function listIncidents() {
        var incidents = doGet('/incidents', args.query);
        incidents = JSON.parse(incidents);

        var hrIncidents = [];
        var incidentIds = [];
        if (incidents.content && incidents.content.length > 0) {
            incidents.content.forEach(function(inc) {
                hrIncidents.push(inc.Incident);
                incidentIds.push(inc.Incident.IncidentID);
            });
        }

        var entryContext = {
            'HPSM.IncidentIDs': incidentIds
        };

        return {
            Type: entryTypes.note,
            ContentsFormat: formats.json,
            Contents: incidents,

            ReadableContentsFormat: formats.markdown,
            HumanReadable: tableToMarkdown('Incidents List', hrIncidents),

            EntryContext: entryContext
        };
    }

    function getIncidentById() {
        var incident = doGet('/incidents/' + args.incidentId);
        incident = JSON.parse(incident);

        hrIncident = incident.Incident;
        var entryContext = {
            'HPSM.Incidents': [incident.Incident],
            Ticket: [
                {
                    ID: incident.Incident.IncidentID,
                    Creator: incident.Incident.OpenedBy,
                    Assignee: incident.Incident.Assignee,
                    State: incident.Incident.Status
                }
            ]
        };
        return {
            Type: entryTypes.note,
            ContentsFormat: formats.json,
            Contents: incident,

            ReadableContentsFormat: formats.markdown,
            HumanReadable: tableToMarkdown('Incident ' + args.incidentId, hrIncident),

            EntryContext: entryContext
        };
    }

    function listDevices() {
        var devices = doGet('/devices', args.query);
        devices = JSON.parse(devices);

        var hrDevices = [];
        var deviceIds = [];
        if (devices.content && devices.content.length > 0) {
            devices.content.forEach(function(dev) {
                hrDevices.push(dev.Device);
                deviceIds.push(dev.Device.ConfigurationItem);
            });
        }

        var entryContext = {
            'HPSM.DeviceIDs': deviceIds
        };

        return {
            Type: entryTypes.note,
            ContentsFormat: formats.json,
            Contents: devices,

            ReadableContentsFormat: formats.markdown,
            HumanReadable: tableToMarkdown('Devices List', hrDevices),

            EntryContext: entryContext
        };
    }

    function getDeviceById() {
        var device = doGet('/devices/' + args.configurationItem);
        device = JSON.parse(device);

        hrDevice = device.Device;
        var entryContext = {
            'HPSM.Devices': [device.Device],
        };
        return {
            Type: entryTypes.note,
            ContentsFormat: formats.json,
            Contents: device,

            ReadableContentsFormat: formats.markdown,
            HumanReadable: tableToMarkdown('Device ' + args.configurationItem, hrDevice),

            EntryContext: entryContext
        };
    }

    function doPost(queryPath, body) {
        return doRequest('POST', queryPath, body);
    }

    function doPut(queryPath, body) {
        return doRequest('PUT', queryPath, body);
    }

    function doRequest(method, queryPath, body) {
        var requestUrl = url + queryPath;
        var res = http(
            requestUrl,
            {
                Method: method,
                Headers: {
                    Authorization: ['Basic ' + token],
                    'Content-Type': ['application/json']
                },
                Body: JSON.stringify(body)
            },
            params.insecure,
            params.proxy
        );

        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            var parsedRes;
            try {
                parsedRes = JSON.parse(res.Body);
            } catch (err) {}

            if (res.Body && parsedRes && parsedRes.ReturnCode !== 0 && parsedRes.Messages) {
                throw method + ' Request Failed to ' + requestUrl + '.\nStatus code: ' + res.StatusCode + '.\nError from Service Manager: ' + parsedRes.Messages;
            }

            throw method + ' Request Failed to ' + requestUrl + '.\nStatus code: ' + res.StatusCode + '.\nBody: ' + JSON.stringify(res.Body) + '.';
        }

        return res.Body;
    }

    function doGet(queryPath, queryParams) {
        var requestUrl = url + queryPath;
        if (queryParams && typeof queryParams === 'string') {
            // in case query is a string, then we convert it obj and then encode it to URL query
            // we also convert every \" to " and after encoding URI, the encodeURI encodes " to %22. We decode it to its original form
            requestUrl += '?' + encodeURI(queryParams.replace(/\\"/g,'"')).replace(/%22/g,"\"");
        } else if (queryParams) {
            // if the query is object then we encode it
            requestUrl += encodeToURLQuery(queryParams);
        }

        var res = http(
            requestUrl,
            {
                Method: 'GET',
                Headers: {
                    Authorization: ['Basic ' + token],
                    'Content-Type': ['application/json']
                }
            },
            params.insecure,
            params.proxy
        );

        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'GET Request Failed to ' + requestUrl + '.\nStatus code: ' + res.StatusCode + '.\nBody: ' + JSON.stringify(res) + '.';
        }

        return res.Body;
    }
  type: javascript
  commands:
  - name: hpsm-create-incident
    description: Creates new incident in the system
    arguments:
    - name: title
      description: The title of incident
      required: true
    - name: description
      description: The description of the incident
      required: true
    - name: service
      required: true
      description: 'Examples: CI1001060, CI1001030'
    - name: impact
      description: Default is 4. Should be number like 3 or 4
    - name: urgency
      description: Default is 4. Should be number like 3 or 4
    - name: alertStatus
      description: 'The alert status. Example: SLA BREACH'
    - name: area
      description: 'The area. Example: performance, failure, hardware, access, '
    - name: assignmentGroup
      description: 'Example: "Office Supplies (North America)"'
    - name: affectedCI
      description: 'Examples: CI1000783'
    - name: category
      required: true
      description: 'Category of incident. Example: (incident, complaint)'
    - name: company
      description: "Example: advantage"
    - name: phase
      description: 'Example: "Categorization"'
    - name: status
      description: 'Example: "Categorize"'
    - name: subarea
      description: "Example: system or application hangs, function or feature not working,  
error message, job failed, hardware failure, etc."
    outputs:
    - contextPath: Ticket.ID
      description: The id of the ticket
    - contextPath: Ticket.Creator
      description: Who created/opened the ticket
    - contextPath: Ticket.Assignee
      description: To whom the ticket assigned
    - contextPath: Ticket.State
      description: The state of the ticket (e.g open, closed, on hold)
    - contextPath: HPSM.Incidents.IncidentID
      description: The id of incident
    - contextPath: HPSM.Incidents.Service
      description: Service/device number (e.g CI1001030)
    - contextPath: HPSM.Incidents.Area
      description: Incident area
    - contextPath: HPSM.Incidents.Assignee
      description: Incident assignee
    - contextPath: HPSM.Incidents.AssignmentGroup
      description: Incident assignment group
    - contextPath: HPSM.Incidents.Category
      description: Incident category
    - contextPath: HPSM.Incidents.ClosedBy
      description: The user that closed the incident
    - contextPath: HPSM.Incidents.ClosedTime
      description: Incident close time
    - contextPath: HPSM.Incidents.ClosureCode
      description: Incident closure code
    - contextPath: HPSM.Incidents.Company
      description: Incident company
    - contextPath: HPSM.Incidents.Contact
      description: Incident contact details
    - contextPath: HPSM.Incidents.Description
      description: Incident description
    - contextPath: HPSM.Incidents.Impact
      description: Incident impact
    - contextPath: HPSM.Incidents.JournalUpdates
      description: Incident journal updates
    - contextPath: HPSM.Incidents.OpenTime
      description: Incident open time
    - contextPath: HPSM.Incidents.OpenedBy
      description: The user that opened the incident
    - contextPath: HPSM.Incidents.Phase
      description: Incident phase
    - contextPath: HPSM.Incidents.Solution
      description: Incident solution
    - contextPath: HPSM.Incidents.Status
      description: Incident status
    - contextPath: HPSM.Incidents.Subarea
      description: Incident sub area
    - contextPath: HPSM.Incidents.Title
      description: Incident title
    - contextPath: HPSM.Incidents.UpdatedBy
      description: The last user that update the incident
    - contextPath: HPSM.Incidents.UpdatedTime
      description: Incident update time
    - contextPath: HPSM.Incidents.Urgency
      description: Incident urgency
    description: 'Creating new incident '
  - name: hpsm-list-incidents
    arguments:
    - name: query
      description: 'OPTIONAL example: field1=value1&field2=value2. Also look https://docs.software.hpe.com/SM/9.50/Hybrid/Content/webservicesguide/rest_queries.htm'
    outputs:
    - contextPath: HPSM.IncidentIDs
      description: Result of incident query. Contains array of incident ids
    description: Returns all incidents
  - name: hpsm-get-incident-by-id
    description: Returns single incident by id. If incident not exists with such id, then error will returned
    arguments:
    - name: incidentId
      required: true
      default: true
      description: The id of incident (example IM10013)
    outputs:
    - contextPath: Ticket.ID
      description: The id of the ticket
    - contextPath: Ticket.Creator
      description: Who created/opened the ticket
    - contextPath: Ticket.Assignee
      description: To whom the ticket assigned
    - contextPath: Ticket.State
      description: The state of the ticket (e.g open, closed, on hold)
    - contextPath: HPSM.Incidents.IncidentID
      description: The id of incident
    - contextPath: HPSM.Incidents.Service
      description: Service/device number (e.g CI1001030)
    - contextPath: HPSM.Incidents.Area
      description: Incident area
    - contextPath: HPSM.Incidents.Assignee
      description: Incident Assignee
    - contextPath: HPSM.Incidents.AssignmentGroup
      description: Incident assignment group
    - contextPath: HPSM.Incidents.Category
      description: Incident category
    - contextPath: HPSM.Incidents.ClosedBy
      description: The user that closed the incident
    - contextPath: HPSM.Incidents.ClosedTime
      description: Incident close time
    - contextPath: HPSM.Incidents.ClosureCode
      description: Incident closure code
    - contextPath: HPSM.Incidents.Company
      description: Incident company
    - contextPath: HPSM.Incidents.Contact
      description: Incident contact details
    - contextPath: HPSM.Incidents.Description
      description: Incident description
    - contextPath: HPSM.Incidents.Impact
      description: Incident impact
    - contextPath: HPSM.Incidents.JournalUpdates
      description: Incident journal updates
    - contextPath: HPSM.Incidents.OpenTime
      description: Incident open time
    - contextPath: HPSM.Incidents.OpenedBy
      description: The user that opened the incident
    - contextPath: HPSM.Incidents.Phase
      description: Incident phase
    - contextPath: HPSM.Incidents.Solution
      description: Incident solution
    - contextPath: HPSM.Incidents.Status
      description: Incident status
    - contextPath: HPSM.Incidents.Subarea
      description: Incident sub area
    - contextPath: HPSM.Incidents.Title
      description: Incident title
    - contextPath: HPSM.Incidents.UpdatedBy
      description: The last user that update the incident
    - contextPath: HPSM.Incidents.UpdatedTime
      description: Incident update time
    - contextPath: HPSM.Incidents.Urgency
      description: Incident urgency
  - name: hpsm-list-devices
    description: Returns list of devices filtered according to query.
    arguments:
    - name: query
      description: 'OPTIONAL example (field1=value1&field2=value2)  Also see here:
        https://docs.software.hpe.com/SM/9.50/Hybrid/Content/webservicesguide/rest_queries.htm'
    outputs:
    - contextPath: HPSM.DeviceIDs
      description: "All the ids(configurationItems) of the devices"
    description: Returns list of devices ids
  - name: hpsm-get-device
    description: Find and return device by id
    arguments:
    - name: configurationItem
      required: true
      description: 'Id of device, configuration item of device. Example: CI1000011'
    outputs:
    - contextPath: HPSM.Devices.AssignmentGroup
      description: Device assignment group
    - contextPath: HPSM.Devices.Company
      description: Device company
    - contextPath: HPSM.Devices.ConfigurationItem
      description: Device configuration item
    - contextPath: HPSM.Devices.ConfigurationItemSubType
      description: Device configurationItem sub type
    - contextPath: HPSM.Devices.ConfigurationItemType
      description: Device configurationItem item type
    - contextPath: HPSM.Devices.Department
      description: Device department
    - contextPath: HPSM.Devices.DisplayName
      description: Device display name
    - contextPath: HPSM.Devices.Location
      description: Device location
    - contextPath: HPSM.Devices.LocationCode
      description: Device location code
    - contextPath: HPSM.Devices.Model
      description: Device model
    - contextPath: HPSM.Devices.PartNumber
      description: Device part number
    - contextPath: HPSM.Devices.Status
      description: Device status
    - contextPath: HPSM.Devices.UpdatedBy
      description: The last user that update the device
