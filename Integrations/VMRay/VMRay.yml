category: Forensics & Malware Analysis
commonfields:
  id: vmray2
  version: -1
configuration:
- defaultvalue: https://cloud.vmray.com
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- display: API Key
  name: api_key
  required: true
  type: 4
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
description: Ransomware analysis sandboxing
display: VMRay2
name: vmray2
script:
  commands:
  - arguments:
    - default: false
      description: Entry id  of file to submit
      isArray: false
      name: entry_id
      required: true
      secret: false
    - default: false
      description: Password of the document
      isArray: false
      name: document_password
      required: false
      secret: false
    - default: false
      description: password of an archive
      isArray: false
      name: archive_password
      required: false
      secret: false
    - default: false
      description: Force type of file
      isArray: false
      name: sample_type
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Make the file shareable
      isArray: false
      name: shareable
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Analyze no matter if analyses already exist
      isArray: false
      name: reanalyze
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: Maximum jobs to be created (number)
      isArray: false
      name: max_jobs
      required: false
      secret: false
    - default: false
      description: Tags to add to sample (comma seperated)
      isArray: false
      name: tags
      required: false
      secret: false
    deprecated: false
    description: Submit sample to VMRay
    execution: false
    name: vmray-upload-sample
    outputs:
    - contextPath: VMRay.Job.JobID
      description: ID of a new job
      type: Number
    - contextPath: VMRay.Job.Created
      description: Timestamp of created job
      type: Date
    - contextPath: VMRay.Job.SampleID
      description: ID of sample
      type: Number
    - contextPath: VMRay.Job.VMName
      description: Name of virtual machine
      type: String
    - contextPath: VMRay.Job.VMID
      description: ID of virtual machine
      type: Number
    - contextPath: VMRay.Sample.SampleID
      description: ID of sample
      type: Number
    - contextPath: VMRay.Sample.Created
      description: Timestamp of created sample
      type: Date
    - contextPath: VMRay.Submission.SubmissionID
      description: Submission ID
      type: Number
  - arguments:
    - default: false
      description: Analysis sample ID
      isArray: false
      name: sample_id
      required: true
      secret: false
    - default: false
      description: Limits results (number)
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Get all analysis details about a specific sample.
    execution: false
    name: vmray-get-analysis-by-sample
    outputs:
    - contextPath: VMRay.Analysis.AnalysisID
      description: ID of analysis
      type: Number
    - contextPath: VMRay.Analysis.SampleID
      description: Sample ID in analysis
      type: Number
    - contextPath: VMRay.Analysis.Severity
      description: Severity of sample (Malicious, Suspicious, Good, Blacklisted, Whitelested,
        Unknown)
      type: String
    - contextPath: VMRay.Analysis.JobCreated
      description: Analysis job started
      type: Date
    - contextPath: VMRay.Analysis.MD5
      description: MD5 of sample
      type: String
    - contextPath: VMRay.Analysis.SHA1
      description: SHA1 of sample
      type: String
    - contextPath: VMRay.Analysis.SHA256
      description: SHA256 of sample
      type: String
    - contextPath: VMRay.Analysis.SSDeep
      description: SSDeep of sample
      type: String
  - arguments:
    - default: false
      description: Job sample id
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: Get all jobs details about a specific sample.
    execution: false
    name: vmray-get-job-by-sample
    outputs:
    - contextPath: VMRay.Job.JobID
      description: ID of job
      type: Number
    - contextPath: VMRay.Job.SampleID
      description: Sample ID of job
      type: Number
    - contextPath: VMRay.Job.SubmissionID
      description: ID of submission
      type: Number
    - contextPath: VMRay.Job.MD5
      description: MD5 of sample in job
      type: String
    - contextPath: VMRay.Job.SHA1
      description: SHA1 of sample in job
      type: String
    - contextPath: VMRay.Job.SHA256
      description: SHA256 of sample in job
      type: String
    - contextPath: VMRay.Job.SSDeep
      description: SSDeep of sample in job
      type: String
    - contextPath: VMRay.Job.VMName
      description: Name of virtual machine
      type: String
    - contextPath: VMRay.Job.VMID
      description: ID of virtual machine
      type: Number
    - contextPath: VMRay.Job.Status
      description: 'Status of job. '
      type: String
  - arguments:
    - default: false
      description: ID of submission (can be aquired from vmray-upload-sample)
      isArray: false
      name: submission_id
      required: true
      secret: false
    deprecated: false
    description: Gets a submission result
    execution: false
    name: vmray-get-submission
    outputs:
    - contextPath: VMRay.Submission.IsFinished
      description: Status of submission (true or false)
      type: Boolean
    - contextPath: VMRay.Submission.HasErrors
      description: If there are any errors in the submission
      type: Boolean
    - contextPath: VMRay.Submission.SubmissionID
      description: ID of of sample in submission
      type: Number
    - contextPath: VMRay.Submission.MD5
      description: MD5 of of sample in submission
      type: String
    - contextPath: VMRay.Submission.SHA1
      description: SHA1 of of sample in submission
      type: String
    - contextPath: VMRay.Submission.SHA256
      description: SHA256 of of sample in submission
      type: String
    - contextPath: VMRay.Submission.SSDeep
      description: SSDeep of of sample in submission
      type: String
    - contextPath: VMRay.Submission.Severity
      description: Severity of sample in submission (Malicious, Suspicious, Good,
        Blacklisted, Whitelested, Unknown)
      type: String
    - contextPath: VMRay.Submission.SampleID
      description: ID of sample in submission
      type: Number
  - arguments:
    - default: false
      description: 'id of sample '
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: get sample by sample id
    execution: false
    name: vmray-get-sample
    outputs:
    - contextPath: VMRay.Sample.SampleID
      description: ID of sample
      type: Number
    - contextPath: VMRay.Sample.FileName
      description: File name of sample
      type: String
    - contextPath: VMRay.Sample.MD5
      description: MD5 of sample
      type: String
    - contextPath: VMRay.Sample.SHA1
      description: SHA1 of sample
      type: String
    - contextPath: VMRay.Sample.SHA256
      description: SHA256 of sample
      type: String
    - contextPath: VMRay.Sample.SSDeep
      description: SSDeep of sample
      type: String
    - contextPath: VMRay.Sample.Severity
      description: Severity of sample in submission (Malicious, Suspicious, Good,
        Blacklisted, Whitelested, Unknown)
      type: String
    - contextPath: VMRay.Sample.Type
      description: File type
      type: String
    - contextPath: VMRay.Sample.Created
      description: timestamp of created sample
      type: Date
    - contextPath: VMRay.Sample.Classifications
      description: Classifications of sample
      type: String
  - arguments:
    - default: false
      description: ID of sample (can get from VMRay.Sample.ID)
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: Get threat indicators (VTI)
    execution: false
    name: vmray-get-threat-indicators
    outputs:
    - contextPath: VMRay.ThreatIndicator.AnalysisID
      description: List of connected analyses ids
      type: Number
    - contextPath: VMRay.ThreatIndicator.Category
      description: Category of threat indicators
      type: String
    - contextPath: VMRay.ThreatIndicator.Classification
      description: Classifications of threat indicators
      type: String
    - contextPath: VMRay.ThreatIndicator.ID
      description: ID of threat indicator
      type: Number
    - contextPath: VMRay.ThreatIndicator.Operation
      description: Operation the indicators caused
      type: String
  - arguments:
    - default: false
      description: ID of submission to add tag to
      isArray: false
      name: submission_id
      required: false
      secret: false
    - default: false
      description: ID of analysis to delete tag from
      isArray: false
      name: analysis_id
      required: false
      secret: false
    - default: false
      description: Tag to add
      isArray: false
      name: tag
      required: false
      secret: false
    deprecated: false
    description: Adds a tag to analysis and/or submission
    execution: false
    name: vmray-add-tag
  - arguments:
    - default: false
      description: ID of analysis to delete tag from
      isArray: false
      name: analysis_id
      required: false
      secret: false
    - default: false
      description: ID of submission to delete tag from
      isArray: false
      name: submission_id
      required: false
      secret: false
    - default: false
      description: Tag to delete
      isArray: false
      name: tag
      required: false
      secret: false
    deprecated: false
    description: Delete tags from analysis and/or submission
    execution: false
    name: vmray-delete-tag
  - arguments:
    - default: false
      description: if of sample
      isArray: false
      name: sample_id
      required: true
      secret: false
    deprecated: false
    description: getting iocs of given sample
    execution: false
    name: vmray-get-iocs
    outputs:
    - contextPath: VMRay.Sample.IOC.URL.AnalysisID
      description: IDs of other analyses conatining given URL
      type: Number
    - contextPath: VMRay.Sample.IOC.URL.URL
      description: URL
      type: String
    - contextPath: VMRay.Sample.IOC.URL.Operation
      description: Operation of given url
      type: String
    - contextPath: VMRay.Sample.IOC.URL.ID
      description: ID of URL
      type: Number
    - contextPath: VMRay.Sample.IOC.URL.Type
      description: Type of url
      type: String
    - contextPath: VMRay.Sample.IOC.Domain.AnalysisID
      description: IDs of other analyses conatining given Domain
      type: Number
    - contextPath: VMRay.Sample.IOC.Domain.Domain
      description: Domain
      type: String
    - contextPath: VMRay.Sample.IOC.Domain.ID
      description: ID of domain
      type: Number
    - contextPath: VMRay.Sample.IOC.Domain.Type
      description: Type of domain
      type: String
    - contextPath: VMRay.Sample.IOC.IP.AnalysisID
      description: IDs of other analyses conatining given IP
      type: Number
    - contextPath: VMRay.Sample.IOC.IP.IP
      description: IP
      type: String
    - contextPath: VMRay.Sample.IOC.IP.Operation
      description: Operation of given IP
      type: String
    - contextPath: VMRay.Sample.IOC.IP.ID
      description: ID of IP
      type: Number
    - contextPath: VMRay.Sample.IOC.IP.Type
      description: Type of IP
      type: String
    - contextPath: VMRay.Sample.IOC.Mutex.AnalysisID
      description: IDs of other analyses conatining given IP
      type: Number
    - contextPath: VMRay.Sample.IOC.Mutex.Name
      description: Name of mutex
      type: String
    - contextPath: VMRay.Sample.IOC.Mutex.Operation
      description: Operation of given mutex
      type: String
    - contextPath: VMRay.Sample.IOC.Mutex.ID
      description: ID of mutex
      type: Number
    - contextPath: VMRay.Sample.IOC.Mutex.Type
      description: Type of mutex
      type: String
  - arguments:
    - default: false
      description: if of a job
      isArray: false
      name: job_id
      required: true
      secret: false
    deprecated: false
    description: Get job by id
    execution: false
    name: vmray-get-job-by-id
    outputs:
    - contextPath: VMRay.Job.JobID
      description: ID of job
      type: Number
    - contextPath: VMRay.Job.SampleID
      description: Sample ID of job
      type: Number
    - contextPath: VMRay.Job.SubmissionID
      description: ID of submission
      type: Number
    - contextPath: VMRay.Job.MD5
      description: MD5 of sample in job
      type: String
    - contextPath: VMRay.Job.SHA1
      description: SHA1 of sample in job
      type: String
    - contextPath: VMRay.Job.SHA256
      description: SHA256 of sample in job
      type: String
    - contextPath: VMRay.Job.SSDeep
      description: SSDeep of sample in job
      type: String
    - contextPath: VMRay.Job.VMName
      description: Name of virtual machine
      type: String
    - contextPath: VMRay.Job.VMID
      description: ID of virtual machine
      type: Number
    - contextPath: VMRay.Job.Status
      description: Status of job
      type: String
  dockerimage: demisto/python
  isfetch: false
  runonce: false
  script: ''
  type: python
