Python 3 compatibility fixes. Improved LOG encoding support.
improved return_error.
