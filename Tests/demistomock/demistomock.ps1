$global:InnerContext = '
{
    "linecount": 34,
    "native": false,
    "params": null,
    "args": {},
    "command": "",
    "context": {
      "Inv": {
        "mirrorTypes": null,
        "closed": "0001-01-01T00:00:00Z",
        "id": "52",
        "slackMirrorAutoClose": false,
        "dbotCreatedBy": "",
        "sortValues": null,
        "rawCategory": "",
        "roles": null,
        "type": 0,
        "created": "2019-09-30T22:53:28.969131+00:00",
        "runStatus": "completed",
        "hasRole": false,
        "category": "",
        "mirrorAutoClose": null,
        "status": 0,
        "ShardID": 0,
        "lastOpen": "0001-01-01T00:00:00Z",
        "version": 5,
        "creatingUserId": "admin",
        "users": [
          "admin"
        ],
        "tags": [
          "Automation"
        ],
        "details": "",
        "modified": "2020-02-29T15:57:18.778448+00:00",
        "name": "test email 6",
        "slackMirrorType": "",
        "systems": null,
        "reason": null,
        "entryUsers": [
          "admin"
        ],
        "previousRoles": null
      },
      "IsDebug": false,
      "IsNotFreeLicense": true,
      "IntegrationBrand": "",
      "CommonUserScript": "",
      "DockerImage": "demisto/powershell:6.2.3.5563",
      "ExposeDownloadDir": false,
      "IgnoreCounts": false,
      "LastCompletedTasks": null,
      "IntegrationInstance": "",
      "BrandContext": "",
      "DockerWorkingDir": "debug/lib/temp/script103016517",
      "ExecutionContext": {
        "File": [
          {
            "SHA1": "cd49084b3f75f085d3b2769340d9800071cb24ac",
            "Type": "PDF document, version 1.3",
            "SHA512": "6a47dcbf46a0424e1537ec955fd027e62f4faadcf3ae1565498c8308e4703ad0ac9cec3cb4f49457345ecffd75e4ca450fe2ef5d4c8c61383155dfc96b9f4a09",
            "Name": "test.pdf",
            "SHA256": "8c0d4220038c869b4238df4f0b19d33531346895649abb0c7412f93ec4bba256",
            "Size": 13326,
            "MD5": "9060c2d4f48745de19a5690d8e6cabe1",
            "EntryID": "12@52",
            "Info": "application/pdf",
            "Extension": "pdf",
            "SSDeep": "192:btaomgRSfbTdiMSDi8sTc4dsQYYmJ2HbFSGvyiGCTsTFGt7UtfZ9:btwliMSGTdEYJbFHvpKct7Utj"
          }
        ]
      },
      "Nested": 1,
      "ParentEntry": {
        "brand": "none",
        "recurrent": false,
        "parentContent": null,
        "pinned": false,
        "previousRoles": null,
        "isTodo": false,
        "times": 0,
        "contentsSize": 48,
        "reputations": null,
        "ShardID": 0,
        "parentEntryTruncated": false,
        "scheduled": false,
        "fileID": "",
        "retryTime": "0001-01-01T00:00:00Z",
        "tags": null,
        "timezoneOffset": 0,
        "file": "",
        "note": false,
        "id": "61@52",
        "taskId": "",
        "contents": "!pwsh script=\"Write-Output ''this is a test''\"",
        "version": 1,
        "format": "text",
        "user": "admin",
        "dbotCreatedBy": "",
        "hasRole": false,
        "parentId": "",
        "reputationSize": 0,
        "playbookId": "",
        "tagsRaw": null,
        "sortValues": null,
        "fileMetadata": null,
        "roles": null,
        "category": "chat",
        "cronView": false,
        "IndicatorTimeline": null,
        "modified": "2020-02-29T15:57:18.75963+00:00",
        "entryTask": null,
        "startDate": "0001-01-01T00:00:00Z",
        "investigationId": "52",
        "errorSource": "",
        "system": "",
        "created": "2020-02-29T15:57:18.759282+00:00",
        "endingDate": "0001-01-01T00:00:00Z",
        "type": 1
      },
      "ScriptType": "powershell",
      "Executor": true,
      "User": {
        "slackName": "",
        "investigationPage": "",
        "hours24": "",
        "theme": "dark",
        "lastHashChange": "2019-12-19T01:21:26.788439+00:00",
        "userType": 0,
        "lastMasterLogin": "0001-01-01T00:00:00Z",
        "recentFailedLogins": null,
        "status": 1,
        "email": "glichtman@paloaltonetworks.com",
        "homepage": "",
        "investogations": {
          "52": {},
          "1258": {}
        },
        "dashboards": null,
        "playgroundId": "24dde5a9-3f10-4ea7-8e9b-ca28c92790b7",
        "readOnly": false,
        "version": 8370,
        "userTimeZone": "America/Los_Angeles",
        "accUser": false,
        "allRoles": [
          "Administrator"
        ],
        "defaultAdmin": true,
        "hashHistory": null,
        "addedSharedDashboards": null,
        "timeZone": "",
        "phone": "+650-123456",
        "editedDashboards": null,
        "notify": null,
        "helpSnippetDisabled": false,
        "name": "Admin Dude",
        "sortValues": null,
        "disableHyperSearch": false,
        "closedInv": [
          "1",
          "11",
          "1285"
        ],
        "lastLogin": "2020-02-29T15:55:43.338458+00:00",
        "favoriteIncidents": {
          "362": {}
        },
        "dateFormat": "",
        "lastHomePageVisit": "0001-01-01T00:00:00Z",
        "shortcutsDisabled": false,
        "disabled": false,
        "username": "admin",
        "wasAssigned": false,
        "editorStyle": "",
        "modified": "2020-02-29T15:56:36.229614+00:00",
        "roles": {
          "demisto": [
            "Administrator"
          ]
        },
        "id": "admin",
        "playgroundCleared": true
      },
      "Lists": {},
      "IsRunningDocker": true,
      "PlaybookInputs": {},
      "IsSampling": false,
      "IntegrationContextChanged": false,
      "IntegrationContext": null,
      "Timeout": "2020-02-29T16:00:18.868979+00:00",
      "Incidents": [
        {
          "closeNotes": "",
          "autime": 1569883979231613000,
          "sourceInstance": "admin",
          "sla": 0,
          "type": "Phishing",
          "dbotCreatedBy": "",
          "closed": "0001-01-01T00:00:00Z",
          "category": "",
          "id": "52",
          "rawType": "Phishing",
          "closingUserId": "",
          "rawCloseReason": "",
          "severity": 0,
          "lastJobRunTime": "0001-01-01T00:00:00Z",
          "rawCategory": "",
          "sortValues": null,
          "parent": "",
          "account": "",
          "canvases": null,
          "playbookId": "ParseEmailFiles-test",
          "attachment": [
            {
              "description": "",
              "showMediaFile": false,
              "name": "test-report.txt",
              "type": "text/plain",
              "path": "52_f727e3b2-a821-4fff-8259-dd4cfab879c0_test-report.txt"
            }
          ],
          "details": "test email",
          "rawName": "test email 6",
          "notifyTime": "0001-01-01T00:00:00Z",
          "runStatus": "completed",
          "CustomFields": {
            "detectionsla": {
              "runStatus": "idle",
              "sla": 20,
              "breachTriggered": false,
              "startDate": "0001-01-01T00:00:00Z",
              "accumulatedPause": 0,
              "endDate": "0001-01-01T00:00:00Z",
              "dueDate": "0001-01-01T00:00:00Z",
              "lastPauseDate": "0001-01-01T00:00:00Z",
              "totalDuration": 0,
              "slaStatus": -1
            },
            "remediationsla": {
              "runStatus": "idle",
              "sla": 7200,
              "breachTriggered": false,
              "startDate": "0001-01-01T00:00:00Z",
              "accumulatedPause": 0,
              "endDate": "0001-01-01T00:00:00Z",
              "dueDate": "0001-01-01T00:00:00Z",
              "lastPauseDate": "0001-01-01T00:00:00Z",
              "totalDuration": 0,
              "slaStatus": -1
            },
            "timetoassignment": {
              "runStatus": "idle",
              "sla": 0,
              "breachTriggered": false,
              "startDate": "0001-01-01T00:00:00Z",
              "accumulatedPause": 0,
              "endDate": "0001-01-01T00:00:00Z",
              "dueDate": "0001-01-01T00:00:00Z",
              "lastPauseDate": "0001-01-01T00:00:00Z",
              "totalDuration": 0,
              "slaStatus": -1
            }
          },
          "previousRoles": null,
          "ShardID": 0,
          "sourceBrand": "Manual",
          "dueDate": "2019-10-10T22:52:59.231613+00:00",
          "status": 1,
          "labels": [
            {
              "value": "admin",
              "type": "Instance"
            },
            {
              "value": "Manual",
              "type": "Brand"
            }
          ],
          "created": "2019-09-30T22:52:59.231613+00:00",
          "droppedCount": 0,
          "hasRole": false,
          "rawJSON": "",
          "reason": "",
          "occurred": "2019-09-30T22:52:59.231613+00:00",
          "version": 7,
          "closeReason": "",
          "name": "test email 6",
          "lastOpen": "0001-01-01T00:00:00Z",
          "rawPhase": "",
          "isPlayground": false,
          "reminder": "0001-01-01T00:00:00Z",
          "phase": "",
          "investigationId": "52",
          "owner": "admin",
          "linkedCount": 0,
          "modified": "2019-11-05T14:06:38.679504+00:00",
          "linkedIncidents": null,
          "openDuration": 0,
          "roles": null,
          "activated": "0001-01-01T00:00:00Z"
        }
      ],
      "ParentPlaybookID": "",
      "LastRun": "",
      "Delta": "",
      "PlaybookQuery": null,
      "TempServerArtifactDir": "",
      "ExecutedCommands": [
        {
          "arguments": "{ script=\"Write-Output $global:InnerContext\" }",
          "moduleBrand": "Scripts",
          "execution": false,
          "name": "pwsh"
        }
      ],
      "IgnoreLock": false,
      "TimeoutDuration": 180000000000,
      "ScriptName": "ad-hoc script",
      "CommandsExecuted": {
        "Array": [
          0
        ],
        "CurrLevel": 0
      },
      "ExecutionPswd": ""
    },
    "integration": false
  }
'

#output stream to console
$global:DemistoOutputStream = [Console]::Out

function global:DemistoServerRequest ([hashtable]$Cmd)
{
    $Command = $Cmd | ConvertTo-Json -Compress -Depth 20
    Write-Debug $Command
    return {}
}

function global:DemistoServerLog([string]$level, $msg) {
    <#
    .Description
    Additional args are loged.
    For example DemistoServerLog "error" "this is a test log"
    #>
    return Write-Information "DemistoServerLog: ${level}: $msg $args"
}

