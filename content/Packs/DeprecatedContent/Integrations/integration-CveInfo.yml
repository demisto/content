commonfields:
  id: CVE Search
  version: -1
name: CVE Search
deprecated: true
system: true
display: CVE Search (Deprecated)
category: Vulnerability Management
image: data:image/png;base64,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
description: Deprecated. Search CVE Information - powered by circl.lu
defaultEnabled: false
configuration: []
script:
  script: >
    var sendRequest = function(url) {
        var res = http(
            url,
            {
                Method: 'GET',
                Headers: {
                    Accept: ['application/json'],
                    'User-Agent': ['Demisto CVE Integration']
                }
            }
        );
        if (res.StatusCode < 200 || res.StatusCode >= 300) {
            throw 'Request Failed.\nStatus code: ' + res.StatusCode + '.\nBody: ' + JSON.stringify(res) + '.';
        }
        if (res.Body === '') {
            throw 'No content recieved.';
        }
        var obj = JSON.parse(res.Body);
        return {body: res.Body, obj: obj, statusCode: res.StatusCode};
    };


    var cveToMd = function(o) {
        if (o && o.id) {
            var md = '### cicle.lu CVE: ' + o.id + '\n';
            md += 'Summary: **' + o.summary + '**\n';
            md += 'Published: **' + o.Published + '**\n';
            md += 'Modified: **' + o.Modified + '**\n';
            md += 'CVSS: **' + nvl(o.cvss) + '**\n';
            md += 'CVSS Time: **' + nvl(o['cvss-time']) + '**\n';
            if (o.references) {
                md += '#### References\n';
                for (var i=0; i<o.references.length; i++) {
                    md += '- [' + o.references[i] + '](' + o.references[i] + ')\n';
                }
            }
            md += objToList(o.access, 'Access');
            md += objToList(o.impact, 'Impact');
            md += objToList(o.map_cve_hp, 'HP');
            md += objToList(o.map_cve_nessus, 'Nessus');
            md += objToList(o.map_cve_ncip, 'NCIP');
            if (o.ranking) {
                md += '### Ranking' + '\n';
                md += objToMd(o.ranking) + '\n';
            }
            if (o.vulnerable_configuration && o.vulnerable_configuration.length > 0) {
                md += '### Vulnerable Configurations' + '\n';
                md += arrToMd(o.vulnerable_configuration) + '\n';
            }
            return md;
        }
        return 'No result found.';
    };


    var cveToContext = function(o) {
        if (o && o.id) {
            return {ID: o.id, CVSS: o.cvss, Published: o.Published, Modified: o.Modified, Description: o.summary};
        }
        return null;
    };


    var doCVE = function() {
        var cves = argToList(args.cveId.toUpperCase());
        var entries = [];
        for (var cve of cves) {
            var res = sendRequest('http://cve.circl.lu/api/cve/' + cve);
            var ec = {};
            ec[outputPaths.cve] = cveToContext(res.obj);
            entries.push({Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: cveToMd(res.obj), EntryContext: ec[outputPaths.cve] ? ec : {}});
        }
        return entries;
    };


    var doLatest = function() {
        var res = sendRequest('http://cve.circl.lu/api/last');
        var o = res.obj;
        var md = '## cicle.lu Latest CVEs\n';
        var context = {};
        var ec = [];
        if (o && Array.isArray(o)) {
            for (var i=0; i<o.length; i++) {
                md += cveToMd(o[i]) + '\n';
                var ecl = cveToContext(o[i]);
                if (ecl) {
                    ec.push(ecl);
                }
            }
            if (ec.length > 0) {
                context[outputPaths.cve] = ec;
            }
        } else {
            md += 'No result found.';
        }
        return {Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, HumanReadable: md, EntryContext: context};
    };


    // The command input arg holds the command sent from the user.

    switch (command) {
        // This is the call made when pressing the integration test button.
        case 'test-module':
            res = sendRequest('http://cve.circl.lu/api/last');
            return 'ok';
        case 'cve-search':
            return doCVE();
        case 'cve-latest':
            return doLatest();
        default:
            throw 'Unknown command - ' + command;
    }
  type: javascript
  commands:
  - name: cve-search
    arguments:
    - name: cveId
      required: true
      default: true
      description: A comma separated list of CVE IDs to search.
      isArray: true
    outputs:
    - contextPath: CVE.ID
      description: The ID of the CVE.
    - contextPath: CVE.CVSS
      description: The CVSS score of the CVE.
    - contextPath: CVE.Published
      description: The date the CVE was published.
    - contextPath: CVE.Modified
      description: The date the CVE was last modified.
    - contextPath: CVE.Description
      description: The description of the CVE.
    description: Search CVE by ID
  - name: cve-latest
    arguments: []
    outputs:
    - contextPath: CVE.ID
      description: The ID of the CVE.
    - contextPath: CVE.CVSS
      description: The CVSS score of the CVE.
    - contextPath: CVE.Published
      description: The date the CVE was published.
    - contextPath: CVE.Modified
      description: When CVE was last modified
    - contextPath: CVE.Description
      description: The description of the CVE.
    description: Retruns the latest updated CVEs.
tests:
- No test
fromversion: 5.0.0
