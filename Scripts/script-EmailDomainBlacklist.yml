commonfields:
  id: EmailDomainBlacklist
  version: -1
name: EmailDomainBlacklist
script: |-
  domainList = demisto.args()['domainList'].replace(' ', '').replace('\n','').split(',')
  emailAddresses = demisto.args()['value']

  filteredAddresses = []

  for address in emailAddresses:
    [user, domain] = address.split('@')

    if not domain in domainList:
        filteredAddresses.append(address)

  demisto.results(filteredAddresses)
type: python
tags:
- transformer
- general
- entirelist
comment: Accepts an array of domains as a blacklist, and a list of email addresses.   It
  will then then filter out any email address whose domain is in the blacklist.  The
  filtered list will be returned as an array.
enabled: true
args:
- name: value
  required: true
  description: An array of email addresses to be filtered by domain
  isArray: true
- name: domainList
  required: true
  description: An array containing domains to blacklist
  isArray: true
scripttarget: 0
runonce: false
runas: DBotWeakRole
