commonfields:
  id: CheckWhitelist
  version: -1
name: CheckWhitelist
script: |
  res = demisto.executeCommand("getList", {"listName": demisto.args()["whitelistname"]})
  if isError(res[0]):
      demisto.results(res)
  else:
      whitelist = res[0]['Contents']
      if demisto.args()['item'] in whitelist:
          answer = True
      else:
          answer = False
      demisto.results(answer)
      demisto.setContext('in_whitelist', answer)
type: python
tags:
- whitelist
comment: Check whether the given item is in the whitelist
system: true
args:
- name: item
  required: true
  default: true
  description: Item to check
- name: whitelistname
  defaultValue: Indicators Whitelist
  description: Name of whitelist to check
outputs:
- contextPath: in_whitelist
  description: Returns boolean True or False depending on whether the input was found
    in the whiltelist
scripttarget: 0
dependson: {}
timeout: 0s
