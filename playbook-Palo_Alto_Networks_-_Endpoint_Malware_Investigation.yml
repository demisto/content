description: "This playbook is triggered by a Palo Alto Networks Cortex threat alert,
  generated by Traps.  The playbook performs host enrichment for the source host with
  Palo Alto Networks Traps, enriches information for the suspicious file with Palo
  Alto Networks Minemeld and AutoFocus, and automatically performs file detonation
  for the extracted file. It then performs IOC enrichment with Minemeld for all related
  IOCs, and calculates the incident severity based on all the findings. In addition
  we detonate the file for the full analysis report. \nThe analyst can perform a manual
  memory dump for the suspected endpoint based on the incidentâ€™s severity, and choose
  to isolate the source endpoint with Traps.\nHunting tasks to find more endpoints
  that are infected is performed automatically based on a playbook input, and after
  all infected endpoints are found, remediation for all malicious IOCs is performed,
  including file quarantine, and IP and URLs blocking with Palo Alto Networks FireWall
  components such as Dynamic Address Groups and Custom URL Categories.\nAfter the
  investigation review the incident is automatically closed."
id: Palo Alto Networks - Endpoint Malware Investigation
inputs:
- description: |-
    This input establishes the threshold severity from which to perform auto-isolation for the infected endpoint.
    Default is High.
    Specify the severity number:
    0 - Unknown
    0.5 - Informational
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  key: AutoIsolation
  required: false
  value:
    simple: "3"
name: Palo Alto Networks - Endpoint Malware Investigation
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 7013d486-d71b-4117-8551-801797af55ca
      iscommand: false
      name: ""
      version: -1
    taskid: 7013d486-d71b-4117-8551-801797af55ca
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 480,
          "y": -220
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 4b8b5b93-5cec-4431-8d0d-cb58204bef47
      iscommand: false
      name: Detonation
      type: title
      version: -1
    taskid: 4b8b5b93-5cec-4431-8d0d-cb58204bef47
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 860,
          "y": 240
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "77"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 3dc7c828-d1d0-436f-815e-77185ec9bb13
      iscommand: false
      name: File Enrichment
      type: title
      version: -1
    taskid: 3dc7c828-d1d0-436f-815e-77185ec9bb13
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 100,
          "y": 240
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Address
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: IP.Address
                    operator: isExists
                root: IP
          operator: isExists
      label: "yes"
    id: "9"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "56"
    note: false
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Check if there are more IOCs to enrich?
      id: fbb76104-1dd1-47b5-810f-a4e891405e37
      iscommand: false
      name: Are there IP addresses to enrich?
      type: condition
      version: -1
    taskid: fbb76104-1dd1-47b5-810f-a4e891405e37
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1180
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 2a2324c7-c345-436f-89ad-07b03c4af941
      iscommand: false
      name: False Positive
      type: title
      version: -1
    taskid: 2a2324c7-c345-436f-89ad-07b03c4af941
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -120,
          "y": 2040
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "82"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 3e110991-baa2-42cf-87a4-8abb4e8fc4d7
      iscommand: false
      name: Hunting
      type: title
      version: -1
    taskid: 3e110991-baa2-42cf-87a4-8abb4e8fc4d7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2570
        }
      }
  "15":
    id: "15"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 912d95d9-2e84-40ef-826c-48e8c868f99c
      iscommand: false
      name: Remediation
      type: title
      version: -1
    taskid: 912d95d9-2e84-40ef-826c-48e8c868f99c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2895
        }
      }
  "19":
    id: "19"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "74"
      "Yes":
      - "86"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 2d655c15-5664-4bbb-88d4-81121aca3c50
      iscommand: false
      name: Manual - Get analyst approval for auto-remediation
      type: condition
      version: -1
    taskid: 2d655c15-5664-4bbb-88d4-81121aca3c50
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 3050
        }
      }
  "20":
    id: "20"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "83"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Manual review from the analyst.
      id: 56ecdcdc-b2f8-40b2-83d3-bd01efe4a466
      iscommand: false
      name: Manual review from the analyst
      type: regular
      version: -1
    taskid: 56ecdcdc-b2f8-40b2-83d3-bd01efe4a466
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 3390
        }
      }
  "21":
    id: "21"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      id: {}
      mndadone: {}
    separatecontext: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: d6f9907b-57cb-4019-818e-f6562ffa24d1
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: d6f9907b-57cb-4019-818e-f6562ffa24d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 3915
        }
      }
  "27":
    id: "27"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: ff288863-5690-432a-86ca-3a86d8350faa
      iscommand: false
      name: Endpoint Enrichment
      type: title
      version: -1
    taskid: ff288863-5690-432a-86ca-3a86d8350faa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 480,
          "y": -75
        }
      }
  "34":
    continueonerror: true
    id: "34"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    scriptarguments:
      filter_data:
        simple: "False"
      os: {}
      sample_id:
        simple: ${File.SHA256}
    separatecontext: false
    task:
      brand: AutoFocus V2
      description: Returns properties, behaviors, and activities observed for a sample.
        Run the command a single time to get the fields and operating systems under
        HTTP, Coverage, Behavior, Registry, Files, Processes, Connections, and DNS.
      id: 38e4c65c-c4df-4931-8db3-108a621d68fa
      iscommand: true
      name: AutoFocus - Perform Sample Analysis
      script: AutoFocus V2|||autofocus-sample-analysis
      type: regular
      version: -1
    taskid: 38e4c65c-c4df-4931-8db3-108a621d68fa
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 540
        }
      }
  "35":
    id: "35"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    scriptarguments:
      file:
        simple: ${incident.filehash}
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Search for file on lists
      id: c52cbff8-1755-4013-8f51-aab7b73d00bf
      iscommand: true
      name: Minemeld - File reputation
      script: Palo Alto Minemeld|||file
      type: regular
      version: -1
    taskid: c52cbff8-1755-4013-8f51-aab7b73d00bf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 880
        }
      }
  "45":
    id: "45"
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 497f868b-82fa-42ab-870f-0af527f51cc1
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 497f868b-82fa-42ab-870f-0af527f51cc1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -120,
          "y": 4090
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: severity
                root: incident
          operator: greaterThanOrEqual
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AutoIsolation
      label: "yes"
    id: "47"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "87"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: This task's condition establishes whether to perform auto-isolation
        based on the AutoIsolation input.
      id: aeb51990-d553-41d3-80ed-83af590c9949
      iscommand: false
      name: Perform auto-isolation?
      type: condition
      version: -1
    taskid: aeb51990-d553-41d3-80ed-83af590c9949
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1695
        }
      }
  "48":
    id: "48"
    ignoreworker: false
    nexttasks:
      Close as False positive:
      - "10"
      Continue:
      - "60"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Manual task for the analyst - Continue with the investigation or
        Close as False Positive?
      id: e7ddaea6-3c95-41a7-8d64-06750165004c
      iscommand: false
      name: Continue with the investigation or Close as False Positive?
      type: condition
      version: -1
    taskid: e7ddaea6-3c95-41a7-8d64-06750165004c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 160,
          "y": 1870
        }
      }
  "53":
    id: "53"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
      - "84"
      - "85"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 73104e89-00ed-4dde-85e2-9608cb339de5
      iscommand: false
      name: IOCs Enrichment
      type: title
      version: -1
    taskid: 73104e89-00ed-4dde-85e2-9608cb339de5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1040
        }
      }
  "54":
    id: "54"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    scriptarguments:
      domain:
        complex:
          accessor: Name
          root: Domain
          transformers:
          - operator: uniq
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Search for domain in lists
      id: 4a81f15b-da81-4bec-8a39-794972425408
      iscommand: true
      name: Minemeld - Domain Reputation
      script: Palo Alto Minemeld|||domain
      type: regular
      version: -1
    taskid: 4a81f15b-da81-4bec-8a39-794972425408
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1350
        }
      }
  "56":
    id: "56"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    scriptarguments:
      fullResponse: {}
      ip:
        complex:
          accessor: Address
          root: IP
          transformers:
          - operator: uniq
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Search for ip in miners
      id: 4da30cbd-bfaf-4d77-8917-dbc25c835f71
      iscommand: true
      name: Minemeld - IP Reputation
      script: Palo Alto Minemeld|||ip
      type: regular
      version: -1
    taskid: 4da30cbd-bfaf-4d77-8917-dbc25c835f71
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1220,
          "y": 1350
        }
      }
  "57":
    id: "57"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        complex:
          accessor: Data
          root: URL
          transformers:
          - operator: uniq
      wait: {}
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Search for url in lists
      id: c8b848b7-ca94-424a-8282-dd03b8cfd6ec
      iscommand: true
      name: Minemeld - URL Reputation
      script: Palo Alto Minemeld|||url
      type: regular
      version: -1
    taskid: c8b848b7-ca94-424a-8282-dd03b8cfd6ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 1350
        }
      }
  "60":
    id: "60"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "66"
      "Yes":
      - "87"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Get the analyst's approval to perform local containment for the
        suspected endpoint.
      id: dd9b1ee1-a7b2-45ea-87d4-5c835751e135
      iscommand: false
      name: Get analyst approval for local containment
      type: condition
      version: -1
    taskid: dd9b1ee1-a7b2-45ea-87d4-5c835751e135
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2040
        }
      }
  "61":
    id: "61"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "73"
    note: false
    separatecontext: true
    task:
      brand: ""
      id: cce6b5c0-93e2-4dfd-8d8e-5ed93b71e578
      iscommand: false
      name: WildFire - Detonate file
      playbookName: WildFire - Detonate file
      type: playbook
      version: -1
    taskid: cce6b5c0-93e2-4dfd-8d8e-5ed93b71e578
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 860,
          "y": 540
        }
      }
  "66":
    id: "66"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Manual task for the analyst - Perform manual Malware Analysis and
        Forensics.
      id: 0dca4b4c-8f48-4aa5-8ebf-d95bfac2e247
      iscommand: false
      name: Perform manual Malware Analysis and Forensics
      type: regular
      version: -1
    taskid: 0dca4b4c-8f48-4aa5-8ebf-d95bfac2e247
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2390
        }
      }
  "73":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: containsString
                    right:
                      value:
                        simple: Palo Alto Minemeld
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    id: "73"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "35"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if MineMeld integration is enabled.
      id: 2fc9da30-b2b2-4ac6-89c2-8051f2878452
      iscommand: false
      name: Is MineMeld Integration enabled?
      type: condition
      version: -1
    taskid: 2fc9da30-b2b2-4ac6-89c2-8051f2878452
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 710
        }
      }
  "74":
    id: "74"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Manual task for the analyst - Perform remediation for the incident.
      id: 07c679de-b8b7-484c-88dc-fba7921c948a
      iscommand: false
      name: Analyst manual Remediation
      type: regular
      version: -1
    taskid: 07c679de-b8b7-484c-88dc-fba7921c948a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 160,
          "y": 3220
        }
      }
  "75":
    id: "75"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "47"
    note: false
    separatecontext: true
    task:
      brand: ""
      id: 58bd2a20-c402-4d10-8f52-bdfbda8dfa52
      iscommand: false
      name: Calculate Severity - Standard
      playbookName: Calculate Severity - Standard
      type: playbook
      version: -1
    taskid: 58bd2a20-c402-4d10-8f52-bdfbda8dfa52
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1520
        }
      }
  "77":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: brand
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Autofocus
                  - left:
                      iscontext: true
                      value:
                        simple: modules.brand
                    operator: isEqualString
                    right:
                      value:
                        simple: AutoFocus V2
                - - left:
                      iscontext: true
                      value:
                        simple: modules.state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    id: "77"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "73"
      "yes":
      - "34"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Check if AutoFocus integration is enabled.
      id: 28fe89a9-d801-4f0c-82e7-89753f7a2efa
      iscommand: false
      name: Is AutoFocus Integration enabled?
      type: condition
      version: -1
    taskid: 28fe89a9-d801-4f0c-82e7-89753f7a2efa
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 100,
          "y": 370
        }
      }
  "78":
    id: "78"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
      - "5"
    note: false
    scriptarguments:
      endpoint_id:
        complex:
          accessor: agentid
          root: incident
    separatecontext: false
    task:
      brand: Traps
      description: Returns details for the specified endpoint.
      id: b679d668-037d-4473-8af9-cda5b2b5e0be
      iscommand: true
      name: Traps - Endpoint enrichment
      script: Traps|||traps-get-endpoint-by-id
      type: regular
      version: -1
    taskid: b679d668-037d-4473-8af9-cda5b2b5e0be
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 480,
          "y": 65
        }
      }
  "79":
    id: "79"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    scriptarguments:
      endpoint_id:
        complex:
          accessor: agentid
          root: incident
      event_id:
        complex:
          accessor: trapsid
          root: incident
      file_name:
        complex:
          accessor: filename
          root: incident
    separatecontext: true
    task:
      brand: ""
      id: a470a15a-ade6-46f4-847e-26fd10dc43dc
      iscommand: false
      name: Traps Retrieve And Download Files
      playbookName: Traps Retrieve And Download Files
      type: playbook
      version: -1
    taskid: a470a15a-ade6-46f4-847e-26fd10dc43dc
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 860,
          "y": 370
        }
      }
  "81":
    id: "81"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    scriptarguments:
      comment:
        simple: Closed after Demisto investigation.
      event_id:
        complex:
          accessor: trapsid
          root: incident
      status:
        simple: closed
    separatecontext: false
    task:
      brand: Traps
      description: Modifies the status and adds a comment to an existing event.
      id: a6888fad-d909-45e5-8911-bf3c103a0380
      iscommand: true
      name: Traps - Close event
      script: Traps|||traps-event-update
      type: regular
      version: -1
    taskid: a6888fad-d909-45e5-8911-bf3c103a0380
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 3740
        }
      }
  "82":
    id: "82"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: f00d0004-d994-4a3c-8096-0c184d24f6b9
      iscommand: false
      name: Manually hunt for additional infected endpoints
      type: regular
      version: -1
    taskid: f00d0004-d994-4a3c-8096-0c184d24f6b9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 400,
          "y": 2710
        }
      }
  "83":
    id: "83"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    separatecontext: false
    task:
      brand: ""
      description: Manually unisolate Traps endpoint after finalizing investigation
        and completing remediation steps.
      id: b5bc0835-df12-4e6b-86fa-70a3507a9411
      iscommand: false
      name: Manually unisolate Traps endpoint
      type: regular
      version: -1
    taskid: b5bc0835-df12-4e6b-86fa-70a3507a9411
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -120,
          "y": 3560
        }
      }
  "84":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Data
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: URL.Data
                    operator: isExists
                root: URL
          operator: isExists
      label: "yes"
    id: "84"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "57"
    note: false
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Check if there are more IOCs to enrich?
      id: 316b33be-fc49-4080-80c8-39a381475940
      iscommand: false
      name: Are there URLs to enrich?
      type: condition
      version: -1
    taskid: 316b33be-fc49-4080-80c8-39a381475940
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1650,
          "y": 1180
        }
      }
  "85":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: Domain.Name
                    operator: isExists
                root: Domain
          operator: isExists
      label: "yes"
    id: "85"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "75"
      "yes":
      - "54"
    note: false
    separatecontext: false
    task:
      brand: Palo Alto Minemeld
      description: Check if there are more IOCs to enrich?
      id: 54e86f05-46bd-485f-8f76-68ef0f775898
      iscommand: false
      name: Are there Domains to enrich?
      type: condition
      version: -1
    taskid: 54e86f05-46bd-485f-8f76-68ef0f775898
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 790,
          "y": 1180
        }
      }
  "86":
    id: "86"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "False"
      CustomURLCategory: {}
      DAG: {}
      EDLServerIP: {}
      EndpointId:
        complex:
          accessor: agentid
          root: incident
      EventId:
        complex:
          accessor: trapsid
          root: incident
      IP:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.Malicious
              operator: isExists
          root: IP
          transformers:
          - operator: uniq
      IPListName: {}
      LogForwarding: {}
      Miner: {}
      SHA256:
        complex:
          accessor: SHA256
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Malicious
              operator: isExists
          root: File
          transformers:
          - operator: uniq
      StaticAddressGroup: {}
      Traps:
        simple: "Yes"
      URL:
        complex:
          accessor: Data
          filters:
          - - left:
                iscontext: true
                value:
                  simple: URL.Malicious
              operator: isExists
          root: URL
          transformers:
          - operator: uniq
      URLListName: {}
    separatecontext: true
    task:
      brand: ""
      id: 8ac62e8d-63cf-4540-8849-3098d7a7bf4d
      iscommand: false
      name: Palo Alto Networks - Malware Remediation
      playbookName: Palo Alto Networks - Malware Remediation
      type: playbook
      version: -1
    taskid: 8ac62e8d-63cf-4540-8849-3098d7a7bf4d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 640,
          "y": 3220
        }
      }
  "87":
    id: "87"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "66"
    note: false
    scriptarguments:
      EndpointId:
        complex:
          accessor: agentid
          root: incident
    separatecontext: true
    task:
      brand: ""
      description: This playbook accepts an endpoint ID from Traps integration and
        performs isolation on this endpoint.
      id: 207ae31b-183d-4ba2-8fd6-5705aca11a40
      iscommand: false
      name: Isolate Endpoint - Traps
      playbookName: Traps Isolate Endpoint
      type: playbook
      version: -1
    taskid: 207ae31b-183d-4ba2-8fd6-5705aca11a40
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 840,
          "y": 2215
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "19_74_#default#": 0.67,
      "47_48_#default#": 0.5,
      "47_87_yes": 0.47,
      "60_66_#default#": 0.48,
      "60_87_Yes": 0.54,
      "73_35_yes": 0.54,
      "73_75_#default#": 0.35,
      "77_34_yes": 0.57,
      "77_73_#default#": 0.28,
      "84_75_#default#": 0.17,
      "9_75_#default#": 0.22
    },
    "paper": {
      "dimensions": {
        "height": 4375,
        "width": 2150,
        "x": -120,
        "y": -220
      }
    }
  }
