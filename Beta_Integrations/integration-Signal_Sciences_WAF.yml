commonfields:
  id: Signal Sciences WAF
  version: -1
name: Signal Sciences WAF
display: Signal Sciences WAF
category: Network Security
image: data:image/png;base64,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
description: Protect your web application using Signal Sciences
configuration:
- display: Email
  name: Email
  defaultvalue: ""
  type: 0
  required: true
- display: Token
  name: Token
  defaultvalue: ""
  type: 4
  required: true
- display: Corporation Name
  name: corpName
  defaultvalue: ""
  type: 0
  required: true
script:
  script: |-
    ''' IMPORTS '''
    import os
    import json
    import requests
    import datetime

    ''' GLOBAL VARS '''
    USE_SSL = True

    EMAIL = demisto.params()['Email']
    TOKEN = demisto.params()['Token']
    CORPNAME = demisto.params()['corpName']

    SERVER_URL = 'https://dashboard.signalsciences.net/api/v0/'

    '''SUFFIX ENDPOINTS'''
    GET_SITES_SUFFIX = 'corps/{0}/sites'
    WHITELIST_SUFFIX = 'corps/{0}/sites/{1}/whitelist'
    BLACKLIST_SUFFIX = 'corps/{0}/sites/{1}/blacklist'
    DELETE_WHITELIST_IP_SUFFIX = 'corps/{0}/sites/{1}/whitelist/{2}'
    DELETE_BLACKLIST_IP_SUFFIX = 'corps/{0}/sites/{1}/blacklist/{2}'

    '''TABLE TITLES'''
    WHITELIST_TITLE = 'Signal Sciences - Whitelist'
    BLACKLIST_TITLE = 'Signal Sciences - Blacklist'
    SITES_LIST_TITLE = "Sites list"
    ADD_IP_TO_WHITELIST_TITLE = 'Signal Sciences - Adding an IP to Whitelist'
    ADD_IP_TO_BLACKLIST_TITLE = 'Signal Sciences - Adding an IP to Blacklist'

    '''TABLE HEADERS'''
    ADD_IP_HEADERS = ['Source', 'Note', 'Expiration data']
    WHITELIST_HEADERS = ['ID', 'Source', 'ExpiryDate', 'Note', 'CreatedDate', 'CreatedBy']

    ''' HELPER FUNCTIONS '''
    def http_request(method, url, params_dict=None, data=None):
        LOG('running %s request with url=%s\nparams=%s' % (method, url, json.dumps(params_dict)))

        headers = {
                      'Content-Type': 'application/json',
                      'x-api-user': EMAIL,
                      'x-api-token': TOKEN
                  }

        try:
            res = requests.request(method,
                                   url,
                                   verify=USE_SSL,
                                   params=params_dict,
                                   headers=headers,
                                   data=data
                                  )
            res.raise_for_status()

            if 'whitelist/' in url or 'blacklist/' in url:
                return None

            return res.json()

        except Exception, e:
            LOG(e)
            raise(e)


    '''COMMANDS'''
    def test_module():
        try:
            url = SERVER_URL + 'corps'
            res = http_request('GET', url)
        except Exception, e:
            raise Exception(e.message)

        demisto.results('ok')


    def get_whitelist(siteName):
        """Get the whitelist data for siteName"""
        url = SERVER_URL + WHITELIST_SUFFIX.format(CORPNAME, siteName)
        site_whitelist = http_request('GET', url)
        data = site_whitelist.get('data', [])

        outputs = []
        for item in data:
            output = {}

            output['ID'] = item.get('id', '')
            output['Source'] = item.get('source', '')
            output['ExpiryDate'] = item.get('expires', '')
            output['Note'] = item.get('note', '')
            output['CreatedDate'] = item.get('created', '')
            output['CreatedBy'] = item.get('createdBy', '')

            outputs.append(output)

        sidedata = "Number of IPs in the Whitelist {0}".format(len(data))

        return {
            'Type': entryTypes['note'],
            'Contents': site_whitelist,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(WHITELIST_TITLE, outputs, WHITELIST_HEADERS, metadata=sidedata),
            'EntryContext': {
                'SigSciences.Whitelist(val.ID==obj.ID)': outputs,
            }
        }


    def get_blacklist(siteName):
        """Get blacklist data for siteName"""
        url = SERVER_URL + BLACKLIST_SUFFIX.format(CORPNAME, siteName)
        site_blacklist = http_request('GET', url)
        data = site_blacklist.get('data', [])

        outputs = []
        for item in data:
            output = {}

            output['ID'] = item.get('id', '')
            output['Source'] = item.get('source', '')
            output['ExpiryDate'] = item.get('expires', '')
            output['Note'] = item.get('note', '')
            output['CreatedDate'] = item.get('created', '')
            output['CreatedBy'] = item.get('createdBy', '')

            outputs.append(output)

        sidedata = "Number of IPs in the Blacklist {0}".format(len(data))

        return {
            'Type': entryTypes['note'],
            'Contents': site_blacklist,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(BLACKLIST_TITLE, outputs, WHITELIST_HEADERS, metadata=sidedata),
            'EntryContext': {
                'SigSciences.Blacklist(val.ID==obj.ID)': outputs,
            }
        }


    def add_ip_to_whitelist(siteName, ip, note, expires=None):
        """Add an ip to the whitelist"""
        url = SERVER_URL + WHITELIST_SUFFIX.format(CORPNAME, siteName)
        data = {
                   'source': ip,
                   'note': note
               }
        if expires is not None:
            data['expires'] = expires

        res = http_request('PUT', url, data=json.dumps(data))

        output = {}
        human_readable = {}
        output['ID'] = res.get('id', '')
        output['Note'] = res.get('note', '')
        output['Source'] = res.get('source', '')
        output['CreatedBy'] = res.get('createdBy', '')
        output['CreatedDate'] = res.get('created', '')
        output['ExpiryDate'] = res.get('expires', '')

        human_readable['Note'] = output['Note']
        human_readable['Source'] = output['Source']
        human_readable['Expiration data'] = output['ExpiryDate'] if output['ExpiryDate'] else "Not Set"

        sidedata = "The IP has been successfully added to whitelist."

        return {
            'Type': entryTypes['note'],
            'Contents': res,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(ADD_IP_TO_WHITELIST_TITLE, human_readable, ADD_IP_HEADERS, metadata=sidedata),
            'EntryContext': {
                'SigSciences.Whitelist(val.ID==obj.ID)': output,
            }
        }


    def add_ip_to_blacklist(siteName, ip, note, expires=None):
        """Add an ip to the blacklist"""
        url = SERVER_URL + BLACKLIST_SUFFIX.format(CORPNAME, siteName)
        data = {
                  'source': ip,
                  'note': note
               }
        if expires is not None:
            data['expires'] = expires

        res = http_request('PUT', url, data=json.dumps(data))

        output = {}
        human_readable = {}
        output['ID'] = res.get('id', '')
        output['Note'] = res.get('note', '')
        output['Source'] = res.get('source', '')
        output['CreatedBy'] = res.get('createdBy', '')
        output['CreatedDate'] = res.get('created', '')
        output['ExpiryDate'] = res.get('expires', '')

        human_readable['Note'] = output['Note']
        human_readable['Source'] = output['Source']
        human_readable['Expiration data'] = output['ExpiryDate'] if output['ExpiryDate'] else "Not Set"

        sidedata = "The IP has been successfully added to blacklist."

        return {
            'Type': entryTypes['note'],
            'Contents': res,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(ADD_IP_TO_BLACKLIST_TITLE, human_readable, ADD_IP_HEADERS, metadata=sidedata),
            'EntryContext': {
                'SigSciences.Blacklist(val.ID==obj.ID)': output,
            }
        }


    def whitelist_remove_ip(siteName, IP):
        """Remove an ip from the whitelist"""
        url = SERVER_URL + WHITELIST_SUFFIX.format(CORPNAME, siteName)
        site_whitelist = http_request('GET', url)
        data = site_whitelist.get('data', [])

        for item in data:
            if item.get('source', '') == IP:
                url = SERVER_URL + DELETE_WHITELIST_IP_SUFFIX.format(CORPNAME, siteName, item.get('id', ''))
                res = http_request('DELETE', url)

        if 'res' not in locals():
            raise Exception("The IP {0} was not found on the WhiteList".format(IP))

        else:
            human_readable = '### Signal Sciences - Removing an IP from Whitelist \n\n The IP has been successfully removed from Whitelist.'

        return {
            'Type': entryTypes['note'],
            'Contents': res,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': human_readable,
            'EntryContext': {
                'SigSciences.Whitelist(val.ID==obj.ID)': {},
            }
        }


    def blacklist_remove_ip(siteName, IP):
        """Remove an ip from the blacklist"""
        url = SERVER_URL + BLACKLIST_SUFFIX.format(CORPNAME, siteName)
        site_blacklist = http_request('GET', url)
        data = site_blacklist.get('data', [])

        for item in data:
            if item.get('source', '') == IP:
                url = SERVER_URL + DELETE_BLACKLIST_IP_SUFFIX.format(CORPNAME, siteName, item.get('id', ''))
                res = http_request('DELETE', url)

        if 'res' not in locals():
            raise Exception("The IP {0} was not found on the BlackList".format(IP))

        else:
            human_readable = '### Signal Sciences - Removing an IP from Blacklist \n\n The IP has been successfully removed from Blacklist.'

        return {
            'Type': entryTypes['note'],
            'Contents': res,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': human_readable,
            'EntryContext': {
                'SigSciences.Blacklist(val.ID==obj.ID)': {},
            }
        }


    def get_sites():
        """Get the sites list"""
        url = SERVER_URL + GET_SITES_SUFFIX.format(CORPNAME)
        res = http_request('GET', url)
        data = res.get('data', [])

        outputs = []
        for item in data:
            output = {}
            output['Name'] = item.get('name', '')
            output['CreatedDate'] = item.get('created', '')

            outputs.append(output)

        return {
            'Type': entryTypes['note'],
            'Contents': res,
            'ContentsFormat': formats['json'],
            'ReadableContentsFormat': formats['markdown'],
            'HumanReadable': tableToMarkdown(SITES_LIST_TITLE, outputs, ['Name', 'CreatedDate']),
            'EntryContext': {
                'SigSciences.Sites(val.Name==obj.Name)': outputs,
            }
        }

    ''' EXECUTION CODE '''

    LOG('command is %s' % (demisto.command(), ))

    try:
        if demisto.command() == 'test-module':
            test_module()
        elif demisto.command() == 'sigsci-get-whitelist':
            demisto.results(get_whitelist(**demisto.args()))
        elif demisto.command() == 'sigsci-get-blacklist':
            demisto.results(get_blacklist(**demisto.args()))
        elif demisto.command() == 'sigsci-whitelist-add-ip':
            demisto.results(add_ip_to_whitelist(**demisto.args()))
        elif demisto.command() == 'sigsci-blacklist-add-ip':
            demisto.results(add_ip_to_blacklist(**demisto.args()))
        elif demisto.command() == 'sigsci-whitelist-remove-ip':
            demisto.results(whitelist_remove_ip(**demisto.args()))
        elif demisto.command() == 'sigsci-blacklist-remove-ip':
            demisto.results(blacklist_remove_ip(**demisto.args()))
        elif demisto.command() == 'sigsci-get-sites':
            demisto.results(get_sites(**demisto.args()))


    except Exception, e:
        LOG(e.message)
        LOG.print_log()
        raise
  type: python
  commands:
  - name: sigsci-get-whitelist
    arguments:
    - name: siteName
      required: true
      description: 'Please input the siteName you want see whitelist for. e.g : siteName='
    outputs:
    - contextPath: SigSciences.Whitelist.ID
      description: ID for this particular entry.
      type: string
    - contextPath: SigSciences.Whitelist.Source
      description: IP Address present in the whitelist.
      type: string
    - contextPath: SigSciences.Whitelist.ExpiryDate
      description: Expiration Timestamp.
      type: date
    - contextPath: SigSciences.Whitelist.Note
      description: Note associated with the tag.
      type: string
    - contextPath: SigSciences.Whitelist.CreatedDate
      description: Created Date Timestamp
      type: date
    - contextPath: SigSciences.Whitelist.CreatedBy
      description: User who added this source.
      type: string
    description: Fetch whitelist residing on Signal Sciences' Platform.
  - name: sigsci-get-blacklist
    arguments:
    - name: siteName
      required: true
      description: 'Please input the siteName you want see whitelist for. e.g : siteName='
    outputs:
    - contextPath: SigSciences.Blacklist.ID
      description: ID for this particular entry.
      type: string
    - contextPath: SigSciences.Blacklist.Source
      description: IP Address present in the blacklist.
      type: string
    - contextPath: SigSciences.Blacklist.ExpiryDate
      description: Expiration Timestamp.
      type: date
    - contextPath: SigSciences.Blacklist.Note
      description: Note associated with the tag.
      type: string
    - contextPath: SigSciences.Blacklist.CreatedDate
      description: Created Date Timestamp
      type: date
    - contextPath: SigSciences.Blacklist.CreatedBy
      description: User who added this source.
      type: string
    description: Fetch blacklist residing on Signal Sciences' Platform.
  - name: sigsci-whitelist-add-ip
    arguments:
    - name: siteName
      required: true
      description: 'Please input the siteName you want see whitelist for. e.g : siteName='
    - name: ip
      required: true
      description: IP Address to be added.
    - name: note
      required: true
      description: Note associated with the tag.
    - name: expires
      description: Optional RFC3339-formatted datetime in the future. Omit this paramater
        if it does not expire.
    outputs:
    - contextPath: SigSciences.Whitelist.Source
      description: IP Address present in the whitelist.
      type: string
    - contextPath: SigSciences.Whitelist.Note
      description: Note associated with the tag.
      type: string
    - contextPath: SigSciences.Whitelist.ID
      description: ID for this particular entry.
      type: string
    - contextPath: SigSciences.Whitelist.CreatedBy
      description: User who added this source.
      type: string
    - contextPath: SigSciences.Whitelist.CreatedDate
      description: Created Date Timestamp
      type: date
    - contextPath: SigSciences.Whitelist.ExpiryDate
      description: Expiration Timestamp.
      type: date
    description: Add an IP to the whitelist residing on Signal Sciences' Platform.
  - name: sigsci-blacklist-add-ip
    arguments:
    - name: siteName
      required: true
      description: 'Please input the siteName you want see whitelist for. e.g : siteName='
    - name: ip
      required: true
      description: IP Address to be added.
    - name: note
      required: true
      description: Note associated with the tag.
    - name: expires
      description: Optional RFC3339-formatted datetime in the future. Omit this paramater
        if it does not expire.
    outputs:
    - contextPath: SigSciences.Blacklist.Source
      description: IP Address present in the Blacklist.
      type: string
    - contextPath: SigSciences.Blacklist.Note
      description: Note associated with the tag.
      type: string
    - contextPath: SigSciences.Blacklist.ID
      description: ID for this particular entry.
      type: string
    - contextPath: SigSciences.Blacklist.CreatedBy
      description: User who added this source.
      type: string
    - contextPath: SigSciences.Blacklist.CreatedDate
      description: Created Date Timestamp.
      type: date
    - contextPath: SigSciences.Blacklist.ExpiryDate
      description: Expiration Timestamp.
      type: date
    description: Add an IP to the blacklist residing on Signal Sciences' Platform.
  - name: sigsci-whitelist-remove-ip
    arguments:
    - name: siteName
      required: true
      description: 'Please input the siteName you want see whitelist for. e.g : siteName='
    - name: IP
      required: true
      description: IP Address entry to be removed.
    description: Remove an IP from whitelist residing on Signal Sciences' Platform.
  - name: sigsci-blacklist-remove-ip
    arguments:
    - name: siteName
      required: true
      description: 'Please input the siteName you want see blacklist for. e.g : siteName='
    - name: IP
      required: true
      description: IP Address entry to be removed.
    description: Remove an IP from blacklist residing on Signal Sciences' Platform.
  - name: sigsci-get-sites
    arguments: []
    outputs:
    - contextPath: SigSciences.Sites.Name
      description: Site name
      type: string
    - contextPath: SigSciences.Sites.CreatedDate
      description: Site creation date
      type: date
    description: Get all the site name from SignalSciences
  runonce: false
releaseNotes: "New integration with SignalSciences."
tests:
  - SignalSciences Test
