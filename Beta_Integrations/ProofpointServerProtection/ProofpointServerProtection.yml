commonfields:
  id: Proofpoint Server Protection
  version: -1
name: Proofpoint Server Protection
display: Proofpoint Server Protection
category: Email Gateway
description: Proofpoint email security appliance.
configuration:
- display: Server URL (e.g. https://192.168.0.1:10000)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Username
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Trust any certificate (not secure)
  name: unsecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
script:
  script: ''
  type: python
  commands:
  - name: proofpoint-download-email
    arguments:
    - name: message_id
      required: true
      default: true
      description: Email message ID to download
    description: Download email message by ID.
  - name: proofpoint-quarantine-messages
    arguments:
    - name: folder
      description: Folder name to quarantine.
    - name: sender
      description: Messages from sender to quarantine.
    - name: subject
      description: Messages subject to quarantine.
    - name: recipient
      description: Messages to recipient to quarantine.
    outputs:
    - contextPath: Proofpoint.Quarantine.Message.ID
      description: Message ID
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Date
      description: Message date
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Recipient
      description: Message recipient
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Sender
      description: Message sender
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Subject
      description: Message subject
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Folder
      description: Message folder
      type: string
    description: Quarantine email message.
  - name: proofpoint-smart-search
    arguments:
    - name: sender
      description: Email sender.
    - name: recipient
      description: Email recipient.
    - name: subject
      description: Email subject.
    - name: process
      auto: PREDEFINED
      predefined:
      - "1"
      - "2"
      - "3"
      - "4"
      - "5"
      - "100"
      - "200"
      - "500"
      - "1000"
      description: Max results
      defaultValue: "100"
    - name: sender_hostname
      description: Sender hostname/IP address
    - name: attachment
      description: Attachment name
    - name: qid
      description: QID
    - name: time
      auto: PREDEFINED
      predefined:
      - Last15Minutes
      - Last60Minutes
      - Last3Hours
      - Last24Hours
      - Last7Days
      - Last15Days
      - Last30Days
      - Last90Days
      description: Time period in which the email was recieved.
      defaultValue: Last24Hours
    - name: message_id
      description: Email message ID.
    - name: virus_name
      description: Virus name.
    - name: sid
      description: SID
    - name: guid
      description: GUID
    outputs:
    - contextPath: Proofpoint.SmartSearch.SMIMERecipients
      type: string
    - contextPath: Proofpoint.SmartSearch.FID
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageID
      type: string
    - contextPath: Proofpoint.SmartSearch.Proofpoint.SmartSearch.Suborg
      type: string
    - contextPath: Proofpoint.SmartSearch.Agent
      type: string
    - contextPath: Proofpoint.SmartSearch.AttachmentNames
      type: string
    - contextPath: Proofpoint.SmartSearch.MoudleID
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageSize
      type: string
    - contextPath: Proofpoint.SmartSearch.SpamScore
      type: string
    - contextPath: Proofpoint.SmartSearch.GUID
      type: string
    - contextPath: Proofpoint.SmartSearch.QuarantineRule
      type: string
    - contextPath: Proofpoint.SmartSearch.VirusNames
      type: string
    - contextPath: Proofpoint.SmartSearch.Subject
      type: string
    - contextPath: Proofpoint.SmartSearch.QID
      type: string
    - contextPath: Proofpoint.SmartSearch.FinalAction
      type: string
    - contextPath: Proofpoint.SmartSearch.DispositionAction
      type: string
    - contextPath: Proofpoint.SmartSearch.SID
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailToStat
      type: string
    - contextPath: Proofpoint.SmartSearch.Date
      type: date
    - contextPath: Proofpoint.SmartSearch.PERecipients
      type: string
    - contextPath: Proofpoint.SmartSearch.FQIN
      type: string
    - contextPath: Proofpoint.SmartSearch.FinalRule
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailStat
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageSplit
      type: string
    - contextPath: Proofpoint.SmartSearch.Duration
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailAction
      type: string
    - contextPath: Proofpoint.SmartSearch.Sender
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailIPAddress
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailTo
      type: string
    - contextPath: Proofpoint.SmartSearch.Recipients
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailRawLog
      type: string
    - contextPath: Proofpoint.SmartSearch.TLS
      type: string
    - contextPath: Proofpoint.SmartSearch.QuarantineFolder
      type: string
    - contextPath: Proofpoint.SmartSearch.RawLog
      type: string
    - contextPath: Proofpoint.SmartSearch.DispositionSmtpProfile
      type: string
    - contextPath: Proofpoint.SmartSearch.PolicyRoutes
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageEncrypted
      type: string
    - contextPath: Proofpoint.SmartSearch.SenderHost
      type: string
    - contextPath: Proofpoint.SmartSearch.SMIMRecipientsSigned
      type: string
    description: Searches for emails.
  - name: proofpoint-quarantine-folders
    arguments: []
    outputs:
    - contextPath: Proofpoint.Quarantine.Folder.Name
      description: Folder name
      type: string
    description: Returns a list of quarantined folders.
  - name: proofpoint-release-email
    arguments:
    - name: message_id
      required: true
      description: Email message ID to release.
    - name: folder
      required: true
      description: Email folder to release.
    description: Release email with virus scan
  - name: proofpoint-add-to-blocked-senders-list
    arguments:
    - name: email
      required: true
      description: Email to add to blocked senders list
    description: Adds an email address to blocked senders list.
  - name: proofpoint-add-to-safe-senders-list
    arguments:
    - name: email
      required: true
      description: Email to add to safe senders list
    description: Adds an email address to safe senders list.
  - name: proofpoint-remove-from-blocked-senders-list
    arguments:
    - name: email
      required: true
      description: Email to remove from blocked senders list
    description: Removes an email address from blocked senders list.
  - name: proofpoint-remove-from-safe-senders-list
    arguments:
    - name: email
      required: true
      description: Email to remove from safe senders list
    description: Removes an email address from safe senders list.
  dockerimage: demisto/bs4:latest
  runonce: false
  subtype: python2
beta: true
