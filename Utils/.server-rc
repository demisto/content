export SERVER=$GOPATH/src/github.com/demisto/server

alias server="cd $SERVER"

alias start_server="$GOPATH/bin/server -public ~/dev/demisto/web-client/dist/ -conf conf_for_systemtests -insecure -loglevel info -stdout"

function start_new_server() {
    cp $GOPATH/src/github.com/demisto/server/conf/testdata/onetimeconf.json $GOPATH/src/github.com/demisto/server
    $GOPATH/bin/server -public ~/dev/demisto/web-client/dist/ -conf conf_for_systemtests -insecure -loglevel info -stdout -onetimeconf onetimeconf.json
}

function create_golang_env() {
    /usr/bin/ruby -e '$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)'
    brew install go
    mkdir $HOME/dev/go
    export GOPATH=$HOME/dev/go
}

function setup_server_repo() {
    if [[ "$1" == "--help" ]]; then
      echo "Usage: setup_server_repo <Server path in git>"
    else
      mkdir $HOME/dev/go/src
      mkdir $HOME/dev/go/src/github.com
      mkdir $HOME/dev/go/src/github.com/demisto
      git clone git@github.com:demisto/server.git
      cd $HOME/dev/go/src/github.com/demisto/server
      cp .hooks/* .git/hooks
      go get github.com/kardianos/govendor
      $GOPATH/bin/govendor sync
      go install
    fi
}

funcion install_extrenal_libs() {
    brew install libxmlsec1
    brew install phantomjs
}

function set_env() {
    if [[ "$1" == "--help" ]]; then
      echo "Usage: set_env <Server path in git>"
    else
      create_golang_env
      setup_server_repo
      install_extrenal_libs
    fi
}
