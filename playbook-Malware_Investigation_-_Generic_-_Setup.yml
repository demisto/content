description: |-
  Verify file sample and hostname information for the "Malware Investigation - Generic" playbook.
  If the file sample or hostname are missing, the playbook will attempt to retrieve them using one or more integrations
id: malware_investigation-_generic_-_setup
inputs:
- description: Malware sample to investigation
  key: File
  required: false
  value:
    complex:
      root: File
- description: MD5 to investigation
  key: MD5
  required: false
  value:
    complex:
      accessor: MD5
      root: File
- description: SHA1 to investigation
  key: SHA1
  required: false
  value:
    complex:
      accessor: SHA1
      root: File
- description: SHA256 to investigation
  key: SHA256
  required: false
  value:
    complex:
      accessor: SHA256
      root: File
- description: Hostname to investigation
  key: Hostname
  required: false
  value:
    complex:
      accessor: Hostname
      root: Endpoint
- description: File path to get sample from
  key: Path
  required: false
  value:
    complex:
      accessor: Path
      root: File
name: Malware Investigation - Generic - Setup
outputs:
- contextPath: Endpoint
  description: The endpoint
  type: unknown
- contextPath: Endpoint.Hostname
  description: Device hostname
  type: string
- contextPath: File
  description: File sample object
  type: unknown
starttaskid: "0"
system: true
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
      - "12"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: f32e3309-cd35-442c-89bb-aedad44e51bc
      iscommand: false
      name: ""
      version: -1
    taskid: f32e3309-cd35-442c-89bb-aedad44e51bc
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 50
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 6cb37fdd-3179-44d7-8846-a16dcc2062f6
      iscommand: false
      name: Validate file sample
      type: title
      version: -1
    taskid: 6cb37fdd-3179-44d7-8846-a16dcc2062f6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 195
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.File.EntryID
                    operator: isExists
                root: inputs.File
          operator: isExists
      label: "yes"
    id: "2"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "3"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: c7670e54-f3e4-4a0d-89c9-e9340888ae6b
      iscommand: false
      name: Do we have a file sample?
      type: condition
      version: -1
    taskid: c7670e54-f3e4-4a0d-89c9-e9340888ae6b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 340
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 3c625815-68d5-4647-8891-11ba875c03c5
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 3c625815-68d5-4647-8891-11ba875c03c5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 387.5,
          "y": 1527
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "18"
    note: false
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
      SHA256:
        complex:
          root: inputs.SHA256
    separatecontext: true
    task:
      brand: ""
      id: a0a3c0b4-515b-4cf6-8347-cdb7faa041f3
      iscommand: false
      name: Get File Sample By Hash - Generic
      playbookName: Get File Sample By Hash - Generic
      type: playbook
      version: -1
    taskid: a0a3c0b4-515b-4cf6-8347-cdb7faa041f3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 117.5,
          "y": 660
        }
      }
  "6":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: File.EntryID
                    operator: isExists
                root: File
          operator: isExists
      label: "yes"
    id: "6"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "3"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 2b71b1fe-ddb3-482a-8166-a8967829aba1
      iscommand: false
      name: Did we get a file sample?
      type: condition
      version: -1
    taskid: 2b71b1fe-ddb3-482a-8166-a8967829aba1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -85,
          "y": 970
        }
      }
  "7":
    id: "7"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 496fdc1e-a8b5-421f-8d42-a29432859fd3
      iscommand: false
      name: File sample is missing
      type: title
      version: -1
    taskid: 496fdc1e-a8b5-421f-8d42-a29432859fd3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -85,
          "y": 1213
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 06ca5c31-261e-40b2-826d-1e0b6b994130
      iscommand: false
      name: Manually upload file sample
      type: regular
      version: -1
    taskid: 06ca5c31-261e-40b2-826d-1e0b6b994130
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -85,
          "y": 1350
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "5"
      - "11"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 52be4e01-b393-484d-8462-fc518e9dc3c2
      iscommand: false
      name: Try to get file sample
      type: title
      version: -1
    taskid: 52be4e01-b393-484d-8462-fc518e9dc3c2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -85,
          "y": 515
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "18"
    note: false
    scriptarguments:
      Hostname:
        complex:
          root: inputs.Hostname
      Path:
        complex:
          root: inputs.Path
      UseD2:
        simple: "no"
    separatecontext: true
    task:
      brand: ""
      id: bb16ce78-06ab-4251-81a9-4a3bcd31426e
      iscommand: false
      name: Get File Sample From Path - Generic
      playbookName: Get File Sample From Path - Generic
      type: playbook
      version: -1
    taskid: bb16ce78-06ab-4251-81a9-4a3bcd31426e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -290,
          "y": 660
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: cd33187e-1841-4fc0-82d0-92a0aff2bed1
      iscommand: false
      name: Validate endpoint
      type: title
      version: -1
    taskid: cd33187e-1841-4fc0-82d0-92a0aff2bed1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 645,
          "y": 195
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Hostname
          operator: isExists
      label: "yes"
    id: "13"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "3"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: ad325a74-79b8-49d4-8332-59488cad36d1
      iscommand: false
      name: Do we have a Hostname?
      type: condition
      version: -1
    taskid: ad325a74-79b8-49d4-8332-59488cad36d1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 645,
          "y": 340
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - "15"
    note: false
    scriptarguments:
      MD5Hash:
        complex:
          root: inputs.MD5
      SHA1Hash:
        complex:
          root: inputs.SHA1
      SHA256Hash:
        complex:
          root: inputs.SHA256
    separatecontext: true
    task:
      brand: ""
      description: Hunt using available tools
      id: 9df62264-a011-4474-8504-ec1eeeaeb32a
      iscommand: false
      name: Search Endpoints By Hash - Generic
      playbookName: Search Endpoints By Hash - Generic
      type: playbook
      version: -1
    taskid: 9df62264-a011-4474-8504-ec1eeeaeb32a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 645,
          "y": 565
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Hostname
                root: Endpoint
          operator: isExists
      label: "yes"
    id: "15"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "3"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 5afea8b2-3723-4c9b-81e5-0a8565d11903
      iscommand: false
      name: Did we get a Hostname?
      type: condition
      version: -1
    taskid: 5afea8b2-3723-4c9b-81e5-0a8565d11903
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 645,
          "y": 755
        }
      }
  "16":
    id: "16"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 91e8996a-4e32-4041-882d-f37d07c4c54c
      iscommand: false
      name: Hostname is missing
      type: title
      version: -1
    taskid: 91e8996a-4e32-4041-882d-f37d07c4c54c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1035
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    scriptarguments:
      append: {}
      key:
        simple: Endpoint.Hostname
      value: {}
    separatecontext: false
    task:
      brand: ""
      id: 9b2ade69-a18a-4ef6-8492-24467f71b7eb
      iscommand: false
      name: Manually enter a Hostname
      scriptName: Set
      type: regular
      version: -1
    taskid: 9b2ade69-a18a-4ef6-8492-24467f71b7eb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1198
        }
      }
  "18":
    id: "18"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    separatecontext: false
    task:
      brand: ""
      id: 98cf5f35-2be9-49ab-8e2f-aa6c5ab9873b
      iscommand: false
      name: Check file sample results
      type: title
      version: -1
    taskid: 98cf5f35-2be9-49ab-8e2f-aa6c5ab9873b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -85,
          "y": 825
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1542,
        "width": 1315,
        "x": -290,
        "y": 50
      }
    }
  }
