category: Network Security
commonfields:
  id: ExtraHop v2
  version: -1
configuration:
- defaultvalue: ""
  display: URL
  name: url
  required: true
  type: 0
- defaultvalue: ""
  display: API Key
  name: apikey
  required: true
  type: 4
- defaultvalue: "false"
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Network detection and response. Complete visibility of network communications
  at enterprise scale, real-time threat detections backed by machine learning, and
  guided investigation workflows that simplify response.
detaileddescription: |
  Visit the [ExtraHop + Demisto Setup Guide](https://www.extrahop.com/customers/community/bundles/extrahop/demisto-integration/) for detailed integration instructions.
display: ExtraHop Reveal(x)
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAH7UlEQVR42u1aaWxVRRR+777XAlpAAQEFG0SRIlBQEIQEQRBQI4LRxjVxwQjEqD/QqDEqLRUBEUExoCzKJggqoAGEtKgYd2STTdAgEiSoIFLWthTPJd9JPse5992uLpmTfLl9d+7MnTnfOWfOmdtYzIkTJ06cOHHixIkTJ06cOHHixIkTJ06cOHHipAokLvAESUHCqeP/JV4A4TVtYL5xpYUgWYl5eTBcrwbWkqT52iRBa6oxPdcSZAquFvSsYZK9GjCef9J4U7272uczQnBAcFhwSnBc0LAKlK9eE2bROn5twZ2CXMEzgqfp+pQgT3BviFfEQrzFlxsE32K86jCqOK3jYeh0cMAzOWh/TNCoJkg+BGJ9nMS1o6Gg8oTXREQLViX7xrSF5hCGHFKkGXJ1HkkyhNq4zkT/D4z+HFaTNKZHc/XIQE1omI3TWlSHu2hecXrfR7Se9qRnL8UWZa6Vt66EAdbB6QkdE5wQFON3G1q4F+KFYZbXCIYyEBY7xOiThuvjWOxRXL8RrBQUCgpwXSH4UtC7HCGO76/B2POqaftQvTQR/IZ3rQ2IJovRfoz0nFZN29lpHZQYXrKPLD9McXztK3hAMEGwVLBZcNDigf0Nj/FlIrW/FGHSLwuWC5YJsul+HcFUwULBW4KzBVfh+SMYf7dgumCBYBz6pQtGC+YLlmBsn5x70N4cc5wrmCWYDcwQDEP+otKU1r0xgJz30V4quITa/fk+gjW8RvB/PypoYDjPOMzBn/ci6GMprr4hD9KHh2LBU6GYQTRQhqCVoI9guOB2Y3/1ZVpISC3DQtQ7Z1sIHk/Pq4eeCcXVAgEerjHscfr8AprrYLpfgHurSZmlxtyK8Uw9i5H7mIT251JsGxsE9fHsuQbBHHbVEJbSnNrhXmPBjyne8xMMKIZ+Uba0h4K8xE9KNgn20J6iaE7PtSIiNcSXYPJl1KfUErY0LL1Iz90fcf/+mnKGLNzbinu+t7bAvUGIKppAboGh5iHi+FIXnq2k3ArPvAzt3QWjkKDl4jpWsJcM40ny9oMBIVrlXbT7fTsYRlsMoscI8nHdSe8ZTgSr03wmuEvwoOA+9NH1bo4ZCZJ6yVqD1FLsGf7f19Bk76aJhVnSSbLC2iEE/yJ4AlFlGCzwNotRXE99RqO8098TjAQrDVWC6fEx8uCf0b4iYN+0SW96p0amZpS07oNhjAbGwEB2kE6U4Hwa62bjPQOpbRTutYdDnUKYNmUT2nbYPOQswa9kZWWGF+ZQnzHlJHgfhbN0g+ATAX2PGPu9Kn0V2n1P2o6//6DSI0Fe9Tva3yPy0ywEf0jnAkzuBYLrBDciunUEwcUWgosihE7VhxKcS209aJvSCKJt+RaC36QcRLP69WjbbksCziP3t4XZa6nPG+UkeA9N3PRgDeuF8LSFIGSiEZ5V8Z2NvZ5DGJ8SNSWCF1MOELcQXEi6UH3kGXrgd+q651g8+BBVAYVUDeyn/h3oHTpuLzIyX66ktmctBM8xMvkY8oK/ebBHCikCKbqvFtNi2lKfReTpYQSrcWyzlEkTLSEoyuFFl2ogeJUxt+4BW5WWkyUWgnUPXh8w/5WWPTiM4B4pCJ4blWD2ku8DiFpDL00iRY9CcImR3Xo0oSn0XF8j3KRTkZ+gjyK+fEJh/wf8XYSMlBfMBC8hAr0QglW5Q2hu83CcmwUi+9O6ZlsI3mhEA51PIRmLjeCrjByiZ4oQPddi1FaC2Tv6YUGTCNOwgF50CjM2YogupoQoZhyavErPDYxY6OdQnxGGlb9i7PFNKcl6J0WSVWgQPIzGHWD0axmRYPMkqyAFwVcYBtologczwetse3DU05LlRMYddApVEoBimkxXMqQkHVzoAj4XdBJcLGhtIIsUv42SKq0NPyXFtaH5NsFzatEtUd9nEMF7AggealGutrUlgmdZCN5gEOwZBHOIHknvGQeyGuA6NgXB040I3BzVyClE4sB9zjxz9VAz7qJFZUQsuLlESRgWektAUlZG0MX0Q82nz42kOfeh+4uNd6wztot9OFLMhKfvNQi27cGlqCvXA99ZvKgZbQcbjO3PRrCeRQ8w1n8ARrffuD+Q6uCTVFp+IfgKNfFeaiso75lsC3xtUhIaI6S8jWO1KQi5k4HpQC7tKXHLvp8Hyy8NMZDDKFF2U3lU3yByGT3P9Xo7nHGXGCdDvoGeQWXhaksWnR/BeGeS92gFsjWA4I+pHyeseXSkauIoeW8M0awsxZx20klZ5Mw120ia1mJR6VBULRBZj5Qf9eNEPSw4G5ataIe6syFKrE74fb4RArWGvxTItBxWXEjj1qX2bHhrVsDcMpFUDQD6I/npirHOoX3fn1+3EOVmof1yJJMsDdG/M107U23v0Ria18zHuvw6/SbkJz3L8QHjL0rqZJwxs4UdJ2iNmEX7VjzC+JX5gB72MT1RiY/tiQrMpSLPJCLMI0EE6/YwuSr0qpbT2jibLk1xOJ5ezsUnQuAZz3gpxrD9J4cX0B42Jpd1SePbcUXHSgQo3wtZu+nBenQ8lcoqnlu8Ip6SgQRF//OjmLJkRZGR3SVjTqpKlOA25EivV5WedYAZEZKOMpQ6lQm/ToIJvghfnfyk7PmqIli9uAGOFMejZnuBoF9Pujlyq1XiCMl1yptMVUUiEfXAxMm/2HrSUsB5bs3wEHdqcOLEiRMnTpw4ceLEiRMnTpw4ceLEyX9A/gQR72NPmG9XCAAAAABJRU5ErkJggg==
name: ExtraHop v2
script:
  commands:
  - arguments: []
    description: Get all alert rules from Reveal(x).
    name: extrahop-get-alerts
    outputs:
    - contextPath: Extrahop.Alert.Operator
      description: The logical operator applied when comparing the value of the operand
        field to alert conditions.
      type: String
    - contextPath: Extrahop.Alert.FieldName
      description: The name of the monitored metric.
      type: String
    - contextPath: Extrahop.Alert.NotifySnmp
      description: 'Indicates whether to send an SNMP trap when an alert is generated. '
      type: Boolean
    - contextPath: Extrahop.Alert.Operand
      description: The value to compare against alert conditions.
      type: String
    - contextPath: Extrahop.Alert.IntervalLength
      description: The length of the alert interval, expressed in seconds.
      type: Number
    - contextPath: Extrahop.Alert.Author
      description: 'The name of the user that created the alert. '
      type: String
    - contextPath: Extrahop.Alert.Name
      description: The unique, friendly name for the alert.
      type: String
    - contextPath: Extrahop.Alert.FieldName2
      description: The second monitored metric when applying a ratio.
      type: String
    - contextPath: Extrahop.Alert.RefireInterval
      description: The time interval in which alert conditions are monitored, expressed
        in seconds.
      type: Number
    - contextPath: Extrahop.Alert.ModTime
      description: 'The time of the most recent update, expressed in milliseconds
        since the epoch. '
      type: Number
    - contextPath: Extrahop.Alert.Units
      description: The interval in which to evaluate the alert condition.
      type: String
    - contextPath: Extrahop.Alert.ApplyAll
      description: Indicates whether the alert is assigned to all available data sources.
      type: Boolean
    - contextPath: Extrahop.Alert.Type
      description: The type of alert.
      type: String
    - contextPath: Extrahop.Alert.FieldOp
      description: The type of comparison between the "field_name" and "field_name2"
        fields when applying a ratio.
      type: String
    - contextPath: Extrahop.Alert.Id
      description: The unique identifier for the alert.
      type: Number
    - contextPath: Extrahop.Alert.Disabled
      description: Indicates whether the alert is disabled.
      type: Boolean
    - contextPath: Extrahop.Alert.Description
      description: An optional description for the alert.
      type: String
    - contextPath: Extrahop.Alert.Severity
      description: The severity level of the alert.
      type: Number
    - contextPath: Extrahop.Alert.StatName
      description: The statistic name for the alert.
      type: String
  - arguments:
    - defaultValue: -30m
      description: 'The beginning timestamp of the time range the query will search,
        expressed in milliseconds since the epoch. A negative value specifies that
        the search will begin with records created at a time in the past relative
        to the current time. For example, specify -10m to begin the search with records
        created 10 minutes before the time of the request. The default unit for a
        negative value is milliseconds, but other units can be specified with one
        of the following unit suffixes: ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_from
      required: true
    - description: 'The ending timestamp of the time range the query will search,
        expressed in milliseconds since the epoch. A 0 value specifies that the search
        will end with records created at the time of the request. A negative value
        specifies that the search will end with records created at a time in the past
        relative to the current time. For example, specify -5m to end the search with
        records created 5 minutes before the time of the request. The default unit
        for a negative value is milliseconds, but other units can be specified with
        one of the following unit suffixes: ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_until
    - defaultValue: "20"
      description: The maximum number of entries to return.
      name: limit
    - description: The number of records to skip in the query results.
      name: offset
    - auto: PREDEFINED
      description: The name of the field in the record to be filtered. The query compares
        field1 to value1 and applies the compare method specified by the operator1
        parameter. If the specified field name is ".any", the union of all field values
        will be searched. If the specified field name is ".ipaddr" or ".port", the
        client, server, sender, and receiver roles are included in the search.
      name: field1
      predefined:
      - .any
      - .ipaddr
      - .port
      - accessTime
      - ackCode
      - ackId
      - adminQueue
      - age
      - alertCode
      - alertLevel
      - answer
      - answers
      - appName
      - application
      - args
      - authDomain
      - authMethod
      - authResult
      - authType
      - authenticator
      - bindDN
      - bytes
      - cName
      - cNameType
      - cNames
      - cRealm
      - callId
      - certificateFingerprint
      - certificateIsSelfSigned
      - certificateIssuer
      - certificateKeySize
      - certificateNotAfter
      - certificateNotBefore
      - certificateSignatureAlgorithm
      - certificateSubject
      - certificateSubjectAlternativeNames
      - channel
      - cipherSuite
      - client
      - clientAddr
      - clientBuild
      - clientBytes
      - clientCGPMsgCount
      - clientCertificateRequested
      - clientCipherAlgorithm
      - clientCompressionAlgorithm
      - clientImplementation
      - clientL2Bytes
      - clientLatency
      - clientMacAlgorithm
      - clientMachine
      - clientMsgCount
      - clientName
      - clientPkts
      - clientPort
      - clientPrincipalName
      - clientRTO
      - clientReqDelay
      - clientType
      - clientVersion
      - clientZeroWnd
      - collection
      - command
      - contentType
      - conversationId
      - cookie
      - correlationId
      - cwd
      - dataSize
      - database
      - deltaBytes
      - deltaPkts
      - desktopHeight
      - desktopWidth
      - destination
      - dn
      - domain
      - drops
      - dscpName
      - dstQueueMgr
      - dups
      - duration
      - egressInterface
      - error
      - errorDetail
      - expiration
      - first
      - flowId
      - format
      - frameCutDuration
      - frameSendDuration
      - from
      - functionId
      - functionName
      - fwdReqClientAddr
      - fwdReqHost
      - fwdReqIsEncrypted
      - fwdReqServerName
      - fwdReqServerPort
      - gwAddr
      - handshakeTime
      - hasSDP
      - hassh
      - hasshServer
      - heartbeatPayloadLength
      - heartbeatType
      - hitCount
      - hopLimit
      - host
      - htype
      - ingressInterface
      - interface
      - isAborted
      - isAuthoritative
      - isBinaryProtocol
      - isCheckingDisabled
      - isCleanShutdown
      - isClientDiskRead
      - isClientDiskWrite
      - isCommandCreate
      - isCommandDelete
      - isCommandFileInfo
      - isCommandLock
      - isCommandRead
      - isCommandRename
      - isCommandWrite
      - isCompressed
      - isEncrypted
      - isNoReply
      - isPipelined
      - isRecursionAvailable
      - isRecursionDesired
      - isRenegotiate
      - isReqAborted
      - isReqTimeout
      - isReqTruncated
      - isRspAborted
      - isRspChunked
      - isRspCompressed
      - isRspImplicit
      - isRspTruncated
      - isSQLi
      - isSharedSession
      - isSubOperation
      - isWeakCipherSuite
      - isXSS
      - ja3Hash
      - ja3sHash
      - jitter
      - kexAlgorithm
      - keyboardLayout
      - l2Bytes
      - l7proto
      - label
      - last
      - launchParams
      - loadTime
      - loginTime
      - method
      - missCount
      - mos
      - msgClass
      - msgCode
      - msgFormat
      - msgId
      - msgLength
      - msgSize
      - msgText
      - msgType
      - network
      - networkAddr
      - networkLatency
      - nextHop
      - nextHopMTU
      - notAfter
      - offeredAddr
      - offset
      - opcode
      - operation
      - option
      - origin
      - outOfOrder
      - path
      - payloadType
      - payloadTypeId
      - persistent
      - pkts
      - pointer
      - printerName
      - priority
      - procedure
      - processingTime
      - program
      - proto
      - protocol
      - putAppName
      - qname
      - qtype
      - query
      - queue
      - queueMgr
      - rFactor
      - realm
      - receiver
      - receiverAddr
      - receiverAsn
      - receiverBytes
      - receiverIsBroker
      - receiverL2Bytes
      - receiverPkts
      - receiverPort
      - receiverPrefixLength
      - receiverRTO
      - receiverZeroWnd
      - recipient
      - recipientList
      - redeliveryCount
      - referer
      - renameDirChanged
      - replyTo
      - reqBytes
      - reqKey
      - reqL2Bytes
      - reqPdu
      - reqPkts
      - reqRTO
      - reqSize
      - reqTimeToLastByte
      - reqTransferTime
      - requestedColorDepth
      - requestedProtocols
      - resolvedQueue
      - resolvedQueueMgr
      - resource
      - responseQueue
      - roundTripTime
      - rspBytes
      - rspL2Bytes
      - rspPdu
      - rspPkts
      - rspRTO
      - rspSize
      - rspTimeToFirstByte
      - rspTimeToFirstHeader
      - rspTimeToFirstPayload
      - rspTimeToLastByte
      - rspTransferTime
      - rspVersion
      - rto
      - sNameType
      - sNames
      - saslMechanism
      - searchFilter
      - searchScope
      - selectedProtocol
      - sender
      - senderAddr
      - senderAsn
      - senderBytes
      - senderIsBroker
      - senderL2Bytes
      - senderPkts
      - senderPort
      - senderPrefixLength
      - senderRTO
      - senderZeroWnd
      - seqNum
      - server
      - serverAddr
      - serverBytes
      - serverCGPMsgCount
      - serverCipherAlgorithm
      - serverCompressionAlgorithm
      - serverImplementation
      - serverL2Bytes
      - serverMacAlgorithm
      - serverMsgCount
      - serverPkts
      - serverPort
      - serverPrincipalName
      - serverRTO
      - serverVersion
      - serverZeroWnd
      - share
      - source
      - sqli
      - srcQueueMgr
      - ssrc
      - statement
      - status
      - statusCode
      - statusText
      - table
      - target
      - tcpFlags
      - thinkTime
      - tickChannel
      - ticketHash
      - till
      - title
      - to
      - totalMsgLength
      - transferBytes
      - txId
      - type
      - unitId
      - uri
      - user
      - userAgent
      - vbucket
      - version
      - vlan
      - vxlanVNI
      - warning
      - xss
    - auto: PREDEFINED
      defaultValue: =
      description: The compare method applied when matching value1 against the field1
        contents.
      name: operator1
      predefined:
      - '>'
      - <
      - <=
      - '>='
      - =
      - '!='
      - startswith
      - exists
      - not_exists
    - description: The value that the query attempts to match. The query compares
        this value to the contents of the field1 parameter and applies the compare
        method specified by the operator1 parameter.
      name: value1
    - auto: PREDEFINED
      description: The name of the field in the record to be filtered. The query compares
        field2 to value2 and applies the compare method specified by the operator2
        parameter. If the specified field name is ".any", the union of all field values
        will be searched. If the specified field name is ".ipaddr" or ".port", the
        client, server, sender, and receiver roles are included in the search.
      name: field2
      predefined:
      - .any
      - .ipaddr
      - .port
      - accessTime
      - ackCode
      - ackId
      - adminQueue
      - age
      - alertCode
      - alertLevel
      - answer
      - answers
      - appName
      - application
      - args
      - authDomain
      - authMethod
      - authResult
      - authType
      - authenticator
      - bindDN
      - bytes
      - cName
      - cNameType
      - cNames
      - cRealm
      - callId
      - certificateFingerprint
      - certificateIsSelfSigned
      - certificateIssuer
      - certificateKeySize
      - certificateNotAfter
      - certificateNotBefore
      - certificateSignatureAlgorithm
      - certificateSubject
      - certificateSubjectAlternativeNames
      - channel
      - cipherSuite
      - client
      - clientAddr
      - clientBuild
      - clientBytes
      - clientCGPMsgCount
      - clientCertificateRequested
      - clientCipherAlgorithm
      - clientCompressionAlgorithm
      - clientImplementation
      - clientL2Bytes
      - clientLatency
      - clientMacAlgorithm
      - clientMachine
      - clientMsgCount
      - clientName
      - clientPkts
      - clientPort
      - clientPrincipalName
      - clientRTO
      - clientReqDelay
      - clientType
      - clientVersion
      - clientZeroWnd
      - collection
      - command
      - contentType
      - conversationId
      - cookie
      - correlationId
      - cwd
      - dataSize
      - database
      - deltaBytes
      - deltaPkts
      - desktopHeight
      - desktopWidth
      - destination
      - dn
      - domain
      - drops
      - dscpName
      - dstQueueMgr
      - dups
      - duration
      - egressInterface
      - error
      - errorDetail
      - expiration
      - first
      - flowId
      - format
      - frameCutDuration
      - frameSendDuration
      - from
      - functionId
      - functionName
      - fwdReqClientAddr
      - fwdReqHost
      - fwdReqIsEncrypted
      - fwdReqServerName
      - fwdReqServerPort
      - gwAddr
      - handshakeTime
      - hasSDP
      - hassh
      - hasshServer
      - heartbeatPayloadLength
      - heartbeatType
      - hitCount
      - hopLimit
      - host
      - htype
      - ingressInterface
      - interface
      - isAborted
      - isAuthoritative
      - isBinaryProtocol
      - isCheckingDisabled
      - isCleanShutdown
      - isClientDiskRead
      - isClientDiskWrite
      - isCommandCreate
      - isCommandDelete
      - isCommandFileInfo
      - isCommandLock
      - isCommandRead
      - isCommandRename
      - isCommandWrite
      - isCompressed
      - isEncrypted
      - isNoReply
      - isPipelined
      - isRecursionAvailable
      - isRecursionDesired
      - isRenegotiate
      - isReqAborted
      - isReqTimeout
      - isReqTruncated
      - isRspAborted
      - isRspChunked
      - isRspCompressed
      - isRspImplicit
      - isRspTruncated
      - isSQLi
      - isSharedSession
      - isSubOperation
      - isWeakCipherSuite
      - isXSS
      - ja3Hash
      - ja3sHash
      - jitter
      - kexAlgorithm
      - keyboardLayout
      - l2Bytes
      - l7proto
      - label
      - last
      - launchParams
      - loadTime
      - loginTime
      - method
      - missCount
      - mos
      - msgClass
      - msgCode
      - msgFormat
      - msgId
      - msgLength
      - msgSize
      - msgText
      - msgType
      - network
      - networkAddr
      - networkLatency
      - nextHop
      - nextHopMTU
      - notAfter
      - offeredAddr
      - offset
      - opcode
      - operation
      - option
      - origin
      - outOfOrder
      - path
      - payloadType
      - payloadTypeId
      - persistent
      - pkts
      - pointer
      - printerName
      - priority
      - procedure
      - processingTime
      - program
      - proto
      - protocol
      - putAppName
      - qname
      - qtype
      - query
      - queue
      - queueMgr
      - rFactor
      - realm
      - receiver
      - receiverAddr
      - receiverAsn
      - receiverBytes
      - receiverIsBroker
      - receiverL2Bytes
      - receiverPkts
      - receiverPort
      - receiverPrefixLength
      - receiverRTO
      - receiverZeroWnd
      - recipient
      - recipientList
      - redeliveryCount
      - referer
      - renameDirChanged
      - replyTo
      - reqBytes
      - reqKey
      - reqL2Bytes
      - reqPdu
      - reqPkts
      - reqRTO
      - reqSize
      - reqTimeToLastByte
      - reqTransferTime
      - requestedColorDepth
      - requestedProtocols
      - resolvedQueue
      - resolvedQueueMgr
      - resource
      - responseQueue
      - roundTripTime
      - rspBytes
      - rspL2Bytes
      - rspPdu
      - rspPkts
      - rspRTO
      - rspSize
      - rspTimeToFirstByte
      - rspTimeToFirstHeader
      - rspTimeToFirstPayload
      - rspTimeToLastByte
      - rspTransferTime
      - rspVersion
      - rto
      - sNameType
      - sNames
      - saslMechanism
      - searchFilter
      - searchScope
      - selectedProtocol
      - sender
      - senderAddr
      - senderAsn
      - senderBytes
      - senderIsBroker
      - senderL2Bytes
      - senderPkts
      - senderPort
      - senderPrefixLength
      - senderRTO
      - senderZeroWnd
      - seqNum
      - server
      - serverAddr
      - serverBytes
      - serverCGPMsgCount
      - serverCipherAlgorithm
      - serverCompressionAlgorithm
      - serverImplementation
      - serverL2Bytes
      - serverMacAlgorithm
      - serverMsgCount
      - serverPkts
      - serverPort
      - serverPrincipalName
      - serverRTO
      - serverVersion
      - serverZeroWnd
      - share
      - source
      - sqli
      - srcQueueMgr
      - ssrc
      - statement
      - status
      - statusCode
      - statusText
      - table
      - target
      - tcpFlags
      - thinkTime
      - tickChannel
      - ticketHash
      - till
      - title
      - to
      - totalMsgLength
      - transferBytes
      - txId
      - type
      - unitId
      - uri
      - user
      - userAgent
      - vbucket
      - version
      - vlan
      - vxlanVNI
      - warning
      - xss
    - auto: PREDEFINED
      defaultValue: =
      description: The compare method applied when matching value2 against the field2
        contents.
      name: operator2
      predefined:
      - '>'
      - <
      - <=
      - '>='
      - =
      - '!='
      - startswith
      - exists
      - not_exists
    - description: The value that the query attempts to match. The query compares
        this value to the contents of the field2 parameter and applies the compare
        method specified by the operator2 parameter.
      name: value2
    - auto: PREDEFINED
      defaultValue: and
      description: The match operator to use when chaining the search fields of 1
        and 2 together. For example, to find HTTP records with status code 500 or
        a processing time greater than 100ms (set match_type=or, field1=statusCode,
        operator1==, value1=500, field2=processingTime, operator2=> value2=100, types=http).
      name: match_type
      predefined:
      - and
      - or
      - not
    - auto: PREDEFINED
      description: A list of one or more record formats for the query to filter on,
        comma separated. The query returns only records that match the specified formats.
      isArray: true
      name: types
      predefined:
      - aaa_request
      - aaa_response
      - activemq
      - ajp
      - cifs
      - db
      - dhcp_request
      - dhcp_response
      - dicom_request
      - dicom_response
      - dns_request
      - dns_response
      - fix_request
      - fix_response
      - flow
      - ftp
      - hl7
      - http
      - ibmmq_request
      - ibmmq_response
      - ica_close
      - ica_open
      - ica_tick
      - icmp
      - kerberos_request
      - kerberos_response
      - ldap_request
      - ldap_response
      - llmnr_request
      - llmnr_response
      - memcache_request
      - memcache_response
      - modbus
      - mongodb_request
      - mongodb_response
      - msmq
      - nfs
      - pop3
      - rdp_close
      - rdp_open
      - rdp_tick
      - redis_request
      - redis_response
      - rfb_close
      - rfb_open
      - rfb_tick
      - rpc_request
      - rpc_response
      - rtcp
      - rtp
      - sccp
      - sip_request
      - sip_response
      - smpp
      - smtp
      - ssh_close
      - ssh_open
      - ssh_tick
      - ssl_alert
      - ssl_close
      - ssl_heartbeat
      - ssl_open
      - telnet
    description: Query records from Reveal(x).
    name: extrahop-query-records
    outputs:
    - contextPath: ExtraHop.Record.Type
      description: The record format.
      type: string
    - contextPath: ExtraHop.Record.Source.timestamp
      description: The timestamp of the item.
      type: Number
    - contextPath: ExtraHop.Record.Source.detection
      description: The detection type that committed the record.
      type: string
    - contextPath: ExtraHop.Record.Source.ex.isSuspicious
      description: Marked as suspicious by Threat Intelligence.
      type: Boolean
    - contextPath: ExtraHop.Record.Source.accessTime
      description: Access Time
      type: Number
    - contextPath: ExtraHop.Record.Source.ackCode
      description: Ack Code
      type: String
    - contextPath: ExtraHop.Record.Source.ackId
      description: Ack ID
      type: String
    - contextPath: ExtraHop.Record.Source.adminQueue
      description: Admin Queue
      type: String
    - contextPath: ExtraHop.Record.Source.age
      description: Age
      type: Number
    - contextPath: ExtraHop.Record.Source.alertCode
      description: Alert Code
      type: Number
    - contextPath: ExtraHop.Record.Source.alertLevel
      description: Alert Level
      type: String
    - contextPath: ExtraHop.Record.Source.answer
      description: Answer
      type: Unknown
    - contextPath: ExtraHop.Record.Source.answers
      description: Answers
      type: Unknown
    - contextPath: ExtraHop.Record.Source.appName
      description: Application Name
      type: String
    - contextPath: ExtraHop.Record.Source.application
      description: Application
      type: Unknown
    - contextPath: ExtraHop.Record.Source.args
      description: Arguments
      type: String
    - contextPath: ExtraHop.Record.Source.authDomain
      description: Authentication Domain
      type: String
    - contextPath: ExtraHop.Record.Source.authMethod
      description: Authentication Method
      type: String
    - contextPath: ExtraHop.Record.Source.authResult
      description: Auth Result
      type: Number
    - contextPath: ExtraHop.Record.Source.authType
      description: Auth Type
      type: Number
    - contextPath: ExtraHop.Record.Source.authenticator
      description: Authenticator
      type: String
    - contextPath: ExtraHop.Record.Source.bindDN
      description: Bind Distinguished Name
      type: String
    - contextPath: ExtraHop.Record.Source.bytes
      description: Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.cName
      description: Canonical Endpoint
      type: String
    - contextPath: ExtraHop.Record.Source.cNameType
      description: Client Name Type
      type: String
    - contextPath: ExtraHop.Record.Source.cNames
      description: Client Name Components
      type: String
    - contextPath: ExtraHop.Record.Source.cRealm
      description: Client Realm
      type: String
    - contextPath: ExtraHop.Record.Source.callId
      description: Call ID
      type: String
    - contextPath: ExtraHop.Record.Source.certificateFingerprint
      description: Certificate Fingerprint
      type: String
    - contextPath: ExtraHop.Record.Source.certificateIsSelfSigned
      description: Certificate Self Signed
      type: Boolean
    - contextPath: ExtraHop.Record.Source.certificateIssuer
      description: Certificate Issuer
      type: String
    - contextPath: ExtraHop.Record.Source.certificateKeySize
      description: Certificate Key Size
      type: Number
    - contextPath: ExtraHop.Record.Source.certificateNotAfter
      description: Certificate Not After
      type: Number
    - contextPath: ExtraHop.Record.Source.certificateNotBefore
      description: Certificate Not Before
      type: Number
    - contextPath: ExtraHop.Record.Source.certificateSignatureAlgorithm
      description: Certificate Signature Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.certificateSubject
      description: Certificate Subject
      type: String
    - contextPath: ExtraHop.Record.Source.certificateSubjectAlternativeNames
      description: Certificate Subject Alternative Names
      type: String
    - contextPath: ExtraHop.Record.Source.channel
      description: Channel
      type: String
    - contextPath: ExtraHop.Record.Source.cipherSuite
      description: Cipher Suite
      type: String
    - contextPath: ExtraHop.Record.Source.client.type
      description: Client Type
      type: String
    - contextPath: ExtraHop.Record.Source.client.value
      description: Client Discovery ID
      type: String
    - contextPath: ExtraHop.Record.Source.clientAddr.type
      description: Client IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.clientAddr.value
      description: Client IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.clientBuild
      description: Client Build
      type: String
    - contextPath: ExtraHop.Record.Source.clientBytes
      description: Client Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.clientCGPMsgCount
      description: Client CGP Messages
      type: Number
    - contextPath: ExtraHop.Record.Source.clientCertificateRequested
      description: Client Certificate Requested
      type: Boolean
    - contextPath: ExtraHop.Record.Source.clientCipherAlgorithm
      description: Client Cipher Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.clientCompressionAlgorithm
      description: Client Compression Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.clientImplementation
      description: Client Implementation
      type: String
    - contextPath: ExtraHop.Record.Source.clientL2Bytes
      description: Client L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.clientLatency
      description: Client Latency
      type: Number
    - contextPath: ExtraHop.Record.Source.clientMacAlgorithm
      description: Client MAC Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.clientMachine
      description: Client Machine
      type: String
    - contextPath: ExtraHop.Record.Source.clientMsgCount
      description: Client Messages
      type: Number
    - contextPath: ExtraHop.Record.Source.clientName
      description: Client Name
      type: String
    - contextPath: ExtraHop.Record.Source.clientPkts
      description: Client Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.clientPort
      description: Client Port
      type: Number
    - contextPath: ExtraHop.Record.Source.clientPrincipalName
      description: Client Principal Name
      type: String
    - contextPath: ExtraHop.Record.Source.clientRTO
      description: Client RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.clientReqDelay
      description: Client Request Delay
      type: Number
    - contextPath: ExtraHop.Record.Source.clientType
      description: ICA Client Type
      type: String
    - contextPath: ExtraHop.Record.Source.clientVersion
      description: Client Version
      type: String
    - contextPath: ExtraHop.Record.Source.clientZeroWnd
      description: Client Zero Windows
      type: Number
    - contextPath: ExtraHop.Record.Source.collection
      description: Collection
      type: String
    - contextPath: ExtraHop.Record.Source.command
      description: Command
      type: String
    - contextPath: ExtraHop.Record.Source.contentType
      description: Content Type
      type: String
    - contextPath: ExtraHop.Record.Source.conversationId
      description: Conversation ID
      type: Number
    - contextPath: ExtraHop.Record.Source.cookie
      description: Cookie
      type: String
    - contextPath: ExtraHop.Record.Source.correlationId
      description: Correlation ID
      type: String
    - contextPath: ExtraHop.Record.Source.cwd
      description: Current Working Directory
      type: String
    - contextPath: ExtraHop.Record.Source.dataSize
      description: Data Size
      type: Number
    - contextPath: ExtraHop.Record.Source.database
      description: Database
      type: String
    - contextPath: ExtraHop.Record.Source.deltaBytes
      description: Delta Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.deltaPkts
      description: Delta Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.desktopHeight
      description: Desktop Height
      type: Number
    - contextPath: ExtraHop.Record.Source.desktopWidth
      description: Desktop Width
      type: Number
    - contextPath: ExtraHop.Record.Source.destination
      description: Destination
      type: String
    - contextPath: ExtraHop.Record.Source.dn
      description: Distinguished Name
      type: String
    - contextPath: ExtraHop.Record.Source.domain
      description: Domain
      type: String
    - contextPath: ExtraHop.Record.Source.drops
      description: Drops
      type: Number
    - contextPath: ExtraHop.Record.Source.dscpName
      description: DSCP
      type: String
    - contextPath: ExtraHop.Record.Source.dstQueueMgr
      description: Destination Queue Manager
      type: String
    - contextPath: ExtraHop.Record.Source.dups
      description: Dups
      type: Number
    - contextPath: ExtraHop.Record.Source.duration
      description: Duration
      type: Number
    - contextPath: ExtraHop.Record.Source.egressInterface
      description: Egress Interface
      type: Unknown
    - contextPath: ExtraHop.Record.Source.error
      description: Error
      type: String
    - contextPath: ExtraHop.Record.Source.errorDetail
      description: Error Detail
      type: String
    - contextPath: ExtraHop.Record.Source.expiration
      description: Expiration
      type: Number
    - contextPath: ExtraHop.Record.Source.first
      description: First
      type: Number
    - contextPath: ExtraHop.Record.Source.flowId
      description: Flow
      type: String
    - contextPath: ExtraHop.Record.Source.format
      description: Format
      type: String
    - contextPath: ExtraHop.Record.Source.frameCutDuration
      description: Frame Cut Duration
      type: Number
    - contextPath: ExtraHop.Record.Source.frameSendDuration
      description: Frame Send Duration
      type: Number
    - contextPath: ExtraHop.Record.Source.from
      description: From
      type: String
    - contextPath: ExtraHop.Record.Source.functionId
      description: Function ID
      type: Number
    - contextPath: ExtraHop.Record.Source.functionName
      description: Function Name
      type: String
    - contextPath: ExtraHop.Record.Source.fwdReqClientAddr.type
      description: Forwarded Request Client IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.fwdReqClientAddr.value
      description: Forwarded Request Client IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.fwdReqHost
      description: Forwarded Request Host
      type: String
    - contextPath: ExtraHop.Record.Source.fwdReqIsEncrypted
      description: Forwarded Request Is Encrypted
      type: Boolean
    - contextPath: ExtraHop.Record.Source.fwdReqServerName
      description: Forwarded Request Server Name
      type: String
    - contextPath: ExtraHop.Record.Source.fwdReqServerPort
      description: Forwarded Request Server Port
      type: Number
    - contextPath: ExtraHop.Record.Source.gwAddr.type
      description: Gateway IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.gwAddr.value
      description: Gateway IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.handshakeTime
      description: Handshake Time
      type: Number
    - contextPath: ExtraHop.Record.Source.hasSDP
      description: Has SDP
      type: Boolean
    - contextPath: ExtraHop.Record.Source.hassh
      description: HASSH
      type: String
    - contextPath: ExtraHop.Record.Source.hasshServer
      description: HASSH Server
      type: String
    - contextPath: ExtraHop.Record.Source.heartbeatPayloadLength
      description: Heartbeat Payload Length
      type: Number
    - contextPath: ExtraHop.Record.Source.heartbeatType
      description: Heartbeat Type
      type: Number
    - contextPath: ExtraHop.Record.Source.hitCount
      description: Hit Count
      type: Number
    - contextPath: ExtraHop.Record.Source.hopLimit
      description: Hop Limit
      type: Number
    - contextPath: ExtraHop.Record.Source.host
      description: Host
      type: String
    - contextPath: ExtraHop.Record.Source.htype
      description: Hardware Address Type
      type: Number
    - contextPath: ExtraHop.Record.Source.ingressInterface
      description: Ingress Interface
      type: Unknown
    - contextPath: ExtraHop.Record.Source.interface
      description: Interface
      type: String
    - contextPath: ExtraHop.Record.Source.isAborted
      description: Aborted
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isAuthoritative
      description: Authoritative
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isBinaryProtocol
      description: Binary Protocol
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCheckingDisabled
      description: Checking Disabled
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCleanShutdown
      description: Clean Shutdown
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isClientDiskRead
      description: Client Disk Read
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isClientDiskWrite
      description: Client Disk Write
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandCreate
      description: Create Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandDelete
      description: Delete Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandFileInfo
      description: FileInfo Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandLock
      description: Lock Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandRead
      description: Read Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandRename
      description: Rename Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCommandWrite
      description: Write Command
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isCompressed
      description: Compressed
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isEncrypted
      description: Encrypted
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isNoReply
      description: No Reply
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isPipelined
      description: Pipelined
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRecursionAvailable
      description: Recursion Available
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRecursionDesired
      description: Recursion Desired
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRenegotiate
      description: Renegotiate
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isReqAborted
      description: Request Aborted
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isReqTimeout
      description: Request Timed Out
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isReqTruncated
      description: Request Truncated
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRspAborted
      description: Response Aborted
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRspChunked
      description: Chunked
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRspCompressed
      description: Rsp Compressed
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRspImplicit
      description: Response Implicit
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isRspTruncated
      description: Response Truncated
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isSQLi
      description: Contains SQLi
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isSharedSession
      description: Shared Session
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isSubOperation
      description: Is a suboperation
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isWeakCipherSuite
      description: Weak Cipher Suite
      type: Boolean
    - contextPath: ExtraHop.Record.Source.isXSS
      description: Contains XSS
      type: Boolean
    - contextPath: ExtraHop.Record.Source.ja3Hash
      description: JA3 Hash
      type: String
    - contextPath: ExtraHop.Record.Source.ja3sHash
      description: JA3S Hash
      type: String
    - contextPath: ExtraHop.Record.Source.jitter
      description: Jitter
      type: Number
    - contextPath: ExtraHop.Record.Source.kexAlgorithm
      description: KEX Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.keyboardLayout
      description: Keyboard Layout
      type: String
    - contextPath: ExtraHop.Record.Source.l2Bytes
      description: L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.l7proto
      description: L7 Protocol
      type: String
    - contextPath: ExtraHop.Record.Source.label
      description: Label
      type: String
    - contextPath: ExtraHop.Record.Source.last
      description: Last
      type: Number
    - contextPath: ExtraHop.Record.Source.launchParams
      description: Parameters
      type: String
    - contextPath: ExtraHop.Record.Source.loadTime
      description: Load Time
      type: Number
    - contextPath: ExtraHop.Record.Source.loginTime
      description: Login Time
      type: Number
    - contextPath: ExtraHop.Record.Source.method
      description: Method
      type: String
    - contextPath: ExtraHop.Record.Source.missCount
      description: Miss Count
      type: Number
    - contextPath: ExtraHop.Record.Source.mos
      description: MOS
      type: Number
    - contextPath: ExtraHop.Record.Source.msgClass
      description: Message Class
      type: String
    - contextPath: ExtraHop.Record.Source.msgCode
      description: Message Code
      type: Number
    - contextPath: ExtraHop.Record.Source.msgFormat
      description: Message Format
      type: String
    - contextPath: ExtraHop.Record.Source.msgId
      description: Message ID
      type: Number
    - contextPath: ExtraHop.Record.Source.msgLength
      description: Message Length
      type: Number
    - contextPath: ExtraHop.Record.Source.msgSize
      description: Message Size
      type: Number
    - contextPath: ExtraHop.Record.Source.msgText
      description: Message Text
      type: String
    - contextPath: ExtraHop.Record.Source.msgType
      description: Message Type
      type: String
    - contextPath: ExtraHop.Record.Source.network
      description: Flow Network
      type: Unknown
    - contextPath: ExtraHop.Record.Source.networkAddr.type
      description: Flow Network IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.networkAddr.value
      description: Flow Network IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.networkLatency
      description: Network Latency
      type: Number
    - contextPath: ExtraHop.Record.Source.nextHop.type
      description: Next Hop IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.nextHop.value
      description: Next Hop IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.nextHopMTU
      description: Next Hop MTU
      type: Number
    - contextPath: ExtraHop.Record.Source.notAfter
      description: Certificate Not After
      type: Number
    - contextPath: ExtraHop.Record.Source.offeredAddr.type
      description: Offered IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.offeredAddr.value
      description: Offered IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.offset
      description: Offset
      type: Number
    - contextPath: ExtraHop.Record.Source.opcode
      description: Opcode
      type: String
    - contextPath: ExtraHop.Record.Source.operation
      description: Operation
      type: String
    - contextPath: ExtraHop.Record.Source.option
      description: Options
      type: String
    - contextPath: ExtraHop.Record.Source.origin
      description: Origin
      type: String
    - contextPath: ExtraHop.Record.Source.outOfOrder
      description: Out Of Order
      type: Number
    - contextPath: ExtraHop.Record.Source.path
      description: Path
      type: String
    - contextPath: ExtraHop.Record.Source.payloadType
      description: Payload Type
      type: String
    - contextPath: ExtraHop.Record.Source.payloadTypeId
      description: Payload Type ID
      type: Number
    - contextPath: ExtraHop.Record.Source.persistent
      description: Persistent
      type: Boolean
    - contextPath: ExtraHop.Record.Source.pkts
      description: Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.pointer
      description: Pointer
      type: Number
    - contextPath: ExtraHop.Record.Source.printerName
      description: Printer Name
      type: String
    - contextPath: ExtraHop.Record.Source.priority
      description: Priority
      type: Number
    - contextPath: ExtraHop.Record.Source.procedure
      description: Procedure
      type: String
    - contextPath: ExtraHop.Record.Source.processingTime
      description: Processing Time
      type: Number
    - contextPath: ExtraHop.Record.Source.program
      description: Program
      type: String
    - contextPath: ExtraHop.Record.Source.proto
      description: IP Protocol
      type: String
    - contextPath: ExtraHop.Record.Source.protocol
      description: Protocol
      type: String
    - contextPath: ExtraHop.Record.Source.putAppName
      description: Put Application Name
      type: String
    - contextPath: ExtraHop.Record.Source.qname
      description: Query Name
      type: String
    - contextPath: ExtraHop.Record.Source.qtype
      description: Query Type
      type: String
    - contextPath: ExtraHop.Record.Source.query
      description: Query
      type: String
    - contextPath: ExtraHop.Record.Source.queue
      description: Queue
      type: String
    - contextPath: ExtraHop.Record.Source.queueMgr
      description: Queue Manager
      type: String
    - contextPath: ExtraHop.Record.Source.rFactor
      description: R Factor
      type: Number
    - contextPath: ExtraHop.Record.Source.realm
      description: Server Realm
      type: String
    - contextPath: ExtraHop.Record.Source.receiver.type
      description: Receiver Type
      type: String
    - contextPath: ExtraHop.Record.Source.receiver.value
      description: Receiver Discovery ID
      type: String
    - contextPath: ExtraHop.Record.Source.receiverAddr.type
      description: Receiver IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.receiverAddr.value
      description: Receiver IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.receiverAsn
      description: Receiver ASN
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverBytes
      description: Receiver Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverIsBroker
      description: To Broker
      type: Boolean
    - contextPath: ExtraHop.Record.Source.receiverL2Bytes
      description: Receiver L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverPkts
      description: Receiver Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverPort
      description: Receiver Port
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverPrefixLength
      description: Receiver Prefix Length
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverRTO
      description: Receiver RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.receiverZeroWnd
      description: Receiver Zero Windows
      type: Number
    - contextPath: ExtraHop.Record.Source.recipient
      description: Recipient
      type: String
    - contextPath: ExtraHop.Record.Source.recipientList
      description: Recipient List
      type: String
    - contextPath: ExtraHop.Record.Source.redeliveryCount
      description: Redelivery Count
      type: Number
    - contextPath: ExtraHop.Record.Source.referer
      description: Referer
      type: String
    - contextPath: ExtraHop.Record.Source.renameDirChanged
      description: Rename Directory Changed
      type: Boolean
    - contextPath: ExtraHop.Record.Source.replyTo
      description: Reply To
      type: String
    - contextPath: ExtraHop.Record.Source.reqBytes
      description: Request Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.reqKey
      description: Request Key
      type: String
    - contextPath: ExtraHop.Record.Source.reqL2Bytes
      description: Request L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.reqPdu
      description: Request PDU Type
      type: String
    - contextPath: ExtraHop.Record.Source.reqPkts
      description: Request Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.reqRTO
      description: Request RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.reqSize
      description: Request Size
      type: Number
    - contextPath: ExtraHop.Record.Source.reqTimeToLastByte
      description: Req Time To Last Byte
      type: Number
    - contextPath: ExtraHop.Record.Source.reqTransferTime
      description: Request Transfer Time
      type: Number
    - contextPath: ExtraHop.Record.Source.requestedColorDepth
      description: Requested Color Depth
      type: String
    - contextPath: ExtraHop.Record.Source.requestedProtocols
      description: Requested Protocols
      type: String
    - contextPath: ExtraHop.Record.Source.resolvedQueue
      description: Resolved Queue
      type: String
    - contextPath: ExtraHop.Record.Source.resolvedQueueMgr
      description: Resolved Queue Manager
      type: String
    - contextPath: ExtraHop.Record.Source.resource
      description: Resource
      type: String
    - contextPath: ExtraHop.Record.Source.responseQueue
      description: Response Queue
      type: String
    - contextPath: ExtraHop.Record.Source.roundTripTime
      description: Round Trip Time
      type: Number
    - contextPath: ExtraHop.Record.Source.rspBytes
      description: Response Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.rspL2Bytes
      description: Response L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.rspPdu
      description: Response PDU Type
      type: String
    - contextPath: ExtraHop.Record.Source.rspPkts
      description: Response Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.rspRTO
      description: Response RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.rspSize
      description: Response Size
      type: Number
    - contextPath: ExtraHop.Record.Source.rspTimeToFirstByte
      description: Rsp Time To First Byte
      type: Number
    - contextPath: ExtraHop.Record.Source.rspTimeToFirstHeader
      description: Rsp Time To First Header
      type: Number
    - contextPath: ExtraHop.Record.Source.rspTimeToFirstPayload
      description: Rsp Time To First Payload
      type: Number
    - contextPath: ExtraHop.Record.Source.rspTimeToLastByte
      description: Rsp Time To Last Byte
      type: Number
    - contextPath: ExtraHop.Record.Source.rspTransferTime
      description: Response Transfer Time
      type: Number
    - contextPath: ExtraHop.Record.Source.rspVersion
      description: Response Version
      type: String
    - contextPath: ExtraHop.Record.Source.rto
      description: RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.sNameType
      description: Server Name Type
      type: String
    - contextPath: ExtraHop.Record.Source.sNames
      description: Server Name Components
      type: String
    - contextPath: ExtraHop.Record.Source.saslMechanism
      description: SASL Mechanism
      type: String
    - contextPath: ExtraHop.Record.Source.searchFilter
      description: Search Filter
      type: String
    - contextPath: ExtraHop.Record.Source.searchScope
      description: Search Scope
      type: String
    - contextPath: ExtraHop.Record.Source.selectedProtocol
      description: Selected Protocol
      type: String
    - contextPath: ExtraHop.Record.Source.sender.type
      description: Sender Type
      type: String
    - contextPath: ExtraHop.Record.Source.sender.value
      description: Sender Discovery ID
      type: String
    - contextPath: ExtraHop.Record.Source.senderAddr.type
      description: Sender IP Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.senderAddr.value
      description: Sender IP Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.senderAsn
      description: Sender ASN
      type: Number
    - contextPath: ExtraHop.Record.Source.senderBytes
      description: Sender Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.senderIsBroker
      description: From Broker
      type: Boolean
    - contextPath: ExtraHop.Record.Source.senderL2Bytes
      description: Sender L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.senderPkts
      description: Sender Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.senderPort
      description: Sender Port
      type: Number
    - contextPath: ExtraHop.Record.Source.senderPrefixLength
      description: Sender Prefix Length
      type: Number
    - contextPath: ExtraHop.Record.Source.senderRTO
      description: Sender RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.senderZeroWnd
      description: Sender Zero Windows
      type: Number
    - contextPath: ExtraHop.Record.Source.seqNum
      description: Sequence Number
      type: Number
    - contextPath: ExtraHop.Record.Source.server.type
      description: Server Type
      type: String
    - contextPath: ExtraHop.Record.Source.server.value
      description: Server Discovery ID
      type: String
    - contextPath: ExtraHop.Record.Source.serverAddr.type
      description: Server IPv4 Address Type
      type: String
    - contextPath: ExtraHop.Record.Source.serverAddr.value
      description: Server IPv4 Address Value
      type: String
    - contextPath: ExtraHop.Record.Source.serverBytes
      description: Server Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.serverCGPMsgCount
      description: Server CGP Messages
      type: Number
    - contextPath: ExtraHop.Record.Source.serverCipherAlgorithm
      description: Server Cipher Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.serverCompressionAlgorithm
      description: Server Compression Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.serverImplementation
      description: Server Implementation
      type: String
    - contextPath: ExtraHop.Record.Source.serverL2Bytes
      description: Server L2 Bytes
      type: Number
    - contextPath: ExtraHop.Record.Source.serverMacAlgorithm
      description: Server MAC Algorithm
      type: String
    - contextPath: ExtraHop.Record.Source.serverMsgCount
      description: Server Messages
      type: Number
    - contextPath: ExtraHop.Record.Source.serverPkts
      description: Server Packets
      type: Number
    - contextPath: ExtraHop.Record.Source.serverPort
      description: Server Port
      type: Number
    - contextPath: ExtraHop.Record.Source.serverPrincipalName
      description: Server Principal Name
      type: String
    - contextPath: ExtraHop.Record.Source.serverRTO
      description: Server RTO
      type: Number
    - contextPath: ExtraHop.Record.Source.serverVersion
      description: Server Version
      type: String
    - contextPath: ExtraHop.Record.Source.serverZeroWnd
      description: Server Zero Windows
      type: Number
    - contextPath: ExtraHop.Record.Source.share
      description: Share
      type: String
    - contextPath: ExtraHop.Record.Source.source
      description: Source
      type: String
    - contextPath: ExtraHop.Record.Source.sqli
      description: Potential SQLi
      type: String
    - contextPath: ExtraHop.Record.Source.srcQueueMgr
      description: Source Queue Manager
      type: String
    - contextPath: ExtraHop.Record.Source.ssrc
      description: Sender SSRC
      type: Number
    - contextPath: ExtraHop.Record.Source.statement
      description: Statement
      type: String
    - contextPath: ExtraHop.Record.Source.status
      description: Status
      type: String
    - contextPath: ExtraHop.Record.Source.statusCode
      description: Status Code
      type: Number
    - contextPath: ExtraHop.Record.Source.statusText
      description: Status Text
      type: String
    - contextPath: ExtraHop.Record.Source.table
      description: Table
      type: String
    - contextPath: ExtraHop.Record.Source.target
      description: Target
      type: String
    - contextPath: ExtraHop.Record.Source.tcpFlags
      description: TCP Flags
      type: Number
    - contextPath: ExtraHop.Record.Source.thinkTime
      description: Think Time
      type: Number
    - contextPath: ExtraHop.Record.Source.tickChannel
      description: Tick Channel
      type: String
    - contextPath: ExtraHop.Record.Source.ticketHash
      description: Encrypted Ticket Hash
      type: String
    - contextPath: ExtraHop.Record.Source.till
      description: Till
      type: String
    - contextPath: ExtraHop.Record.Source.title
      description: Title
      type: String
    - contextPath: ExtraHop.Record.Source.to
      description: To
      type: String
    - contextPath: ExtraHop.Record.Source.totalMsgLength
      description: Total Msg Length
      type: Number
    - contextPath: ExtraHop.Record.Source.transferBytes
      description: Bytes Transferred
      type: Number
    - contextPath: ExtraHop.Record.Source.txId
      description: Transaction ID
      type: Number
    - contextPath: ExtraHop.Record.Source.unitId
      description: Unit ID
      type: Number
    - contextPath: ExtraHop.Record.Source.uri
      description: URI
      type: String
    - contextPath: ExtraHop.Record.Source.user
      description: User
      type: String
    - contextPath: ExtraHop.Record.Source.userAgent
      description: User Agent
      type: String
    - contextPath: ExtraHop.Record.Source.vbucket
      description: vBucket
      type: Number
    - contextPath: ExtraHop.Record.Source.version
      description: Version
      type: String
    - contextPath: ExtraHop.Record.Source.vlan
      description: VLAN
      type: Number
    - contextPath: ExtraHop.Record.Source.vxlanVNI
      description: VxLAN VNI
      type: Number
    - contextPath: ExtraHop.Record.Source.warning
      description: Warning
      type: String
    - contextPath: ExtraHop.Record.Source.xss
      description: Potential XSS
      type: String
  - arguments:
    - description: The name of the device. This searches for matches on all ExtraHop
        name fields (DHCP, DNS, NetBIOS, Cisco Discovery Protocol, etc).
      name: name
    - description: The IP address of the device.
      name: ip
    - description: The MAC address of the device.
      name: mac
    - auto: PREDEFINED
      description: The role of the device.
      name: role
      predefined:
      - db_server
      - dhcp_server
      - dns_server
      - file_server
      - firewall
      - gateway
      - http_server
      - domain_controller
      - web_proxy
      - load_balancer
      - pc
      - medical_device
      - mobile_device
      - printer
      - scanner
      - custom
      - voip_phone
      - other
    - auto: PREDEFINED
      description: The OS of the device.
      name: software
      predefined:
      - android
      - apple_ios
      - arista_eos
      - cisco_ios
      - cisco_nx-os
      - chrome_os
      - linux
      - mac_os
      - windows
      - windows_server
      - windows_server_2008
      - windows_server_2008_r2
      - windows_server_2012
      - windows_server_2012_r2
      - windows_server_2016
      - windows_vista
      - windows_7
      - windows_8
      - windows_8.1
      - windows_10
    - description: 'A tag present on the device. '
      name: tag
    - auto: PREDEFINED
      description: The vendor of the device, based on MAC address via OUI lookup.
      name: vendor
      predefined:
      - alcatel-lucent
      - apple
      - arista
      - asus
      - brother
      - canon
      - cisco
      - cisco-linksys
      - citrix
      - dell
      - dellemc
      - d-link
      - emc
      - f5
      - google
      - hp
      - htc
      - huawei
      - ibm
      - juniper
      - kyocera
      - microsoft
      - netapp
      - netgear
      - nokia
      - nortel
      - oracle
      - paloalto
      - samsung
      - 3com
      - toshiba
      - virtualbox
      - vmware
      - zte
    - description: 'The time that device was first seen by ExtraHop, expressed in
        milliseconds since the epoch. A negative value is evaluated relative to the
        current time. The default unit for a negative value is milliseconds, but other
        units can be specified with the following unit suffixes: ms, s, m, h, d, w,
        M, y. For example, to look one day back enter -1d or -24h. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: discover_time
    - description: The VLAN ID of the Virtual LAN that the device is on.
      name: vlan
    - auto: PREDEFINED
      description: The activity of the device.
      name: activity
      predefined:
      - aaa_client
      - aaa_server
      - ajp_client
      - ajp_server
      - amf_client
      - amf_server
      - cifs_client
      - cifs_server
      - db_client
      - db_server
      - dhcp_client
      - dhcp_server
      - dicom_client
      - dicom_server
      - dns_client
      - dns_server
      - fix_client
      - fix_server
      - ftp_client
      - ftp_server
      - hl7_client
      - hl7_server
      - http_client
      - http_server
      - ibmmq_client
      - ibmmq_server
      - ica_client
      - ica_server
      - icmp
      - iscsi_client
      - iscsi_server
      - kerberos_client
      - kerberos_server
      - ldap_client
      - ldap_server
      - llmnr_client
      - llmnr_server
      - memcache_client
      - memcache_server
      - modbus_client
      - modbus_server
      - mongo_client
      - mongo_server
      - msmq
      - nbns_client
      - nbns_server
      - nfs_client
      - nfs_server
      - pcoip_client
      - pcoip_server
      - pop3_client
      - pop3_server
      - rdp_client
      - rdp_server
      - redis_client
      - redis_server
      - rfb_client
      - rfb_server
      - rpc_client
      - rpc_server
      - rtcp
      - rtp
      - scanner
      - sip_client
      - sip_server
      - smpp_client
      - smpp_server
      - smtp_client
      - smtp_server
      - ssh_client
      - ssh_server
      - ssl_client
      - ssl_server
      - tcp
      - telnet_client
      - telnet_server
      - udp
      - websocket_client
      - websocket_server
      - wsman_client
      - wsman_server
    - auto: PREDEFINED
      defaultValue: =
      description: The compare method applied when matching the fields against their
        values. For example, to find devices with names that begin with 'SEA1' (set
        name=SEA1, operator=startswith)
      name: operator
      predefined:
      - '>'
      - <
      - <=
      - '>='
      - =
      - '!='
      - startswith
      - exists
      - not_exists
      - "~"
      - '!~'
    - auto: PREDEFINED
      defaultValue: and
      description: The match operator to use when chaining the search fields together.
        For example, to find all HTTP servers running Windows on the network (set
        match_type=and, role=http_server, software=windows).
      name: match_type
      predefined:
      - and
      - or
      - not
    - description: 'The beginning timestamp for the request. Return only devices active
        after this time. Time is expressed in milliseconds since the epoch. 0 indicates
        the time of the request. A negative value is evaluated relative to the current
        time. The default unit for a negative value is milliseconds, but other units
        can be specified with one of the following unit suffixes: ms, s, m, h, d,
        w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: active_from
    - description: 'The ending timestamp for the request. Return only devices active
        before this time. Time is expressed in milliseconds since the epoch. 0 indicates
        the time of the request. A negative value is evaluated relative to the current
        time. The default unit for a negative value is milliseconds, but other units
        can be specified with one of the following unit suffixes: ms, s, m, h, d,
        w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: active_until
    - defaultValue: "10"
      description: The maximum number of devices to return.
      name: limit
    - auto: PREDEFINED
      defaultValue: "true"
      description: Only returns layer 3 devices by filtering out any layer 2 parent
        devices.
      name: l3_only
      predefined:
      - "true"
      - "false"
    description: Search for devices in Reveal(x).
    name: extrahop-device-search
    outputs:
    - contextPath: ExtraHop.Device.Macaddr
      description: The MAC Address of the device.
      type: String
    - contextPath: ExtraHop.Device.DeviceClass
      description: The class of the device.
      type: String
    - contextPath: ExtraHop.Device.UserModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: Number
    - contextPath: ExtraHop.Device.AutoRole
      description: The role automatically detected by the ExtraHop.
      type: String
    - contextPath: ExtraHop.Device.ParentId
      description: The ID of the parent device.
      type: Number
    - contextPath: ExtraHop.Device.Vendor
      description: The device vendor.
      type: String
    - contextPath: ExtraHop.Device.Analysis
      description: The level of analysis preformed on the device.
      type: string
    - contextPath: ExtraHop.Device.DiscoveryId
      description: The UUID given by the Discover appliance.
      type: String
    - contextPath: ExtraHop.Device.DefaultName
      description: The default name of the device.
      type: String
    - contextPath: ExtraHop.Device.DisplayName
      description: The display name of device.
      type: String
    - contextPath: ExtraHop.Device.OnWatchlist
      description: Whether the device is on the advanced analysis whitelist.
      type: Boolean
    - contextPath: ExtraHop.Device.ModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: Number
    - contextPath: ExtraHop.Device.IsL3
      description: Indicates whether the device is a Layer 3 device.
      type: Boolean
    - contextPath: ExtraHop.Device.Role
      description: The role of the device.
      type: String
    - contextPath: ExtraHop.Device.DiscoverTime
      description: The time that the device was discovered.
      type: Number
    - contextPath: ExtraHop.Device.Id
      description: The ID of the device.
      type: Number
    - contextPath: ExtraHop.Device.Ipaddr4
      description: The IPv4 address of the device.
      type: String
    - contextPath: ExtraHop.Device.Vlanid
      description: The ID of VLan.
      type: Number
    - contextPath: ExtraHop.Device.Ipaddr6
      description: The IPv6 address of the device.
      type: string
    - contextPath: ExtraHop.Device.NodeId
      description: The Node ID of the Discover appliance.
      type: number
    - contextPath: ExtraHop.Device.Description
      description: A user customizable description of the device.
      type: string
    - contextPath: ExtraHop.Device.DnsName
      description: The DNS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.DhcpName
      description: The DHCP name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.CdpName
      description: The Cisco Discovery Protocol name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.NetbiosName
      description: The NetBIOS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.Url
      description: Link to the device details page in ExtraHop.
      type: string
  - arguments:
    - description: The list of IP Addresses or ExtraHop API IDs of the devices to
        add, comma separated.
      isArray: true
      name: add
    - description: The list of IP Addresses or ExtraHop API IDs of the devices to
        remove, comma separated.
      isArray: true
      name: remove
    description: Add or remove devices from the watchlist in Reveal(x).
    name: extrahop-edit-watchlist
  - arguments: []
    description: Get all devices on the watchlist in Reveal(x).
    name: extrahop-get-watchlist
    outputs:
    - contextPath: Extrahop.Device.Macaddr
      description: The MAC Address of the device.
      type: String
    - contextPath: Extrahop.Device.DeviceClass
      description: 'The class of this device. '
      type: String
    - contextPath: Extrahop.Device.UserModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: Number
    - contextPath: Extrahop.Device.AutoRole
      description: 'The role automatically detected by the ExtraHop. '
      type: String
    - contextPath: Extrahop.Device.ParentId
      description: The ID of the parent device.
      type: Number
    - contextPath: Extrahop.Device.Vendor
      description: The device vendor.
      type: String
    - contextPath: Extrahop.Device.Analysis
      description: The level of analysis preformed on the device.
      type: string
    - contextPath: Extrahop.Device.DiscoveryId
      description: The UUID given by the Discover appliance.
      type: String
    - contextPath: Extrahop.Device.DefaultName
      description: The default name for this device.
      type: String
    - contextPath: Extrahop.Device.DisplayName
      description: The display name of device.
      type: String
    - contextPath: Extrahop.Device.OnWatchlist
      description: Whether the device is on the advanced analysis whitelist.
      type: Boolean
    - contextPath: Extrahop.Device.ModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: Number
    - contextPath: Extrahop.Device.IsL3
      description: Indicates whether the device is a Layer 3 device.
      type: Boolean
    - contextPath: Extrahop.Device.Role
      description: 'The role of the device. '
      type: String
    - contextPath: Extrahop.Device.DiscoverTime
      description: The time that the device was discovered.
      type: Number
    - contextPath: Extrahop.Device.Id
      description: The ID of the device.
      type: Number
    - contextPath: Extrahop.Device.Ipaddr4
      description: The IPv4 address for this device.
      type: String
    - contextPath: Extrahop.Device.Vlanid
      description: The unique identifier for the VLAN this device is associated with.
      type: Number
    - contextPath: ExtraHop.Device.Ipaddr6
      description: The IPv6 address of the device.
      type: string
    - contextPath: ExtraHop.Device.NodeId
      description: The Node ID of the Discover appliance.
      type: number
    - contextPath: ExtraHop.Device.Description
      description: A user customizable description of the device.
      type: string
    - contextPath: ExtraHop.Device.DnsName
      description: The DNS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.DhcpName
      description: The DHCP name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.CdpName
      description: The Cisco Discovery Protocol name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.NetbiosName
      description: The NetBIOS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.Url
      description: Link to the device details page in ExtraHop.
      type: string
  - arguments:
    - auto: PREDEFINED
      description: Indicates whether the alert is assigned to all available data sources.
      name: apply_all
      predefined:
      - "true"
      - "false"
      required: true
    - auto: PREDEFINED
      description: Indicates whether the alert is disabled.
      name: disabled
      predefined:
      - "true"
      - "false"
      required: true
    - description: The unique, friendly name for the alert.
      name: name
      required: true
    - auto: PREDEFINED
      description: Indicates whether to send an SNMP trap when an alert is generated.
      name: notify_snmp
      predefined:
      - "true"
      - "false"
      required: true
    - auto: PREDEFINED
      description: 'The time interval in which alert conditions are monitored, expressed
        in seconds. '
      name: refire_interval
      predefined:
      - "300"
      - "600"
      - "900"
      - "1800"
      - "3600"
      - "7200"
      - "14400"
      required: true
    - description: 'The severity level of the alert, which is displayed in the Alert
        History, email notifications, and SNMP traps. Supported values: 0, 1, 2, 3,
        4, 5, 6, 7'
      name: severity
      required: true
    - auto: PREDEFINED
      description: 'The type of alert. '
      name: type
      predefined:
      - detection
      - threshold
      required: true
    - auto: PREDEFINED
      description: 'The type of metric source monitored by the alert configuration.
        Only applicable to detection alerts. '
      name: object_type
      predefined:
      - application
      - device
    - description: The list of monitored protocols. Only applicable to detection alerts.
      name: protocols
    - description: The name of the monitored metric. Only applicable to threshold
        alerts.
      name: field_name
    - description: The second monitored metric when applying a ratio. Only applicable
        to threshold alerts.
      name: field_name2
    - description: The statistic name for the alert. Only applicable to threshold
        alerts.
      name: stat_name
    - auto: PREDEFINED
      description: "The interval in which to evaluate the alert condition. Only applicable
        to threshold alerts. \nSupported values: \"none\", \"period\", \"1 sec\",
        \"1 min\", \"1 hr\""
      name: units
      predefined:
      - none
      - period
      - 1 sec
      - 1 min
      - 1 hr
    - auto: PREDEFINED
      defaultValue: "30"
      description: "The length of the alert interval, expressed in seconds. Only applicable
        to threshold alerts. \nSupported values: 30, 60, 120, 300, 600, 900, 1200,
        1800"
      name: interval_length
      predefined:
      - "30"
      - "60"
      - "120"
      - "300"
      - "600"
      - "900"
      - "1200"
      - "1800"
    - description: The value to compare against alert conditions. The compare method
        is specified by the value of the operator field. Only applicable to threshold
        alerts.
      name: operand
    - auto: PREDEFINED
      description: The logical operator applied when comparing the value of the operand
        field to alert conditions. Only applicable to threshold alerts.
      name: operator
      predefined:
      - ==
      - '>'
      - <
      - '>='
      - <=
    - auto: PREDEFINED
      description: The type of comparison between the field_name and field_name2 fields
        when applying a ratio. Only applicable to threshold alerts.
      name: field_op
      predefined:
      - /
      - "null"
    - description: The first alert parameter, which is either a key pattern or a data
        point. Only applicable to threshold alerts.
      name: param
    - description: The second alert parameter, which is either a key pattern or a
        data point. Only applicable to threshold alerts.
      name: param2
    description: Create a new alert rule in Reveal(x).
    name: extrahop-create-alert
  - arguments:
    - description: The unique identifier for the alert.
      name: alert_id
      required: true
    - auto: PREDEFINED
      description: Indicates whether the alert is assigned to all available data sources.
      name: apply_all
      predefined:
      - "true"
      - "false"
      required: true
    - auto: PREDEFINED
      description: Indicates whether the alert is disabled.
      name: disabled
      predefined:
      - "true"
      - "false"
      required: true
    - description: The unique, friendly name for the alert.
      name: name
      required: true
    - auto: PREDEFINED
      description: Indicates whether to send an SNMP trap when an alert is generated.
      name: notify_snmp
      predefined:
      - "true"
      - "false"
      required: true
    - description: The name of the monitored metric. Only applicable to threshold
        alerts.
      name: field_name
    - description: The statistic name for the alert. Only applicable to threshold
        alerts.
      name: stat_name
    - auto: PREDEFINED
      description: The interval in which to evaluate the alert condition. Only applicable
        to threshold alerts.
      name: units
      predefined:
      - none
      - period
      - 1 sec
      - 1 min
      - 1 hr
    - auto: PREDEFINED
      description: The length of the alert interval, expressed in seconds. Only applicable
        to threshold alerts.
      name: interval_length
      predefined:
      - "30"
      - "60"
      - "120"
      - "300"
      - "600"
      - "900"
      - "1200"
      - "1800"
    - description: The value to compare against alert conditions. The compare method
        is specified by the value of the operator field. Only applicable to threshold
        alerts.
      name: operand
    - auto: PREDEFINED
      description: The time interval in which alert conditions are monitored, expressed
        in seconds.
      name: refire_interval
      predefined:
      - "300"
      - "600"
      - "900"
      - "1800"
      - "3600"
      - "7200"
      - "14400"
      required: true
    - auto: PREDEFINED
      description: The severity level of the alert, which is displayed in the Alert
        History, email notifications, and SNMP traps.
      name: severity
      predefined:
      - "0"
      - "1"
      - "2"
      - "3"
      - "4"
      - "5"
      - "6"
      - "7"
      required: true
    - auto: PREDEFINED
      description: The type of alert.
      name: type
      predefined:
      - detection
      - threshold
      required: true
    - auto: PREDEFINED
      description: The type of metric source monitored by the alert configuration.
        Only applicable to detection alerts.
      name: object_type
      predefined:
      - application
      - device
    - description: The list of monitored protocols. Only applicable to detection alerts.
      name: protocols
    - auto: PREDEFINED
      description: The logical operator applied when comparing the value of the operand
        field to alert conditions. Only applicable to threshold alerts.
      name: operator
      predefined:
      - ==
      - '>'
      - <
      - '>='
      - <=
    - description: The second monitored metric when applying a ratio. Only applicable
        to threshold alerts.
      name: field_name2
    - auto: PREDEFINED
      description: The type of comparison between the field_name and field_name2 fields
        when applying a ratio. Only applicable to threshold alerts.
      name: field_op
      predefined:
      - /
      - "null"
    - description: The first alert parameter, which is either a key pattern or a data
        point. Only applicable to threshold alerts.
      name: param
    - description: The second alert parameter, which is either a key pattern or a
        data point. Only applicable to threshold alerts.
      name: param2
    description: Modify an alert rule in Reveal(x).
    name: extrahop-edit-alert
  - arguments:
    - description: The ID of the Demisto Incident to ticket track.
      name: incident_id
      required: true
    - description: The ID of the ExtraHop Detection to ticket track.
      name: detection_id
      required: true
    - description: Owner of the incident.
      name: incident_owner
    - description: Status of the incident
      name: incident_status
    - description: Reason the incident was closed
      name: incident_close_reason
    description: Link a Reveal(x) detection to a Demisto Investigation.
    name: extrahop-track-ticket
    outputs:
    - contextPath: ExtraHop.TicketId
      description: Demisto Incident ID successfully tracked to ExtraHop Detection
      type: string
  - arguments:
    - description: The IP Address or ExtraHop API ID of the source device to get peer
        devices.
      name: ip_or_id
      required: true
    - defaultValue: -30m
      description: 'The beginning timestamp of the time range the query will search,
        expressed in milliseconds since the epoch. A negative value is evaluated relative
        to the current time. The default unit for a negative value is milliseconds,
        but other units can be specified with one of the following unit suffixes:
        ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_from
    - description: 'The ending timestamp of the time range the query will search,
        expressed in milliseconds since the epoch. 0 indicates the time of the request.
        A negative value is evaluated relative to the current time. The default unit
        for a negative value is milliseconds, but other units can be specified with
        one of the following unit suffixes: ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_until
    - auto: PREDEFINED
      defaultValue: any
      description: The role of the peer device in relation to the origin device.
      name: peer_role
      predefined:
      - any
      - client
      - server
    - auto: PREDEFINED
      defaultValue: any
      description: A filter to only return peers that the source device has communicated
        with over this protocol. If no value is set, the object includes any protocol.
      name: protocol
      predefined:
      - any
      - AAA
      - ActiveMQ
      - AJP
      - amf
      - CIFS
      - DB
      - DHCP
      - DICOM
      - DNS
      - FIX
      - FTP
      - HL7
      - HTTP
      - IBMMQ
      - ICA
      - IKE/ISAKMP
      - IMAP
      - IPFIX
      - IPsec NAT-T
      - IRC
      - iSCSI
      - Kerberos
      - L2TP
      - LDAP
      - lync-compress
      - memcache
      - Modbus
      - MongoDB
      - MSMQ
      - MSN
      - MSRPC
      - NetFlow
      - NFS
      - NTP
      - OpenVPN
      - PCoIP
      - Perforce
      - POP3
      - RDP
      - Redis
      - RFB
      - RTCP
      - RTP
      - sFlow
      - SIP
      - SMPP
      - SMTP
      - SNMP
      - SSH
      - SSL
      - Syslog
      - TCP
      - telnet
      - UDP
      - WebSocket
    description: Get all peers for a device from Reveal(x).
    name: extrahop-get-peers
    outputs:
    - contextPath: ExtraHop.Device.Macaddr
      description: The MAC Address of the device.
      type: string
    - contextPath: ExtraHop.Device.DeviceClass
      description: The class of the device.
      type: string
    - contextPath: ExtraHop.Device.UserModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: number
    - contextPath: ExtraHop.Device.AutoRole
      description: The role automatically detected by the ExtraHop.
      type: string
    - contextPath: ExtraHop.Device.ParentId
      description: The ID of the parent device.
      type: number
    - contextPath: ExtraHop.Device.Vendor
      description: The device vendor.
      type: string
    - contextPath: ExtraHop.Device.Analysis
      description: The level of analysis preformed on the device.
      type: string
    - contextPath: ExtraHop.Device.DiscoveryId
      description: The UUID given by the Discover appliance.
      type: string
    - contextPath: ExtraHop.Device.DefaultName
      description: The default name of the device.
      type: string
    - contextPath: ExtraHop.Device.DisplayName
      description: The display name of device.
      type: string
    - contextPath: ExtraHop.Device.OnWatchlist
      description: Whether the device is on the advanced analysis whitelist.
      type: boolean
    - contextPath: ExtraHop.Device.ModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: number
    - contextPath: ExtraHop.Device.IsL3
      description: Indicates whether the device is a Layer 3 device.
      type: boolean
    - contextPath: ExtraHop.Device.Role
      description: The role of the device.
      type: string
    - contextPath: ExtraHop.Device.DiscoverTime
      description: The time that the device was discovered.
      type: number
    - contextPath: ExtraHop.Device.Id
      description: The ID of the device.
      type: number
    - contextPath: ExtraHop.Device.Ipaddr4
      description: The IPv4 address of the device.
      type: string
    - contextPath: ExtraHop.Device.Vlanid
      description: The ID of VLan.
      type: number
    - contextPath: ExtraHop.Device.Ipaddr6
      description: The IPv6 address of the device.
      type: string
    - contextPath: ExtraHop.Device.NodeId
      description: The Node ID of the Discover appliance.
      type: number
    - contextPath: ExtraHop.Device.Description
      description: A user customizable description of the device.
      type: string
    - contextPath: ExtraHop.Device.DnsName
      description: The DNS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.DhcpName
      description: The DHCP name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.CdpName
      description: The Cisco Discovery Protocol name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.NetbiosName
      description: The NetBIOS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.Url
      description: Link to the device details page in ExtraHop.
      type: string
    - contextPath: ExtraHop.Device.ClientProtocols
      description: The list of protocols the peer device is communicating as a client.
      type: string
    - contextPath: ExtraHop.Device.ServerProtocols
      description: The list of protocols the peer device is communicating as a server.
      type: string
  - arguments:
    - description: The IP Address or ExtraHop API ID of the device to get all active
        network protocols.
      name: ip_or_id
      required: true
    - defaultValue: -30m
      description: 'The beginning timestamp of the time range the query will search,
        expressed in milliseconds since the epoch. A negative value is evaluated relative
        to the current time. The default unit for a negative value is milliseconds,
        but other units can be specified with one of the following unit suffixes:
        ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_from
    - description: 'The ending timestamp of the time range the query will search,
        expressed in milliseconds since the epoch. 0 indicates the time of the request.
        A negative value is evaluated relative to the current time. The default unit
        for a negative value is milliseconds, but other units can be specified with
        one of the following unit suffixes: ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_until
    description: Get all active network protocols for a device from Reveal(x).
    name: extrahop-get-protocols
    outputs:
    - contextPath: ExtraHop.Device.Macaddr
      description: The MAC Address of the device.
      type: string
    - contextPath: ExtraHop.Device.DeviceClass
      description: The class of the device.
      type: string
    - contextPath: ExtraHop.Device.UserModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: number
    - contextPath: ExtraHop.Device.AutoRole
      description: The role automatically detected by the ExtraHop.
      type: string
    - contextPath: ExtraHop.Device.ParentId
      description: The ID of the parent device.
      type: number
    - contextPath: ExtraHop.Device.Vendor
      description: The device vendor.
      type: string
    - contextPath: ExtraHop.Device.Analysis
      description: The level of analysis preformed on the device.
      type: string
    - contextPath: ExtraHop.Device.DiscoveryId
      description: The UUID given by the Discover appliance.
      type: string
    - contextPath: ExtraHop.Device.DefaultName
      description: The default name of the device.
      type: string
    - contextPath: ExtraHop.Device.DisplayName
      description: The display name of device.
      type: string
    - contextPath: ExtraHop.Device.OnWatchlist
      description: Whether the device is on the advanced analysis whitelist.
      type: boolean
    - contextPath: ExtraHop.Device.ModTime
      description: The time of the most recent update, expressed in milliseconds since
        the epoch.
      type: number
    - contextPath: ExtraHop.Device.IsL3
      description: Indicates whether the device is a Layer 3 device.
      type: boolean
    - contextPath: ExtraHop.Device.Role
      description: The role of the device.
      type: string
    - contextPath: ExtraHop.Device.DiscoverTime
      description: The time that the device was discovered.
      type: number
    - contextPath: ExtraHop.Device.Id
      description: The ID of the device.
      type: number
    - contextPath: ExtraHop.Device.Ipaddr4
      description: The IPv4 address of the device.
      type: string
    - contextPath: ExtraHop.Device.Vlanid
      description: The ID of VLan.
      type: number
    - contextPath: ExtraHop.Device.Ipaddr6
      description: The IPv6 address of the device.
      type: string
    - contextPath: ExtraHop.Device.NodeId
      description: The Node ID of the Discover appliance.
      type: number
    - contextPath: ExtraHop.Device.Description
      description: A user customizable description of the device.
      type: string
    - contextPath: ExtraHop.Device.DnsName
      description: The DNS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.DhcpName
      description: The DHCP name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.CdpName
      description: The Cisco Discovery Protocol name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.NetbiosName
      description: The NetBIOS name associated with the device.
      type: string
    - contextPath: ExtraHop.Device.Url
      description: Link to the device details page in ExtraHop.
      type: string
    - contextPath: ExtraHop.Device.ClientProtocols
      description: The list of protocols the peer device is communicating as a client.
      type: string
    - contextPath: ExtraHop.Device.ServerProtocols
      description: The list of protocols the peer device is communicating as a server.
      type: string
  - arguments:
    - description: The case-sensitive value of the tag.
      name: tag
    - description: The list of IP Addresses or ExtraHop API IDs of the devices to
        tag, comma separated.
      isArray: true
      name: add
    - description: The list of IP Addresses or ExtraHop API IDs of the devices to
        remove the tag from, comma separated.
      isArray: true
      name: remove
    description: Add or remove a tag from devices in Reveal(x).
    name: extrahop-tag-devices
  - arguments:
    - description: The IP Address or ExtraHop API ID of the source device to get an
        activity map.
      name: ip_or_id
      required: true
    - auto: PREDEFINED
      defaultValue: 30 minutes
      description: The time interval of the live activity map, expressed as the "Last"
        30 minutes. For example, specify a value of 30 minutes to get an activity
        map showing the time range of the last 30 minutes. This field is ignored if
        from_time and until_time are provided.
      name: time_interval
      predefined:
      - 30 minutes
      - 6 hours
      - 1 day
      - 1 week
    - description: The beginning timestamp of a fixed time range the activity map
        will display, expressed in seconds since the epoch.
      name: from_time
    - description: The ending timestamp of a fixed time range the activity map will
        display, expressed in seconds since the epoch.
      name: until_time
    - auto: PREDEFINED
      defaultValue: any
      description: The role of the peer devices in relation to the source device.
        For example, specifying a peer_role of client will show All Clients communicating
        with the source device. Additionally specifying a protocol of HTTP will result
        in further filtering and only showing HTTP Clients communicating with the
        source device.
      name: peer_role
      predefined:
      - any
      - client
      - server
    - auto: PREDEFINED
      defaultValue: any
      description: The protocol over which the source device is communicating. For
        example, specifying a protocol of HTTP show only HTTP Clients and HTTP Servers
        communicating with the source device. Additionally specifying a peer_role
        of client will result in further filtering and only showing HTTP Clients communicating
        with the source device.
      name: protocol
      predefined:
      - any
      - AAA
      - ActiveMQ
      - AJP
      - amf
      - CIFS
      - DB
      - DHCP
      - DICOM
      - DNS
      - FIX
      - FTP
      - HL7
      - HTTP
      - IBMMQ
      - ICA
      - IKE/ISAKMP
      - IMAP
      - IPFIX
      - IPsec NAT-T
      - IRC
      - iSCSI
      - Kerberos
      - L2TP
      - LDAP
      - lync-compress
      - memcache
      - Modbus
      - MongoDB
      - MSMQ
      - MSN
      - MSRPC
      - NetFlow
      - NFS
      - NTP
      - OpenVPN
      - PCoIP
      - Perforce
      - POP3
      - RDP
      - Redis
      - RFB
      - RTCP
      - RTP
      - sFlow
      - SIP
      - SMPP
      - SMTP
      - SNMP
      - SSH
      - SSL
      - Syslog
      - TCP
      - telnet
      - UDP
      - WebSocket
    description: Get a link to a live activity map in Reveal(x).
    name: extrahop-get-activity-map
    outputs:
    - contextPath: ExtraHop.ActivityMap
      description: The link to a visual activity map in ExtraHop.
      type: string
  - arguments:
    - auto: PREDEFINED
      defaultValue: pcap
      description: The output format. A pcap file, A keylog.txt file that can be loaded
        in wireshark to decode ssl packets, or a zip file containing both a packets.pcap
        and keylog.txt.
      name: output
      predefined:
      - pcap
      - keylog_txt
      - zip
    - defaultValue: 10MB
      description: The maximum number of bytes to return.
      name: limit_bytes
    - defaultValue: 5m
      description: The maximum amount of time to run the packet search. The default
        unit is milliseconds, but other units can be specified with a unit suffix.
      name: limit_search_duration
    - defaultValue: -10m
      description: 'The beginning timestamp of the time range the search will include,
        expressed in milliseconds since the epoch. A negative value specifies that
        the search will begin with packets captured at a time in the past relative
        to the current time. For example, specify -10m to begin the search with packets
        captured 10 minutes before the time of the request. The default unit for a
        negative value is milliseconds, but other units can be specified with one
        of the following unit suffixes: ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_from
      required: true
    - description: 'The ending timestamp of the time range the search will include,
        expressed in milliseconds since the epoch. A 0 value specifies that the search
        will end with packets captured at the time of the search. A negative value
        specifies that the search will end with packets captured at a time in the
        past relative to the current time. For example, specify -5m to end the search
        with packets captured 5 minutes before the time of the request. The default
        unit for a negative value is milliseconds, but other units can be specified
        with one of the following unit suffixes: ms, s, m, h, d, w, M, y. See https://docs.extrahop.com/current/rest-api-guide/#supported-time-units-
        for more details on supported time units and suffixes.'
      name: query_until
    - description: The Berkeley Packet Filter (BPF) syntax for the packet search.
      name: bpf
    - description: Returns packets sent to or received by the specified IP address.
      name: ip1
    - description: Returns packets sent from or received on the specified port.
      name: port1
    - description: Returns packets sent to or received by the specified IP address.
      name: ip2
    - description: Returns packets sent from or received on the specified port.
      name: port2
    description: Search for specific packets in Reveal(x).
    name: extrahop-search-packets
  dockerimage: demisto/python3:3.7.2.200
  runonce: false
  script: |2-




    ''' IMPORTS '''

    import json
    import requests
    from ipaddress import ip_address
    from distutils.util import strtobool
    from typing import DefaultDict
    from collections import defaultdict

    # Disable insecure warnings
    requests.packages.urllib3.disable_warnings()

    ''' GLOBALS/PARAMS '''

    APIKEY = demisto.params().get('apikey')
    SERVER = SERVER = demisto.params().get('url', '').strip('/')
    USE_SSL = not demisto.params().get('insecure', False)
    BASE_URL = SERVER + '/api/v1/'
    HEADERS = {
        'Accept': 'application/json',
        'Authorization': 'ExtraHop apikey={key}'.format(key=APIKEY)
    }
    handle_proxy()


    ''' HELPER FUNCTIONS '''


    def http_request(method, url_suffix, data=None, params=None, raw_response=False):
        data = json.dumps(data)
        demisto.debug("EH - Request Endpoint: {url} \n EH - Request params: {params} \n EH - Request data: {body}".format(
            url=BASE_URL + url_suffix, params=params, body=data))
        try:
            res = requests.request(
                method,
                BASE_URL + url_suffix,
                verify=USE_SSL,
                data=data,
                headers=HEADERS,
                params=params
            )
        except requests.exceptions.RequestException:
            return_error('Failed to connect to - {url} - Please check the URL'.format(url=BASE_URL))
        # Handle error responses gracefully
        if res.status_code not in {200, 201, 204}:
            error_reason = res.reason
            try:
                resp = res.json()
                error_reason = resp.get('error_message', resp.get('cpc_error', resp.get('failures', res.reason)))
            except Exception:
                pass
            return_error('Error in API call to ExtraHop {code} - {reason}'.format(code=res.status_code, reason=error_reason))
        # Handle no content responses gracefully
        elif not raw_response:
            if res.status_code == 201:
                return demisto.results('Successfully Created')
            elif res.status_code == 204:
                return demisto.results('Successful Modification')
        return res


    def format_protocol_stack(protocol_list):
        if len(protocol_list) > 1:
            protos = protocol_list[1:]
        else:
            protos = protocol_list

        return ":".join(protos)


    def sort_protocols(protos_by_weight):
        sorted_protos = sorted(protos_by_weight.items(), key=lambda x: x[1], reverse=True)
        return [proto_tuple[0] for proto_tuple in sorted_protos]


    def parse_location_header(location):
        # Parse the object id from the location header
        if location:
            last_slash_index = location.rindex('/') + 1
            location_id = location[last_slash_index:]
            if location_id.isdigit():
                return location_id
        # return error in any other case
        return_error("Error unable to parse ExtraHop API response location header")


    def next_page(cursor):
        body = {
            "cursor": cursor
        }
        params = {
            "context_ttl": 30000
        }
        res_raw = http_request('POST', 'records/cursor', data=body, params=params)
        res = res_raw.json()
        return res.get('records', [])


    def format_alerts(alerts):
        hr_table = []
        ec = {
            "ExtraHop": {
                "Alert": []
            }
        }  # type: dict
        for alert in alerts:
            hr_table.append(alert)
            ec['ExtraHop']['Alert'].append(createContext(alert, keyTransform=string_to_context_key, removeNull=True))
        if len(alerts) == 0:
            demisto.results('No Alerts were found')
        else:
            demisto.results({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['markdown'],
                'Contents': alerts,
                'HumanReadable': tableToMarkdown("Found {} Alert(s)".format(len(alerts)),
                                                 hr_table, headerTransform=string_to_table_header, removeNull=True),
                'EntryContext': ec
            })


    def format_devices(devices, appliance_uuids, hr_title="{} Device(s) Found", no_results_msg="No Devices were found"):
        hr_table = []
        ec = {
            "ExtraHop": {
                "Device": []
            }
        }  # type: dict
        headers = ['Display Name', 'IP Address', 'MAC Address', 'Role', 'Vendor', 'URL']

        for device in devices:
            hr = {
                'Display Name': device.get('display_name'),
                'IP Address': device.get('ipaddr4', device.get('ipaddr6')),
                'MAC Address': device.get('macaddr'),
                'Role': device.get('role'),
                'Vendor': device.get('vendor')
            }

            device_url = "{}/extrahop/#/metrics/devices/{}.{}/overview/".format(
                SERVER, appliance_uuids[device.get('node_id')], device.get('discovery_id'))
            hr['URL'] = "[{}]({})".format("View Device in ExtraHop", device_url)
            device['url'] = device_url

            if 'client_protocols' in device or 'server_protocols' in device:
                hr['Protocols'] = {}
                # re-arrange headers to add protocol information
                headers = ['Display Name', 'IP Address', 'MAC Address', 'Role', 'Protocols', 'URL', 'Vendor']
                if 'client_protocols' in device:
                    hr['Protocols']['Client'] = ', '.join(device.get('client_protocols', []))
                if 'server_protocols' in device:
                    hr['Protocols']['Server'] = ', '.join(device.get('server_protocols', []))

            hr_table.append(hr)
            ec['ExtraHop']['Device'].append(createContext(device, keyTransform=string_to_context_key, removeNull=True))
        if len(devices) == 0:
            demisto.results(no_results_msg)
        else:
            demisto.results({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['markdown'],
                'Contents': devices,
                'HumanReadable': tableToMarkdown(hr_title.format(len(devices)), hr_table, headers=headers),
                'EntryContext': ec
            })


    def format_device_with_protocols(device, appliance_uuids):
        if not device.get('client_protocols') and not device.get('server_protocols'):
            demisto.results("No Protocol activity found")
        else:
            ec = {
                "ExtraHop": {
                    "Device": []
                }
            }  # type: dict
            headers = ['Display Name', 'IP Address', 'MAC Address',
                       'Protocols (Client)', 'Protocols (Server)', 'Role', 'Vendor', 'URL']

            hr = {
                'Display Name': device.get('display_name'),
                'IP Address': device.get('ipaddr4', device.get('ipaddr6')),
                'MAC Address': device.get('macaddr'),
                'Protocols (Client)': {},
                'Protocols (Server)': {},
                'Role': device.get('role'),
                'Vendor': device.get('vendor')
            }

            device_url = "{}/extrahop/#/metrics/devices/{}.{}/overview/".format(
                SERVER, appliance_uuids[device.get('node_id')], device.get('discovery_id'))
            hr['URL'] = "[{}]({})".format("View Device in ExtraHop", device_url)
            device['url'] = device_url

            hr['Protocols (Client)'] = ', '.join(device.get('client_protocols', []))
            hr['Protocols (Server)'] = ', '.join(device.get('server_protocols', []))

            ec['ExtraHop']['Device'].append(createContext(device, keyTransform=string_to_context_key, removeNull=True))
            demisto.results({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['markdown'],
                'Contents': device,
                'HumanReadable': tableToMarkdown("Device Activity Found", hr, headers=headers),
                'EntryContext': ec
            })


    def format_records(res):
        records = res.get("records")

        hr_table = []
        ec = {
            "ExtraHop": {
                "Record": []
            }
        }  # type: dict
        for record in records:
            hr_table.append(record['_source'])
            ec['ExtraHop']['Record'].append(createContext(record, keyTransform=string_to_context_key, removeNull=True))
        if len(records) == 0:
            demisto.results('No Records were found')
        else:
            demisto.results({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['markdown'],
                'Contents': res,
                'HumanReadable': tableToMarkdown("Showing {results} out of {total} Record(s) Found.".format(total=res.get('total', 0),
                                                 results=len(records)), hr_table),
                'EntryContext': createContext(ec, removeNull=True)
            })


    ''' REQUESTS FUNCTIONS '''


    def test_module():
        """
        Performs basic get request to check ExtraHop version
        """
        test_result = http_request('GET', 'extrahop')
        return test_result


    def get_appliance_uuids():
        res_raw = http_request('GET', 'networks')
        networks = res_raw.json()
        uuid_lookup = {}
        for network in networks:
            uuid_lookup[network['node_id']] = network['appliance_uuid']
        return uuid_lookup


    def get_device_by_ip(ip, active_from=None, active_until=None, limit=None, offset=None):
        devices = device_search(name=None, ip=ip, mac=None, role=None, software=None, vendor=None, tag=None, discover_time=None,
                                vlan=None, activity=None, operator="=", match_type="and", active_from=active_from,
                                active_until=active_until, limit=limit, l3_only=True)
        if devices:
            return devices[0]
        else:
            return_error("Error the IP Address {} was not found in ExtraHop.".format(ip))


    def get_device_by_id(api_id):
        return http_request('GET', 'devices/{id}'.format(id=api_id)).json()


    def get_devices_by_ip_or_id(devices_str, active_from=None, active_until=None, limit=None, id_only=False):
        devices = []
        for item in str(devices_str).split(','):
            if item.isdigit():
                if id_only:
                    devices.append(int(item))
                else:
                    device = get_device_by_id(item)
                    devices.append(device)
            else:
                try:
                    ip_address(item)
                except ValueError:
                    return_error("Error parsing IP Address {}".format(item))

                device = get_device_by_ip(item, active_from, active_until, limit)

                if id_only:
                    devices.append(int(device['id']))
                else:
                    devices.append(device)

        return devices


    def get_alerts():
        res_raw = http_request('GET', 'alerts')
        res = res_raw.json()
        return res


    def query_records(query_from, query_until, limit, offset,
                      field1, operator1, value1, field2, operator2, value2, match_type, types):
        data = {}
        if query_from:
            data['from'] = query_from
        if query_until:
            data['until'] = query_until
        if limit:
            if int(limit) > 1000:
                data['limit'] = 1000
                data['context_ttl'] = "30s"
            else:
                data['limit'] = int(limit)
        if offset:
            data['offset'] = int(offset)
        if types:
            try:
                data['types'] = ['~' + rec_type for rec_type in types.split(',')]
            except Exception:
                return_error('Error parsing the types argument, expected a comma separated list of types.')

        if field1 or value1 or field2 or value2:
            search_filters = [
                (field1, operator1, value1),
                (field2, operator2, value2)
            ]
            data['filter'] = {
                "operator": match_type,
                "rules": []
            }
            for search_filter in search_filters:
                if search_filter[0]:
                    rule = {
                        "field": search_filter[0],
                        "operator": search_filter[1],
                        "operand": search_filter[2] or ""
                    }
                    data['filter']['rules'].append(rule)

        res_raw = http_request('POST', 'records/search', data)
        res = res_raw.json()
        cursor = res.get('cursor')
        if cursor and res.get('total', 0) > data['limit']:
            additional_records = next_page(cursor)
            while len(additional_records) > 0:
                res['records'].extend(additional_records)
                additional_records = next_page(cursor)
        return res


    def device_search(name, ip, mac, role, software, vendor, tag, discover_time, vlan, activity,
                      operator, match_type, active_from, active_until, limit, l3_only):

        fields = {
            "name": name,
            "ipaddr": ip,
            "macaddr": mac,
            "role": role,
            "software": software,
            "vendor": vendor,
            "tag": tag,
            "discover_time": discover_time,
            "vlan": vlan,
            "activity": activity
        }

        data = {}
        if active_from:
            data['active_from'] = active_from
        if active_until:
            data['active_until'] = active_until
        if limit:
            data['limit'] = int(limit)
        if any([val is not None for val in fields.values()]):
            data['filter'] = {
                "operator": match_type,
                "rules": []
            }
            rules_list = data['filter']['rules']

            if l3_only:
                rules_list.append(
                    {
                        "field": "ipaddr",
                        "operator": "exists"
                    }
                )
                if match_type != "and":
                    data['filter']['operator'] = "and"
                    rules_list.append(
                        {
                            "operator": match_type,
                            "rules": []
                        }
                    )
                    rules_list = data['filter']['rules'][1]['rules']

            for field in fields.items():
                if field[1]:
                    search_filter = {
                        "field": field[0],
                        "operator": operator,
                        "operand": field[1]
                    }
                    rules_list.append(search_filter)

        res_raw = http_request('POST', 'devices/search', data=data)
        res = res_raw.json()
        return res


    def get_peers(ip_or_id, query_from, query_until, peer_role, protocol):
        device = get_devices_by_ip_or_id(ip_or_id)[0]
        api_id = int(device['id'])

        if device['analysis'] == 'discovery':
            demisto.results({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['markdown'],
                'Contents': ("This Device is in Discovery Mode. "
                             "Configure your [Analysis Priorities](https://docs.extrahop.com/current/analysis_priorities/) "
                             "or add this device to the "
                             "[Watchlist](https://docs.extrahop.com/current/analysis-priorities-faq/#what-is-the-watchlist) "
                             "manually with: `!extrahop-edit-watchlist add={}`".format(api_id))
            })

        body = {
            "edge_annotations": ["protocols"],
            "from": query_from,
            "walks": [{
                "origins": [{
                    "object_id": api_id,
                    "object_type": "device"
                }],
                "steps": [{
                    "relationships": [{
                        "protocol": protocol,
                        "role": peer_role
                    }]
                }]
            }]
        }
        if query_until:
            body['until'] = query_until

        activitymap_raw = http_request('POST', 'activitymaps/query', data=body)
        activitymap = activitymap_raw.json()

        peers = defaultdict(lambda: {
            'weight': 0,
            'client_protocols': defaultdict(int),
            'server_protocols': defaultdict(int)
        })  # type: DefaultDict[str, dict]

        for edge in activitymap['edges']:
            if edge["to"] == api_id:
                peer_id = edge['from']
                role_key = 'client_protocols'
            else:
                peer_id = edge['to']
                role_key = 'server_protocols'

            peers[peer_id]['weight'] += edge['weight']

            # add protocols
            if 'annotations' in edge and 'protocols' in edge['annotations']:
                for protocol_list in edge['annotations']['protocols']:
                    proto_stack = format_protocol_stack(protocol_list['protocol'])
                    peers[peer_id][role_key][proto_stack] += protocol_list['weight']

        peer_devices = []
        peer_ids_by_weight = [peer[0] for peer in sorted(peers.items(), key=lambda x:x[1]['weight'], reverse=True)]
        # Lookup each peer device by id
        for peer_id in peer_ids_by_weight:
            device = get_device_by_id(peer_id)
            if peer_role in ('any', 'client'):
                device['client_protocols'] = sort_protocols(peers[peer_id]['client_protocols'])
            if peer_role in ('any', 'server'):
                device['server_protocols'] = sort_protocols(peers[peer_id]['server_protocols'])
            peer_devices.append(device)
        return peer_devices


    def get_protocols(ip_or_id, query_from, query_until):
        device = get_devices_by_ip_or_id(ip_or_id)[0]
        api_id = int(device['id'])

        if device['analysis'] == 'discovery':
            demisto.results({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['markdown'],
                'Contents': ("This Device is in Discovery Mode. "
                             "Configure your [Analysis Priorities](https://docs.extrahop.com/current/analysis_priorities/) "
                             "or add this device to the "
                             "[Watchlist](https://docs.extrahop.com/current/analysis-priorities-faq/#what-is-the-watchlist) "
                             "manually with: `!extrahop-edit-watchlist add={}`".format(api_id))
            })

        body = {
            "edge_annotations": ["protocols"],
            "from": query_from,
            "walks": [{
                "origins": [{
                    "object_id": api_id,
                    "object_type": "device"
                }],
                "steps": [{}]
            }]
        }
        if query_until:
            body['until'] = query_until

        activitymap_raw = http_request('POST', 'activitymaps/query', data=body)
        activitymap = activitymap_raw.json()

        client_protocols = defaultdict(int)  # type: DefaultDict[str, int]
        server_protocols = defaultdict(int)  # type: DefaultDict[str, int]
        for edge in activitymap['edges']:
            if 'annotations' in edge and 'protocols' in edge['annotations']:
                for protocol_list in edge['annotations']['protocols']:
                    proto_stack = format_protocol_stack(protocol_list['protocol'])
                    if edge["from"] == api_id:
                        client_protocols[proto_stack] += protocol_list['weight']
                    elif edge["to"] == api_id:
                        server_protocols[proto_stack] += protocol_list['weight']

        device['client_protocols'] = sort_protocols(client_protocols)
        device['server_protocols'] = sort_protocols(server_protocols)

        return device


    def edit_watchlist(add, remove):
        body = {}
        if add:
            body['assign'] = get_devices_by_ip_or_id(add, id_only=True)
        if remove:
            body['unassign'] = get_devices_by_ip_or_id(remove, id_only=True)

        res = http_request('POST', 'whitelist/devices', data=body)

        return res


    def get_watchlist():
        res_raw = http_request('GET', 'whitelist/devices')
        res = res_raw.json()
        return res


    def create_alert(apply_all, disabled, name, notify_snmp, refire_interval, severity, alert_type, object_type,
                     protocols, field_name, stat_name, units, interval_length, operand, operator, field_name2, field_op,
                     param, param2, alert_id=None):
        data = {
            "apply_all": apply_all,
            "disabled": disabled,
            "name": name,
            "notify_snmp": notify_snmp,
            "refire_interval": int(refire_interval),
            "severity": int(severity),
            "type": alert_type
        }
        if alert_type == 'detection':
            data['object_type'] = object_type
            data['protocols'] = [str(protocols)]
        elif alert_type == 'threshold':
            data['field_name'] = field_name
            data['stat_name'] = stat_name
            data['units'] = units
            data['interval_length'] = int(interval_length)
            data['operand'] = operand
            data['operator'] = operator
            if field_name2:
                data['field_name2'] = field_name2
            if field_op:
                data['field_op'] = field_op
            if param:
                data['param'] = param
            if param2:
                data['param2'] = param2
        if alert_id:
            method = 'PATCH'
            url_suffix = 'alerts/{alert_id}'.format(alert_id=alert_id)
        else:
            method = 'POST'
            url_suffix = 'alerts'

        res = http_request(method, url_suffix, data=data)
        return res


    def track_ticket(incident_id, detection_id, incident_owner, incident_status, incident_close_reason):
        detection_status = {
            'ticket_id': incident_id
        }

        status_map = {
            "0": 'new',           # pending
            "1": 'in_progress',   # active
            "2": 'closed',        # done
            "3": 'closed'         # archived
        }
        detection_status['status'] = status_map.get(str(incident_status))

        # Assignee cannot be an empty string
        detection_status['assignee'] = incident_owner if incident_owner else None
        # Only set Resolution if the incident is closed
        if detection_status['status'] == 'closed' and incident_close_reason:
            if incident_close_reason in ('Resolved'):
                detection_status['resolution'] = 'action_taken'
            elif incident_close_reason in ('False Positive', 'Duplicate'):
                detection_status['resolution'] = 'no_action_taken'
        else:
            # Clear resolution to avoid error
            detection_status['resolution'] = None

        res = http_request('PATCH', 'detections/{id}'.format(id=detection_id), data=detection_status, raw_response=True)
        return res


    def tag_devices(tag, add, remove):
        body = {}
        if add:
            body['assign'] = get_devices_by_ip_or_id(add, id_only=True)
        if remove:
            body['unassign'] = get_devices_by_ip_or_id(remove, id_only=True)

        all_tags = http_request('GET', 'tags').json()
        for t in all_tags:
            if t['name'] == tag:
                tag_id = t['id']
                break
        else:
            if remove and not add:
                return_warning("Warning: tag {} does not exist, nothing to remove.".format(tag))
            tag_create_res = http_request('POST', 'tags', data={'name': tag}, raw_response=True)
            tag_location = tag_create_res.headers.get('location')
            tag_id = parse_location_header(tag_location)

        res = http_request('POST', "tags/{}/devices".format(tag_id), data=body)

        return res


    def get_activity_map(ip_or_id, time_interval, from_time, until_time, peer_role, protocol):
        device = get_devices_by_ip_or_id(ip_or_id)[0]

        time_intervals = {
            '30 minutes': (30, 'MIN'),
            '6 hours': (6, 'HR'),
            '1 day': (1, 'DAY'),
            '1 week': (1, 'WK')
        }

        if from_time or until_time:
            if from_time and until_time:
                interval = 'DT'
                start = from_time
                end = until_time
            else:
                raise ValueError("When using a fixed time range both from_time and until_time timestamps need to be provided.")
        else:
            start, interval = time_intervals.get(time_interval, (30, 'MIN'))
            end = 0

        activity_map_params = {
            'server': SERVER,
            'app_id': get_appliance_uuids()[device.get('node_id')],
            'disc_id': device.get('discovery_id'),
            'start': start,
            'interval': interval,
            'obj': "device",
            'proto': protocol,
            'role': peer_role,
            'end': end
        }

        activity_map_link_format = ("{server}/extrahop/#/activitymaps"
                                    "?appliance_id={app_id}"
                                    "&discovery_id={disc_id}"
                                    "&from={start}"
                                    "&interval_type={interval}"
                                    "&object_type={obj}"
                                    "&protocol={proto}"
                                    "&role={role}"
                                    "&until={end}")

        activity_map_link = activity_map_link_format.format(**activity_map_params)

        return activity_map_link


    def search_packets(output, limit_bytes, limit_search_duration, query_from, query_until, bpf, ip1, port1, ip2, port2):
        params = {
            'output': output,
            'limit_bytes': limit_bytes,
            'limit_search_duration': limit_search_duration,
            'always_return_body': 'false',
            'from': query_from,
            'until': query_until,
            'bpf': bpf,
            'ip1': ip1,
            'port1': port1,
            'ip2': ip2,
            'port2': port2
        }

        res = http_request("GET", "packets/search", params=params, raw_response=True)

        return res


    ''' COMMANDS FUNCTIONS '''


    def create_or_edit_alert_command():
        dargs = demisto.args()
        alert_id = dargs.get('alert_id')
        apply_all = bool(strtobool(dargs.get('apply_all', False)))
        disabled = bool(strtobool(dargs.get('disabled', False)))
        name = dargs.get('name')
        notify_snmp = bool(strtobool(dargs.get('notify_snmp', False)))
        field_name = dargs.get('field_name')
        stat_name = dargs.get('stat_name')
        units = dargs.get('units')
        interval_length = dargs.get('interval_length')
        operand = dargs.get('operand')
        refire_interval = dargs.get('refire_interval')
        severity = dargs.get('severity')
        alert_type = dargs.get('type')
        object_type = dargs.get('object_type')
        protocols = dargs.get('protocols')
        operator = dargs.get('operator')
        field_name2 = dargs.get('field_name2')
        field_op = dargs.get('field_op')
        param = dargs.get('param')
        param2 = dargs.get('param2')
        create_alert(apply_all, disabled, name, notify_snmp, refire_interval, severity, alert_type, object_type,
                     protocols, field_name, stat_name, units, interval_length, operand, operator, field_name2, field_op,
                     param, param2, alert_id)


    def get_alerts_command():
        res = get_alerts()
        format_alerts(res)


    def edit_watchlist_command():
        dargs = demisto.args()
        add = dargs.get('add')
        remove = dargs.get('remove')
        edit_watchlist(add, remove)


    def query_records_command():
        dargs = demisto.args()
        query_from = dargs.get('query_from')
        query_until = dargs.get('query_until')
        limit = dargs.get('limit')
        offset = dargs.get('offset')
        field1 = dargs.get('field1')
        operator1 = dargs.get('operator1')
        value1 = dargs.get('value1')
        field2 = dargs.get('field2')
        operator2 = dargs.get('operator2')
        value2 = dargs.get('value2')
        match_type = dargs.get('match_type')
        types = dargs.get('types')
        res = query_records(query_from, query_until, limit, offset, field1, operator1, value1,
                            field2, operator2, value2, match_type, types)
        format_records(res)


    def get_watchlist_command():
        res = get_watchlist()
        if len(res) == 0:
            demisto.results('No Devices were found in the watchlist')
        elif len(res) > 0:
            format_devices(res, get_appliance_uuids())


    def device_search_command():
        dargs = demisto.args()
        name = dargs.get('name')
        ip = dargs.get('ip')
        mac = dargs.get('mac')
        role = dargs.get('role')
        software = dargs.get('software')
        vendor = dargs.get('vendor')
        tag = dargs.get('tag')
        discover_time = dargs.get('discover_time')
        vlan = dargs.get('vlan')
        activity = dargs.get('activity')
        operator = dargs.get('operator')
        match_type = dargs.get('match_type')
        active_from = dargs.get('active_from')
        active_until = dargs.get('active_until')
        limit = dargs.get('limit')
        l3_only = bool(strtobool(dargs.get('l3_only', True)))
        found_devices = device_search(name, ip, mac, role, software, vendor, tag, discover_time,
                                      vlan, activity, operator, match_type, active_from, active_until, limit, l3_only)
        format_devices(found_devices, get_appliance_uuids())


    def track_ticket_command():
        dargs = demisto.args()
        incident_id = dargs.get('incident_id')
        detection_id = dargs.get('detection_id')
        incident_owner = dargs.get('incident_owner')
        incident_status = dargs.get('incident_status')
        incident_close_reason = dargs.get('incident_close_reason')
        track_ticket(incident_id, detection_id, incident_owner, incident_status, incident_close_reason)
        ec = {
            "ExtraHop": {
                "TicketId": incident_id
            }
        }  # type: dict
        demisto.results({
            'Type': entryTypes['note'],
            'ContentsFormat': formats['markdown'],
            'Contents': ec,
            'HumanReadable': 'Successful Modification',
            'EntryContext': createContext(ec, removeNull=True)
        })


    def get_peers_command():
        dargs = demisto.args()
        ip_or_id = dargs.get('ip_or_id')
        query_from = dargs.get('query_from', '-30m')
        query_until = dargs.get('query_until')
        peer_role = dargs.get('peer_role')
        protocol = dargs.get('protocol')
        peer_devices = get_peers(ip_or_id, query_from, query_until, peer_role, protocol)
        format_devices(peer_devices, get_appliance_uuids(), hr_title="{} Peer Device(s) Found",
                       no_results_msg="No Peer Devices were found")


    def get_protocols_command():
        dargs = demisto.args()
        ip_or_id = dargs.get('ip_or_id')
        query_from = dargs.get('query_from')
        query_until = dargs.get('query_until')
        device = get_protocols(ip_or_id, query_from, query_until)
        format_device_with_protocols(device, get_appliance_uuids())


    def tag_devices_command():
        dargs = demisto.args()
        tag = dargs.get('tag')
        add = dargs.get('add')
        remove = dargs.get('remove')
        tag_devices(tag, add, remove)


    def get_activity_map_command():
        dargs = demisto.args()
        ip_or_id = dargs.get('ip_or_id')
        time_interval = dargs.get('time_interval')
        from_time = dargs.get('from_time')
        until_time = dargs.get('until_time')
        peer_role = dargs.get('peer_role')
        protocol = dargs.get('protocol')
        activity_map_link = get_activity_map(ip_or_id, time_interval, from_time, until_time, peer_role, protocol)

        ec = {
            "ExtraHop": {
                "ActivityMap": activity_map_link
            }
        }  # type: dict
        return_outputs('[View Live Activity Map in ExtraHop]({})'.format(activity_map_link), createContext(ec, removeNull=True), ec)


    def search_packets_command():
        dargs = demisto.args()
        output = dargs.get('output')
        limit_bytes = dargs.get('limit_bytes')
        limit_search_duration = dargs.get('limit_search_duration')
        query_from = dargs.get('query_from')
        query_until = dargs.get('query_until')
        bpf = dargs.get('bpf')
        ip1 = dargs.get('ip1')
        port1 = dargs.get('port1')
        ip2 = dargs.get('ip2')
        port2 = dargs.get('port2')

        res_raw = search_packets(output, limit_bytes, limit_search_duration, query_from, query_until, bpf, ip1, port1, ip2, port2)
        if res_raw.status_code == 204:
            demisto.results('Search matched no packets.')
        else:
            filename_header = res_raw.headers.get('content-disposition')
            f_attr = 'filename='
            if filename_header and f_attr in filename_header:
                quoted_filename = filename_header[filename_header.index(f_attr) + len(f_attr):]
                filename = quoted_filename.replace('"', '')
            else:
                return_error('Error filename could not be found in response header.')

            demisto.results(fileResult(filename, res_raw.content))


    ''' COMMANDS MANAGER / SWITCH PANEL '''


    try:
        if demisto.command() == 'test-module':
            test_module()
            demisto.results('ok')
        elif demisto.command() == 'extrahop-get-alerts':
            get_alerts_command()
        elif demisto.command() == 'extrahop-query-records':
            query_records_command()
        elif demisto.command() == 'extrahop-device-search':
            device_search_command()
        elif demisto.command() == 'extrahop-edit-watchlist':
            edit_watchlist_command()
        elif demisto.command() == 'extrahop-get-watchlist':
            get_watchlist_command()
        elif demisto.command() == 'extrahop-create-alert':
            create_or_edit_alert_command()
        elif demisto.command() == 'extrahop-edit-alert':
            create_or_edit_alert_command()
        elif demisto.command() == 'extrahop-track-ticket':
            track_ticket_command()
        elif demisto.command() == 'extrahop-get-peers':
            get_peers_command()
        elif demisto.command() == 'extrahop-get-protocols':
            get_protocols_command()
        elif demisto.command() == 'extrahop-tag-devices':
            tag_devices_command()
        elif demisto.command() == 'extrahop-get-activity-map':
            get_activity_map_command()
        elif demisto.command() == 'extrahop-search-packets':
            search_packets_command()

    # Log exceptions
    except Exception as e:
        return_error('Failed to execute {} command. Error: {}'.format(demisto.command(), str(e)))
  subtype: python3
  type: python
system: true
