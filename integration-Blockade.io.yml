category: Data Enrichment & Threat Intelligence
commonfields:
  id: Blockade.io
  version: -1
configuration:
- defaultvalue: ""
  display: Email
  name: email
  required: true
  type: 0
- defaultvalue: ""
  display: Key
  name: key
  required: true
  type: 4
- defaultvalue: ""
  display: Server URL
  name: url
  required: true
  type: 0
description: Blockade brings antivirus-like capabilities to users who run the Chrome
  browser. Built as an extension, Blockade blocks malicious resources from being viewed
  or loaded inside of the browser.
detaileddescription: |-
  Blockade focuses on those who are often targeted via phishing attacks and may not have a substantial capability at their disposal. Using threat intelligence mined from multiple sources (and analysts), Blockade attempts to detect attacks that may exist in the browser by monitoring web traffic requests. The primary goal for the project is to detect and prevent as many attacks as possible for those who would otherwise go left unnoticed.
  To learn more and set your own cloud node go to https://www.blockade.io/
display: Blockade.io
image: data:image/png;base64,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
name: Blockade.io
script:
  commands:
  - arguments:
    - description: Optional DB name in a multi-DB cloud node
      name: dbroute
    description: Lists all the indicators for Blockade to consume
    name: blockade-get-indicators
  - arguments:
    - default: true
      description: The list of MD5 hashes to add as indicators. Multiple hashes can
        be added separated by ",".
      name: indicators
      required: true
    description: Add indicators to the database
    name: blockade-add-indicators
  runonce: false
  script: |
    var serverUrl = params.url;
    if (serverUrl[serverUrl.length - 1] !== '/') {
        serverUrl += '/';
    }

    var doReq = function(method, path, body) {
        var result = http(
            serverUrl + path,
                {
                    Headers: {'Content-Type': ['application/json']},
                    Method: method,
                    Body: body ? body : ''
                }
        );
        if (result.StatusCode < 200 || result.StatusCode > 299) {
            throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode + ', check that username/password are correct';
        }
        return result.Body;
    };

    switch (command) {
        // This is the call made when pressing the integration test button.
        case 'test-module':
            doReq('')
            return 'ok';
        case 'blockade-get-indicators':
            var path = (args.dbroute ? args.dbroute + '/' : '') + 'get-indicators';
            return {Type: 1, Contents: doReq('GET', path), ContentsFormat: 'json'};
        case 'blockade-add-indicators':
            return {Type: 1, Contents: doReq('POST', 'admin/add-indicators', JSON.stringify({email: params.email, api_key: params.key, indicators: argToList(args.indicators)})), ContentsFormat: 'json'};
        default:
            throw 'Unknown command requested - ' + command;
    }
  type: javascript
system: true
